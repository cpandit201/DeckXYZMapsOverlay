{"id":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","dependencies":[{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688279811807},{"name":"/project/deck-gl-examples-01/node_modules/@here/xyz-maps-core/package.json","includedInParent":true,"mtime":1688279861829}],"generated":{"js":"var define;\nvar global = arguments[3];\n/*\n * @here/xyz-maps-core\n * (c) 2019-2022 HERE\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global = typeof globalThis !== 'undefined' ? globalThis : global || self, (global.here = global.here || {}, global.here.xyz = global.here.xyz || {}, global.here.xyz.maps = factory()));\n})(this, (function () { 'use strict';\n\n\tlet shared;\n\tlet worker;\n\tfunction define(dep, factory) {\n\t    if (!shared) {\n\t        shared = factory;\n\t    } else if (!worker) {\n\t        worker = factory;\n\t    } else {\n\t        const xyz = here.xyz.maps;\n\t        const sharedExports = {};\n\t        shared(sharedExports);\n\t        xyz.__workerURL = window.URL.createObjectURL(new Blob(['var shared={};('+shared+')(shared);('+worker+')(shared);'], {type: 'text/javascript'}));\n\t        factory(xyz, sharedExports, xyz.common);\n\t    }\n\t}\n\n\n\tdefine([\"exports\"],(function(t){\"use strict\";\n\t/******************************************************************************\n\tCopyright (c) Microsoft Corporation.\n\n\tPermission to use, copy, modify, and/or distribute this software for any\n\tpurpose with or without fee is hereby granted.\n\n\tTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n\tREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n\tAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n\tINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n\tLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n\tOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n\tPERFORMANCE OF THIS SOFTWARE.\n\t***************************************************************************** */var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);},e(t,i)};function i(t,i){if(\"function\"!=typeof i&&null!==i)throw new TypeError(\"Class extends value \"+String(i)+\" is not a constructor or null\");function r(){this.constructor=t;}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r);}t.__assign=function(){return t.__assign=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},t.__assign.apply(this,arguments)};var r=function(){function t(t){this.bO=0,\"number\"==typeof t&&(t=new ArrayBuffer(t)),this.dV=new DataView(t),this.aB=t;}return t.prototype.setUint16Array=function(t){var e=this.bO,i=t.length;this.dV.setUint32(e,i),new Uint16Array(this.aB,e+4,i).set(t),this.bO+=4+2*i;},t.prototype.setLayer=function(t,e){var i=this.dV,r=this.bO;i.setUint16(r,Number(t)),i.setUint32(r+2,e),this.bO+=6;},t.prototype.setFeature=function(t,e){this.dV.setUint16(this.bO,t),this.bO+=2,this.setUint16Array(e);},t.prototype.getLayers=function(){for(var t=this.dV,e=t.byteLength,i=0,r={};i<e;){var n=t.getUint16(i),s=2*t.getUint32(i+2);i+=6,r[n]={offset:i,length:s,features:null},i+=s;}return r},t.prototype.getFeatures=function(t){if(t.features)return t.features;for(var e=t.features={},i=this.dV,r=this.aB,n=t.offset,s=n+t.length;n<s;){var o=i.getUint16(n),a=i.getUint32(n+2);n+=6,e[o]=new Uint16Array(r,n,a),n+=2*a;}},t.prototype.getBuffer=function(){return this.aB},t}(),n=function(){function t(t){for(var e in this.withCredentials=!1,this.responseType=\"\",t)this[e]=t[e];}return t.prototype.send=function(t){var e=t.success,i=t.error,r=t.responseType||this.responseType,n=t.headers,s=new XMLHttpRequest,o=t.withCredentials;if(s.withCredentials=null!=o?o:this.withCredentials,s.responseType=\"json\"==r?\"text\":r,s.onload=function(){var t,i,n=this.responseType;\"\"==n||\"text\"==n?(i=(t=this.responseText).length,\"json\"==r&&204!=this.status&&(t=JSON.parse(t))):i=(t=this.response).byteLength,this.status>=200&&this.status<=226&&e(t,i);},s.onreadystatechange=function(){4==this.readyState&&(this.status<200||this.status>=300)&&(this.onload=null,0!==this.status&&i&&i(this));},s.open(t.type||\"GET\",t.url,!0),n)for(var a in n)s.setRequestHeader(a,n[a]);return s.send(t.data||null),s},t}(),s={},o=/{([xX]|(COL))}/,a=/{([yY]|(ROW))}/,h=/{([zZ]|(LEVEL))}/,u=/{((qk)|(QK)|(quadkey)|(QUADKEY))}/,f=/{SUBDOMAIN_INT_1_4}/,p=/{SUBDOMAIN_INT}/,c=/{SUBDOMAIN_CHAR}/,l=function(t){function e(e){var i=t.call(this,\"Service request failed with HTTP status: '\"+e.status+\" \"+e.statusText+\"'\")||this;i.name=\"NetworkError\";var r=i,n=e.responseType;return r.statusCode=e.status,\"\"!=n&&\"text\"!=n||(r.responseText=e.responseText||null),i}return i(e,t),e}(Error),d=function(){function e(e){this.withCredentials=!1,this.headers=null,this.store=null,this.baseUrl=null,this.q={};var i=e.responseType||\"json\",r=e.src||e.url,o=!!e.withCredentials;this.withCredentials=o,this.baseUrl=r,this.headers=t.__assign(t.__assign({},s),e.headers||{}),\"function\"==typeof r&&(this.getUrl=function(t){return r(t.z,t.y,t.x,t.quadkey)}),this.http=new n({responseType:i,withCredentials:o}),this.tileType=e.tileType;}return e.createImageFromBlob=function(t,e){var i=new Image;return i.onload=function(t){window.URL.revokeObjectURL(i.src),e&&e(i);},i.src=window.URL.createObjectURL(t),i},e.prototype.getUrl=function(t){var e=4*Math.random()^0;return this.baseUrl.replace(f,e+1).replace(p,e).replace(c,\"abcd\"[e]).replace(u,t.quadkey).replace(h,t.z).replace(o,t.x).replace(a,t.y)},e.prototype.setUrl=function(t){this.baseUrl=t;},e.prototype.load=function(t,i,r){var n,s=this.getUrl(t),o=t.quadkey,a=this.q,h={id:o,url:s,success:i,error:r},u=this.tileType||t.type;\"image\"==u?(h.responseType=\"blob\",h.success=function(t){a[o]=n,e.createImageFromBlob(t,(function(t){delete a[o],n._aborted||i(t);}));}):(\"json\"==u&&(h.success=function(t,e){i(\"FeatureCollection\"==t.type?t.features:t,e);}),h.headers=this.headers),n=this.send(h);},e.prototype.abort=function(t){var e=this.q,i=t.quadkey,r=e[i];r&&(\"image\"==t.type&&(r.onload=undefined,r._aborted=!0),r.abort&&r.abort(),delete e[i]);},e.prototype.send=function(t){var e=t.id||t.key||Math.random(),i=this.q,r=t.success,n=t;n.success=function(t,n){delete i[e],r(t,n);};var s=t.error;return n.error=function(t){delete i[e],s&&s(new l(t),t);},i[e]=this.http.send(n)},e}(),y={read:function(t,e,i,r,n){var s,o,a=8*n-r-1,h=(1<<a)-1,u=h>>1,f=-7,p=i?n-1:0,c=i?-1:1,l=t[e+p];for(p+=c,s=l&(1<<-f)-1,l>>=-f,f+=a;f>0;s=256*s+t[e+p],p+=c,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=r;f>0;o=256*o+t[e+p],p+=c,f-=8);if(0===s)s=1-u;else {if(s===h)return o?NaN:1/0*(l?-1:1);o+=Math.pow(2,r),s-=u;}return (l?-1:1)*o*Math.pow(2,s-r)},write:function(t,e,i,r,n,s){var o,a,h,u=8*s-n-1,f=(1<<u)-1,p=f>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,l=r?0:s-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+p>=1?c/h:c*Math.pow(2,1-p))*h>=2&&(o++,h/=2),o+p>=f?(a=0,o=f):o+p>=1?(a=(e*h-1)*Math.pow(2,n),o+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,n),o=0));n>=8;t[i+l]=255&a,l+=d,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;t[i+l]=255&o,l+=d,o/=256,u-=8);t[i+l-d]|=128*y;}},w=g,v=y;function g(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length;}g.Varint=0,g.Fixed64=1,g.Bytes=2,g.Fixed32=5;var x=4294967296,b=1/x,F=\"undefined\"==typeof TextDecoder?null:new TextDecoder(\"utf8\");function _(t){return t.type===g.Bytes?t.readVarint()+t.pos:t.pos+1}function V(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function M(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=t;n--)i.buf[n+r]=i.buf[n];}function S(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i]);}function B(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i]);}function T(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i]);}function m(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i]);}function k(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i]);}function P(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i]);}function U(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i]);}function O(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i]);}function A(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i]);}function q(t,e){return (t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function C(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24;}function D(t,e){return (t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}g.prototype={destroy:function(){this.buf=null;},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,s=this.pos;this.type=7&r,t(n,e,this),this.pos===s&&this.skip(r);}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=q(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=D(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=q(this.buf,this.pos)+q(this.buf,this.pos+4)*x;return this.pos+=8,t},readSFixed64:function(){var t=q(this.buf,this.pos)+D(this.buf,this.pos+4)*x;return this.pos+=8,t},readFloat:function(){var t=v.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=v.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,r=this.buf;return e=127&(i=r[this.pos++]),i<128?e:(e|=(127&(i=r[this.pos++]))<<7,i<128?e:(e|=(127&(i=r[this.pos++]))<<14,i<128?e:(e|=(127&(i=r[this.pos++]))<<21,i<128?e:function(t,e,i){var r,n,s=i.buf;if(n=s[i.pos++],r=(112&n)>>4,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<3,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<10,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<17,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<24,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(1&n)<<31,n<128)return V(t,r,e);throw new Error(\"Expected varint not more than 10 bytes\")}(e|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&F?function(t,e,i){return F.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var r=\"\",n=e;for(;n<i;){var s,o,a,h=t[n],u=null,f=h>239?4:h>223?3:h>191?2:1;if(n+f>i)break;1===f?h<128&&(u=h):2===f?128==(192&(s=t[n+1]))&&(u=(31&h)<<6|63&s)<=127&&(u=null):3===f?(s=t[n+1],o=t[n+2],128==(192&s)&&128==(192&o)&&((u=(15&h)<<12|(63&s)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===f&&(s=t[n+1],o=t[n+2],a=t[n+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((u=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,f=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),n+=f;}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==g.Bytes)return t.push(this.readVarint(e));var i=_(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==g.Bytes)return t.push(this.readSVarint());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==g.Bytes)return t.push(this.readBoolean());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==g.Bytes)return t.push(this.readFloat());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==g.Bytes)return t.push(this.readDouble());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed32());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed32());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed64());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed64());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===g.Varint)for(;this.buf[this.pos++]>127;);else if(e===g.Bytes)this.pos=this.readVarint()+this.pos;else if(e===g.Fixed32)this.pos+=4;else {if(e!==g.Fixed64)throw new Error(\"Unimplemented type: \"+e);this.pos+=8;}},writeTag:function(t,e){this.writeVarint(t<<3|e);},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e;}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),C(this.buf,t,this.pos),this.pos+=4;},writeSFixed32:function(t){this.realloc(4),C(this.buf,t,this.pos),this.pos+=4;},writeFixed64:function(t){this.realloc(8),C(this.buf,-1&t,this.pos),C(this.buf,Math.floor(t*b),this.pos+4),this.pos+=8;},writeSFixed64:function(t){this.realloc(8),C(this.buf,-1&t,this.pos),C(this.buf,Math.floor(t*b),this.pos+4),this.pos+=8;},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,r;t>=0?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error(\"Given varint doesn't fit into 10 bytes\");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t;}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t;}(r,e);}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))));},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t);},writeBoolean:function(t){this.writeVarint(Boolean(t));},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,s=0;s<e.length;s++){if((r=e.charCodeAt(s))>55295&&r<57344){if(!n){r>56319||s+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null;}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128);}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&M(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i;},writeFloat:function(t){this.realloc(4),v.write(this.buf,t,this.pos,!0,23,4),this.pos+=4;},writeDouble:function(t){this.realloc(8),v.write(this.buf,t,this.pos,!0,52,8),this.pos+=8;},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i];},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;r>=128&&M(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r;},writeMessage:function(t,e,i){this.writeTag(t,g.Bytes),this.writeRawMessage(e,i);},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,S,e);},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,B,e);},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,k,e);},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,T,e);},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,m,e);},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,P,e);},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,U,e);},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,O,e);},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,A,e);},writeBytesField:function(t,e){this.writeTag(t,g.Bytes),this.writeBytes(e);},writeFixed32Field:function(t,e){this.writeTag(t,g.Fixed32),this.writeFixed32(e);},writeSFixed32Field:function(t,e){this.writeTag(t,g.Fixed32),this.writeSFixed32(e);},writeFixed64Field:function(t,e){this.writeTag(t,g.Fixed64),this.writeFixed64(e);},writeSFixed64Field:function(t,e){this.writeTag(t,g.Fixed64),this.writeSFixed64(e);},writeVarintField:function(t,e){this.writeTag(t,g.Varint),this.writeVarint(e);},writeSVarintField:function(t,e){this.writeTag(t,g.Varint),this.writeSVarint(e);},writeStringField:function(t,e){this.writeTag(t,g.Bytes),this.writeString(e);},writeFloatField:function(t,e){this.writeTag(t,g.Fixed32),this.writeFloat(e);},writeDoubleField:function(t,e){this.writeTag(t,g.Fixed64),this.writeDouble(e);},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e));}};var L={},N=E;function E(t,e){this.x=t,this.y=e;}E.prototype={clone:function(){return new E(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=e*this.x-i*this.y,n=i*this.x+e*this.y;return this.x=r,this.y=n,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.x+i*(this.x-e.x)-r*(this.y-e.y),s=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=n,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},E.convert=function(t){return t instanceof E?t:Array.isArray(t)?new E(t[0],t[1]):t};var j=N,I=R;function R(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(G,this,e);}function G(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){var i=t.readVarint()+t.pos;for(;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n;}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos);}function H(t){for(var e,i,r=0,n=0,s=t.length,o=s-1;n<s;o=n++)e=t[n],r+=((i=t[o]).x-e.x)*(e.y+i.y);return r}R.types=[\"Unknown\",\"Point\",\"LineString\",\"Polygon\"],R.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,n=0,s=0,o=0,a=[];t.pos<i;){if(n<=0){var h=t.readVarint();r=7&h,n=h>>3;}if(n--,1===r||2===r)s+=t.readSVarint(),o+=t.readSVarint(),1===r&&(e&&a.push(e),e=[]),e.push(new j(s,o));else {if(7!==r)throw new Error(\"unknown command \"+r);e&&e.push(e[0].clone());}}return e&&a.push(e),a},R.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,s=0,o=1/0,a=-1/0,h=1/0,u=-1/0;t.pos<e;){if(r<=0){var f=t.readVarint();i=7&f,r=f>>3;}if(r--,1===i||2===i)(n+=t.readSVarint())<o&&(o=n),n>a&&(a=n),(s+=t.readSVarint())<h&&(h=s),s>u&&(u=s);else if(7!==i)throw new Error(\"unknown command \"+i)}return [o,h,a,u]},R.prototype.toGeoJSON=function(t,e,i){var r,n,s=this.extent*Math.pow(2,i),o=this.extent*t,a=this.extent*e,h=this.loadGeometry(),u=R.types[this.type];function f(t){for(var e=0;e<t.length;e++){var i=t[e],r=180-360*(i.y+a)/s;t[e]=[360*(i.x+o)/s-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90];}}switch(this.type){case 1:var p=[];for(r=0;r<h.length;r++)p[r]=h[r][0];f(h=p);break;case 2:for(r=0;r<h.length;r++)f(h[r]);break;case 3:for(h=function(t){var e=t.length;if(e<=1)return [t];for(var i,r,n=[],s=0;s<e;s++){var o=H(t[s]);0!==o&&(void 0===r&&(r=o<0),r===o<0?(i&&n.push(i),i=[t[s]]):i.push(t[s]));}i&&n.push(i);return n}(h),r=0;r<h.length;r++)for(n=0;n<h[r].length;n++)f(h[r][n]);}1===h.length?h=h[0]:u=\"Multi\"+u;var c={type:\"Feature\",geometry:{type:u,coordinates:h},properties:this.properties};return \"id\"in this&&(c.id=this.id),c};var W=I,z=X;function X(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Y,this,e),this.length=this._features.length;}function Y(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){var e=null,i=t.readVarint()+t.pos;for(;t.pos<i;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null;}return e}(i));}X.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error(\"feature index out of bounds\");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new W(this._pbf,e,this.extent,this._keys,this._values)};var J=z,K=function(t,e){this.layers=t.readFields(Q,{},e);};function Q(t,e,i){if(3===t){var r=new J(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r);}}var Z=L.VectorTile=K;L.VectorTileFeature=I,L.VectorTileLayer=z,t.HTTPLoader=d,t.VectorTile=Z,t.XYZBin=r,t.__extends=i,t.pbf=w,t.vectorTile=L;}));\n\n\tdefine([\"./shared\"],(function(e){\"use strict\";var n={exports:{}};function r(e,n,r){r=r||2;var i,u,a,o,f,l,h,y=n&&n.length,c=y?n[0]*r:e.length,d=t(e,0,c,r,!0),g=[];if(!d||d.next===d.prev)return g;if(y&&(d=function(e,n,r,i){var x,u,a,o=[];for(x=0,u=n.length;x<u;x++)(a=t(e,n[x]*i,x<u-1?n[x+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),o.push(p(a));for(o.sort(v),x=0;x<o.length;x++)r=s(o[x],r);return r}(e,n,d,r)),e.length>80*r){i=a=e[0],u=o=e[1];for(var Z=r;Z<c;Z+=r)(f=e[Z])<i&&(i=f),(l=e[Z+1])<u&&(u=l),f>a&&(a=f),l>o&&(o=l);h=0!==(h=Math.max(a-i,o-u))?32767/h:0;}return x(d,g,r,i,u,h,0),g}function t(e,n,r,t,i){var x,u;if(i===q(e,n,r,t)>0)for(x=n;x<r;x+=t)u=M(x,e[x],e[x+1],u);else for(x=r-t;x>=n;x-=t)u=M(x,e[x],e[x+1],u);return u&&g(u,u.next)&&(z(u),u=u.next),u}function i(e,n){if(!e)return e;n||(n=e);var r,t=e;do{if(r=!1,t.steiner||!g(t,t.next)&&0!==d(t.prev,t,t.next))t=t.next;else {if(z(t),(t=n=t.prev)===t.next)break;r=!0;}}while(r||t!==n);return n}function x(e,n,r,t,v,s,l){if(e){!l&&s&&function(e,n,r,t){var i=e;do{0===i.z&&(i.z=h(i.x,i.y,n,r,t)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var n,r,t,i,x,u,a,o,f=1;do{for(r=e,e=null,x=null,u=0;r;){for(u++,t=r,a=0,n=0;n<f&&(a++,t=t.nextZ);n++);for(o=f;a>0||o>0&&t;)0!==a&&(0===o||!t||r.z<=t.z)?(i=r,r=r.nextZ,a--):(i=t,t=t.nextZ,o--),x?x.nextZ=i:e=i,i.prevZ=x,x=i;r=t;}x.nextZ=null,f*=2;}while(u>1)}(i);}(e,t,v,s);for(var p,y,c=e;e.prev!==e.next;)if(p=e.prev,y=e.next,s?a(e,t,v,s):u(e))n.push(p.i/r|0),n.push(e.i/r|0),n.push(y.i/r|0),z(e),e=y.next,c=y.next;else if((e=y)===c){l?1===l?x(e=o(i(e),n,r),n,r,t,v,s,2):2===l&&f(e,n,r,t,v,s):x(i(e),n,r,t,v,s,1);break}}}function u(e){var n=e.prev,r=e,t=e.next;if(d(n,r,t)>=0)return !1;for(var i=n.x,x=r.x,u=t.x,a=n.y,o=r.y,f=t.y,v=i<x?i<u?i:u:x<u?x:u,s=a<o?a<f?a:f:o<f?o:f,l=i>x?i>u?i:u:x>u?x:u,h=a>o?a>f?a:f:o>f?o:f,p=t.next;p!==n;){if(p.x>=v&&p.x<=l&&p.y>=s&&p.y<=h&&y(i,a,x,o,u,f,p.x,p.y)&&d(p.prev,p,p.next)>=0)return !1;p=p.next;}return !0}function a(e,n,r,t){var i=e.prev,x=e,u=e.next;if(d(i,x,u)>=0)return !1;for(var a=i.x,o=x.x,f=u.x,v=i.y,s=x.y,l=u.y,p=a<o?a<f?a:f:o<f?o:f,c=v<s?v<l?v:l:s<l?s:l,g=a>o?a>f?a:f:o>f?o:f,Z=v>s?v>l?v:l:s>l?s:l,w=h(p,c,n,r,t),m=h(g,Z,n,r,t),b=e.prevZ,k=e.nextZ;b&&b.z>=w&&k&&k.z<=m;){if(b.x>=p&&b.x<=g&&b.y>=c&&b.y<=Z&&b!==i&&b!==u&&y(a,v,o,s,f,l,b.x,b.y)&&d(b.prev,b,b.next)>=0)return !1;if(b=b.prevZ,k.x>=p&&k.x<=g&&k.y>=c&&k.y<=Z&&k!==i&&k!==u&&y(a,v,o,s,f,l,k.x,k.y)&&d(k.prev,k,k.next)>=0)return !1;k=k.nextZ;}for(;b&&b.z>=w;){if(b.x>=p&&b.x<=g&&b.y>=c&&b.y<=Z&&b!==i&&b!==u&&y(a,v,o,s,f,l,b.x,b.y)&&d(b.prev,b,b.next)>=0)return !1;b=b.prevZ;}for(;k&&k.z<=m;){if(k.x>=p&&k.x<=g&&k.y>=c&&k.y<=Z&&k!==i&&k!==u&&y(a,v,o,s,f,l,k.x,k.y)&&d(k.prev,k,k.next)>=0)return !1;k=k.nextZ;}return !0}function o(e,n,r){var t=e;do{var x=t.prev,u=t.next.next;!g(x,u)&&Z(x,t,t.next,u)&&b(x,u)&&b(u,x)&&(n.push(x.i/r|0),n.push(t.i/r|0),n.push(u.i/r|0),z(t),z(t.next),t=e=u),t=t.next;}while(t!==e);return i(t)}function f(e,n,r,t,u,a){var o=e;do{for(var f=o.next.next;f!==o.prev;){if(o.i!==f.i&&c(o,f)){var v=k(o,f);return o=i(o,o.next),v=i(v,v.next),x(o,n,r,t,u,a,0),void x(v,n,r,t,u,a,0)}f=f.next;}o=o.next;}while(o!==e)}function v(e,n){return e.x-n.x}function s(e,n){var r=function(e,n){var r,t=n,i=e.x,x=e.y,u=-1/0;do{if(x<=t.y&&x>=t.next.y&&t.next.y!==t.y){var a=t.x+(x-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>u&&(u=a,r=t.x<t.next.x?t:t.next,a===i))return r}t=t.next;}while(t!==n);if(!r)return null;var o,f=r,v=r.x,s=r.y,h=1/0;t=r;do{i>=t.x&&t.x>=v&&i!==t.x&&y(x<s?i:u,x,v,s,x<s?u:i,x,t.x,t.y)&&(o=Math.abs(x-t.y)/(i-t.x),b(t,e)&&(o<h||o===h&&(t.x>r.x||t.x===r.x&&l(r,t)))&&(r=t,h=o)),t=t.next;}while(t!==f);return r}(e,n);if(!r)return n;var t=k(r,e);return i(t,t.next),i(r,r.next)}function l(e,n){return d(e.prev,e,n.prev)<0&&d(n.next,e,e.next)<0}function h(e,n,r,t,i){return (e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*i|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function p(e){var n=e,r=e;do{(n.x<r.x||n.x===r.x&&n.y<r.y)&&(r=n),n=n.next;}while(n!==e);return r}function y(e,n,r,t,i,x,u,a){return (i-u)*(n-a)>=(e-u)*(x-a)&&(e-u)*(t-a)>=(r-u)*(n-a)&&(r-u)*(x-a)>=(i-u)*(t-a)}function c(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!function(e,n){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&Z(r,r.next,e,n))return !0;r=r.next;}while(r!==e);return !1}(e,n)&&(b(e,n)&&b(n,e)&&function(e,n){var r=e,t=!1,i=(e.x+n.x)/2,x=(e.y+n.y)/2;do{r.y>x!=r.next.y>x&&r.next.y!==r.y&&i<(r.next.x-r.x)*(x-r.y)/(r.next.y-r.y)+r.x&&(t=!t),r=r.next;}while(r!==e);return t}(e,n)&&(d(e.prev,e,n.prev)||d(e,n.prev,n))||g(e,n)&&d(e.prev,e,e.next)>0&&d(n.prev,n,n.next)>0)}function d(e,n,r){return (n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y)}function g(e,n){return e.x===n.x&&e.y===n.y}function Z(e,n,r,t){var i=m(d(e,n,r)),x=m(d(e,n,t)),u=m(d(r,t,e)),a=m(d(r,t,n));return i!==x&&u!==a||(!(0!==i||!w(e,r,n))||(!(0!==x||!w(e,t,n))||(!(0!==u||!w(r,e,t))||!(0!==a||!w(r,n,t)))))}function w(e,n,r){return n.x<=Math.max(e.x,r.x)&&n.x>=Math.min(e.x,r.x)&&n.y<=Math.max(e.y,r.y)&&n.y>=Math.min(e.y,r.y)}function m(e){return e>0?1:e<0?-1:0}function b(e,n){return d(e.prev,e,e.next)<0?d(e,n,e.next)>=0&&d(e,e.prev,n)>=0:d(e,n,e.prev)<0||d(e,e.next,n)<0}function k(e,n){var r=new V(e.i,e.x,e.y),t=new V(n.i,n.x,n.y),i=e.next,x=n.prev;return e.next=n,n.prev=e,r.next=i,i.prev=r,t.next=r,r.prev=t,x.next=t,t.prev=x,t}function M(e,n,r,t){var i=new V(e,n,r);return t?(i.next=t.next,i.prev=t,t.next.prev=i,t.next=i):(i.prev=i,i.next=i),i}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ);}function V(e,n,r){this.i=e,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1;}function q(e,n,r,t){for(var i=0,x=n,u=r-t;x<r;x+=t)i+=(e[u]-e[x])*(e[x+1]+e[u+1]),u=x;return i}n.exports=r,n.exports.default=r,r.deviation=function(e,n,r,t){var i=n&&n.length,x=i?n[0]*r:e.length,u=Math.abs(q(e,0,x,r));if(i)for(var a=0,o=n.length;a<o;a++){var f=n[a]*r,v=a<o-1?n[a+1]*r:e.length;u-=Math.abs(q(e,f,v,r));}var s=0;for(a=0;a<t.length;a+=3){var l=t[a]*r,h=t[a+1]*r,p=t[a+2]*r;s+=Math.abs((e[l]-e[p])*(e[h+1]-e[l+1])-(e[l]-e[h])*(e[p+1]-e[l+1]));}return 0===u&&0===s?0:Math.abs((s-u)/u)},r.flatten=function(e){for(var n=e[0][0].length,r={vertices:[],holes:[],dimensions:n},t=0,i=0;i<e.length;i++){for(var x=0;x<e[i].length;x++)for(var u=0;u<n;u++)r.vertices.push(e[i][x][u]);i>0&&(t+=e[i-1].length,r.holes.push(t));}return r};var L=function(e){var n=e._pbf;n.pos=e._geometry;for(var r,t=n.readVarint()+n.pos,i=1,x=0,u=0,a=0,o=[];n.pos<t;){if(x<=0){var f=n.readVarint();i=7&f,x=f>>3;}if(x--,1===i||2===i)u+=n.readSVarint(),a+=n.readSVarint(),1===i&&(r&&o.push(r),r=[]),r.push([u,a]);else {if(7!==i)throw new Error(\"unknown command \"+i);r&&r.push(r[0].slice());}}return r&&o.push(r),o};function T(e){var n=e.length;if(n<=1)return [e];for(var r,t,i=[],x=0;x<n;x++){var u=E(e[x]);0!==u&&(void 0===t&&(t=u<0),t===u<0?(r&&i.push(r),r=[e[x]]):r.push(e[x]));}return r&&i.push(r),i}function E(e){for(var n,r,t=0,i=0,x=e.length,u=x-1;i<x;u=i++)n=e[i],t+=((r=e[u])[0]-n[0])*(n[1]+r[1]);return t}var _=function(e,n){void 0===n&&(n=[]);for(var r=[],t=0,i=0;i<e.length;i++){for(var x=0;x<e[i].length;x++)n[n.length]=e[i][x][0],n[n.length]=e[i][x][1];i>0&&(t+=e[i-1].length,r[r.length]=t);}return {vertices:n,holes:r,dimensions:e[0][0].length}},W={id:\"MVTWorker\",Worker:function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return e.__extends(t,r),t.prototype.process=function(r,t,i,x){var u=function(r,t,i,x){var u=new e.VectorTile(new e.pbf(r)),a={},o=0,f=0,v=0;for(var s in u.layers){for(var l=u.layers[s],h=0,p=a[o++]={length:0,features:{}};h<l.length;){if(3==(S=l.feature(h)).type){for(var y=[],c=[],d=0,g=0,Z=T(L(S));g<Z.length;g++){var w=Z[g],m=_(w),b=n.exports(m.vertices,m.holes,m.dimensions);c.push(d);for(var k=0,M=b;k<M.length;k++){var z=M[k];y[y.length]=d+z;}d+=m.vertices.length/m.dimensions;}p.features[h]={tris:y,verts:[],polys:c,holes:[]},p.length+=y.length+2+1;}h++;}p.length&&(v++,f+=2*p.length);}var V=new e.XYZBin(6*v+f);if(f>0)for(var q in a){var E=(p=a[q]).length;if(E){V.setLayer(q,E);var W=p.features;for(var B in W){var S;b=(S=W[B]).tris,V.setFeature(Number(B),b);}}}return V.getBuffer()}(r);return {data:{mvt:r,triangles:u},transfer:[r,u]}},t}(function(){function n(){var n=this.loader=new e.HTTPLoader({responseType:\"arraybuffer\"}),r=this;self.addEventListener(\"message\",(function(e){var t=e.data,i=t.msg,x=t.quadkey,u=t.url,a=t.x,o=t.y,f=t.z;switch(i){case\"abort\":n.abort({quadkey:x});break;case\"load\":n.baseUrl=u,n.load({quadkey:x},(function(e){var n=r.process(e,a,o,f),t=n.data,i=n.transfer;self.postMessage({msg:\"success\",url:u,quadkey:x,data:t},i);}),(function(e){self.postMessage({msg:\"error\",url:u,quadkey:x,data:e});}));}}));}return n.prototype.process=function(e,n,r,t){return {data:e,transfer:[e]}},n}())},B=[W];self.addEventListener(\"message\",(function e(n){var r=n.data,t=r.msg,i=r.worker;if(r.payload,\"init\"==t){var x=B.find((function(e){return e.id==i})).Worker;x&&(new x,x=null),B=null,self.removeEventListener(\"message\",e);}}));}));\n\n\tdefine([\"exports\",\"./shared\",\"@here/xyz-maps-common\"],(function(e,t,r){\"use strict\";function o(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if(\"default\"!==r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return e[r]}});}})),t.default=e,Object.freeze(t)}var n=o(r),i=function(e,t){this.x=e,this.y=t;},a=function(e,t,r,o){this.minX=e,this.minY=t,this.maxX=r,this.maxY=o;},s=function(e,t){this.longitude=e,this.latitude=t;},u=function(e,t,r,o){this.minLon=e,this.minLat=t,this.maxLon=r,this.maxLat=o;},p=[{zIndex:0,type:\"Circle\",radius:6,fill:\"#ff0000\"}],l=[{zIndex:0,type:\"Line\",strokeWidth:10,stroke:\"#ff0000\"}],c=[{zIndex:0,type:\"Polygon\",strokeWidth:1,stroke:\"#ffffff\",fill:\"#ff0000\"}],h={styleGroups:{Point:p,MultiPoint:p,LineString:l,MultiLineString:l,Polygon:c,MultiPolygon:c},assign:function(e){return e.geometry.type}};function f(e,t){for(var r in t)e[r]=t[r];return e}var d=[],y=function(){function e(e,t){this.styleGroups=null,this._c=null;var r=function(e,t){if(\"object\"!=typeof e||null===e)return e;for(var o in t=t||(Array.isArray(e)?[]:{}),e)t[o]=r(e[o]);return t};for(var o in e)this[o]=\"styleGroups\"==o?r(e.styleGroups,{}):e[o];this._c=t||{};}return e.prototype.assign=function(e,t){return e.geometry.type},e.prototype.getCustomStyleGroup=function(e){return this._c[e.id]},e.prototype.getStyleGroup=function(e,t,r){var o=this._c[e.id];return (null==o||r)&&\"object\"!=typeof(o=this.assign(e,t))&&(o=this.styleGroups[o]),o},e.prototype.setStyleGroup=function(e,t,r){var o=e.id,n=this._c;return t&&r&&(t=this.merge(this.getStyleGroup(e),t)),t?n[o]=t:null===t||!1===t?t=n[o]=d:n[o]&&delete n[o],t},e.prototype.merge=function(e,t){if(null===t||!1===t)return null;for(var r,o=[],n=0,i=e.length;n<i;n++)r=f({},e[n]),t[n]&&f(r,t[n]),o[n]=r;return o},e}(),v=function(){function e(e){this.name=\"\",this.__type=\"Layer\";var t=this;for(var o in e)t[o]=e[o];null==t.id&&(t.id=\"L-\"+(1e8*Math.random()^0)),t._l=new r.Listener([\"layerAdd\",\"layerRemove\"]);}return e.prototype.addEventListener=function(e,t,r){var o=this._l;if(o.isDefined(e))return o.add(e,t,r)},e.prototype.removeEventListener=function(e,t,r){var o=this._l;if(o.isDefined(e))return o.remove(e,t,r)},e.prototype.dispatchEvent=function(e,t){t.layer=this;var r=new CustomEvent(e,{detail:t});this._l.trigger(e,r,!0);},e}(),g=\"featureRemove\",m=\"featureAdd\",x=\"featureCoordinatesChange\",_=\"styleGroupChange\",L=\"styleChange\",w=\"viewportReady\",T=\"clear\",b=function(e){function r(r){var o=this,n=r.pointerEvents;delete r.pointerEvents,(o=e.call(this,t.__assign({min:15,max:32,tiled:!0},r))||this)._p=[],o._sd=null,o._pev=!0,o.__type=\"Layer\",o.margin=20,o.tiled=!0,o.levelOffset=0,o.custom=!1;var i=o;[m,g,x,T,_,w,L].forEach((function(e){return i._l.addEvent(e)})),\"boolean\"==typeof n&&o.pointerEvents(n);var a,s=r.providers||r.provider,u=256,p=function(e,t,r){for(var o=e;o<=t;o++)i._p[o]=r;};if(s instanceof Array)for(var l=0,c=s;l<c.length;l++){var f=c[l];p(f.min,f.max,f.provider);}else {u=o.tileSize?s.size=o.tileSize:Math.max(u,s.size);var d=Number(512==u),y=i.min,v=i.max;p(y-d,v-d,s),i._fp=s,s.minLevel=y,s.maxLevel=v;}o.tileSize||u%256||(o.tileSize=u),o.levelOffset=Math.round(Math.log(o.tileSize)/Math.log(2)-8),i._p.forEach((function(e,t){e&&(\"FeatureProvider\"==e.__type&&(e.addEventListener(m,i._eventProxy,i),e.addEventListener(g,i._eventProxy,i),e.addEventListener(x,i._eventProxy,i)),e.addEventListener(T,i._eventProxy,i));})),i.setMargin(i.getMargin());var b=o._fp&&o._fp.styles;return (a=r.style||r.styles||b||h)&&i.setStyle(a),[\"style\",\"styles\",\"provider\",\"providers\"].forEach((function(e){delete i[e];})),o}return t.__extends(r,e),r.prototype.getProvider=function(e){return e?this._p[Math.floor(e)-this.levelOffset]:this._fp},r.prototype.addEventListener=function(t,r,o){var n;return this._l.isDefined(t)?e.prototype.addEventListener.call(this,t,r,o):null===(n=this._fp)||void 0===n?void 0:n.addEventListener(t,r,o)},r.prototype.removeEventListener=function(t,r,o){return this._l.isDefined(t)?e.prototype.removeEventListener.call(this,t,r,o):this._fp.removeEventListener(t,r,o)},r.prototype._eventProxy=function(e){var t=e.type,r=e.detail;r.layer=this,t==g&&this.setStyleGroup(r.feature),this._l.trigger(t,e,!0);},r.prototype.setFeatureCoordinates=function(e,t){return this._fp.setFeatureCoordinates(e,t)},r.prototype.addFeature=function(e,t){var r=this._fp;if(r.addFeature){var o=r.addFeature(e);return t&&this.setStyleGroup(o,t),o}},r.prototype.removeFeature=function(e){var t=this._fp;if(t.removeFeature)return t.removeFeature(e)},r.prototype.setStyleGroup=function(e,t,r){this._sd&&this.dispatchEvent(_,{feature:e,styleGroup:this._sd.setStyleGroup(e,t,r)});},r.prototype.getStyleGroup=function(e,t,r){var o;return null===(o=this._sd)||void 0===o?void 0:o.getStyleGroup(e,t,r)},r.prototype._getCustomStyleGroup=function(e){var t;return null===(t=this._sd)||void 0===t?void 0:t.getCustomStyleGroup(e)},r.prototype.search=function(e,t){var r=this._fp;if(r&&r.search)return r.search.apply(this._fp,arguments)},r.prototype.getTile=function(e,t){var r=e.length,o=this._p[r];if(o)return o.getTile(e,t)},r.prototype.cancelTile=function(e,t){var r=\"string\"==typeof e?e.length:e.quadkey.length,o=this._p[r];if(o&&o.cancel)return o.cancel(e,t)},r.prototype.getCachedTile=function(e){var t=e.length,r=this._p[t];if(r)return r.getCachedTile(e)},r.prototype.setStyle=function(e,t){void 0===t&&(t=!1);var r=function(e){return \"function\"==typeof e};r(e.getStyleGroup)&&r(e.setStyleGroup)||(e=new y(e,t&&this._sd&&this._sd._c)),this._sd=e,this.dispatchEvent(L,{style:e});},r.prototype.getStyle=function(){return this._sd},r.prototype.getMargin=function(){return this.margin},r.prototype.setMargin=function(e){void 0===e&&(e=0),e=Number(e);for(var t=this._p,r=t.length;r--;)t[r]&&t[r].setMargin(e);return this.margin=e},r.prototype.pointerEvents=function(e){return null!=e&&(this._pev=!!e),this._pev},r.prototype.getCopyright=function(e){for(var t,r=this._p.filter((function(e,t,r){return r.indexOf(e)===t})),o=[],n=0,i=function(t){t.length&&o.push.apply(o,t),--n||e&&e(o);};t=r.pop();)t&&t.getCopyright&&(n++,t.getCopyright(i));},r}(v);b.prototype.modifyFeatureCoordinates=b.prototype.setFeatureCoordinates;var P=function(e){function r(t,r,o){var n=e.call(this,r)||this;return n.cbs=new Map,o||(o=new ArrayBuffer(0)),n.worker=new Worker(window.here.xyz.maps.__workerURL),n.worker.postMessage({msg:\"init\",worker:t,payload:o},[o]),n.worker.addEventListener(\"message\",n.receiveMessage.bind(n)),n}return t.__extends(r,e),r.prototype.processData=function(e){return e.data},r.prototype.receiveMessage=function(e){var t=e.data;if(\"success\"===t.msg){var r=t.quadkey,o=this.cbs.get(r);o&&(this.cbs.delete(r),o.success(this.processData(t.data)));}},r.prototype.load=function(e,t,r){var o=this.getUrl(e),n=e.quadkey,i=e.x,a=e.y,s=e.z;this.cbs.set(n,{tile:e,success:t,error:r}),this.worker.postMessage({msg:\"load\",url:o,quadkey:n,x:i,y:a,z:s});},r.prototype.abort=function(e){var t=this.getUrl(e),r=e.quadkey,o=e.x,n=e.y,i=e.z;this.cbs.get(r)&&(this.cbs.delete(r),this.worker.postMessage({msg:\"abort\",url:t,quadkey:r,x:o,y:n,z:i}));},r}(t.HTTPLoader),M=function(e){function r(t){return e.call(this,\"MVTWorker\",t)||this}return t.__extends(r,e),r.prototype.processData=function(e){var r=new t.XYZBin(e.triangles),o=r.getLayers();for(var n in o)r.getFeatures(o[n]);return {mvt:e.mvt,xyz:o}},r}(P),E=function(){function e(e,t){this._m=0,this.id=e.id,this.properties=e.properties,this.geometry=e.geometry,this.bbox=e.bbox,this._provider=t;}return e.prototype.toJSON=function(){return r.JSUtils.clone({id:this.id,type:this.type,bbox:this.bbox,properties:this.properties,geometry:{type:this.geometry.type,coordinates:this.geometry.coordinates}})},e.prototype.getProvider=function(){return this._provider},e.prototype.getBBox=function(){return this._provider.decBBox(this)},e}();E.prototype.type=\"Feature\";\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self&&self;var F=t.vectorTile.VectorTile,S=t.vectorTile.VectorTileFeature;S.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,o=1,n=0,i=0,a=0,s=[];e.pos<r;){if(n<=0){var u=e.readVarint();o=7&u,n=u>>3;}if(n--,1===o||2===o)i+=e.readSVarint(),a+=e.readSVarint(),1===o&&(t&&s.push(t),t=[]),t.push([i,a]);else {if(7!==o)throw new Error(\"unknown command \"+o);t&&t.push(t[0].slice());}}return t&&s.push(t),s};var B=r.TaskManager.getInstance(),R=0;function O(e){for(var t,r,o=0,n=0,i=e.length,a=i-1;n<i;a=n++)t=e[n],o+=((r=e[a])[0]-t[0])*(t[1]+r[1]);return o}var k=function(e,t){return 360*e/t-180},C=function(e,t){var r=180-360*e/t;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90},U=function(e,t,r,o,n){var i=e.loadGeometry();switch(e.type){case 1:for(var a=[],s=0;s<i.length;s++)a[s]=i[s][0];n(i=a,t,r,o,e);break;case 2:for(s=0;s<i.length;s++)n(i[s],t,r,o,e);break;case 3:i=function(e){var t=e.length;if(t<=1)return [e];for(var r,o,n=[],i=0;i<t;i++){var a=O(e[i]);0!==a&&(void 0===o&&(o=a<0),o===a<0?(r&&n.push(r),r=[e[i]]):r.push(e[i]));}return r&&n.push(r),n}(i);for(s=0;s<i.length;s++)for(var u=0;u<i[s].length;u++)n(i[s][u],t,r,o,e);}return i};function z(e,t,r){var o=function(e,t,r,o){var n=1/0,i=-n,a=n,s=-a,u=e.extent*(1<<o),p=e.extent*t,l=e.extent*r,c=S.types[e.type];return U(e,t,r,o,(function(e){for(var t=0,r=e;t<r.length;t++){var o=r[t],u=o[0],p=o[1];u<n&&(n=u),u>i&&(i=u),p<a&&(a=p),p>s&&(s=p);}})).length>1&&(c=\"Multi\"+c),{bbox:[k(n+p,u),C(s+l,u),k(i+p,u),C(a+l,u)],type:c}}(e,t.x,t.y,t.z),n={type:\"Feature\",geometry:new D(o.type,e,t),properties:e.properties};return \"id\"in e&&(n.id=e.id),r&&(n.bbox=o.bbox),n}var I=function(e,t,r,o,n){for(var i=n.extent,a=1<<o,s=0,u=e;s<u.length;s++){var p=u[s];p[0]=(t+p[0]/i)/a,p[1]=(r+p[1]/i)/a;}},D=function(){function e(e,t,r){this.type=e,this._vtf=t,this.__xyz=r;}return e.prototype._coordinates=function(){var e=this.type,t=this.__xyz,r=t.x,o=t.y,n=t.z,i=U(this._vtf,r,o,n,I);return \"Point\"!=e&&\"Polygon\"!=e&&\"LineString\"!=e||(i=i[0]),i},Object.defineProperty(e.prototype,\"coordinates\",{get:function(){var e=this.__xyz,t=e.x,r=e.y,o=e.z;return function(e,t,r,o){var n=e.extent*(1<<o),i=e.extent*t,a=e.extent*r,s=U(e,t,r,o,(function(e){for(var t=0;t<e.length;t++){var r=e[t],o=k(r[0]+i,n),s=C(r[1]+a,n);e[t]=[o,s];}}));return 1===s.length&&(s=s[0]),s}(this._vtf,t,r,o)},enumerable:!1,configurable:!0}),e}();function Y(e){B.create({init:function(){var r=[],o=new F(new t.pbf(e.data.mvt)),n=e.tile;for(var i in o.layers)r.push(i);return {xyz:{x:n.x,y:n.y,z:n.z},mvt:o,xyzLayers:e.data.xyz,layers:r,l:0,f:0,geojson:[]}},priority:4,exec:function(e){for(var t,r,o,n,i=e.mvt,a=e.xyz,s=e.layers,u=e.xyzLayers,p=e.l,l=e.f,c=e.geojson;p<s.length;){for(t=i.layers[s[p]],n={x:a.x,y:a.y,z:a.z,l:t.name};l<t.length;){if(\"MultiPolygon\"==(o=(r=z(t.feature(l),n,!0)).geometry.type)||\"Polygon\"==o){var h=u[p]&&u[p].features[l];h&&(r.geometry._xyz=h);}if(r.id=++R,l++,null==r.properties.layer&&(r.properties.layer=t.name),c.push(r),!(l%16))return e.f=l,this.CONTINUE}return e.l=++p,e.f=0,this.CONTINUE}return this.BREAK},onDone:function(t){e.ready(t.geojson);}}).start();}var X=Math.PI,q=X/180,A=2*X*(19113026/3),j=Array.from({length:33},(function(e,t){return 40075017/256/(1<<t)})),G=function(e,t){return (e+180)/360*t},H=function(e,t){return (180-180/X*Math.log(Math.tan(X/4+e*X/360)))*t/360},J=function(e,t){return 360*e/t-180},N=function(e,t){var r=180-360*e/t;return 360/X*Math.atan(Math.exp(r*q))-90},V=function(e){return void 0===e&&(e=0),A*Math.cos(e*q)},Z={mapSizePixel:function(e,t){return Math.pow(2,t)*e},lon2x:G,lat2y:H,x2lon:J,y2lat:N,pixelToGeo:function(e,t,r){return new s(J(e,r),N(t,r))},geoToPixel:function(e,t,r){return new i(G(e,r),H(t,r))},meterToPixel:function(e,t){return e/j[t]},pixelToMeter:function(e,t){return e*j[t]},getGroundResolution:function(e){return j[e]},alt2z:function(e,t){return e/V(t)},earthCircumference:V},W=r.global.Math,K=256,Q=85.05112878,$=-85.05112878,ee=function(e,t,r){var o=1<<r;return [W.floor(Z.lon2x(e,o)),W.floor(Z.lat2y(t,o)),r]},te=function(e){\"number\"==typeof e&&(e=String(e));for(var t=e.length,r=0,o=0,n=0;n<t;++n)switch(r*=2,o*=2,e[n]){case\"1\":o++;break;case\"3\":o++;case\"2\":r++;}return [t,r,o]},re=function(e,t,r){for(var o,n=\"\";e-- >0;)n+=(0!=(r&(o=1<<e)))+2*(0!=(t&o));return n},oe=function(e,t,r){var o=K<<e,n=K*r,i=K*t;return [Z.x2lon(n,o),Z.y2lat(i+K,o),Z.x2lon(n+K,o),Z.y2lat(i,o)]},ne=function(e,t){for(var r=[],o=t[1]-e[1]+1,n=t[0]-e[0]+1,i=e[2],a=0;a<o;a++)for(var s=0;s<n;s++)r[r.length]=re(i,e[1]+a,e[0]+s);return r},ie={geoToGrid:ee,pixelToGrid:function(e,t,r){return [W.floor(e),W.floor(t),r]},quadToGrid:te,tileXYToQuadKey:re,getGeoBounds:oe,getTilesOfLevel:function(e,t){var r=[e],o=0,n=r.length,i=e.length;if(t<=i)return [e.substring(0,t)];for(;i<t;){for(;o<n;o++)r.push(r[o]+\"0\",r[o]+\"1\",r[o]+\"2\",r[o]+\"3\");o=n,n=r.length,i++;}return r.slice(o)},getTilesIds:ne,getTilesInRect:function(e,t,r,o,n){r>=180&&(r=179.999999),e<=-180&&(e=-180),o>=Q&&(o=85.05112778),t<$&&(t=-85.05112778);var i=ee(e,o,n),a=ee(r,t,n);return ne(i,a)}},ae={exports:{}};ae.exports=function(){function e(e,o,n,i,a){!function e(r,o,n,i,a){for(;i>n;){if(i-n>600){var s=i-n+1,u=o-n+1,p=Math.log(s),l=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*l*(s-l)/s)*(u-s/2<0?-1:1);e(r,o,Math.max(n,Math.floor(o-u*l/s+c)),Math.min(i,Math.floor(o+(s-u)*l/s+c)),a);}var h=r[o],f=n,d=i;for(t(r,n,o),a(r[i],h)>0&&t(r,n,i);f<d;){for(t(r,f,d),f++,d--;a(r[f],h)<0;)f++;for(;a(r[d],h)>0;)d--;}0===a(r[n],h)?t(r,n,d):t(r,++d,i),d<=o&&(n=d+1),o<=d&&(i=d-1);}}(e,o,n||0,i||e.length-1,a||r);}function t(e,t,r){var o=e[t];e[t]=e[r],e[r]=o;}function r(e,t){return e<t?-1:e>t?1:0}var o=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear();};function n(e,t,r){if(!r)return t.indexOf(e);for(var o=0;o<t.length;o++)if(r(e,t[o]))return o;return -1}function i(e,t){a(e,0,e.children.length,t,e);}function a(e,t,r,o,n){n||(n=d(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var i=t;i<r;i++){var a=e.children[i];s(n,e.leaf?o(a):a);}return n}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function u(e,t){return e.minX-t.minX}function p(e,t){return e.minY-t.minY}function l(e){return (e.maxX-e.minX)*(e.maxY-e.minY)}function c(e){return e.maxX-e.minX+(e.maxY-e.minY)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function f(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function d(e){return {children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,r,o,n,i){for(var a=[r,o];a.length;)if(!((o=a.pop())-(r=a.pop())<=n)){var s=r+Math.ceil((o-r)/n/2)*n;e(t,s,r,o,i),a.push(r,s,s,o);}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(e){var t=this.data,r=[];if(!f(e,t))return r;for(var o=this.toBBox,n=[];t;){for(var i=0;i<t.children.length;i++){var a=t.children[i],s=t.leaf?o(a):a;f(e,s)&&(t.leaf?r.push(a):h(e,s)?this._all(a,r):n.push(a));}t=n.pop();}return r},o.prototype.collides=function(e){var t=this.data;if(!f(e,t))return !1;for(var r=[];t;){for(var o=0;o<t.children.length;o++){var n=t.children[o],i=t.leaf?this.toBBox(n):n;if(f(e,i)){if(t.leaf||h(e,i))return !0;r.push(n);}}t=r.pop();}return !1},o.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else {if(this.data.height<r.height){var o=this.data;this.data=r,r=o;}this._insert(r,this.data.height-r.height-1,!0);}else this.data=r;return this},o.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},o.prototype.clear=function(){return this.data=d([]),this},o.prototype.remove=function(e,t){if(!e)return this;for(var r,o,i,a=this.data,s=this.toBBox(e),u=[],p=[];a||u.length;){if(a||(a=u.pop(),o=u[u.length-1],r=p.pop(),i=!0),a.leaf){var l=n(e,a.children,t);if(-1!==l)return a.children.splice(l,1),u.push(a),this._condense(u),this}i||a.leaf||!h(a,s)?o?(r++,a=o.children[r],i=!1):a=null:(u.push(a),p.push(r),r=0,o=a,a=a.children[0]);}return this},o.prototype.toBBox=function(e){return e},o.prototype.compareMinX=function(e,t){return e.minX-t.minX},o.prototype.compareMinY=function(e,t){return e.minY-t.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(e){return this.data=e,this},o.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},o.prototype._build=function(e,t,r,o){var n,a=r-t+1,s=this._maxEntries;if(a<=s)return i(n=d(e.slice(t,r+1)),this.toBBox),n;o||(o=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,o-1))),(n=d([])).leaf=!1,n.height=o;var u=Math.ceil(a/s),p=u*Math.ceil(Math.sqrt(s));y(e,t,r,p,this.compareMinX);for(var l=t;l<=r;l+=p){var c=Math.min(l+p-1,r);y(e,l,c,u,this.compareMinY);for(var h=l;h<=c;h+=u){var f=Math.min(h+u-1,c);n.children.push(this._build(e,h,f,o-1));}}return i(n,this.toBBox),n},o.prototype._chooseSubtree=function(e,t,r,o){for(;o.push(t),!t.leaf&&o.length-1!==r;){for(var n=1/0,i=1/0,a=void 0,s=0;s<t.children.length;s++){var u=t.children[s],p=l(u),c=(h=e,f=u,(Math.max(f.maxX,h.maxX)-Math.min(f.minX,h.minX))*(Math.max(f.maxY,h.maxY)-Math.min(f.minY,h.minY))-p);c<i?(i=c,n=p<n?p:n,a=u):c===i&&p<n&&(n=p,a=u);}t=a||t.children[0];}var h,f;return t},o.prototype._insert=function(e,t,r){var o=r?e:this.toBBox(e),n=[],i=this._chooseSubtree(o,this.data,t,n);for(i.children.push(e),s(i,o);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(o,n,t);},o.prototype._split=function(e,t){var r=e[t],o=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,o);var a=this._chooseSplitIndex(r,n,o),s=d(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,i(r,this.toBBox),i(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(r,s);},o.prototype._splitRoot=function(e,t){this.data=d([e,t]),this.data.height=e.height+1,this.data.leaf=!1,i(this.data,this.toBBox);},o.prototype._chooseSplitIndex=function(e,t,r){for(var o,n,i,s,u,p,c,h=1/0,f=1/0,d=t;d<=r-t;d++){var y=a(e,0,d,this.toBBox),v=a(e,d,r,this.toBBox),g=(n=y,i=v,s=void 0,u=void 0,p=void 0,c=void 0,s=Math.max(n.minX,i.minX),u=Math.max(n.minY,i.minY),p=Math.min(n.maxX,i.maxX),c=Math.min(n.maxY,i.maxY),Math.max(0,p-s)*Math.max(0,c-u)),m=l(y)+l(v);g<h?(h=g,o=d,f=m<f?m:f):g===h&&m<f&&(f=m,o=d);}return o||r-t},o.prototype._chooseSplitAxis=function(e,t,r){var o=e.leaf?this.compareMinX:u,n=e.leaf?this.compareMinY:p;this._allDistMargin(e,t,r,o)<this._allDistMargin(e,t,r,n)&&e.children.sort(o);},o.prototype._allDistMargin=function(e,t,r,o){e.children.sort(o);for(var n=this.toBBox,i=a(e,0,t,n),u=a(e,r-t,r,n),p=c(i)+c(u),l=t;l<r-t;l++){var h=e.children[l];s(i,e.leaf?n(h):h),p+=c(i);}for(var f=r-t-1;f>=t;f--){var d=e.children[f];s(u,e.leaf?n(d):d),p+=c(u);}return p},o.prototype._adjustParentBBoxes=function(e,t,r){for(var o=r;o>=0;o--)s(t[o],e);},o.prototype._condense=function(e){for(var t=e.length-1,r=void 0;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():i(e[t],this.toBBox);},o}();var se=function(e){function r(t){return e.call(this,t)||this}return t.__extends(r,e),r.prototype.toBBox=function(e){var t=e.bbox;return {minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},r.prototype.compareMinX=function(e,t){return e.bbox[0]-t.bbox[0]},r.prototype.compareMinY=function(e,t){return e.bbox[1]-t.bbox[1]},r}(ae.exports),ue=256,pe=null,le=function(){function e(e,t,r,o){var n=te(e);this.quadkey=e,this.z=n[0],this.y=n[1],this.x=n[2],this.type=t,this.bounds=oe(n[0],n[1],n[2]),this.expire=o,this.clipped=r;}return e.prototype.expired=function(e){return (e=e||Date.now())-this.loadStopTs>1e3*this.expire},e.prototype.add=function(e){var t=this.data;t&&-1==t.indexOf(e)&&(t.push(e),this.tree&&this.tree.insert(e));},e.prototype.remove=function(e){var t=this.data.indexOf(e);-1!==t&&(this.data.splice(t,1),this.tree&&this.tree.remove(e));},e.prototype.search=function(e){if(this.data)return this.tree||(this.tree=new se(9),this.tree.load(this.data)),this.tree.search(e)},e.prototype.isLoaded=function(){return \"number\"==typeof this.loadStopTs},e.prototype.getContentBounds=function(){if(!this.cbnds){var e=this.bounds,t=this.provider,r=t.margin;if(r){var o=t.size,n=o<<this.z,i=Z.lon2x(e[0],n),a=Z.lat2y(e[1],n);this.cbnds=[Z.x2lon(i-r,n),Z.y2lat(a+r,n),Z.x2lon(i+r+o,n),Z.y2lat(a-r-o,n)];}else this.cbnds=this.bounds;}return this.cbnds},e.prototype.project=function(e,t){var r=ue<<this.z,o=this.x*ue,n=this.y*ue;return [Math.round(Z.lon2x(e,r)-o),Math.round(Z.lat2y(t,r)-n)]},e.prototype.lon2x=function(e,t){void 0===t&&(t=ue);var r=t<<this.z,o=this.x*t;return Z.lon2x(e,r)-o},e.prototype.lat2y=function(e,t){void 0===t&&(t=ue);var r=t<<this.z,o=this.y*t;return Z.lat2y(e,r)-o},e.prototype.isInside=function(e){var t=this.bounds,r=e[0],o=e[1];return r>t[0]&&r<=t[2]&&o>t[1]&&o<=t[3]},e}(),ce=le.prototype;ce.expire=1/0,ce.error=pe,ce.canvasX=pe,ce.canvasY=pe;var he=function(e){function r(t,r,o,n){var i=e.call(this,t,r,o,n)||this;return i.s=1<<i.z,i}return t.__extends(r,e),r.prototype.lon2x=function(e,t){return void 0===t&&(t=256),(e*this.s-this.x)*t},r.prototype.lat2y=function(e,t){return void 0===t&&(t=256),(e*this.s-this.y)*t},r.prototype.isInside=function(e){var t=e[0]*this.s-this.x,r=e[1]*this.s-this.y;return !(t<0||t>1||r<0||r>1)},r}(le),fe=function(){function e(e,t,o){this.lvl=e,this.main=\"object\"==typeof t?t:new r.LRU(t||256),this.sub=\"object\"==typeof o?o:new r.LRU(t||1024);}return e.prototype.forEach=function(e){this.main.forEach(e),this.sub.forEach(e);},e.prototype.clear=function(){this.main.clear(),this.sub.clear();},e.prototype.getCache=function(e){return e==this.lvl?this.main:this.sub},e.prototype.remove=function(e){this.getCache(e.z).remove(e.quadkey);},e.prototype.get=function(e){return this.getCache(e.length).get(e)},e.prototype.set=function(e){var t=this.getCache(e.z).set(e.quadkey,e),r=this._onDrop;t&&r&&r(t);},e.prototype.onDrop=function(e){this._onDrop=e;},e}(),de=function(){function e(e){this.margin=0,this.Tile=le,this.size=256,this.expire=Infinity,this.clipped=!1;var t=this;for(var o in e=e||{})this[o]=e[o];null==this.id&&(this.id=\"TP-\"+(1e6*Math.random()^0)),t.storage=e.storage||new fe(t.level),t.initStorage(t.storage),this.listeners=new r.Listener([\"clear\",\"error\"]);}return e.prototype.dispatchEvent=function(e,t){t.provider=this;var r=new CustomEvent(e,{detail:t});this.listeners.trigger(e,r,!0);},e.prototype.initStorage=function(e){e.onDrop((function(e){return e.provider._removeTile(e)}));},e.prototype.addEventListener=function(e,t,r){return this.listeners.add(e,t,r)},e.prototype.removeEventListener=function(e,t,r){return this.listeners.remove(e,t,r)},e.prototype.clear=function(e){this.storage.clear();},e.prototype.getCachedTile=function(e){return this.storage.get(e)},e.prototype.setMargin=function(e){void 0===e&&(e=0),this.margin=Number(e),this.storage.forEach((function(e){return e.cbnds=null}));},e.prototype.getCachedTilesOfBBox=function(e,t){var r=e[0],o=e[1],n=e[2],i=e[3],a=[];return t^=0,this.storage.forEach((function(e){var s,u,p,l,c,h,f,d=e.getContentBounds();s=d[0],u=d[2],p=d[1],l=d[3],c=r,h=o,f=i,s<=n&&c<=u&&p<=f&&h<=l&&(!t||e.z==t)&&(a[a.length]=e);})),a},e.prototype.config=function(e){for(var t in e=e||{})this.config[t]=e[t];return this},e.prototype.createTile=function(e){var t=new this.Tile(e,this.dataType,this.clipped,this.expire);return t.provider=this,t},e}();de.prototype.__type=\"Provider\";var ye,ve=function(e,t){var r,o;t&&((r=e[0])<t[0]&&(t[0]=r),r>t[2]&&(t[2]=r),(o=e[1])<t[1]&&(t[1]=o),o>t[3]&&(t[3]=o));},ge=function(e,t){for(var r=e.length;r--;)ve(e[r],t);},me=function(e,t){var r=e.geometry.type,o=e.geometry.coordinates;if(\"Point\"==r)t?ve(o,t):t=[o[0],o[1],o[0],o[1]];else if(t=t||[1/0,1/0,-1/0,-1/0],\"MultiLineString\"==r)for(var n=0;n<o.length;n++)ge(o[n],t);else if(\"MultiPolygon\"==r)for(var i=0;i<o.length;i++)ge(o[i][0],t);else if(\"LineString\"==r||\"MultiPoint\"==r)ge(o,t);else {if(\"Polygon\"!=r)return !1;ge(o[0],t);}return t},xe={calcBBox:me},_e=\"featureRemove\",Le=\"featureAdd\",we=\"featureCoordinatesChange\";function Te(e){this.feature=e;}Te.prototype.cnt=0;var be=function(e){function o(t){var r=e.call(this,t)||this;return r.IDPOOL={},r.dataType=\"json\",r.ignore=!1,r.cnt=0,r.__type=\"FeatureProvider\",r.tree=new se(9),r.Feature=r.Feature||E,[Le,_e,we].forEach((function(e){return r.listeners.addEvent(e)})),r}return t.__extends(o,e),o.prototype.isDroppable=function(e){return !0},o.prototype.loadTileData=function(e,t,r){for(var o,n,i,a=this,s=[],u=t.length,p=0;p<u;p++)!1!==(o=a.prepareFeature(i=t[p]))?(i=o,(n=a._insert(i,e))?(i=n,s[s.length]=i):a.tree||(s[s.length]=a.getFeature(i.id))):(t.splice(p--,1),u--);t=s,a.tree&&a.tree.load(t),r(t=a.clipped?t:a.search(e.getContentBounds()));},o.prototype.addFeature=function(e){var t,r,o=this;if(\"object\"==typeof e){if(\"FeatureCollection\"==e.type&&(e=e.features||[]),Array.isArray(e)){for(var n=[],i=0,a=e.length;i<a;i++)n[i]=o.addFeature(e[i]);return n}if(o.isFeatureInstance(e,E)){var s=e.getProvider();s&&s!=o&&(e=e.toJSON());}if(!1!==(t=o.prepareFeature(e))){if((r=o._insert(t))!=ye){e=r;for(var u=o.getCachedTilesOfBBox(o.decBBox(e)),p=0,l=void 0;p<u.length;p++)(l=u[p]).add(e),l.z==o.level&&this._mark(e,l);o.tree&&o.tree.insert(e),o.ignore||o.dispatchEvent(Le,{feature:e,tiles:u});}}else e=null;return e}},o.prototype.addEventListener=function(t,r,o){return e.prototype.addEventListener.call(this,t,r,o)},o.prototype.removeEventListener=function(t,r,o){return e.prototype.removeEventListener.call(this,t,r,o)},o.prototype.all=function(){var e=this;return e.tree?e.tree.all():e._s({minX:-180,maxX:180,minY:-90,maxY:90})},o.prototype.getFeature=function(e){if(this.IDPOOL[e])return this.IDPOOL[e].feature},o.prototype.getFeatures=function(e){e instanceof Array||(e=[e]);for(var t=[],r=0;r<e.length;r++)t[r]=this.getFeature(e[r]);return 1==t.length?t[0]:t},o.prototype.getTile=function(e,t){var r=this,o=r.storage,n=o.get(e);return n===ye&&(o.set(n=r.createTile(e)),n.loadStartTs=n.loadStopTs=Date.now(),n.data=r.search(n.getContentBounds())),t&&t(n),n},o.prototype.setFilter=function(e){this.filter=\"function\"==typeof e?e:ye;},o.prototype.getFeatureClass=function(e){return this.Feature},o.prototype.isFeatureInstance=function(e,t){return e instanceof t},o.prototype.createFeature=function(e,t){return new t(e,this)},o.prototype.search=function(e,t){var o,n,i=this;if(\"object\"==typeof e)if(t)for(var a in e)t[a]=e[a];else t=e;var s=t&&t.radius||1;if(e instanceof Array)n=4==e.length?e:r.geotools.getPointBBox(e,s);else {if(\"number\"==typeof e||\"string\"==typeof e||!e)return i.getFeatures(e);if(e.longitude!=ye&&e.latitude!=ye)n=r.geotools.getPointBBox([e.longitude,e.latitude],s);else if(e.minLon!=ye&&e.minLat!=ye&&e.maxLon!=ye&&e.maxLat!=ye)n=[e.minLon,e.minLat,e.maxLon,e.maxLat];else {if(o=e.point||e.rect||e.viewport)return i.search(o,t);if(e.id||e.ids)return i.getFeatures(e.id||e.ids)}}return n={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]},i._s(n)},o.prototype.exists=function(e){return this.IDPOOL[e.id]},o.prototype.setFeatureCoordinates=function(e,t){var r=e;if(e=this.getFeature(e.id)){var o=e.getBBox(),n=e.geometry,i=n.coordinates;this.ignore=!0,this.removeFeature(e),n._xyz&&delete n._xyz,n.coordinates=this.encCoord(n.type,t),e.bbox=null,this.addFeature(e),this.ignore=!1,this.dispatchEvent(we,{feature:e,prevBBox:o,prevCoordinates:i,provider:this});}else r.geometry.coordinates=t,r.bbox=null,this.updateBBox(r);},o.prototype.removeFeature=function(e){if(e){if(\"FeatureCollection\"==e.type&&(e=e.features),Array.isArray(e)){for(var t=[],r=0,o=e.length;r<o;r++)t[r]=this.removeFeature(e[r]);return t}if(e=this.getFeature(e.id)){for(var n=this.getCachedTilesOfBBox(this.decBBox(e)),i=void 0,a=0;a<n.length;a++)(i=n[a]).isLoaded()&&i.remove(e);this.cnt--,delete this.IDPOOL[e.id],this.tree&&this.tree.remove(e),this.ignore||this.dispatchEvent(_e,{feature:e,tiles:n});}}return e},o.prototype.clear=function(e){var t,r=this,o=null;if(4==arguments.length&&(e=Array.prototype.slice.call(arguments)),e instanceof Array){o=r.getCachedTilesOfBBox(e,r.level);for(var n=0,i=void 0;n<o.length;n++)i=o[n],r._removeTile(i,!1),o[n]=i.quadkey;}else if(0==arguments.length){var a={},s=r.IDPOOL,u=0;for(var p in r.tree&&r.tree.clear(),s)t=r.getFeature(p),r.isDroppable(t)||(a[p]=new Te(t),u++,r.tree&&r.tree.insert(t));r.cnt=u,r.IDPOOL=a,de.prototype.clear.call(this,e);}r.dispatchEvent(\"clear\",{tiles:o});},o.prototype._insert=function(e,t){var r=e.id,o=null,n=this.getFeatureClass(e),i=this.filter;return i&&!i(e)||(this.IDPOOL[r]===ye&&(this.cnt++,this.isFeatureInstance(e,n)?e._provider=this:e=this.createFeature(e,n),this.updateBBox(e),this.IDPOOL[r]=new Te(e),o=e),t&&this._mark(e,t)),o},o.prototype._mark=function(e,t){var r=this.IDPOOL[e.id];r[t.quadkey]||(r.cnt++,r[t.quadkey]=!0);},o.prototype._removeTile=function(e,t){var r,o=e.quadkey;if(this.storage.remove(e),r=e.data)for(var n=0;n<r.length;n++)this._dropFeature(r[n],o,t);},o.prototype._dropFeature=function(e,t,r){var o=this,n=o.IDPOOL[e.id];n&&(n[t]&&(n[t]=ye,n.cnt--),o.isDroppable(e)&&(n.cnt||(o.cnt--,delete o.IDPOOL[e.id],o.tree&&o.tree.remove(e),r&&o.dispatchEvent(_e,{feature:e}))));},o.prototype._s=function(e){if(this.tree)return this.tree.search(e);var t,r,o=1e8*Math.random()^0,n=this.level;return this.storage.forEach((function(i){if(i.z==n&&i.isLoaded()&&(r=i.search(e)).length)if(t)for(var a=0,s=r;a<s.length;a++){(l=s[a])._m!=o&&(l._m=o,t[t.length]=l);}else for(var u=0,p=t=r;u<p.length;u++){var l;(l=p[u])._m=o;}})),t||[]},o.prototype.encCoord=function(e,t){return t},o.prototype.decCoord=function(e){return e.geometry.coordinates},o.prototype.decBBox=function(e){return e.bbox},o.prototype.prepareFeature=function(e){return e.id==ye&&(e.id=1e8*Math.random()^0),e.bbox?(6===e.bbox.length&&(e.bbox=[e.bbox[0],e.bbox[1],e.bbox[3],e.bbox[4]]),e):this.updateBBox(e)&&e},o.prototype.updateBBox=function(e){if(!e.bbox){var t=me(e);if(!t)return !1;e.bbox=t,e.geometry._c&&(e.geometry._c=null);}return !0},o}(de);be.prototype.modifyFeatureCoordinates=be.prototype.setFeatureCoordinates;var Pe=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.executing=0,this.parallel=16,this.q=[],this.lq={},this.src=e;}return e.prototype.exec=function(){for(var e=this,t=e.q;t.length&&e.executing<e.parallel;)e.fire(t.pop(),t.pop(),t.pop());},e.prototype.fire=function(e,t,r,o){var n=this,i=n.src,a=n.lq;o^=0;n.executing++,a[e.quadkey]=[e,t,r,o],i[o].load(e,(function(r,o){n.executing--,delete a[e.quadkey],n.exec(),t(r,o);}),(function(t,o){r(t,o),n.executing--,delete a[e.quadkey],n.exec();}));},e.prototype.tile=function(e,t,r){this.q.push(r,t,e),this.exec();},e.prototype.abort=function(e){var t,r,o=this,n=o.q,i=o.lq,a=o.src,s=!0;return -1!==(t=n.indexOf(e))?n.splice(t-2,3):(r=i[e.quadkey])?(o.executing--,delete i[e.quadkey],a[r[3]].abort(e)):s=!1,o.exec(),s},e.prototype.store=function(e,t){var r=this.src;for(var o in r)if(r[o].store){r[o].store(e,t);break}},e.prototype.clear=function(){this.src.forEach((function(e){e.clear&&e.clear();}));},e.prototype.setUrl=function(){var e=this.src;for(var t in e)e[t].setUrl&&e[t].setUrl.apply(e[t],arguments);},e}();Pe.prototype;var Me=function(){function e(e,t){this.c=0,this.cbs=[],this.qks=t,this.tile=e;}return e.prototype.receive=function(e){var t=this;if(!t.ready){var r=t.tile,o=t.qks,n=o.indexOf(e.quadkey);if(-1!=n&&(o[n]=null,++t.c==o.length)){t.ready=!0,r.processedData=undefined;var i=e.error;i?r.error=i:r.data=r.provider.search(r.getContentBounds()),r.loadStopTs=Date.now(),t.exec(),r.onLoaded.length=0,t.qks=null;}}},e.prototype.exec=function(){for(var e=this.cbs,t=e.length,r=this.tile,o=0;o<t;)e[o++](r,r.error);e.length=0;},e.prototype.add=function(e){var t=this.cbs;if(\"function\"==typeof e&&-1==t.indexOf(e))return t.push(e),!0},e.prototype.remove=function(e){var t=this.cbs,r=t.indexOf(e);return -1!=r&&t.splice(r,1),t.length},e}();Me.prototype.ready=!1;var Ee,Fe,Se=function(e){return \"function\"==typeof e},Be=function(e){return Se(e)},Re=function(e){return function(t,r,o){var n={data:t,provider:this,ready:r};o&&(n.tile={x:o.x,y:o.y,z:o.z}),function(e,t){void 0===t&&(t={});var r,o,n=t.ready;r=Be(e)?e(t):t.data,!(o=r)||\"object\"!=typeof o&&\"function\"!=typeof o||\"function\"!=typeof o.then?void 0!==r&&n(r):r.then(n);}(e,n);}},Oe=function(){function e(e){var t=e.loader;if(!t)throw new Error(\"no tile loader defined.\");t instanceof Pe||(t=new Pe(t)),this.loader=t,this.provider=e.provider;var r=e.preProcessor;this.preprocess=Re(r),\"function\"==typeof e.processTileResponse&&(this.processTileResponse=e.processTileResponse);}return e.prototype.cancel=function(e,t){var r,o=this.provider,n=o.storage,i=t==Ee;if(r=e instanceof o.Tile?e:n.get(e)){var a=r.onLoaded;a&&(i?a.length=0:a.splice(a.indexOf(t),1),a.length||this.loader.abort(r)&&n.remove(r));}},e.prototype.execTile=function(e){var t,r=e.onLoaded;if(r){for(var o=0,n=r.length;o<n;o++)(t=r[o])instanceof Me?t.receive(e):t(e);r.length=0;}},e.prototype.processTileResponse=function(e,t,r,o){r(t);},e.prototype.handleTileResponse=function(e,t,r,o){var n=this;e.loadStopTs=Date.now(),this.processTileResponse(e,t,(function(t){e.data=t,n.execTile(e),o&&o();}),r);},e.prototype.completeTile=function(e,t){this.handleTileResponse(e,t);},e.prototype.getTile=function(e,t){var r,o=this,n=this.provider,i=n.storage;if((r=i.get(e))==Ee)(r=n.createTile(e)).onLoaded=[],r.data=[],i.set(r);else if(r.isLoaded())return t&&t(r,r.error),r;return t&&-1==r.onLoaded.indexOf(t)&&r.onLoaded.push(t),r.loadStartTs||(r.loadStartTs=Date.now(),this.loader.tile(r,(function(e,t){o.preprocess(e,(function(e){return o.completeTile(r,e)}),r);}),(function(e,t){r.error=e,o.handleTileResponse(r,void 0,t,(function(){return n.listeners.trigger(\"error\",[e,r],!0)}));}))),r},e.prototype.drop=function(e){this.provider.storage.remove(e),e.isLoaded()||this.loader.abort(e);},e}(),ke=function(e){function r(t){var r=e.call(this,t)||this;return r.dep={},r.level=t.level,r}return t.__extends(r,e),r.prototype.cancel=function(e,t){var r,o,n=this.provider,i=n.storage,a=t==Fe;if(o=e instanceof n.Tile?e:i.get(e)){e=o.quadkey,r=ie.getTilesOfLevel(e,this.level);for(var s=0,u=void 0,p=void 0;s<r.length;s++)if(u=(p=r[s])==e?o:i.get(p)){var l=u.onLoaded,c=void 0;l&&(a?o.onLoaded.length=0:n.level&&o.z!=n.level?-1!=(c=l.indexOf(o.onLoaded[0]))&&(l[c].remove(t)||l.splice(c,1)):l.splice(l.indexOf(t),1),l.length||this.loader.abort(u)&&i.remove(u));}}},r.prototype.clear=function(){this.loader.clear(),this.dep={};},r.prototype.createTile=function(e){var t,r,o=this.provider.createTile(e),n=o.z,i=this.level;if(i&&n!=i&&(n>i?t=[e.substr(0,i)]:n<i&&(t=ie.getTilesOfLevel(e,i)),t))for(var a=0,s=t.length;a<s;a++){var u=t[a];(r=this.dep[u])||(r=this.dep[u]=[]),r[r.length]=o;}return o},r.prototype.getTile=function(e,t){var r,o=this,n=this.provider,i=n.storage,a=this.level;if((r=i.get(e))==Fe)(r=this.createTile(e)).onLoaded=[],r.data=[],i.set(r);else if(r.isLoaded())return t&&t(r,r.error),r;if(e.length!=a){var s=ie.getTilesOfLevel(e,a),u=void 0,p=void 0;r.loadStartTs=Date.now(),r.onLoaded.length?p=r.onLoaded[0]:(p=new Me(r,s),r.onLoaded.push(p)),p.add(t);for(var l=0;l<s.length;l++)(u=i.get(s[l]))==Fe?u=n.getTile(s[l],p):u.isLoaded()?p.receive(u):-1==u.onLoaded.indexOf(p)&&u.onLoaded.push(p);}else t&&-1==r.onLoaded.indexOf(t)&&r.onLoaded.push(t),r.loadStartTs||(r.loadStartTs=Date.now(),this.loader.tile(r,(function(e){o.preprocess(e,(function(e){return o.completeTile(r,e)}),r);}),(function(e,t){r.error=e,o.handleTileResponse(r,void 0,t,(function(){return n.listeners.trigger(\"error\",[e,r],!0)}));})));return r},r.prototype.drop=function(t){var r,o=t.quadkey,n=this.provider.storage;if(r=this.dep[o]){for(var i=0;i<r.length;i++)n.remove(r[i]);delete this.dep[o];}e.prototype.drop.call(this,t);},r}(Oe),Ce=function(e){function r(r){var o=e.call(this,t.__assign({minLevel:8,maxLevel:20,staticData:!1},r))||this;o.sizeKB=0;var n=o,i=r.loader;if(!i)throw new Error(\"no tile loader defined.\");i instanceof Pe||(i=new Pe(i));var a=r.preProcessor;return o.remoteTileLoader=new ke({provider:n,loader:i,level:n.level,preProcessor:a,processTileResponse:function(e,t,r){if(e.error)return r(e.data);o.loadTileData(e,t,r);}}),o}return t.__extends(r,e),r.prototype.cancel=function(e,t){this.remoteTileLoader.cancel(e,t);},r.prototype.getLoader=function(){return this.remoteTileLoader.loader},r.prototype.config=function(t){return e.prototype.config.call(this,t)},r.prototype.clear=function(t){0==arguments.length&&this.remoteTileLoader.clear(),e.prototype.clear.apply(this,arguments);},r.prototype.getTile=function(e,t){return this.remoteTileLoader.getTile(e,t)},r.prototype._removeTile=function(t,r){this.remoteTileLoader.drop(t),e.prototype._removeTile.call(this,t,r);},r}(be),Ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.getMvtLayer=function(){return this.geometry.__xyz.l},r}(E),ze=function(e){function o(t){var o=e.call(this,r.JSUtils.extend({loader:t.loader||new M(t),margin:0,Tile:he,Feature:Ue,preProcessor:Y},t))||this;return o.c=null,o.clipped=!0,o.tree=null,o}return t.__extends(o,e),o.prototype.decCoord=function(e){return e.geometry._coordinates()},o.prototype.getCopyright=function(e){var t=this,o=t.url;\"function\"==typeof o&&(o=o(0,0,0,\"\"));var n=(null==o?void 0:o.match)&&o.match(/.*xyz+.*here\\.com\\/tiles\\/[a-zA-Z]+[\\.\\d]*\\//),i=t.c;e&&(null==i?n?((i=new r.Queue).add(e),t.c=i,t.getLoader().src[0].send({url:n+\"copyright\",responseType:\"json\",success:function(e){t.c=e,i.done(e);}})):e(t.c=[]):i instanceof r.Queue?i.add(e):e(i));},o}(Ce),Ie={backgroundColor:\"#555555\",strokeWidthZoomScale:function(e){return e>17?1:e>14?.5:.25},styleGroups:{earth:[{zIndex:1,type:\"Polygon\",fill:\"#555555\"}],landuse:[{zIndex:2,type:\"Polygon\",fill:\"#666666\"}],water:[{zIndex:3,type:\"Polygon\",fill:\"#353535\"}],roads:[{zIndex:4,type:\"Line\",stroke:\"#ffffff\",strokeWidth:4}],highway:[{zIndex:5,type:\"Line\",stroke:\"#ffffff\",strokeWidth:6}],buildings:[{zIndex:6,type:\"Polygon\",fill:\"#999999\"}]},assign:function(e,t){var r=e.properties,o=r.kind,n=r.layer,i=e.geometry.type;if(\"water\"!=n||\"LineString\"!=i&&\"MultiLineString\"!=i){if(\"roads\"==n){if(\"rail\"==o||\"ferry\"==o)return;if(\"highway\"==o)return o}return n}}},De=function(e){function o(o){var n=o.remote,i=n.url,a=n.min||1,s=n.max||16,u=o.tileSize||n.tileSize,p=o.name||\"\",l=o.max||32,c=new M(n),h=[];if(!u){var f=\"string\"==typeof i&&i.match(/256|512|1024|2048|4096/);u=f?Number(f[0]):512;}for(var d=new r.LRU(256/Math.pow(2,0)),y=new r.LRU(4*d.max),v=a;v<=s;v++)h.push({min:v,max:v==s?l:v,provider:new ze({name:p+\"-L\"+v,url:i,level:v-0,loader:c,size:u,storage:new fe(v-0,d,y)})});return e.call(this,t.__assign(t.__assign({min:a,max:l,style:Ie,margin:0,pointerEvents:!1},o),{tileSize:u,providers:h}))||this}return t.__extends(o,e),o.prototype.getProvider=function(e){var t=Math.floor(e)-this.levelOffset;return this._p[t]},o.prototype.getCopyright=function(e){this.getProvider(this.max).getCopyright(e);},o}(b),Ye=function(e){function r(t){var r=e.call(this,t||{})||this;r.custom=!0,r.style={},r.tiled=!1;var o=r,n=o.onLayerAdd,i=o.onLayerRemove;return n&&o.addEventListener(\"layerAdd\",o.onLayerAdd=function(e){o.init(),n.call(o,e);}),i&&o.addEventListener(\"layerRemove\",o.onLayerRemove=i.bind(o)),r}return t.__extends(r,e),r.prototype.init=function(){var e=this.renderOptions||(this.renderOptions={}),t=e.mode||(e.mode=\"2d\");this.flat=\"2d\"==t;},r.prototype.onLayerAdd=function(e){},r.prototype.onLayerRemove=function(e){},r.prototype.render=function(e,t){},r.prototype.pointerEvents=function(e){return !1},r.prototype.getCopyright=function(){},r.prototype.getStyle=function(){return this.style},r}(v);function Xe(e,t,r){var o=new XMLHttpRequest;return o.onload=function(){t(JSON.parse(this.responseText));},o.onreadystatechange=function(){var e=this.status;4==this.readyState&&(e<200||e>=300)&&0!==e&&r&&r(this);},o.open(\"GET\",e,!0),o.send(),o}var qe=function(){function e(e){var t=\".json\";(e=e||{}).host=e.host||\"geocoder.api.here.com\",e.version=e.version||\"6.2\",this.url=\"https://\"+e.host+\"/\"+e.version+\"/geocode\"+t,this.reverseUrl=\"https://reverse.\"+e.host+\"/\"+e.version+\"/reversegeocode\"+t,this.cfg=e;}return e.prototype.createUrl=function(e,t){var r=\"\";for(var o in t=t||{})r+=\"&\"+o+\"=\"+encodeURIComponent(t[o]);return this.reverseUrl+\"?app_id=\"+this.cfg.app_id+\"&app_code=\"+this.cfg.app_code+r},e.prototype.geocode=function(e,t,r){Xe(this.createUrl(this.url,e),t,r);},e.prototype.reverseGeocode=function(e,t,r){Xe(this.createUrl(this.reverseUrl,e),t,r);},e.prototype.getIsoCountryCode=function(e,t,r){var o={mode:\"retrieveAddresses\",maxresults:1,jsonattributes:1};o.prox=e instanceof Array?e[1]+\",\"+e[0]:e.latitude+\",\"+e.longitude,this.reverseGeocode(o,(function(e){var r=null;try{r=e.response.view[0].result[0].location.address.country;}catch(e){}t&&t(r,e);}),r);},e}(),Ae=function(){function e(e){this.cache=new r.LRU(e||256);}return e.prototype.forEach=function(e){this.cache.forEach(e);},e.prototype.clear=function(){this.cache.clear();},e.prototype.remove=function(e){this.cache.remove(e.quadkey);},e.prototype.get=function(e){return this.cache.get(e)},e.prototype.set=function(e){var t=this.cache.set(e.quadkey,e),r=this._onDrop;t&&r&&r(t);},e.prototype.onDrop=function(e){this._onDrop=e;},e}(),je=function(e){function r(r){var o=e.call(this,t.__assign({storage:new Ae(512)},r))||this;if(o.name=\"\",o.opacity=1,o.dataType=\"image\",\"string\"==typeof r.errorImage){var n=new Image;n.src=r.errorImage,o.errorImage=n;}return o.tileLoader=new Oe({provider:o,loader:new Pe(new t.HTTPLoader({url:r.url,headers:{Accept:\"*/*\"}})),preProcessor:r.preProcessor,processTileResponse:function(e,r,n,i){if(e.error)if(o.errorImage)r=o.errorImage;else if(404==e.error.statusCode){var a=i.response;if(a instanceof Blob&&a.type.startsWith(\"image\"))return t.HTTPLoader.createImageFromBlob(a,(function(e){n(e);}))}n(r);}}),o}return t.__extends(r,e),r.prototype.getTile=function(e,t){return this.tileLoader.getTile(e,t)},r.prototype._removeTile=function(e){this.tileLoader.drop(e);},r.prototype.clear=function(e){var t=this,r=null;if(e instanceof Array){r=t.getCachedTilesOfBBox(e,t.level);for(var o=0,n=void 0;o<r.length;o++)n=r[o],this.tileLoader.drop(n),r[o]=n.quadkey;}else 0==arguments.length&&this.storage.clear();t.dispatchEvent(\"clear\",{tiles:r});},r.prototype.cancel=function(e){return this.tileLoader.cancel(e)},r}(de);je.prototype.__type=\"ImageProvider\";var Ge,He=function(e){function o(r){var o=e.call(this,t.__assign({editable:!0,enforceRandomFeatureId:!0},r))||this;return o.blocked={},o}return t.__extends(o,e),o.prototype.detectFeatureClass=function(e){switch(e.geometry.type){case\"Point\":return \"MARKER\";case\"LineString\":return \"LINE\";case\"Polygon\":case\"MultiPolygon\":return \"AREA\"}},o.prototype.getFeatureProperties=function(e){return e.properties},o.prototype.readRoutingPoint=function(e){return {link:this.readRoutingLink(e),position:this.readRoutingPosition(e)}},o.prototype.blockFeature=function(e,t){var r=e.id||e,o=typeof r;\"string\"!=o&&\"number\"!=o||(t?this.blocked[r]=!0:delete this.blocked[r]);},o.prototype._insert=function(t,r){return this.blocked[t.id]?null:e.prototype._insert.call(this,t,r)},o.prototype.reserveId=function(e,t){setTimeout((function(){return t(e.map((function(e){return e.id})))}),0);},o.prototype.isoCC=function(e,t){return !0},o.prototype.prepareFeature=function(e){return e.properties||(e.properties={}),null==e.id&&(e.id=r.JSUtils.String.random()),e},o}(be),Je=\"Method not implemented.\",Ne=function(e){function r(t,r){var o=e.call(this,t)||this;return o.name=\"FeatureError\",o.feature=r,o}return t.__extends(r,e),r}(Error),Ve=function(e){function o(r){var o=e.call(this,t.__assign({minLevel:8,maxLevel:20,staticData:!1},r))||this;o.sizeKB=0,o._clearOnCommit=!0;var n=o,i=r.loader;if(!i)throw new Error(\"no tile loader defined.\");i instanceof Pe||(i=new Pe(i));var a,s=r.preProcessor;return n.preprocess=Re(s||r.preprocessor),n.postprocess=Re(r.postProcessor),o.remoteTileLoader=new ke({provider:n,loader:i,level:n.level,preProcessor:s,processTileResponse:function(e,t,r){if(e.error)return r(e.data);o.loadTileData(e,t,r);}}),n.commit&&(n.commit=(a=n.commit,function(e,t,r){var o,i=this,s=this.postProcessor,u=function(e){Array.isArray(e)||(e=[e]);for(var t,r=e.length;r--;)(t=(e[r]=E.prototype.toJSON.call(e[r])).properties)&&delete t[\"@ns:com:here:editor\"];return e};return \"object\"==typeof e&&(e.put=u(e.put||[]),e.remove=u(e.remove||[]),Se(s))?(n.postprocess(e,(function(e){o=a.call(i,e,t,r);})),o):a.call(this,e,t,r)})),o}return t.__extends(o,e),o.prototype.getFeatures=function(t,r){var o=this;r=r||{},t instanceof Array||(\"object\"==typeof t&&(t.remote&&(r.remote=t.remote),t.onload&&(r.onload=t.onload),t=t.ids||t.id),t=[].concat(t));var n=this,i=!0,a=r.onload,s=r.remote;(l=e.prototype.getFeatures.call(this,t))instanceof Array||(l=[l]);for(var u=0;u<l.length;u++)l[u]||(l[u]=t[u],i=!1);function p(){return 1==(l=l.map((function(e){return \"object\"==typeof e?e:Ge}))).length?l[0]:l}if(i||!s){var l=p();return a&&a(l),l}t=l.filter((function(e){return \"object\"!=typeof e}));var c=function(e){var t=r.onerror;t&&t(e);};n._requestFeatures(t,(function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],s=i.geometry;if(!s||!s.type||!s.coordinates)return void c(new Ne(\"Invalid geometry\",i))}o.preprocess(e,(function(e){for(var t=0,r=e;t<r.length;t++){var o=r[t];l[l.indexOf(o.id)]=n.addFeature(o);}a&&a(p());}));}),c,r);},o.prototype.cancel=function(e,t){this.remoteTileLoader.cancel(e,t);},o.prototype.search=function(e,t){var o,n,i=this;if(\"object\"==typeof e)if(t)for(var a in e)t[a]=e[a];else t=e;var s=(t=t||{}).onload,u=t.radius,p=t.remote,l=t.onerror;if(u==Ge&&(u=1),e instanceof Array)n=4==e.length?e:r.geotools.getPointBBox(e,u);else {if(\"number\"==typeof e||\"string\"==typeof e||!e)return i.getFeatures(e,t);if(e.longitude!=Ge&&e.latitude!=Ge)n=r.geotools.getPointBBox([e.longitude,e.latitude],u);else if(e.minLon!=Ge&&e.minLat!=Ge&&e.maxLon!=Ge&&e.maxLat!=Ge)n=[e.minLon,e.minLat,e.maxLon,e.maxLat];else {if(o=e.point||e.rect||e.viewport)return i.search(o,t);if(e.id||e.ids)return i.getFeatures(e.id||e.ids,t)}}if(n={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]},p){for(var c,h=ie.getTilesInRect(n.minX,n.minY,n.maxX,n.maxY,i.level),f=function(e){h.splice(h.indexOf(e.quadkey),1),c=c||e.error,h.length||(c?l(c):s&&s(i._s(n)));},d=0;d<h.length;d++){var y=h[d],v=i.getCachedTile(y);if(v&&v.isLoaded()){if(v.error)return void(l&&l(v.error));h.splice(d--,1);}else i.getTile(y,f);}if(h.length)return}var g=i._s(n);return s&&s(g),g},o.prototype.getLoader=function(){return this.remoteTileLoader.loader},o.prototype.config=function(t){return e.prototype.config.call(this,t)},o.prototype.clear=function(t){0==arguments.length&&this.remoteTileLoader.clear(),e.prototype.clear.apply(this,arguments);},o.prototype.getTile=function(e,t){return this.remoteTileLoader.getTile(e,t)},o.prototype._removeTile=function(t,r){this.remoteTileLoader.drop(t),e.prototype._removeTile.call(this,t,r);},o.prototype.readDirection=function(e){throw new Error(Je)},o.prototype.readPedestrianOnly=function(e){throw new Error(Je)},o.prototype.writeTurnRestriction=function(e,t,r){throw new Error(Je)},o.prototype.readRoutingProvider=function(e,t){return this.id},o.prototype.readRoutingPosition=function(e){throw new Error(Je)},o.prototype.readRoutingLink=function(e){throw new Error(Je)},o.prototype.writeRoutingPosition=function(e,t){throw new Error(Je)},o.prototype.writeRoutingLink=function(e,t){throw new Error(Je)},o.prototype.readTurnRestriction=function(e,t){throw new Error(Je)},o.prototype.writeRoutingPoint=function(e,t,r){this.writeRoutingLink(e,t),this.writeRoutingPosition(e,r);},o.prototype.writeEditState=function(e,t){},o.prototype.readFeatureHeight=function(e){return null},o.prototype.writeFeatureHeight=function(e,t){throw new Error(Je)},o.prototype.reserveId=function(e,t){for(var o,n=e.length,i=[];n--;)\"string\"==typeof(o=e[n].id)&&o.length>15?i.push(e[n].id):i.push(r.JSUtils.String.random(16));setTimeout((function(){t(i.reverse());}),0);},o.prototype.isDroppable=function(e){var t=e.editState&&e.editState();return !t||!t.modified&&!t.removed&&!t.split},o}(He),Ze=\"Method not implemented.\",We=function(e){function o(r){var o=this,n=r.loader;return n?n instanceof Pe||(n=new Pe(n)):n=new Pe(new t.HTTPLoader({url:r.url,withCredentials:r.withCredentials,headers:r.headers})),r.loader=n,(o=e.call(this,r)||this).setParams(r.params||{}),o.setHeaders(r.headers||{}),o}return t.__extends(o,e),o.prototype._httpLoader=function(){var e=this.remoteTileLoader.loader.src;return e[e.length-1]},o.prototype.getHeader=function(e){return this._httpLoader().headers[e]||null},o.prototype.getHeaders=function(){return r.JSUtils.clone(this._httpLoader().headers)},o.prototype.setHeader=function(e,t){var r=this.getHeaders();r[e]=t,this._httpLoader().headers=r,this.headers=r;},o.prototype.setHeaders=function(e){var t=this.getHeaders();r.JSUtils.extend(t,e),this._httpLoader().headers=t,this.headers=t;},o.prototype.getParams=function(){return this.params},o.prototype.getParam=function(e){return this.params[e]||null},o.prototype.setParams=function(e){var t=this._httpLoader(),o=t.baseUrl,n=this.params||{};if(r.JSUtils.extend(n,e),this.params=n,\"string\"==typeof o){n=r.JSUtils.extend(function(e,t){return t=t||{},e.split(/\\?|\\&/).slice(1).map((function(e){e=e.split(/\\=/),t[e[0]]=e[1];})),t}(o),n);var i=o.split(/\\?/)[0],a=\"?\";for(var s in n){var u=n[s];void 0===u?delete n[s]:(i+=a+s+\"=\"+u,a=\"&\");}t.setUrl(i);}},o.prototype.setParam=function(e,t){var r={};r[e]=t,this.setParams(r);},o.prototype.config=function(t){return e.prototype.config.call(this,t),t&&t.url&&this.setParams({}),this},o.prototype.commit=function(e,t,r,o){throw new Error(Ze)},o.prototype._requestFeatures=function(e,t,r,o){throw new Error(Ze)},o.prototype.readZLevels=function(e){throw new Error(Ze)},o.prototype.writeZLevels=function(e,t){throw new Error(Ze)},o}(Ve);We.prototype.getFeatureUrl=We.prototype.getLayerUrl=We.prototype.getTileUrl=function(){throw new Error(Ze)};var Ke=\"Method not implemented.\",Qe=function(e){function o(t){return t.level=t.level||13,t.headers=r.JSUtils.extend({Accept:\"application/geo+json\"},t.headers||{}),e.call(this,t)||this}return t.__extends(o,e),o.prototype.getFeatureUrl=function(e,t){throw new Error(Ke)},o.prototype.getLayerUrl=function(e){throw new Error(Ke)},o.prototype.getTileUrl=function(e){throw new Error(Ke)},o}(We),$e=\"Method not implemented.\",et=function(e){function r(r){var o=e.call(this,t.__assign({minLevel:8,maxLevel:20,storage:new Ae(512),editable:!1,size:512},r))||this;return o._clearOnCommit=!1,delete o.level,o.editable||(o.Feature=E,o.detectFeatureClass=function(){return null}),o}return t.__extends(r,e),r.prototype.cancel=function(e){},r.prototype.delete=function(e){this.tree.remove(e);},r.prototype.import=function(e){var t=this;t.tree.fromJSON(e);for(var r=(e=t.tree.all()).length;r--;)t._insert(e[r]);},r.prototype.initStorage=function(e){},r.prototype.commit=function(e,t,r){return \"function\"==typeof t&&setTimeout((function(){return t({})}),0),!0},r.prototype.readDirection=function(e){throw new Error($e)},r.prototype.readPedestrianOnly=function(e){throw new Error($e)},r.prototype.writeTurnRestriction=function(e,t,r){throw new Error($e)},r.prototype.readRoutingProvider=function(e,t){return this.id},r.prototype.readRoutingPosition=function(e){throw new Error($e)},r.prototype.readRoutingLink=function(e){throw new Error($e)},r.prototype.writeRoutingPosition=function(e,t){throw new Error($e)},r.prototype.writeRoutingLink=function(e,t){throw new Error($e)},r.prototype.readTurnRestriction=function(e,t){throw new Error($e)},r.prototype.writeRoutingPoint=function(e,t,r){this.writeRoutingLink(e,t),this.writeRoutingPosition(e,r);},r.prototype.readZLevels=function(e){throw new Error(\"Method not implemented.\")},r.prototype.writeZLevels=function(e,t){throw new Error(\"Method not implemented.\")},r.prototype.writeEditState=function(e,t){},r.prototype.readFeatureHeight=function(e){return null},r.prototype.writeFeatureHeight=function(e,t){throw new Error($e)},r}(He),tt={environment:\"prd\",space:\"\",credentials:{access_token:\"\"},withCredentials:!1,tags:!1,https:!0,clip:!1,url:null,headers:null,propertySearch:null,editable:!0,level:0},rt=\"@ns:com:here:xyz\",ot=\"http://\",nt={prd:ot+\"xyz.api.here.com/hub/spaces\"},it=function(e,t){return (e=r.JSUtils.extend(r.JSUtils.clone(tt),e)).params=r.JSUtils.extend(e.params||{},e.credentials),delete e.credentials,Be(t)&&(e.preProcessor=t),e.url||(e.url=nt[e.environment]),e.https&&(e.url=e.url.replace(ot,\"https://\")),e},at=function(e){function o(t){var r=e.call(this,it(t,arguments[1]))||this;return r.definition=null,r.setUrl(r.getTileUrl(r.space)),t.propertySearch&&r.setPropertySearch(t.propertySearch),r}return t.__extends(o,e),o.prototype.getHttpLoader=function(){var e=this.getLoader().src;return e[e.length-1]},o.prototype.config=function(t){var r=null==t?void 0:t.credentials;return r&&(delete t.credentials,this.setParams(r)),e.prototype.config.call(this,t)},o.prototype.commit=function(e,t,r){var o=this.getHttpLoader(),n=0,i=function(e){!--n&&t&&t(e);},a=function(e){r&&r(e);};if(\"object\"==typeof e){var s=e.put||[],u=e.remove||[];s.length&&(n++,o.send(this.createUpdateFeatureRequest(s,{success:i,error:a}))),u.length&&(n++,o.send(this.createRemoveFeatureRequest(u,{success:i,error:a})));}},o.prototype.getLayerUrl=function(e){return this.url+\"/\"+e},o.prototype.getTileUrl=function(e){return this._addUrlFilters(this.getLayerUrl(e)+\"/tile/quadkey/{QUADKEY}?margin=\"+this.margin+\"&clip=\"+!!this.clip)},o.prototype.getFeatureUrl=function(e,t){return t instanceof Array||(t=[t]),this.getLayerUrl(e)+\"/features?id=\"+t.join(\"&id=\")},o.prototype.createUpdateFeatureRequest=function(e,r){void 0===r&&(r={});var o=this,n=o._addUrlCredentials(o.getLayerUrl(o.space)+\"/features\",\"?\");return t.__assign({type:\"POST\",url:n,headers:t.__assign(t.__assign({},o.headers),{\"Content-Type\":\"application/geo+json\"}),data:JSON.stringify({type:\"FeatureCollection\",features:e})},r)},o.prototype.createRemoveFeatureRequest=function(e,r){void 0===r&&(r={});var o=this,n=o._addUrlCredentials(o.getLayerUrl(o.space)+\"/features\",\"?\");return t.__assign({type:\"DELETE\",url:n+\"&id=\"+e.map((function(e){return e.id})).join(\",\"),headers:t.__assign(t.__assign({},o.headers),{Accept:\"application/json\"})},r)},o.prototype.prepareFeature=function(t){var r=(t=e.prototype.prepareFeature.call(this,t)).properties;return r[rt]||(r[rt]={}),t},o.prototype.setMargin=function(e){Qe.prototype.setMargin.call(this,e),this.setUrl(this.getTileUrl(this.space));},o.prototype.setUrl=function(e){this._httpLoader().setUrl(this._addUrlCredentials(e));},o.prototype.setTags=function(e){\"string\"==typeof e&&(e=[e]),this.tags=e,this.setUrl(this.getTileUrl(this.space)),this.clear();},o.prototype.setPropertySearch=function(e,t,o){var n,i=\"\";for(var a in \"string\"==typeof e?(n={})[e]={operator:t,value:o}:n=e,n){var s=n[a];t=s.operator.replace(\">=\",\"=gte=\").replace(\"<=\",\"=lte=\").replace(\">\",\"=gt=\").replace(\"<\",\"=lt=\"),(o=null==s.values?s.value:s.values)instanceof Array||(o=[o]),o=o.map((function(e){return \"string\"==typeof e&&(r.JSUtils.isNumeric(e)||\"true\"==e||\"false\"==e||\"null\"==e)&&(e='\"'+e+'\"'),encodeURIComponent(e)}));var u=a.slice(0,2);\"f.\"!=u&&\"p.\"!=u&&(a=\"p.\"+a),i+=a+t+o+\"&\";}this.psf=i.slice(0,-1),this.setUrl(this.getTileUrl(this.space)),this.clear();},o.prototype.getCopyright=function(e,t){this.getDefinition((function(t){e&&e(t.copyright||[]);}),t);},o.prototype.getDefinition=function(e,o){var n=this,i=n.getHttpLoader(),a=n.definition;if(null==a){var s=new r.Queue;a=this.definition=s,i.send({url:n._addUrlCredentials(n.getLayerUrl(n.space),\"?\"),id:\"def\",success:function(e){n.definition=e,s.done(e);},error:function(e){n.definition=[],o&&o(e);},headers:t.__assign(t.__assign({},this.headers),{Accept:\"application/json\"})});}e&&(a instanceof r.Queue?a.add(e):e(a));},o.prototype._requestFeatures=function(e,t,r,o){this.getHttpLoader().send({id:e.join(\"&\"),url:this._addUrlCredentials(this.getFeatureUrl(this.space,e)),success:function(e){t(e.features);},headers:this.headers,error:r});},o.prototype._addUrlCredentials=function(e,t){return e=function(e,t,r){for(var o in t)e+=r+o+\"=\"+t[o],r=\"&\";return e}(e,this.params,t||\"&\"),e},o.prototype._addUrlFilters=function(e){var t=this.tags,r=this.psf;return t&&t.length&&(e+=\"&tags=\"+t.join(\",\")),r&&(e+=\"&\"+r),e},o}(Qe),st=function(e){function r(r){var o,n=this;return n=e.call(this,function(e){var r=t.__assign(t.__assign({url:\"http://interactive.data.api.platform.here.com/interactive/v1\",https:!0,space:e.layer},e),{credentials:t.__assign({},e.credentials)});return delete r.credentials.token,r}(r))||this,n.definition=[],n.token=null===(o=r.credentials)||void 0===o?void 0:o.token,n}return t.__extends(r,e),r.prototype.addRequestToken=function(e){return (e.headers=e.headers||{}).Authorization=\"Bearer \"+this.token,e},r.prototype.createUpdateFeatureRequest=function(t,r){return void 0===r&&(r={}),this.addRequestToken(e.prototype.createUpdateFeatureRequest.call(this,t,r))},r.prototype.createRemoveFeatureRequest=function(t,r){return void 0===r&&(r={}),this.addRequestToken(e.prototype.createRemoveFeatureRequest.call(this,t,r))},r.prototype.getLayerUrl=function(e){return this.url+\"/catalogs/\"+this.catalog+\"/layers/\"+e},r.prototype.config=function(t){var r,o=null===(r=null==t?void 0:t.credentials)||void 0===r?void 0:r.token;return o&&(this.token=o,delete t.credentials.token),e.prototype.config.call(this,t)},r}(at),ut=Z,pt=t.__assign({name:\"xyz-maps\"},{version:\"0.32.0\",revision:\"f28fa04\",date:\"2022-10-14T17:30:53Z\"}),lt=n.global.here.xyz.maps;lt.common=n;var ct=lt.geo={Point:s,Rect:u},ht=lt.pixel={Point:i,Rect:a},ft=lt.layers={TileLayer:b,MVTLayer:De,CustomLayer:Ye},dt=lt.features={Feature:E},yt=lt.tile={Tile:le,Utils:ie};lt.build=pt;var vt=lt.providers={ImageProvider:je,GeoJSONProvider:Qe,FeatureProvider:be,LocalProvider:et,RemoteTileProvider:Ce,EditableRemoteTileProvider:Ve,SpaceProvider:at,IMLProvider:st,MVTProvider:ze,EditableFeatureProvider:He},gt=lt.projection={webMercator:ut},mt=lt.loaders={HTTPLoader:t.HTTPLoader,Manager:Pe},xt=lt.service||{Geocoder:qe},_t={tile:yt,layers:ft,geo:ct,pixel:ht,features:dt,providers:vt,projection:gt,loaders:mt,service:xt,build:pt,common:n};e.CustomLayer=Ye,e.DEFAULT_LAYER_MAX_ZOOM=32,e.DEFAULT_LAYER_MIN_ZOOM=15,e.EditableFeatureProvider=He,e.EditableRemoteTileProvider=Ve,e.Feature=E,e.FeatureProvider=be,e.GeoCoder=qe,e.GeoJSONProvider=Qe,e.GeoPoint=s,e.GeoRect=u,e.HTTPProvider=We,e.IMLProvider=st,e.ImageProvider=je,e.Layer=v,e.LocalProvider=et,e.MVTLayer=De,e.MVTProvider=ze,e.PixelPoint=i,e.PixelRect=a,e.RemoteTileProvider=Ce,e.SpaceProvider=at,e.Tile=le,e.TileLayer=b,e.build=pt,e.default=_t,e.features=dt,e.layers=ft,e.loaders=mt,e.pixel=ht,e.projection=gt,e.providers=vt,e.service=xt,e.tile=yt,e.tileUtils=ie,e.utils=xe,e.webMercator=ut,Object.defineProperty(e,\"__esModule\",{value:!0});}));\n\n\tlet xyz = window;\n\t'here.xyz.maps'.split('.').forEach((ns) => xyz = (xyz[ns] = xyz[ns] || {}));\n\tvar xyz$1 = xyz;\n\n\treturn xyz$1;\n\n}));\n"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":1,"column":0},"generated":{"line":3,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":2,"column":0},"generated":{"line":4,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":3,"column":0},"generated":{"line":5,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":4,"column":0},"generated":{"line":6,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":5,"column":0},"generated":{"line":7,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":6,"column":0},"generated":{"line":8,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":7,"column":0},"generated":{"line":9,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":8,"column":0},"generated":{"line":10,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":9,"column":0},"generated":{"line":11,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":10,"column":0},"generated":{"line":12,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":11,"column":0},"generated":{"line":13,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":12,"column":0},"generated":{"line":14,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":13,"column":0},"generated":{"line":15,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":14,"column":0},"generated":{"line":16,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":15,"column":0},"generated":{"line":17,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":16,"column":0},"generated":{"line":18,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":17,"column":0},"generated":{"line":19,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":18,"column":0},"generated":{"line":20,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":19,"column":0},"generated":{"line":21,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":20,"column":0},"generated":{"line":22,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":21,"column":0},"generated":{"line":23,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":22,"column":0},"generated":{"line":24,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":23,"column":0},"generated":{"line":25,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":24,"column":0},"generated":{"line":26,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":25,"column":0},"generated":{"line":27,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":26,"column":0},"generated":{"line":28,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":27,"column":0},"generated":{"line":29,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":28,"column":0},"generated":{"line":30,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":29,"column":0},"generated":{"line":31,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":30,"column":0},"generated":{"line":32,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":31,"column":0},"generated":{"line":33,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":32,"column":0},"generated":{"line":34,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":33,"column":0},"generated":{"line":35,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":34,"column":0},"generated":{"line":36,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":35,"column":0},"generated":{"line":37,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":36,"column":0},"generated":{"line":38,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":37,"column":0},"generated":{"line":39,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":38,"column":0},"generated":{"line":40,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":39,"column":0},"generated":{"line":41,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":40,"column":0},"generated":{"line":42,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":41,"column":0},"generated":{"line":43,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":42,"column":0},"generated":{"line":44,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":43,"column":0},"generated":{"line":45,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":44,"column":0},"generated":{"line":46,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":45,"column":0},"generated":{"line":47,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":46,"column":0},"generated":{"line":48,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":47,"column":0},"generated":{"line":49,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":48,"column":0},"generated":{"line":50,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":49,"column":0},"generated":{"line":51,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":50,"column":0},"generated":{"line":52,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":51,"column":0},"generated":{"line":53,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":52,"column":0},"generated":{"line":54,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":53,"column":0},"generated":{"line":55,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":54,"column":0},"generated":{"line":56,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":55,"column":0},"generated":{"line":57,"column":0}},{"source":"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js","original":{"line":56,"column":0},"generated":{"line":58,"column":0}}],"sources":{"node_modules/@here/xyz-maps-core/dist/xyz-maps-core.min.js":"/*\n * @here/xyz-maps-core\n * (c) 2019-2022 HERE\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global = typeof globalThis !== 'undefined' ? globalThis : global || self, (global.here = global.here || {}, global.here.xyz = global.here.xyz || {}, global.here.xyz.maps = factory()));\n})(this, (function () { 'use strict';\n\n\tlet shared;\n\tlet worker;\n\tfunction define(dep, factory) {\n\t    if (!shared) {\n\t        shared = factory;\n\t    } else if (!worker) {\n\t        worker = factory;\n\t    } else {\n\t        const xyz = here.xyz.maps;\n\t        const sharedExports = {};\n\t        shared(sharedExports);\n\t        xyz.__workerURL = window.URL.createObjectURL(new Blob(['var shared={};('+shared+')(shared);('+worker+')(shared);'], {type: 'text/javascript'}));\n\t        factory(xyz, sharedExports, xyz.common);\n\t    }\n\t}\n\n\n\tdefine([\"exports\"],(function(t){\"use strict\";\n\t/******************************************************************************\n\tCopyright (c) Microsoft Corporation.\n\n\tPermission to use, copy, modify, and/or distribute this software for any\n\tpurpose with or without fee is hereby granted.\n\n\tTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n\tREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n\tAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n\tINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n\tLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n\tOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n\tPERFORMANCE OF THIS SOFTWARE.\n\t***************************************************************************** */var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);},e(t,i)};function i(t,i){if(\"function\"!=typeof i&&null!==i)throw new TypeError(\"Class extends value \"+String(i)+\" is not a constructor or null\");function r(){this.constructor=t;}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r);}t.__assign=function(){return t.__assign=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},t.__assign.apply(this,arguments)};var r=function(){function t(t){this.bO=0,\"number\"==typeof t&&(t=new ArrayBuffer(t)),this.dV=new DataView(t),this.aB=t;}return t.prototype.setUint16Array=function(t){var e=this.bO,i=t.length;this.dV.setUint32(e,i),new Uint16Array(this.aB,e+4,i).set(t),this.bO+=4+2*i;},t.prototype.setLayer=function(t,e){var i=this.dV,r=this.bO;i.setUint16(r,Number(t)),i.setUint32(r+2,e),this.bO+=6;},t.prototype.setFeature=function(t,e){this.dV.setUint16(this.bO,t),this.bO+=2,this.setUint16Array(e);},t.prototype.getLayers=function(){for(var t=this.dV,e=t.byteLength,i=0,r={};i<e;){var n=t.getUint16(i),s=2*t.getUint32(i+2);i+=6,r[n]={offset:i,length:s,features:null},i+=s;}return r},t.prototype.getFeatures=function(t){if(t.features)return t.features;for(var e=t.features={},i=this.dV,r=this.aB,n=t.offset,s=n+t.length;n<s;){var o=i.getUint16(n),a=i.getUint32(n+2);n+=6,e[o]=new Uint16Array(r,n,a),n+=2*a;}},t.prototype.getBuffer=function(){return this.aB},t}(),n=function(){function t(t){for(var e in this.withCredentials=!1,this.responseType=\"\",t)this[e]=t[e];}return t.prototype.send=function(t){var e=t.success,i=t.error,r=t.responseType||this.responseType,n=t.headers,s=new XMLHttpRequest,o=t.withCredentials;if(s.withCredentials=null!=o?o:this.withCredentials,s.responseType=\"json\"==r?\"text\":r,s.onload=function(){var t,i,n=this.responseType;\"\"==n||\"text\"==n?(i=(t=this.responseText).length,\"json\"==r&&204!=this.status&&(t=JSON.parse(t))):i=(t=this.response).byteLength,this.status>=200&&this.status<=226&&e(t,i);},s.onreadystatechange=function(){4==this.readyState&&(this.status<200||this.status>=300)&&(this.onload=null,0!==this.status&&i&&i(this));},s.open(t.type||\"GET\",t.url,!0),n)for(var a in n)s.setRequestHeader(a,n[a]);return s.send(t.data||null),s},t}(),s={},o=/{([xX]|(COL))}/,a=/{([yY]|(ROW))}/,h=/{([zZ]|(LEVEL))}/,u=/{((qk)|(QK)|(quadkey)|(QUADKEY))}/,f=/{SUBDOMAIN_INT_1_4}/,p=/{SUBDOMAIN_INT}/,c=/{SUBDOMAIN_CHAR}/,l=function(t){function e(e){var i=t.call(this,\"Service request failed with HTTP status: '\"+e.status+\" \"+e.statusText+\"'\")||this;i.name=\"NetworkError\";var r=i,n=e.responseType;return r.statusCode=e.status,\"\"!=n&&\"text\"!=n||(r.responseText=e.responseText||null),i}return i(e,t),e}(Error),d=function(){function e(e){this.withCredentials=!1,this.headers=null,this.store=null,this.baseUrl=null,this.q={};var i=e.responseType||\"json\",r=e.src||e.url,o=!!e.withCredentials;this.withCredentials=o,this.baseUrl=r,this.headers=t.__assign(t.__assign({},s),e.headers||{}),\"function\"==typeof r&&(this.getUrl=function(t){return r(t.z,t.y,t.x,t.quadkey)}),this.http=new n({responseType:i,withCredentials:o}),this.tileType=e.tileType;}return e.createImageFromBlob=function(t,e){var i=new Image;return i.onload=function(t){window.URL.revokeObjectURL(i.src),e&&e(i);},i.src=window.URL.createObjectURL(t),i},e.prototype.getUrl=function(t){var e=4*Math.random()^0;return this.baseUrl.replace(f,e+1).replace(p,e).replace(c,\"abcd\"[e]).replace(u,t.quadkey).replace(h,t.z).replace(o,t.x).replace(a,t.y)},e.prototype.setUrl=function(t){this.baseUrl=t;},e.prototype.load=function(t,i,r){var n,s=this.getUrl(t),o=t.quadkey,a=this.q,h={id:o,url:s,success:i,error:r},u=this.tileType||t.type;\"image\"==u?(h.responseType=\"blob\",h.success=function(t){a[o]=n,e.createImageFromBlob(t,(function(t){delete a[o],n._aborted||i(t);}));}):(\"json\"==u&&(h.success=function(t,e){i(\"FeatureCollection\"==t.type?t.features:t,e);}),h.headers=this.headers),n=this.send(h);},e.prototype.abort=function(t){var e=this.q,i=t.quadkey,r=e[i];r&&(\"image\"==t.type&&(r.onload=undefined,r._aborted=!0),r.abort&&r.abort(),delete e[i]);},e.prototype.send=function(t){var e=t.id||t.key||Math.random(),i=this.q,r=t.success,n=t;n.success=function(t,n){delete i[e],r(t,n);};var s=t.error;return n.error=function(t){delete i[e],s&&s(new l(t),t);},i[e]=this.http.send(n)},e}(),y={read:function(t,e,i,r,n){var s,o,a=8*n-r-1,h=(1<<a)-1,u=h>>1,f=-7,p=i?n-1:0,c=i?-1:1,l=t[e+p];for(p+=c,s=l&(1<<-f)-1,l>>=-f,f+=a;f>0;s=256*s+t[e+p],p+=c,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=r;f>0;o=256*o+t[e+p],p+=c,f-=8);if(0===s)s=1-u;else {if(s===h)return o?NaN:1/0*(l?-1:1);o+=Math.pow(2,r),s-=u;}return (l?-1:1)*o*Math.pow(2,s-r)},write:function(t,e,i,r,n,s){var o,a,h,u=8*s-n-1,f=(1<<u)-1,p=f>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,l=r?0:s-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+p>=1?c/h:c*Math.pow(2,1-p))*h>=2&&(o++,h/=2),o+p>=f?(a=0,o=f):o+p>=1?(a=(e*h-1)*Math.pow(2,n),o+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,n),o=0));n>=8;t[i+l]=255&a,l+=d,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;t[i+l]=255&o,l+=d,o/=256,u-=8);t[i+l-d]|=128*y;}},w=g,v=y;function g(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length;}g.Varint=0,g.Fixed64=1,g.Bytes=2,g.Fixed32=5;var x=4294967296,b=1/x,F=\"undefined\"==typeof TextDecoder?null:new TextDecoder(\"utf8\");function _(t){return t.type===g.Bytes?t.readVarint()+t.pos:t.pos+1}function V(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function M(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=t;n--)i.buf[n+r]=i.buf[n];}function S(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i]);}function B(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i]);}function T(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i]);}function m(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i]);}function k(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i]);}function P(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i]);}function U(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i]);}function O(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i]);}function A(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i]);}function q(t,e){return (t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function C(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24;}function D(t,e){return (t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}g.prototype={destroy:function(){this.buf=null;},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,s=this.pos;this.type=7&r,t(n,e,this),this.pos===s&&this.skip(r);}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=q(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=D(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=q(this.buf,this.pos)+q(this.buf,this.pos+4)*x;return this.pos+=8,t},readSFixed64:function(){var t=q(this.buf,this.pos)+D(this.buf,this.pos+4)*x;return this.pos+=8,t},readFloat:function(){var t=v.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=v.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,r=this.buf;return e=127&(i=r[this.pos++]),i<128?e:(e|=(127&(i=r[this.pos++]))<<7,i<128?e:(e|=(127&(i=r[this.pos++]))<<14,i<128?e:(e|=(127&(i=r[this.pos++]))<<21,i<128?e:function(t,e,i){var r,n,s=i.buf;if(n=s[i.pos++],r=(112&n)>>4,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<3,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<10,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<17,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(127&n)<<24,n<128)return V(t,r,e);if(n=s[i.pos++],r|=(1&n)<<31,n<128)return V(t,r,e);throw new Error(\"Expected varint not more than 10 bytes\")}(e|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&F?function(t,e,i){return F.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var r=\"\",n=e;for(;n<i;){var s,o,a,h=t[n],u=null,f=h>239?4:h>223?3:h>191?2:1;if(n+f>i)break;1===f?h<128&&(u=h):2===f?128==(192&(s=t[n+1]))&&(u=(31&h)<<6|63&s)<=127&&(u=null):3===f?(s=t[n+1],o=t[n+2],128==(192&s)&&128==(192&o)&&((u=(15&h)<<12|(63&s)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===f&&(s=t[n+1],o=t[n+2],a=t[n+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((u=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,f=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),n+=f;}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==g.Bytes)return t.push(this.readVarint(e));var i=_(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==g.Bytes)return t.push(this.readSVarint());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==g.Bytes)return t.push(this.readBoolean());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==g.Bytes)return t.push(this.readFloat());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==g.Bytes)return t.push(this.readDouble());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed32());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed32());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed64());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed64());var e=_(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===g.Varint)for(;this.buf[this.pos++]>127;);else if(e===g.Bytes)this.pos=this.readVarint()+this.pos;else if(e===g.Fixed32)this.pos+=4;else {if(e!==g.Fixed64)throw new Error(\"Unimplemented type: \"+e);this.pos+=8;}},writeTag:function(t,e){this.writeVarint(t<<3|e);},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e;}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),C(this.buf,t,this.pos),this.pos+=4;},writeSFixed32:function(t){this.realloc(4),C(this.buf,t,this.pos),this.pos+=4;},writeFixed64:function(t){this.realloc(8),C(this.buf,-1&t,this.pos),C(this.buf,Math.floor(t*b),this.pos+4),this.pos+=8;},writeSFixed64:function(t){this.realloc(8),C(this.buf,-1&t,this.pos),C(this.buf,Math.floor(t*b),this.pos+4),this.pos+=8;},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,r;t>=0?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error(\"Given varint doesn't fit into 10 bytes\");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t;}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t;}(r,e);}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))));},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t);},writeBoolean:function(t){this.writeVarint(Boolean(t));},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,s=0;s<e.length;s++){if((r=e.charCodeAt(s))>55295&&r<57344){if(!n){r>56319||s+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null;}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128);}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&M(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i;},writeFloat:function(t){this.realloc(4),v.write(this.buf,t,this.pos,!0,23,4),this.pos+=4;},writeDouble:function(t){this.realloc(8),v.write(this.buf,t,this.pos,!0,52,8),this.pos+=8;},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i];},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;r>=128&&M(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r;},writeMessage:function(t,e,i){this.writeTag(t,g.Bytes),this.writeRawMessage(e,i);},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,S,e);},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,B,e);},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,k,e);},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,T,e);},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,m,e);},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,P,e);},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,U,e);},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,O,e);},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,A,e);},writeBytesField:function(t,e){this.writeTag(t,g.Bytes),this.writeBytes(e);},writeFixed32Field:function(t,e){this.writeTag(t,g.Fixed32),this.writeFixed32(e);},writeSFixed32Field:function(t,e){this.writeTag(t,g.Fixed32),this.writeSFixed32(e);},writeFixed64Field:function(t,e){this.writeTag(t,g.Fixed64),this.writeFixed64(e);},writeSFixed64Field:function(t,e){this.writeTag(t,g.Fixed64),this.writeSFixed64(e);},writeVarintField:function(t,e){this.writeTag(t,g.Varint),this.writeVarint(e);},writeSVarintField:function(t,e){this.writeTag(t,g.Varint),this.writeSVarint(e);},writeStringField:function(t,e){this.writeTag(t,g.Bytes),this.writeString(e);},writeFloatField:function(t,e){this.writeTag(t,g.Fixed32),this.writeFloat(e);},writeDoubleField:function(t,e){this.writeTag(t,g.Fixed64),this.writeDouble(e);},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e));}};var L={},N=E;function E(t,e){this.x=t,this.y=e;}E.prototype={clone:function(){return new E(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=e*this.x-i*this.y,n=i*this.x+e*this.y;return this.x=r,this.y=n,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.x+i*(this.x-e.x)-r*(this.y-e.y),s=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=n,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},E.convert=function(t){return t instanceof E?t:Array.isArray(t)?new E(t[0],t[1]):t};var j=N,I=R;function R(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(G,this,e);}function G(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){var i=t.readVarint()+t.pos;for(;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n;}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos);}function H(t){for(var e,i,r=0,n=0,s=t.length,o=s-1;n<s;o=n++)e=t[n],r+=((i=t[o]).x-e.x)*(e.y+i.y);return r}R.types=[\"Unknown\",\"Point\",\"LineString\",\"Polygon\"],R.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,n=0,s=0,o=0,a=[];t.pos<i;){if(n<=0){var h=t.readVarint();r=7&h,n=h>>3;}if(n--,1===r||2===r)s+=t.readSVarint(),o+=t.readSVarint(),1===r&&(e&&a.push(e),e=[]),e.push(new j(s,o));else {if(7!==r)throw new Error(\"unknown command \"+r);e&&e.push(e[0].clone());}}return e&&a.push(e),a},R.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,s=0,o=1/0,a=-1/0,h=1/0,u=-1/0;t.pos<e;){if(r<=0){var f=t.readVarint();i=7&f,r=f>>3;}if(r--,1===i||2===i)(n+=t.readSVarint())<o&&(o=n),n>a&&(a=n),(s+=t.readSVarint())<h&&(h=s),s>u&&(u=s);else if(7!==i)throw new Error(\"unknown command \"+i)}return [o,h,a,u]},R.prototype.toGeoJSON=function(t,e,i){var r,n,s=this.extent*Math.pow(2,i),o=this.extent*t,a=this.extent*e,h=this.loadGeometry(),u=R.types[this.type];function f(t){for(var e=0;e<t.length;e++){var i=t[e],r=180-360*(i.y+a)/s;t[e]=[360*(i.x+o)/s-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90];}}switch(this.type){case 1:var p=[];for(r=0;r<h.length;r++)p[r]=h[r][0];f(h=p);break;case 2:for(r=0;r<h.length;r++)f(h[r]);break;case 3:for(h=function(t){var e=t.length;if(e<=1)return [t];for(var i,r,n=[],s=0;s<e;s++){var o=H(t[s]);0!==o&&(void 0===r&&(r=o<0),r===o<0?(i&&n.push(i),i=[t[s]]):i.push(t[s]));}i&&n.push(i);return n}(h),r=0;r<h.length;r++)for(n=0;n<h[r].length;n++)f(h[r][n]);}1===h.length?h=h[0]:u=\"Multi\"+u;var c={type:\"Feature\",geometry:{type:u,coordinates:h},properties:this.properties};return \"id\"in this&&(c.id=this.id),c};var W=I,z=X;function X(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Y,this,e),this.length=this._features.length;}function Y(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){var e=null,i=t.readVarint()+t.pos;for(;t.pos<i;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null;}return e}(i));}X.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error(\"feature index out of bounds\");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new W(this._pbf,e,this.extent,this._keys,this._values)};var J=z,K=function(t,e){this.layers=t.readFields(Q,{},e);};function Q(t,e,i){if(3===t){var r=new J(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r);}}var Z=L.VectorTile=K;L.VectorTileFeature=I,L.VectorTileLayer=z,t.HTTPLoader=d,t.VectorTile=Z,t.XYZBin=r,t.__extends=i,t.pbf=w,t.vectorTile=L;}));\n\n\tdefine([\"./shared\"],(function(e){\"use strict\";var n={exports:{}};function r(e,n,r){r=r||2;var i,u,a,o,f,l,h,y=n&&n.length,c=y?n[0]*r:e.length,d=t(e,0,c,r,!0),g=[];if(!d||d.next===d.prev)return g;if(y&&(d=function(e,n,r,i){var x,u,a,o=[];for(x=0,u=n.length;x<u;x++)(a=t(e,n[x]*i,x<u-1?n[x+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),o.push(p(a));for(o.sort(v),x=0;x<o.length;x++)r=s(o[x],r);return r}(e,n,d,r)),e.length>80*r){i=a=e[0],u=o=e[1];for(var Z=r;Z<c;Z+=r)(f=e[Z])<i&&(i=f),(l=e[Z+1])<u&&(u=l),f>a&&(a=f),l>o&&(o=l);h=0!==(h=Math.max(a-i,o-u))?32767/h:0;}return x(d,g,r,i,u,h,0),g}function t(e,n,r,t,i){var x,u;if(i===q(e,n,r,t)>0)for(x=n;x<r;x+=t)u=M(x,e[x],e[x+1],u);else for(x=r-t;x>=n;x-=t)u=M(x,e[x],e[x+1],u);return u&&g(u,u.next)&&(z(u),u=u.next),u}function i(e,n){if(!e)return e;n||(n=e);var r,t=e;do{if(r=!1,t.steiner||!g(t,t.next)&&0!==d(t.prev,t,t.next))t=t.next;else {if(z(t),(t=n=t.prev)===t.next)break;r=!0;}}while(r||t!==n);return n}function x(e,n,r,t,v,s,l){if(e){!l&&s&&function(e,n,r,t){var i=e;do{0===i.z&&(i.z=h(i.x,i.y,n,r,t)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var n,r,t,i,x,u,a,o,f=1;do{for(r=e,e=null,x=null,u=0;r;){for(u++,t=r,a=0,n=0;n<f&&(a++,t=t.nextZ);n++);for(o=f;a>0||o>0&&t;)0!==a&&(0===o||!t||r.z<=t.z)?(i=r,r=r.nextZ,a--):(i=t,t=t.nextZ,o--),x?x.nextZ=i:e=i,i.prevZ=x,x=i;r=t;}x.nextZ=null,f*=2;}while(u>1)}(i);}(e,t,v,s);for(var p,y,c=e;e.prev!==e.next;)if(p=e.prev,y=e.next,s?a(e,t,v,s):u(e))n.push(p.i/r|0),n.push(e.i/r|0),n.push(y.i/r|0),z(e),e=y.next,c=y.next;else if((e=y)===c){l?1===l?x(e=o(i(e),n,r),n,r,t,v,s,2):2===l&&f(e,n,r,t,v,s):x(i(e),n,r,t,v,s,1);break}}}function u(e){var n=e.prev,r=e,t=e.next;if(d(n,r,t)>=0)return !1;for(var i=n.x,x=r.x,u=t.x,a=n.y,o=r.y,f=t.y,v=i<x?i<u?i:u:x<u?x:u,s=a<o?a<f?a:f:o<f?o:f,l=i>x?i>u?i:u:x>u?x:u,h=a>o?a>f?a:f:o>f?o:f,p=t.next;p!==n;){if(p.x>=v&&p.x<=l&&p.y>=s&&p.y<=h&&y(i,a,x,o,u,f,p.x,p.y)&&d(p.prev,p,p.next)>=0)return !1;p=p.next;}return !0}function a(e,n,r,t){var i=e.prev,x=e,u=e.next;if(d(i,x,u)>=0)return !1;for(var a=i.x,o=x.x,f=u.x,v=i.y,s=x.y,l=u.y,p=a<o?a<f?a:f:o<f?o:f,c=v<s?v<l?v:l:s<l?s:l,g=a>o?a>f?a:f:o>f?o:f,Z=v>s?v>l?v:l:s>l?s:l,w=h(p,c,n,r,t),m=h(g,Z,n,r,t),b=e.prevZ,k=e.nextZ;b&&b.z>=w&&k&&k.z<=m;){if(b.x>=p&&b.x<=g&&b.y>=c&&b.y<=Z&&b!==i&&b!==u&&y(a,v,o,s,f,l,b.x,b.y)&&d(b.prev,b,b.next)>=0)return !1;if(b=b.prevZ,k.x>=p&&k.x<=g&&k.y>=c&&k.y<=Z&&k!==i&&k!==u&&y(a,v,o,s,f,l,k.x,k.y)&&d(k.prev,k,k.next)>=0)return !1;k=k.nextZ;}for(;b&&b.z>=w;){if(b.x>=p&&b.x<=g&&b.y>=c&&b.y<=Z&&b!==i&&b!==u&&y(a,v,o,s,f,l,b.x,b.y)&&d(b.prev,b,b.next)>=0)return !1;b=b.prevZ;}for(;k&&k.z<=m;){if(k.x>=p&&k.x<=g&&k.y>=c&&k.y<=Z&&k!==i&&k!==u&&y(a,v,o,s,f,l,k.x,k.y)&&d(k.prev,k,k.next)>=0)return !1;k=k.nextZ;}return !0}function o(e,n,r){var t=e;do{var x=t.prev,u=t.next.next;!g(x,u)&&Z(x,t,t.next,u)&&b(x,u)&&b(u,x)&&(n.push(x.i/r|0),n.push(t.i/r|0),n.push(u.i/r|0),z(t),z(t.next),t=e=u),t=t.next;}while(t!==e);return i(t)}function f(e,n,r,t,u,a){var o=e;do{for(var f=o.next.next;f!==o.prev;){if(o.i!==f.i&&c(o,f)){var v=k(o,f);return o=i(o,o.next),v=i(v,v.next),x(o,n,r,t,u,a,0),void x(v,n,r,t,u,a,0)}f=f.next;}o=o.next;}while(o!==e)}function v(e,n){return e.x-n.x}function s(e,n){var r=function(e,n){var r,t=n,i=e.x,x=e.y,u=-1/0;do{if(x<=t.y&&x>=t.next.y&&t.next.y!==t.y){var a=t.x+(x-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>u&&(u=a,r=t.x<t.next.x?t:t.next,a===i))return r}t=t.next;}while(t!==n);if(!r)return null;var o,f=r,v=r.x,s=r.y,h=1/0;t=r;do{i>=t.x&&t.x>=v&&i!==t.x&&y(x<s?i:u,x,v,s,x<s?u:i,x,t.x,t.y)&&(o=Math.abs(x-t.y)/(i-t.x),b(t,e)&&(o<h||o===h&&(t.x>r.x||t.x===r.x&&l(r,t)))&&(r=t,h=o)),t=t.next;}while(t!==f);return r}(e,n);if(!r)return n;var t=k(r,e);return i(t,t.next),i(r,r.next)}function l(e,n){return d(e.prev,e,n.prev)<0&&d(n.next,e,e.next)<0}function h(e,n,r,t,i){return (e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*i|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function p(e){var n=e,r=e;do{(n.x<r.x||n.x===r.x&&n.y<r.y)&&(r=n),n=n.next;}while(n!==e);return r}function y(e,n,r,t,i,x,u,a){return (i-u)*(n-a)>=(e-u)*(x-a)&&(e-u)*(t-a)>=(r-u)*(n-a)&&(r-u)*(x-a)>=(i-u)*(t-a)}function c(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!function(e,n){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&Z(r,r.next,e,n))return !0;r=r.next;}while(r!==e);return !1}(e,n)&&(b(e,n)&&b(n,e)&&function(e,n){var r=e,t=!1,i=(e.x+n.x)/2,x=(e.y+n.y)/2;do{r.y>x!=r.next.y>x&&r.next.y!==r.y&&i<(r.next.x-r.x)*(x-r.y)/(r.next.y-r.y)+r.x&&(t=!t),r=r.next;}while(r!==e);return t}(e,n)&&(d(e.prev,e,n.prev)||d(e,n.prev,n))||g(e,n)&&d(e.prev,e,e.next)>0&&d(n.prev,n,n.next)>0)}function d(e,n,r){return (n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y)}function g(e,n){return e.x===n.x&&e.y===n.y}function Z(e,n,r,t){var i=m(d(e,n,r)),x=m(d(e,n,t)),u=m(d(r,t,e)),a=m(d(r,t,n));return i!==x&&u!==a||(!(0!==i||!w(e,r,n))||(!(0!==x||!w(e,t,n))||(!(0!==u||!w(r,e,t))||!(0!==a||!w(r,n,t)))))}function w(e,n,r){return n.x<=Math.max(e.x,r.x)&&n.x>=Math.min(e.x,r.x)&&n.y<=Math.max(e.y,r.y)&&n.y>=Math.min(e.y,r.y)}function m(e){return e>0?1:e<0?-1:0}function b(e,n){return d(e.prev,e,e.next)<0?d(e,n,e.next)>=0&&d(e,e.prev,n)>=0:d(e,n,e.prev)<0||d(e,e.next,n)<0}function k(e,n){var r=new V(e.i,e.x,e.y),t=new V(n.i,n.x,n.y),i=e.next,x=n.prev;return e.next=n,n.prev=e,r.next=i,i.prev=r,t.next=r,r.prev=t,x.next=t,t.prev=x,t}function M(e,n,r,t){var i=new V(e,n,r);return t?(i.next=t.next,i.prev=t,t.next.prev=i,t.next=i):(i.prev=i,i.next=i),i}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ);}function V(e,n,r){this.i=e,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1;}function q(e,n,r,t){for(var i=0,x=n,u=r-t;x<r;x+=t)i+=(e[u]-e[x])*(e[x+1]+e[u+1]),u=x;return i}n.exports=r,n.exports.default=r,r.deviation=function(e,n,r,t){var i=n&&n.length,x=i?n[0]*r:e.length,u=Math.abs(q(e,0,x,r));if(i)for(var a=0,o=n.length;a<o;a++){var f=n[a]*r,v=a<o-1?n[a+1]*r:e.length;u-=Math.abs(q(e,f,v,r));}var s=0;for(a=0;a<t.length;a+=3){var l=t[a]*r,h=t[a+1]*r,p=t[a+2]*r;s+=Math.abs((e[l]-e[p])*(e[h+1]-e[l+1])-(e[l]-e[h])*(e[p+1]-e[l+1]));}return 0===u&&0===s?0:Math.abs((s-u)/u)},r.flatten=function(e){for(var n=e[0][0].length,r={vertices:[],holes:[],dimensions:n},t=0,i=0;i<e.length;i++){for(var x=0;x<e[i].length;x++)for(var u=0;u<n;u++)r.vertices.push(e[i][x][u]);i>0&&(t+=e[i-1].length,r.holes.push(t));}return r};var L=function(e){var n=e._pbf;n.pos=e._geometry;for(var r,t=n.readVarint()+n.pos,i=1,x=0,u=0,a=0,o=[];n.pos<t;){if(x<=0){var f=n.readVarint();i=7&f,x=f>>3;}if(x--,1===i||2===i)u+=n.readSVarint(),a+=n.readSVarint(),1===i&&(r&&o.push(r),r=[]),r.push([u,a]);else {if(7!==i)throw new Error(\"unknown command \"+i);r&&r.push(r[0].slice());}}return r&&o.push(r),o};function T(e){var n=e.length;if(n<=1)return [e];for(var r,t,i=[],x=0;x<n;x++){var u=E(e[x]);0!==u&&(void 0===t&&(t=u<0),t===u<0?(r&&i.push(r),r=[e[x]]):r.push(e[x]));}return r&&i.push(r),i}function E(e){for(var n,r,t=0,i=0,x=e.length,u=x-1;i<x;u=i++)n=e[i],t+=((r=e[u])[0]-n[0])*(n[1]+r[1]);return t}var _=function(e,n){void 0===n&&(n=[]);for(var r=[],t=0,i=0;i<e.length;i++){for(var x=0;x<e[i].length;x++)n[n.length]=e[i][x][0],n[n.length]=e[i][x][1];i>0&&(t+=e[i-1].length,r[r.length]=t);}return {vertices:n,holes:r,dimensions:e[0][0].length}},W={id:\"MVTWorker\",Worker:function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return e.__extends(t,r),t.prototype.process=function(r,t,i,x){var u=function(r,t,i,x){var u=new e.VectorTile(new e.pbf(r)),a={},o=0,f=0,v=0;for(var s in u.layers){for(var l=u.layers[s],h=0,p=a[o++]={length:0,features:{}};h<l.length;){if(3==(S=l.feature(h)).type){for(var y=[],c=[],d=0,g=0,Z=T(L(S));g<Z.length;g++){var w=Z[g],m=_(w),b=n.exports(m.vertices,m.holes,m.dimensions);c.push(d);for(var k=0,M=b;k<M.length;k++){var z=M[k];y[y.length]=d+z;}d+=m.vertices.length/m.dimensions;}p.features[h]={tris:y,verts:[],polys:c,holes:[]},p.length+=y.length+2+1;}h++;}p.length&&(v++,f+=2*p.length);}var V=new e.XYZBin(6*v+f);if(f>0)for(var q in a){var E=(p=a[q]).length;if(E){V.setLayer(q,E);var W=p.features;for(var B in W){var S;b=(S=W[B]).tris,V.setFeature(Number(B),b);}}}return V.getBuffer()}(r);return {data:{mvt:r,triangles:u},transfer:[r,u]}},t}(function(){function n(){var n=this.loader=new e.HTTPLoader({responseType:\"arraybuffer\"}),r=this;self.addEventListener(\"message\",(function(e){var t=e.data,i=t.msg,x=t.quadkey,u=t.url,a=t.x,o=t.y,f=t.z;switch(i){case\"abort\":n.abort({quadkey:x});break;case\"load\":n.baseUrl=u,n.load({quadkey:x},(function(e){var n=r.process(e,a,o,f),t=n.data,i=n.transfer;self.postMessage({msg:\"success\",url:u,quadkey:x,data:t},i);}),(function(e){self.postMessage({msg:\"error\",url:u,quadkey:x,data:e});}));}}));}return n.prototype.process=function(e,n,r,t){return {data:e,transfer:[e]}},n}())},B=[W];self.addEventListener(\"message\",(function e(n){var r=n.data,t=r.msg,i=r.worker;if(r.payload,\"init\"==t){var x=B.find((function(e){return e.id==i})).Worker;x&&(new x,x=null),B=null,self.removeEventListener(\"message\",e);}}));}));\n\n\tdefine([\"exports\",\"./shared\",\"@here/xyz-maps-common\"],(function(e,t,r){\"use strict\";function o(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if(\"default\"!==r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return e[r]}});}})),t.default=e,Object.freeze(t)}var n=o(r),i=function(e,t){this.x=e,this.y=t;},a=function(e,t,r,o){this.minX=e,this.minY=t,this.maxX=r,this.maxY=o;},s=function(e,t){this.longitude=e,this.latitude=t;},u=function(e,t,r,o){this.minLon=e,this.minLat=t,this.maxLon=r,this.maxLat=o;},p=[{zIndex:0,type:\"Circle\",radius:6,fill:\"#ff0000\"}],l=[{zIndex:0,type:\"Line\",strokeWidth:10,stroke:\"#ff0000\"}],c=[{zIndex:0,type:\"Polygon\",strokeWidth:1,stroke:\"#ffffff\",fill:\"#ff0000\"}],h={styleGroups:{Point:p,MultiPoint:p,LineString:l,MultiLineString:l,Polygon:c,MultiPolygon:c},assign:function(e){return e.geometry.type}};function f(e,t){for(var r in t)e[r]=t[r];return e}var d=[],y=function(){function e(e,t){this.styleGroups=null,this._c=null;var r=function(e,t){if(\"object\"!=typeof e||null===e)return e;for(var o in t=t||(Array.isArray(e)?[]:{}),e)t[o]=r(e[o]);return t};for(var o in e)this[o]=\"styleGroups\"==o?r(e.styleGroups,{}):e[o];this._c=t||{};}return e.prototype.assign=function(e,t){return e.geometry.type},e.prototype.getCustomStyleGroup=function(e){return this._c[e.id]},e.prototype.getStyleGroup=function(e,t,r){var o=this._c[e.id];return (null==o||r)&&\"object\"!=typeof(o=this.assign(e,t))&&(o=this.styleGroups[o]),o},e.prototype.setStyleGroup=function(e,t,r){var o=e.id,n=this._c;return t&&r&&(t=this.merge(this.getStyleGroup(e),t)),t?n[o]=t:null===t||!1===t?t=n[o]=d:n[o]&&delete n[o],t},e.prototype.merge=function(e,t){if(null===t||!1===t)return null;for(var r,o=[],n=0,i=e.length;n<i;n++)r=f({},e[n]),t[n]&&f(r,t[n]),o[n]=r;return o},e}(),v=function(){function e(e){this.name=\"\",this.__type=\"Layer\";var t=this;for(var o in e)t[o]=e[o];null==t.id&&(t.id=\"L-\"+(1e8*Math.random()^0)),t._l=new r.Listener([\"layerAdd\",\"layerRemove\"]);}return e.prototype.addEventListener=function(e,t,r){var o=this._l;if(o.isDefined(e))return o.add(e,t,r)},e.prototype.removeEventListener=function(e,t,r){var o=this._l;if(o.isDefined(e))return o.remove(e,t,r)},e.prototype.dispatchEvent=function(e,t){t.layer=this;var r=new CustomEvent(e,{detail:t});this._l.trigger(e,r,!0);},e}(),g=\"featureRemove\",m=\"featureAdd\",x=\"featureCoordinatesChange\",_=\"styleGroupChange\",L=\"styleChange\",w=\"viewportReady\",T=\"clear\",b=function(e){function r(r){var o=this,n=r.pointerEvents;delete r.pointerEvents,(o=e.call(this,t.__assign({min:15,max:32,tiled:!0},r))||this)._p=[],o._sd=null,o._pev=!0,o.__type=\"Layer\",o.margin=20,o.tiled=!0,o.levelOffset=0,o.custom=!1;var i=o;[m,g,x,T,_,w,L].forEach((function(e){return i._l.addEvent(e)})),\"boolean\"==typeof n&&o.pointerEvents(n);var a,s=r.providers||r.provider,u=256,p=function(e,t,r){for(var o=e;o<=t;o++)i._p[o]=r;};if(s instanceof Array)for(var l=0,c=s;l<c.length;l++){var f=c[l];p(f.min,f.max,f.provider);}else {u=o.tileSize?s.size=o.tileSize:Math.max(u,s.size);var d=Number(512==u),y=i.min,v=i.max;p(y-d,v-d,s),i._fp=s,s.minLevel=y,s.maxLevel=v;}o.tileSize||u%256||(o.tileSize=u),o.levelOffset=Math.round(Math.log(o.tileSize)/Math.log(2)-8),i._p.forEach((function(e,t){e&&(\"FeatureProvider\"==e.__type&&(e.addEventListener(m,i._eventProxy,i),e.addEventListener(g,i._eventProxy,i),e.addEventListener(x,i._eventProxy,i)),e.addEventListener(T,i._eventProxy,i));})),i.setMargin(i.getMargin());var b=o._fp&&o._fp.styles;return (a=r.style||r.styles||b||h)&&i.setStyle(a),[\"style\",\"styles\",\"provider\",\"providers\"].forEach((function(e){delete i[e];})),o}return t.__extends(r,e),r.prototype.getProvider=function(e){return e?this._p[Math.floor(e)-this.levelOffset]:this._fp},r.prototype.addEventListener=function(t,r,o){var n;return this._l.isDefined(t)?e.prototype.addEventListener.call(this,t,r,o):null===(n=this._fp)||void 0===n?void 0:n.addEventListener(t,r,o)},r.prototype.removeEventListener=function(t,r,o){return this._l.isDefined(t)?e.prototype.removeEventListener.call(this,t,r,o):this._fp.removeEventListener(t,r,o)},r.prototype._eventProxy=function(e){var t=e.type,r=e.detail;r.layer=this,t==g&&this.setStyleGroup(r.feature),this._l.trigger(t,e,!0);},r.prototype.setFeatureCoordinates=function(e,t){return this._fp.setFeatureCoordinates(e,t)},r.prototype.addFeature=function(e,t){var r=this._fp;if(r.addFeature){var o=r.addFeature(e);return t&&this.setStyleGroup(o,t),o}},r.prototype.removeFeature=function(e){var t=this._fp;if(t.removeFeature)return t.removeFeature(e)},r.prototype.setStyleGroup=function(e,t,r){this._sd&&this.dispatchEvent(_,{feature:e,styleGroup:this._sd.setStyleGroup(e,t,r)});},r.prototype.getStyleGroup=function(e,t,r){var o;return null===(o=this._sd)||void 0===o?void 0:o.getStyleGroup(e,t,r)},r.prototype._getCustomStyleGroup=function(e){var t;return null===(t=this._sd)||void 0===t?void 0:t.getCustomStyleGroup(e)},r.prototype.search=function(e,t){var r=this._fp;if(r&&r.search)return r.search.apply(this._fp,arguments)},r.prototype.getTile=function(e,t){var r=e.length,o=this._p[r];if(o)return o.getTile(e,t)},r.prototype.cancelTile=function(e,t){var r=\"string\"==typeof e?e.length:e.quadkey.length,o=this._p[r];if(o&&o.cancel)return o.cancel(e,t)},r.prototype.getCachedTile=function(e){var t=e.length,r=this._p[t];if(r)return r.getCachedTile(e)},r.prototype.setStyle=function(e,t){void 0===t&&(t=!1);var r=function(e){return \"function\"==typeof e};r(e.getStyleGroup)&&r(e.setStyleGroup)||(e=new y(e,t&&this._sd&&this._sd._c)),this._sd=e,this.dispatchEvent(L,{style:e});},r.prototype.getStyle=function(){return this._sd},r.prototype.getMargin=function(){return this.margin},r.prototype.setMargin=function(e){void 0===e&&(e=0),e=Number(e);for(var t=this._p,r=t.length;r--;)t[r]&&t[r].setMargin(e);return this.margin=e},r.prototype.pointerEvents=function(e){return null!=e&&(this._pev=!!e),this._pev},r.prototype.getCopyright=function(e){for(var t,r=this._p.filter((function(e,t,r){return r.indexOf(e)===t})),o=[],n=0,i=function(t){t.length&&o.push.apply(o,t),--n||e&&e(o);};t=r.pop();)t&&t.getCopyright&&(n++,t.getCopyright(i));},r}(v);b.prototype.modifyFeatureCoordinates=b.prototype.setFeatureCoordinates;var P=function(e){function r(t,r,o){var n=e.call(this,r)||this;return n.cbs=new Map,o||(o=new ArrayBuffer(0)),n.worker=new Worker(window.here.xyz.maps.__workerURL),n.worker.postMessage({msg:\"init\",worker:t,payload:o},[o]),n.worker.addEventListener(\"message\",n.receiveMessage.bind(n)),n}return t.__extends(r,e),r.prototype.processData=function(e){return e.data},r.prototype.receiveMessage=function(e){var t=e.data;if(\"success\"===t.msg){var r=t.quadkey,o=this.cbs.get(r);o&&(this.cbs.delete(r),o.success(this.processData(t.data)));}},r.prototype.load=function(e,t,r){var o=this.getUrl(e),n=e.quadkey,i=e.x,a=e.y,s=e.z;this.cbs.set(n,{tile:e,success:t,error:r}),this.worker.postMessage({msg:\"load\",url:o,quadkey:n,x:i,y:a,z:s});},r.prototype.abort=function(e){var t=this.getUrl(e),r=e.quadkey,o=e.x,n=e.y,i=e.z;this.cbs.get(r)&&(this.cbs.delete(r),this.worker.postMessage({msg:\"abort\",url:t,quadkey:r,x:o,y:n,z:i}));},r}(t.HTTPLoader),M=function(e){function r(t){return e.call(this,\"MVTWorker\",t)||this}return t.__extends(r,e),r.prototype.processData=function(e){var r=new t.XYZBin(e.triangles),o=r.getLayers();for(var n in o)r.getFeatures(o[n]);return {mvt:e.mvt,xyz:o}},r}(P),E=function(){function e(e,t){this._m=0,this.id=e.id,this.properties=e.properties,this.geometry=e.geometry,this.bbox=e.bbox,this._provider=t;}return e.prototype.toJSON=function(){return r.JSUtils.clone({id:this.id,type:this.type,bbox:this.bbox,properties:this.properties,geometry:{type:this.geometry.type,coordinates:this.geometry.coordinates}})},e.prototype.getProvider=function(){return this._provider},e.prototype.getBBox=function(){return this._provider.decBBox(this)},e}();E.prototype.type=\"Feature\";\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self&&self;var F=t.vectorTile.VectorTile,S=t.vectorTile.VectorTileFeature;S.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,o=1,n=0,i=0,a=0,s=[];e.pos<r;){if(n<=0){var u=e.readVarint();o=7&u,n=u>>3;}if(n--,1===o||2===o)i+=e.readSVarint(),a+=e.readSVarint(),1===o&&(t&&s.push(t),t=[]),t.push([i,a]);else {if(7!==o)throw new Error(\"unknown command \"+o);t&&t.push(t[0].slice());}}return t&&s.push(t),s};var B=r.TaskManager.getInstance(),R=0;function O(e){for(var t,r,o=0,n=0,i=e.length,a=i-1;n<i;a=n++)t=e[n],o+=((r=e[a])[0]-t[0])*(t[1]+r[1]);return o}var k=function(e,t){return 360*e/t-180},C=function(e,t){var r=180-360*e/t;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90},U=function(e,t,r,o,n){var i=e.loadGeometry();switch(e.type){case 1:for(var a=[],s=0;s<i.length;s++)a[s]=i[s][0];n(i=a,t,r,o,e);break;case 2:for(s=0;s<i.length;s++)n(i[s],t,r,o,e);break;case 3:i=function(e){var t=e.length;if(t<=1)return [e];for(var r,o,n=[],i=0;i<t;i++){var a=O(e[i]);0!==a&&(void 0===o&&(o=a<0),o===a<0?(r&&n.push(r),r=[e[i]]):r.push(e[i]));}return r&&n.push(r),n}(i);for(s=0;s<i.length;s++)for(var u=0;u<i[s].length;u++)n(i[s][u],t,r,o,e);}return i};function z(e,t,r){var o=function(e,t,r,o){var n=1/0,i=-n,a=n,s=-a,u=e.extent*(1<<o),p=e.extent*t,l=e.extent*r,c=S.types[e.type];return U(e,t,r,o,(function(e){for(var t=0,r=e;t<r.length;t++){var o=r[t],u=o[0],p=o[1];u<n&&(n=u),u>i&&(i=u),p<a&&(a=p),p>s&&(s=p);}})).length>1&&(c=\"Multi\"+c),{bbox:[k(n+p,u),C(s+l,u),k(i+p,u),C(a+l,u)],type:c}}(e,t.x,t.y,t.z),n={type:\"Feature\",geometry:new D(o.type,e,t),properties:e.properties};return \"id\"in e&&(n.id=e.id),r&&(n.bbox=o.bbox),n}var I=function(e,t,r,o,n){for(var i=n.extent,a=1<<o,s=0,u=e;s<u.length;s++){var p=u[s];p[0]=(t+p[0]/i)/a,p[1]=(r+p[1]/i)/a;}},D=function(){function e(e,t,r){this.type=e,this._vtf=t,this.__xyz=r;}return e.prototype._coordinates=function(){var e=this.type,t=this.__xyz,r=t.x,o=t.y,n=t.z,i=U(this._vtf,r,o,n,I);return \"Point\"!=e&&\"Polygon\"!=e&&\"LineString\"!=e||(i=i[0]),i},Object.defineProperty(e.prototype,\"coordinates\",{get:function(){var e=this.__xyz,t=e.x,r=e.y,o=e.z;return function(e,t,r,o){var n=e.extent*(1<<o),i=e.extent*t,a=e.extent*r,s=U(e,t,r,o,(function(e){for(var t=0;t<e.length;t++){var r=e[t],o=k(r[0]+i,n),s=C(r[1]+a,n);e[t]=[o,s];}}));return 1===s.length&&(s=s[0]),s}(this._vtf,t,r,o)},enumerable:!1,configurable:!0}),e}();function Y(e){B.create({init:function(){var r=[],o=new F(new t.pbf(e.data.mvt)),n=e.tile;for(var i in o.layers)r.push(i);return {xyz:{x:n.x,y:n.y,z:n.z},mvt:o,xyzLayers:e.data.xyz,layers:r,l:0,f:0,geojson:[]}},priority:4,exec:function(e){for(var t,r,o,n,i=e.mvt,a=e.xyz,s=e.layers,u=e.xyzLayers,p=e.l,l=e.f,c=e.geojson;p<s.length;){for(t=i.layers[s[p]],n={x:a.x,y:a.y,z:a.z,l:t.name};l<t.length;){if(\"MultiPolygon\"==(o=(r=z(t.feature(l),n,!0)).geometry.type)||\"Polygon\"==o){var h=u[p]&&u[p].features[l];h&&(r.geometry._xyz=h);}if(r.id=++R,l++,null==r.properties.layer&&(r.properties.layer=t.name),c.push(r),!(l%16))return e.f=l,this.CONTINUE}return e.l=++p,e.f=0,this.CONTINUE}return this.BREAK},onDone:function(t){e.ready(t.geojson);}}).start();}var X=Math.PI,q=X/180,A=2*X*(19113026/3),j=Array.from({length:33},(function(e,t){return 40075017/256/(1<<t)})),G=function(e,t){return (e+180)/360*t},H=function(e,t){return (180-180/X*Math.log(Math.tan(X/4+e*X/360)))*t/360},J=function(e,t){return 360*e/t-180},N=function(e,t){var r=180-360*e/t;return 360/X*Math.atan(Math.exp(r*q))-90},V=function(e){return void 0===e&&(e=0),A*Math.cos(e*q)},Z={mapSizePixel:function(e,t){return Math.pow(2,t)*e},lon2x:G,lat2y:H,x2lon:J,y2lat:N,pixelToGeo:function(e,t,r){return new s(J(e,r),N(t,r))},geoToPixel:function(e,t,r){return new i(G(e,r),H(t,r))},meterToPixel:function(e,t){return e/j[t]},pixelToMeter:function(e,t){return e*j[t]},getGroundResolution:function(e){return j[e]},alt2z:function(e,t){return e/V(t)},earthCircumference:V},W=r.global.Math,K=256,Q=85.05112878,$=-85.05112878,ee=function(e,t,r){var o=1<<r;return [W.floor(Z.lon2x(e,o)),W.floor(Z.lat2y(t,o)),r]},te=function(e){\"number\"==typeof e&&(e=String(e));for(var t=e.length,r=0,o=0,n=0;n<t;++n)switch(r*=2,o*=2,e[n]){case\"1\":o++;break;case\"3\":o++;case\"2\":r++;}return [t,r,o]},re=function(e,t,r){for(var o,n=\"\";e-- >0;)n+=(0!=(r&(o=1<<e)))+2*(0!=(t&o));return n},oe=function(e,t,r){var o=K<<e,n=K*r,i=K*t;return [Z.x2lon(n,o),Z.y2lat(i+K,o),Z.x2lon(n+K,o),Z.y2lat(i,o)]},ne=function(e,t){for(var r=[],o=t[1]-e[1]+1,n=t[0]-e[0]+1,i=e[2],a=0;a<o;a++)for(var s=0;s<n;s++)r[r.length]=re(i,e[1]+a,e[0]+s);return r},ie={geoToGrid:ee,pixelToGrid:function(e,t,r){return [W.floor(e),W.floor(t),r]},quadToGrid:te,tileXYToQuadKey:re,getGeoBounds:oe,getTilesOfLevel:function(e,t){var r=[e],o=0,n=r.length,i=e.length;if(t<=i)return [e.substring(0,t)];for(;i<t;){for(;o<n;o++)r.push(r[o]+\"0\",r[o]+\"1\",r[o]+\"2\",r[o]+\"3\");o=n,n=r.length,i++;}return r.slice(o)},getTilesIds:ne,getTilesInRect:function(e,t,r,o,n){r>=180&&(r=179.999999),e<=-180&&(e=-180),o>=Q&&(o=85.05112778),t<$&&(t=-85.05112778);var i=ee(e,o,n),a=ee(r,t,n);return ne(i,a)}},ae={exports:{}};ae.exports=function(){function e(e,o,n,i,a){!function e(r,o,n,i,a){for(;i>n;){if(i-n>600){var s=i-n+1,u=o-n+1,p=Math.log(s),l=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*l*(s-l)/s)*(u-s/2<0?-1:1);e(r,o,Math.max(n,Math.floor(o-u*l/s+c)),Math.min(i,Math.floor(o+(s-u)*l/s+c)),a);}var h=r[o],f=n,d=i;for(t(r,n,o),a(r[i],h)>0&&t(r,n,i);f<d;){for(t(r,f,d),f++,d--;a(r[f],h)<0;)f++;for(;a(r[d],h)>0;)d--;}0===a(r[n],h)?t(r,n,d):t(r,++d,i),d<=o&&(n=d+1),o<=d&&(i=d-1);}}(e,o,n||0,i||e.length-1,a||r);}function t(e,t,r){var o=e[t];e[t]=e[r],e[r]=o;}function r(e,t){return e<t?-1:e>t?1:0}var o=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear();};function n(e,t,r){if(!r)return t.indexOf(e);for(var o=0;o<t.length;o++)if(r(e,t[o]))return o;return -1}function i(e,t){a(e,0,e.children.length,t,e);}function a(e,t,r,o,n){n||(n=d(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var i=t;i<r;i++){var a=e.children[i];s(n,e.leaf?o(a):a);}return n}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function u(e,t){return e.minX-t.minX}function p(e,t){return e.minY-t.minY}function l(e){return (e.maxX-e.minX)*(e.maxY-e.minY)}function c(e){return e.maxX-e.minX+(e.maxY-e.minY)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function f(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function d(e){return {children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,r,o,n,i){for(var a=[r,o];a.length;)if(!((o=a.pop())-(r=a.pop())<=n)){var s=r+Math.ceil((o-r)/n/2)*n;e(t,s,r,o,i),a.push(r,s,s,o);}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(e){var t=this.data,r=[];if(!f(e,t))return r;for(var o=this.toBBox,n=[];t;){for(var i=0;i<t.children.length;i++){var a=t.children[i],s=t.leaf?o(a):a;f(e,s)&&(t.leaf?r.push(a):h(e,s)?this._all(a,r):n.push(a));}t=n.pop();}return r},o.prototype.collides=function(e){var t=this.data;if(!f(e,t))return !1;for(var r=[];t;){for(var o=0;o<t.children.length;o++){var n=t.children[o],i=t.leaf?this.toBBox(n):n;if(f(e,i)){if(t.leaf||h(e,i))return !0;r.push(n);}}t=r.pop();}return !1},o.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else {if(this.data.height<r.height){var o=this.data;this.data=r,r=o;}this._insert(r,this.data.height-r.height-1,!0);}else this.data=r;return this},o.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},o.prototype.clear=function(){return this.data=d([]),this},o.prototype.remove=function(e,t){if(!e)return this;for(var r,o,i,a=this.data,s=this.toBBox(e),u=[],p=[];a||u.length;){if(a||(a=u.pop(),o=u[u.length-1],r=p.pop(),i=!0),a.leaf){var l=n(e,a.children,t);if(-1!==l)return a.children.splice(l,1),u.push(a),this._condense(u),this}i||a.leaf||!h(a,s)?o?(r++,a=o.children[r],i=!1):a=null:(u.push(a),p.push(r),r=0,o=a,a=a.children[0]);}return this},o.prototype.toBBox=function(e){return e},o.prototype.compareMinX=function(e,t){return e.minX-t.minX},o.prototype.compareMinY=function(e,t){return e.minY-t.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(e){return this.data=e,this},o.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},o.prototype._build=function(e,t,r,o){var n,a=r-t+1,s=this._maxEntries;if(a<=s)return i(n=d(e.slice(t,r+1)),this.toBBox),n;o||(o=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,o-1))),(n=d([])).leaf=!1,n.height=o;var u=Math.ceil(a/s),p=u*Math.ceil(Math.sqrt(s));y(e,t,r,p,this.compareMinX);for(var l=t;l<=r;l+=p){var c=Math.min(l+p-1,r);y(e,l,c,u,this.compareMinY);for(var h=l;h<=c;h+=u){var f=Math.min(h+u-1,c);n.children.push(this._build(e,h,f,o-1));}}return i(n,this.toBBox),n},o.prototype._chooseSubtree=function(e,t,r,o){for(;o.push(t),!t.leaf&&o.length-1!==r;){for(var n=1/0,i=1/0,a=void 0,s=0;s<t.children.length;s++){var u=t.children[s],p=l(u),c=(h=e,f=u,(Math.max(f.maxX,h.maxX)-Math.min(f.minX,h.minX))*(Math.max(f.maxY,h.maxY)-Math.min(f.minY,h.minY))-p);c<i?(i=c,n=p<n?p:n,a=u):c===i&&p<n&&(n=p,a=u);}t=a||t.children[0];}var h,f;return t},o.prototype._insert=function(e,t,r){var o=r?e:this.toBBox(e),n=[],i=this._chooseSubtree(o,this.data,t,n);for(i.children.push(e),s(i,o);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(o,n,t);},o.prototype._split=function(e,t){var r=e[t],o=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,o);var a=this._chooseSplitIndex(r,n,o),s=d(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,i(r,this.toBBox),i(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(r,s);},o.prototype._splitRoot=function(e,t){this.data=d([e,t]),this.data.height=e.height+1,this.data.leaf=!1,i(this.data,this.toBBox);},o.prototype._chooseSplitIndex=function(e,t,r){for(var o,n,i,s,u,p,c,h=1/0,f=1/0,d=t;d<=r-t;d++){var y=a(e,0,d,this.toBBox),v=a(e,d,r,this.toBBox),g=(n=y,i=v,s=void 0,u=void 0,p=void 0,c=void 0,s=Math.max(n.minX,i.minX),u=Math.max(n.minY,i.minY),p=Math.min(n.maxX,i.maxX),c=Math.min(n.maxY,i.maxY),Math.max(0,p-s)*Math.max(0,c-u)),m=l(y)+l(v);g<h?(h=g,o=d,f=m<f?m:f):g===h&&m<f&&(f=m,o=d);}return o||r-t},o.prototype._chooseSplitAxis=function(e,t,r){var o=e.leaf?this.compareMinX:u,n=e.leaf?this.compareMinY:p;this._allDistMargin(e,t,r,o)<this._allDistMargin(e,t,r,n)&&e.children.sort(o);},o.prototype._allDistMargin=function(e,t,r,o){e.children.sort(o);for(var n=this.toBBox,i=a(e,0,t,n),u=a(e,r-t,r,n),p=c(i)+c(u),l=t;l<r-t;l++){var h=e.children[l];s(i,e.leaf?n(h):h),p+=c(i);}for(var f=r-t-1;f>=t;f--){var d=e.children[f];s(u,e.leaf?n(d):d),p+=c(u);}return p},o.prototype._adjustParentBBoxes=function(e,t,r){for(var o=r;o>=0;o--)s(t[o],e);},o.prototype._condense=function(e){for(var t=e.length-1,r=void 0;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():i(e[t],this.toBBox);},o}();var se=function(e){function r(t){return e.call(this,t)||this}return t.__extends(r,e),r.prototype.toBBox=function(e){var t=e.bbox;return {minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},r.prototype.compareMinX=function(e,t){return e.bbox[0]-t.bbox[0]},r.prototype.compareMinY=function(e,t){return e.bbox[1]-t.bbox[1]},r}(ae.exports),ue=256,pe=null,le=function(){function e(e,t,r,o){var n=te(e);this.quadkey=e,this.z=n[0],this.y=n[1],this.x=n[2],this.type=t,this.bounds=oe(n[0],n[1],n[2]),this.expire=o,this.clipped=r;}return e.prototype.expired=function(e){return (e=e||Date.now())-this.loadStopTs>1e3*this.expire},e.prototype.add=function(e){var t=this.data;t&&-1==t.indexOf(e)&&(t.push(e),this.tree&&this.tree.insert(e));},e.prototype.remove=function(e){var t=this.data.indexOf(e);-1!==t&&(this.data.splice(t,1),this.tree&&this.tree.remove(e));},e.prototype.search=function(e){if(this.data)return this.tree||(this.tree=new se(9),this.tree.load(this.data)),this.tree.search(e)},e.prototype.isLoaded=function(){return \"number\"==typeof this.loadStopTs},e.prototype.getContentBounds=function(){if(!this.cbnds){var e=this.bounds,t=this.provider,r=t.margin;if(r){var o=t.size,n=o<<this.z,i=Z.lon2x(e[0],n),a=Z.lat2y(e[1],n);this.cbnds=[Z.x2lon(i-r,n),Z.y2lat(a+r,n),Z.x2lon(i+r+o,n),Z.y2lat(a-r-o,n)];}else this.cbnds=this.bounds;}return this.cbnds},e.prototype.project=function(e,t){var r=ue<<this.z,o=this.x*ue,n=this.y*ue;return [Math.round(Z.lon2x(e,r)-o),Math.round(Z.lat2y(t,r)-n)]},e.prototype.lon2x=function(e,t){void 0===t&&(t=ue);var r=t<<this.z,o=this.x*t;return Z.lon2x(e,r)-o},e.prototype.lat2y=function(e,t){void 0===t&&(t=ue);var r=t<<this.z,o=this.y*t;return Z.lat2y(e,r)-o},e.prototype.isInside=function(e){var t=this.bounds,r=e[0],o=e[1];return r>t[0]&&r<=t[2]&&o>t[1]&&o<=t[3]},e}(),ce=le.prototype;ce.expire=1/0,ce.error=pe,ce.canvasX=pe,ce.canvasY=pe;var he=function(e){function r(t,r,o,n){var i=e.call(this,t,r,o,n)||this;return i.s=1<<i.z,i}return t.__extends(r,e),r.prototype.lon2x=function(e,t){return void 0===t&&(t=256),(e*this.s-this.x)*t},r.prototype.lat2y=function(e,t){return void 0===t&&(t=256),(e*this.s-this.y)*t},r.prototype.isInside=function(e){var t=e[0]*this.s-this.x,r=e[1]*this.s-this.y;return !(t<0||t>1||r<0||r>1)},r}(le),fe=function(){function e(e,t,o){this.lvl=e,this.main=\"object\"==typeof t?t:new r.LRU(t||256),this.sub=\"object\"==typeof o?o:new r.LRU(t||1024);}return e.prototype.forEach=function(e){this.main.forEach(e),this.sub.forEach(e);},e.prototype.clear=function(){this.main.clear(),this.sub.clear();},e.prototype.getCache=function(e){return e==this.lvl?this.main:this.sub},e.prototype.remove=function(e){this.getCache(e.z).remove(e.quadkey);},e.prototype.get=function(e){return this.getCache(e.length).get(e)},e.prototype.set=function(e){var t=this.getCache(e.z).set(e.quadkey,e),r=this._onDrop;t&&r&&r(t);},e.prototype.onDrop=function(e){this._onDrop=e;},e}(),de=function(){function e(e){this.margin=0,this.Tile=le,this.size=256,this.expire=Infinity,this.clipped=!1;var t=this;for(var o in e=e||{})this[o]=e[o];null==this.id&&(this.id=\"TP-\"+(1e6*Math.random()^0)),t.storage=e.storage||new fe(t.level),t.initStorage(t.storage),this.listeners=new r.Listener([\"clear\",\"error\"]);}return e.prototype.dispatchEvent=function(e,t){t.provider=this;var r=new CustomEvent(e,{detail:t});this.listeners.trigger(e,r,!0);},e.prototype.initStorage=function(e){e.onDrop((function(e){return e.provider._removeTile(e)}));},e.prototype.addEventListener=function(e,t,r){return this.listeners.add(e,t,r)},e.prototype.removeEventListener=function(e,t,r){return this.listeners.remove(e,t,r)},e.prototype.clear=function(e){this.storage.clear();},e.prototype.getCachedTile=function(e){return this.storage.get(e)},e.prototype.setMargin=function(e){void 0===e&&(e=0),this.margin=Number(e),this.storage.forEach((function(e){return e.cbnds=null}));},e.prototype.getCachedTilesOfBBox=function(e,t){var r=e[0],o=e[1],n=e[2],i=e[3],a=[];return t^=0,this.storage.forEach((function(e){var s,u,p,l,c,h,f,d=e.getContentBounds();s=d[0],u=d[2],p=d[1],l=d[3],c=r,h=o,f=i,s<=n&&c<=u&&p<=f&&h<=l&&(!t||e.z==t)&&(a[a.length]=e);})),a},e.prototype.config=function(e){for(var t in e=e||{})this.config[t]=e[t];return this},e.prototype.createTile=function(e){var t=new this.Tile(e,this.dataType,this.clipped,this.expire);return t.provider=this,t},e}();de.prototype.__type=\"Provider\";var ye,ve=function(e,t){var r,o;t&&((r=e[0])<t[0]&&(t[0]=r),r>t[2]&&(t[2]=r),(o=e[1])<t[1]&&(t[1]=o),o>t[3]&&(t[3]=o));},ge=function(e,t){for(var r=e.length;r--;)ve(e[r],t);},me=function(e,t){var r=e.geometry.type,o=e.geometry.coordinates;if(\"Point\"==r)t?ve(o,t):t=[o[0],o[1],o[0],o[1]];else if(t=t||[1/0,1/0,-1/0,-1/0],\"MultiLineString\"==r)for(var n=0;n<o.length;n++)ge(o[n],t);else if(\"MultiPolygon\"==r)for(var i=0;i<o.length;i++)ge(o[i][0],t);else if(\"LineString\"==r||\"MultiPoint\"==r)ge(o,t);else {if(\"Polygon\"!=r)return !1;ge(o[0],t);}return t},xe={calcBBox:me},_e=\"featureRemove\",Le=\"featureAdd\",we=\"featureCoordinatesChange\";function Te(e){this.feature=e;}Te.prototype.cnt=0;var be=function(e){function o(t){var r=e.call(this,t)||this;return r.IDPOOL={},r.dataType=\"json\",r.ignore=!1,r.cnt=0,r.__type=\"FeatureProvider\",r.tree=new se(9),r.Feature=r.Feature||E,[Le,_e,we].forEach((function(e){return r.listeners.addEvent(e)})),r}return t.__extends(o,e),o.prototype.isDroppable=function(e){return !0},o.prototype.loadTileData=function(e,t,r){for(var o,n,i,a=this,s=[],u=t.length,p=0;p<u;p++)!1!==(o=a.prepareFeature(i=t[p]))?(i=o,(n=a._insert(i,e))?(i=n,s[s.length]=i):a.tree||(s[s.length]=a.getFeature(i.id))):(t.splice(p--,1),u--);t=s,a.tree&&a.tree.load(t),r(t=a.clipped?t:a.search(e.getContentBounds()));},o.prototype.addFeature=function(e){var t,r,o=this;if(\"object\"==typeof e){if(\"FeatureCollection\"==e.type&&(e=e.features||[]),Array.isArray(e)){for(var n=[],i=0,a=e.length;i<a;i++)n[i]=o.addFeature(e[i]);return n}if(o.isFeatureInstance(e,E)){var s=e.getProvider();s&&s!=o&&(e=e.toJSON());}if(!1!==(t=o.prepareFeature(e))){if((r=o._insert(t))!=ye){e=r;for(var u=o.getCachedTilesOfBBox(o.decBBox(e)),p=0,l=void 0;p<u.length;p++)(l=u[p]).add(e),l.z==o.level&&this._mark(e,l);o.tree&&o.tree.insert(e),o.ignore||o.dispatchEvent(Le,{feature:e,tiles:u});}}else e=null;return e}},o.prototype.addEventListener=function(t,r,o){return e.prototype.addEventListener.call(this,t,r,o)},o.prototype.removeEventListener=function(t,r,o){return e.prototype.removeEventListener.call(this,t,r,o)},o.prototype.all=function(){var e=this;return e.tree?e.tree.all():e._s({minX:-180,maxX:180,minY:-90,maxY:90})},o.prototype.getFeature=function(e){if(this.IDPOOL[e])return this.IDPOOL[e].feature},o.prototype.getFeatures=function(e){e instanceof Array||(e=[e]);for(var t=[],r=0;r<e.length;r++)t[r]=this.getFeature(e[r]);return 1==t.length?t[0]:t},o.prototype.getTile=function(e,t){var r=this,o=r.storage,n=o.get(e);return n===ye&&(o.set(n=r.createTile(e)),n.loadStartTs=n.loadStopTs=Date.now(),n.data=r.search(n.getContentBounds())),t&&t(n),n},o.prototype.setFilter=function(e){this.filter=\"function\"==typeof e?e:ye;},o.prototype.getFeatureClass=function(e){return this.Feature},o.prototype.isFeatureInstance=function(e,t){return e instanceof t},o.prototype.createFeature=function(e,t){return new t(e,this)},o.prototype.search=function(e,t){var o,n,i=this;if(\"object\"==typeof e)if(t)for(var a in e)t[a]=e[a];else t=e;var s=t&&t.radius||1;if(e instanceof Array)n=4==e.length?e:r.geotools.getPointBBox(e,s);else {if(\"number\"==typeof e||\"string\"==typeof e||!e)return i.getFeatures(e);if(e.longitude!=ye&&e.latitude!=ye)n=r.geotools.getPointBBox([e.longitude,e.latitude],s);else if(e.minLon!=ye&&e.minLat!=ye&&e.maxLon!=ye&&e.maxLat!=ye)n=[e.minLon,e.minLat,e.maxLon,e.maxLat];else {if(o=e.point||e.rect||e.viewport)return i.search(o,t);if(e.id||e.ids)return i.getFeatures(e.id||e.ids)}}return n={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]},i._s(n)},o.prototype.exists=function(e){return this.IDPOOL[e.id]},o.prototype.setFeatureCoordinates=function(e,t){var r=e;if(e=this.getFeature(e.id)){var o=e.getBBox(),n=e.geometry,i=n.coordinates;this.ignore=!0,this.removeFeature(e),n._xyz&&delete n._xyz,n.coordinates=this.encCoord(n.type,t),e.bbox=null,this.addFeature(e),this.ignore=!1,this.dispatchEvent(we,{feature:e,prevBBox:o,prevCoordinates:i,provider:this});}else r.geometry.coordinates=t,r.bbox=null,this.updateBBox(r);},o.prototype.removeFeature=function(e){if(e){if(\"FeatureCollection\"==e.type&&(e=e.features),Array.isArray(e)){for(var t=[],r=0,o=e.length;r<o;r++)t[r]=this.removeFeature(e[r]);return t}if(e=this.getFeature(e.id)){for(var n=this.getCachedTilesOfBBox(this.decBBox(e)),i=void 0,a=0;a<n.length;a++)(i=n[a]).isLoaded()&&i.remove(e);this.cnt--,delete this.IDPOOL[e.id],this.tree&&this.tree.remove(e),this.ignore||this.dispatchEvent(_e,{feature:e,tiles:n});}}return e},o.prototype.clear=function(e){var t,r=this,o=null;if(4==arguments.length&&(e=Array.prototype.slice.call(arguments)),e instanceof Array){o=r.getCachedTilesOfBBox(e,r.level);for(var n=0,i=void 0;n<o.length;n++)i=o[n],r._removeTile(i,!1),o[n]=i.quadkey;}else if(0==arguments.length){var a={},s=r.IDPOOL,u=0;for(var p in r.tree&&r.tree.clear(),s)t=r.getFeature(p),r.isDroppable(t)||(a[p]=new Te(t),u++,r.tree&&r.tree.insert(t));r.cnt=u,r.IDPOOL=a,de.prototype.clear.call(this,e);}r.dispatchEvent(\"clear\",{tiles:o});},o.prototype._insert=function(e,t){var r=e.id,o=null,n=this.getFeatureClass(e),i=this.filter;return i&&!i(e)||(this.IDPOOL[r]===ye&&(this.cnt++,this.isFeatureInstance(e,n)?e._provider=this:e=this.createFeature(e,n),this.updateBBox(e),this.IDPOOL[r]=new Te(e),o=e),t&&this._mark(e,t)),o},o.prototype._mark=function(e,t){var r=this.IDPOOL[e.id];r[t.quadkey]||(r.cnt++,r[t.quadkey]=!0);},o.prototype._removeTile=function(e,t){var r,o=e.quadkey;if(this.storage.remove(e),r=e.data)for(var n=0;n<r.length;n++)this._dropFeature(r[n],o,t);},o.prototype._dropFeature=function(e,t,r){var o=this,n=o.IDPOOL[e.id];n&&(n[t]&&(n[t]=ye,n.cnt--),o.isDroppable(e)&&(n.cnt||(o.cnt--,delete o.IDPOOL[e.id],o.tree&&o.tree.remove(e),r&&o.dispatchEvent(_e,{feature:e}))));},o.prototype._s=function(e){if(this.tree)return this.tree.search(e);var t,r,o=1e8*Math.random()^0,n=this.level;return this.storage.forEach((function(i){if(i.z==n&&i.isLoaded()&&(r=i.search(e)).length)if(t)for(var a=0,s=r;a<s.length;a++){(l=s[a])._m!=o&&(l._m=o,t[t.length]=l);}else for(var u=0,p=t=r;u<p.length;u++){var l;(l=p[u])._m=o;}})),t||[]},o.prototype.encCoord=function(e,t){return t},o.prototype.decCoord=function(e){return e.geometry.coordinates},o.prototype.decBBox=function(e){return e.bbox},o.prototype.prepareFeature=function(e){return e.id==ye&&(e.id=1e8*Math.random()^0),e.bbox?(6===e.bbox.length&&(e.bbox=[e.bbox[0],e.bbox[1],e.bbox[3],e.bbox[4]]),e):this.updateBBox(e)&&e},o.prototype.updateBBox=function(e){if(!e.bbox){var t=me(e);if(!t)return !1;e.bbox=t,e.geometry._c&&(e.geometry._c=null);}return !0},o}(de);be.prototype.modifyFeatureCoordinates=be.prototype.setFeatureCoordinates;var Pe=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.executing=0,this.parallel=16,this.q=[],this.lq={},this.src=e;}return e.prototype.exec=function(){for(var e=this,t=e.q;t.length&&e.executing<e.parallel;)e.fire(t.pop(),t.pop(),t.pop());},e.prototype.fire=function(e,t,r,o){var n=this,i=n.src,a=n.lq;o^=0;n.executing++,a[e.quadkey]=[e,t,r,o],i[o].load(e,(function(r,o){n.executing--,delete a[e.quadkey],n.exec(),t(r,o);}),(function(t,o){r(t,o),n.executing--,delete a[e.quadkey],n.exec();}));},e.prototype.tile=function(e,t,r){this.q.push(r,t,e),this.exec();},e.prototype.abort=function(e){var t,r,o=this,n=o.q,i=o.lq,a=o.src,s=!0;return -1!==(t=n.indexOf(e))?n.splice(t-2,3):(r=i[e.quadkey])?(o.executing--,delete i[e.quadkey],a[r[3]].abort(e)):s=!1,o.exec(),s},e.prototype.store=function(e,t){var r=this.src;for(var o in r)if(r[o].store){r[o].store(e,t);break}},e.prototype.clear=function(){this.src.forEach((function(e){e.clear&&e.clear();}));},e.prototype.setUrl=function(){var e=this.src;for(var t in e)e[t].setUrl&&e[t].setUrl.apply(e[t],arguments);},e}();Pe.prototype;var Me=function(){function e(e,t){this.c=0,this.cbs=[],this.qks=t,this.tile=e;}return e.prototype.receive=function(e){var t=this;if(!t.ready){var r=t.tile,o=t.qks,n=o.indexOf(e.quadkey);if(-1!=n&&(o[n]=null,++t.c==o.length)){t.ready=!0,r.processedData=undefined;var i=e.error;i?r.error=i:r.data=r.provider.search(r.getContentBounds()),r.loadStopTs=Date.now(),t.exec(),r.onLoaded.length=0,t.qks=null;}}},e.prototype.exec=function(){for(var e=this.cbs,t=e.length,r=this.tile,o=0;o<t;)e[o++](r,r.error);e.length=0;},e.prototype.add=function(e){var t=this.cbs;if(\"function\"==typeof e&&-1==t.indexOf(e))return t.push(e),!0},e.prototype.remove=function(e){var t=this.cbs,r=t.indexOf(e);return -1!=r&&t.splice(r,1),t.length},e}();Me.prototype.ready=!1;var Ee,Fe,Se=function(e){return \"function\"==typeof e},Be=function(e){return Se(e)},Re=function(e){return function(t,r,o){var n={data:t,provider:this,ready:r};o&&(n.tile={x:o.x,y:o.y,z:o.z}),function(e,t){void 0===t&&(t={});var r,o,n=t.ready;r=Be(e)?e(t):t.data,!(o=r)||\"object\"!=typeof o&&\"function\"!=typeof o||\"function\"!=typeof o.then?void 0!==r&&n(r):r.then(n);}(e,n);}},Oe=function(){function e(e){var t=e.loader;if(!t)throw new Error(\"no tile loader defined.\");t instanceof Pe||(t=new Pe(t)),this.loader=t,this.provider=e.provider;var r=e.preProcessor;this.preprocess=Re(r),\"function\"==typeof e.processTileResponse&&(this.processTileResponse=e.processTileResponse);}return e.prototype.cancel=function(e,t){var r,o=this.provider,n=o.storage,i=t==Ee;if(r=e instanceof o.Tile?e:n.get(e)){var a=r.onLoaded;a&&(i?a.length=0:a.splice(a.indexOf(t),1),a.length||this.loader.abort(r)&&n.remove(r));}},e.prototype.execTile=function(e){var t,r=e.onLoaded;if(r){for(var o=0,n=r.length;o<n;o++)(t=r[o])instanceof Me?t.receive(e):t(e);r.length=0;}},e.prototype.processTileResponse=function(e,t,r,o){r(t);},e.prototype.handleTileResponse=function(e,t,r,o){var n=this;e.loadStopTs=Date.now(),this.processTileResponse(e,t,(function(t){e.data=t,n.execTile(e),o&&o();}),r);},e.prototype.completeTile=function(e,t){this.handleTileResponse(e,t);},e.prototype.getTile=function(e,t){var r,o=this,n=this.provider,i=n.storage;if((r=i.get(e))==Ee)(r=n.createTile(e)).onLoaded=[],r.data=[],i.set(r);else if(r.isLoaded())return t&&t(r,r.error),r;return t&&-1==r.onLoaded.indexOf(t)&&r.onLoaded.push(t),r.loadStartTs||(r.loadStartTs=Date.now(),this.loader.tile(r,(function(e,t){o.preprocess(e,(function(e){return o.completeTile(r,e)}),r);}),(function(e,t){r.error=e,o.handleTileResponse(r,void 0,t,(function(){return n.listeners.trigger(\"error\",[e,r],!0)}));}))),r},e.prototype.drop=function(e){this.provider.storage.remove(e),e.isLoaded()||this.loader.abort(e);},e}(),ke=function(e){function r(t){var r=e.call(this,t)||this;return r.dep={},r.level=t.level,r}return t.__extends(r,e),r.prototype.cancel=function(e,t){var r,o,n=this.provider,i=n.storage,a=t==Fe;if(o=e instanceof n.Tile?e:i.get(e)){e=o.quadkey,r=ie.getTilesOfLevel(e,this.level);for(var s=0,u=void 0,p=void 0;s<r.length;s++)if(u=(p=r[s])==e?o:i.get(p)){var l=u.onLoaded,c=void 0;l&&(a?o.onLoaded.length=0:n.level&&o.z!=n.level?-1!=(c=l.indexOf(o.onLoaded[0]))&&(l[c].remove(t)||l.splice(c,1)):l.splice(l.indexOf(t),1),l.length||this.loader.abort(u)&&i.remove(u));}}},r.prototype.clear=function(){this.loader.clear(),this.dep={};},r.prototype.createTile=function(e){var t,r,o=this.provider.createTile(e),n=o.z,i=this.level;if(i&&n!=i&&(n>i?t=[e.substr(0,i)]:n<i&&(t=ie.getTilesOfLevel(e,i)),t))for(var a=0,s=t.length;a<s;a++){var u=t[a];(r=this.dep[u])||(r=this.dep[u]=[]),r[r.length]=o;}return o},r.prototype.getTile=function(e,t){var r,o=this,n=this.provider,i=n.storage,a=this.level;if((r=i.get(e))==Fe)(r=this.createTile(e)).onLoaded=[],r.data=[],i.set(r);else if(r.isLoaded())return t&&t(r,r.error),r;if(e.length!=a){var s=ie.getTilesOfLevel(e,a),u=void 0,p=void 0;r.loadStartTs=Date.now(),r.onLoaded.length?p=r.onLoaded[0]:(p=new Me(r,s),r.onLoaded.push(p)),p.add(t);for(var l=0;l<s.length;l++)(u=i.get(s[l]))==Fe?u=n.getTile(s[l],p):u.isLoaded()?p.receive(u):-1==u.onLoaded.indexOf(p)&&u.onLoaded.push(p);}else t&&-1==r.onLoaded.indexOf(t)&&r.onLoaded.push(t),r.loadStartTs||(r.loadStartTs=Date.now(),this.loader.tile(r,(function(e){o.preprocess(e,(function(e){return o.completeTile(r,e)}),r);}),(function(e,t){r.error=e,o.handleTileResponse(r,void 0,t,(function(){return n.listeners.trigger(\"error\",[e,r],!0)}));})));return r},r.prototype.drop=function(t){var r,o=t.quadkey,n=this.provider.storage;if(r=this.dep[o]){for(var i=0;i<r.length;i++)n.remove(r[i]);delete this.dep[o];}e.prototype.drop.call(this,t);},r}(Oe),Ce=function(e){function r(r){var o=e.call(this,t.__assign({minLevel:8,maxLevel:20,staticData:!1},r))||this;o.sizeKB=0;var n=o,i=r.loader;if(!i)throw new Error(\"no tile loader defined.\");i instanceof Pe||(i=new Pe(i));var a=r.preProcessor;return o.remoteTileLoader=new ke({provider:n,loader:i,level:n.level,preProcessor:a,processTileResponse:function(e,t,r){if(e.error)return r(e.data);o.loadTileData(e,t,r);}}),o}return t.__extends(r,e),r.prototype.cancel=function(e,t){this.remoteTileLoader.cancel(e,t);},r.prototype.getLoader=function(){return this.remoteTileLoader.loader},r.prototype.config=function(t){return e.prototype.config.call(this,t)},r.prototype.clear=function(t){0==arguments.length&&this.remoteTileLoader.clear(),e.prototype.clear.apply(this,arguments);},r.prototype.getTile=function(e,t){return this.remoteTileLoader.getTile(e,t)},r.prototype._removeTile=function(t,r){this.remoteTileLoader.drop(t),e.prototype._removeTile.call(this,t,r);},r}(be),Ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.getMvtLayer=function(){return this.geometry.__xyz.l},r}(E),ze=function(e){function o(t){var o=e.call(this,r.JSUtils.extend({loader:t.loader||new M(t),margin:0,Tile:he,Feature:Ue,preProcessor:Y},t))||this;return o.c=null,o.clipped=!0,o.tree=null,o}return t.__extends(o,e),o.prototype.decCoord=function(e){return e.geometry._coordinates()},o.prototype.getCopyright=function(e){var t=this,o=t.url;\"function\"==typeof o&&(o=o(0,0,0,\"\"));var n=(null==o?void 0:o.match)&&o.match(/.*xyz+.*here\\.com\\/tiles\\/[a-zA-Z]+[\\.\\d]*\\//),i=t.c;e&&(null==i?n?((i=new r.Queue).add(e),t.c=i,t.getLoader().src[0].send({url:n+\"copyright\",responseType:\"json\",success:function(e){t.c=e,i.done(e);}})):e(t.c=[]):i instanceof r.Queue?i.add(e):e(i));},o}(Ce),Ie={backgroundColor:\"#555555\",strokeWidthZoomScale:function(e){return e>17?1:e>14?.5:.25},styleGroups:{earth:[{zIndex:1,type:\"Polygon\",fill:\"#555555\"}],landuse:[{zIndex:2,type:\"Polygon\",fill:\"#666666\"}],water:[{zIndex:3,type:\"Polygon\",fill:\"#353535\"}],roads:[{zIndex:4,type:\"Line\",stroke:\"#ffffff\",strokeWidth:4}],highway:[{zIndex:5,type:\"Line\",stroke:\"#ffffff\",strokeWidth:6}],buildings:[{zIndex:6,type:\"Polygon\",fill:\"#999999\"}]},assign:function(e,t){var r=e.properties,o=r.kind,n=r.layer,i=e.geometry.type;if(\"water\"!=n||\"LineString\"!=i&&\"MultiLineString\"!=i){if(\"roads\"==n){if(\"rail\"==o||\"ferry\"==o)return;if(\"highway\"==o)return o}return n}}},De=function(e){function o(o){var n=o.remote,i=n.url,a=n.min||1,s=n.max||16,u=o.tileSize||n.tileSize,p=o.name||\"\",l=o.max||32,c=new M(n),h=[];if(!u){var f=\"string\"==typeof i&&i.match(/256|512|1024|2048|4096/);u=f?Number(f[0]):512;}for(var d=new r.LRU(256/Math.pow(2,0)),y=new r.LRU(4*d.max),v=a;v<=s;v++)h.push({min:v,max:v==s?l:v,provider:new ze({name:p+\"-L\"+v,url:i,level:v-0,loader:c,size:u,storage:new fe(v-0,d,y)})});return e.call(this,t.__assign(t.__assign({min:a,max:l,style:Ie,margin:0,pointerEvents:!1},o),{tileSize:u,providers:h}))||this}return t.__extends(o,e),o.prototype.getProvider=function(e){var t=Math.floor(e)-this.levelOffset;return this._p[t]},o.prototype.getCopyright=function(e){this.getProvider(this.max).getCopyright(e);},o}(b),Ye=function(e){function r(t){var r=e.call(this,t||{})||this;r.custom=!0,r.style={},r.tiled=!1;var o=r,n=o.onLayerAdd,i=o.onLayerRemove;return n&&o.addEventListener(\"layerAdd\",o.onLayerAdd=function(e){o.init(),n.call(o,e);}),i&&o.addEventListener(\"layerRemove\",o.onLayerRemove=i.bind(o)),r}return t.__extends(r,e),r.prototype.init=function(){var e=this.renderOptions||(this.renderOptions={}),t=e.mode||(e.mode=\"2d\");this.flat=\"2d\"==t;},r.prototype.onLayerAdd=function(e){},r.prototype.onLayerRemove=function(e){},r.prototype.render=function(e,t){},r.prototype.pointerEvents=function(e){return !1},r.prototype.getCopyright=function(){},r.prototype.getStyle=function(){return this.style},r}(v);function Xe(e,t,r){var o=new XMLHttpRequest;return o.onload=function(){t(JSON.parse(this.responseText));},o.onreadystatechange=function(){var e=this.status;4==this.readyState&&(e<200||e>=300)&&0!==e&&r&&r(this);},o.open(\"GET\",e,!0),o.send(),o}var qe=function(){function e(e){var t=\".json\";(e=e||{}).host=e.host||\"geocoder.api.here.com\",e.version=e.version||\"6.2\",this.url=\"https://\"+e.host+\"/\"+e.version+\"/geocode\"+t,this.reverseUrl=\"https://reverse.\"+e.host+\"/\"+e.version+\"/reversegeocode\"+t,this.cfg=e;}return e.prototype.createUrl=function(e,t){var r=\"\";for(var o in t=t||{})r+=\"&\"+o+\"=\"+encodeURIComponent(t[o]);return this.reverseUrl+\"?app_id=\"+this.cfg.app_id+\"&app_code=\"+this.cfg.app_code+r},e.prototype.geocode=function(e,t,r){Xe(this.createUrl(this.url,e),t,r);},e.prototype.reverseGeocode=function(e,t,r){Xe(this.createUrl(this.reverseUrl,e),t,r);},e.prototype.getIsoCountryCode=function(e,t,r){var o={mode:\"retrieveAddresses\",maxresults:1,jsonattributes:1};o.prox=e instanceof Array?e[1]+\",\"+e[0]:e.latitude+\",\"+e.longitude,this.reverseGeocode(o,(function(e){var r=null;try{r=e.response.view[0].result[0].location.address.country;}catch(e){}t&&t(r,e);}),r);},e}(),Ae=function(){function e(e){this.cache=new r.LRU(e||256);}return e.prototype.forEach=function(e){this.cache.forEach(e);},e.prototype.clear=function(){this.cache.clear();},e.prototype.remove=function(e){this.cache.remove(e.quadkey);},e.prototype.get=function(e){return this.cache.get(e)},e.prototype.set=function(e){var t=this.cache.set(e.quadkey,e),r=this._onDrop;t&&r&&r(t);},e.prototype.onDrop=function(e){this._onDrop=e;},e}(),je=function(e){function r(r){var o=e.call(this,t.__assign({storage:new Ae(512)},r))||this;if(o.name=\"\",o.opacity=1,o.dataType=\"image\",\"string\"==typeof r.errorImage){var n=new Image;n.src=r.errorImage,o.errorImage=n;}return o.tileLoader=new Oe({provider:o,loader:new Pe(new t.HTTPLoader({url:r.url,headers:{Accept:\"*/*\"}})),preProcessor:r.preProcessor,processTileResponse:function(e,r,n,i){if(e.error)if(o.errorImage)r=o.errorImage;else if(404==e.error.statusCode){var a=i.response;if(a instanceof Blob&&a.type.startsWith(\"image\"))return t.HTTPLoader.createImageFromBlob(a,(function(e){n(e);}))}n(r);}}),o}return t.__extends(r,e),r.prototype.getTile=function(e,t){return this.tileLoader.getTile(e,t)},r.prototype._removeTile=function(e){this.tileLoader.drop(e);},r.prototype.clear=function(e){var t=this,r=null;if(e instanceof Array){r=t.getCachedTilesOfBBox(e,t.level);for(var o=0,n=void 0;o<r.length;o++)n=r[o],this.tileLoader.drop(n),r[o]=n.quadkey;}else 0==arguments.length&&this.storage.clear();t.dispatchEvent(\"clear\",{tiles:r});},r.prototype.cancel=function(e){return this.tileLoader.cancel(e)},r}(de);je.prototype.__type=\"ImageProvider\";var Ge,He=function(e){function o(r){var o=e.call(this,t.__assign({editable:!0,enforceRandomFeatureId:!0},r))||this;return o.blocked={},o}return t.__extends(o,e),o.prototype.detectFeatureClass=function(e){switch(e.geometry.type){case\"Point\":return \"MARKER\";case\"LineString\":return \"LINE\";case\"Polygon\":case\"MultiPolygon\":return \"AREA\"}},o.prototype.getFeatureProperties=function(e){return e.properties},o.prototype.readRoutingPoint=function(e){return {link:this.readRoutingLink(e),position:this.readRoutingPosition(e)}},o.prototype.blockFeature=function(e,t){var r=e.id||e,o=typeof r;\"string\"!=o&&\"number\"!=o||(t?this.blocked[r]=!0:delete this.blocked[r]);},o.prototype._insert=function(t,r){return this.blocked[t.id]?null:e.prototype._insert.call(this,t,r)},o.prototype.reserveId=function(e,t){setTimeout((function(){return t(e.map((function(e){return e.id})))}),0);},o.prototype.isoCC=function(e,t){return !0},o.prototype.prepareFeature=function(e){return e.properties||(e.properties={}),null==e.id&&(e.id=r.JSUtils.String.random()),e},o}(be),Je=\"Method not implemented.\",Ne=function(e){function r(t,r){var o=e.call(this,t)||this;return o.name=\"FeatureError\",o.feature=r,o}return t.__extends(r,e),r}(Error),Ve=function(e){function o(r){var o=e.call(this,t.__assign({minLevel:8,maxLevel:20,staticData:!1},r))||this;o.sizeKB=0,o._clearOnCommit=!0;var n=o,i=r.loader;if(!i)throw new Error(\"no tile loader defined.\");i instanceof Pe||(i=new Pe(i));var a,s=r.preProcessor;return n.preprocess=Re(s||r.preprocessor),n.postprocess=Re(r.postProcessor),o.remoteTileLoader=new ke({provider:n,loader:i,level:n.level,preProcessor:s,processTileResponse:function(e,t,r){if(e.error)return r(e.data);o.loadTileData(e,t,r);}}),n.commit&&(n.commit=(a=n.commit,function(e,t,r){var o,i=this,s=this.postProcessor,u=function(e){Array.isArray(e)||(e=[e]);for(var t,r=e.length;r--;)(t=(e[r]=E.prototype.toJSON.call(e[r])).properties)&&delete t[\"@ns:com:here:editor\"];return e};return \"object\"==typeof e&&(e.put=u(e.put||[]),e.remove=u(e.remove||[]),Se(s))?(n.postprocess(e,(function(e){o=a.call(i,e,t,r);})),o):a.call(this,e,t,r)})),o}return t.__extends(o,e),o.prototype.getFeatures=function(t,r){var o=this;r=r||{},t instanceof Array||(\"object\"==typeof t&&(t.remote&&(r.remote=t.remote),t.onload&&(r.onload=t.onload),t=t.ids||t.id),t=[].concat(t));var n=this,i=!0,a=r.onload,s=r.remote;(l=e.prototype.getFeatures.call(this,t))instanceof Array||(l=[l]);for(var u=0;u<l.length;u++)l[u]||(l[u]=t[u],i=!1);function p(){return 1==(l=l.map((function(e){return \"object\"==typeof e?e:Ge}))).length?l[0]:l}if(i||!s){var l=p();return a&&a(l),l}t=l.filter((function(e){return \"object\"!=typeof e}));var c=function(e){var t=r.onerror;t&&t(e);};n._requestFeatures(t,(function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],s=i.geometry;if(!s||!s.type||!s.coordinates)return void c(new Ne(\"Invalid geometry\",i))}o.preprocess(e,(function(e){for(var t=0,r=e;t<r.length;t++){var o=r[t];l[l.indexOf(o.id)]=n.addFeature(o);}a&&a(p());}));}),c,r);},o.prototype.cancel=function(e,t){this.remoteTileLoader.cancel(e,t);},o.prototype.search=function(e,t){var o,n,i=this;if(\"object\"==typeof e)if(t)for(var a in e)t[a]=e[a];else t=e;var s=(t=t||{}).onload,u=t.radius,p=t.remote,l=t.onerror;if(u==Ge&&(u=1),e instanceof Array)n=4==e.length?e:r.geotools.getPointBBox(e,u);else {if(\"number\"==typeof e||\"string\"==typeof e||!e)return i.getFeatures(e,t);if(e.longitude!=Ge&&e.latitude!=Ge)n=r.geotools.getPointBBox([e.longitude,e.latitude],u);else if(e.minLon!=Ge&&e.minLat!=Ge&&e.maxLon!=Ge&&e.maxLat!=Ge)n=[e.minLon,e.minLat,e.maxLon,e.maxLat];else {if(o=e.point||e.rect||e.viewport)return i.search(o,t);if(e.id||e.ids)return i.getFeatures(e.id||e.ids,t)}}if(n={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]},p){for(var c,h=ie.getTilesInRect(n.minX,n.minY,n.maxX,n.maxY,i.level),f=function(e){h.splice(h.indexOf(e.quadkey),1),c=c||e.error,h.length||(c?l(c):s&&s(i._s(n)));},d=0;d<h.length;d++){var y=h[d],v=i.getCachedTile(y);if(v&&v.isLoaded()){if(v.error)return void(l&&l(v.error));h.splice(d--,1);}else i.getTile(y,f);}if(h.length)return}var g=i._s(n);return s&&s(g),g},o.prototype.getLoader=function(){return this.remoteTileLoader.loader},o.prototype.config=function(t){return e.prototype.config.call(this,t)},o.prototype.clear=function(t){0==arguments.length&&this.remoteTileLoader.clear(),e.prototype.clear.apply(this,arguments);},o.prototype.getTile=function(e,t){return this.remoteTileLoader.getTile(e,t)},o.prototype._removeTile=function(t,r){this.remoteTileLoader.drop(t),e.prototype._removeTile.call(this,t,r);},o.prototype.readDirection=function(e){throw new Error(Je)},o.prototype.readPedestrianOnly=function(e){throw new Error(Je)},o.prototype.writeTurnRestriction=function(e,t,r){throw new Error(Je)},o.prototype.readRoutingProvider=function(e,t){return this.id},o.prototype.readRoutingPosition=function(e){throw new Error(Je)},o.prototype.readRoutingLink=function(e){throw new Error(Je)},o.prototype.writeRoutingPosition=function(e,t){throw new Error(Je)},o.prototype.writeRoutingLink=function(e,t){throw new Error(Je)},o.prototype.readTurnRestriction=function(e,t){throw new Error(Je)},o.prototype.writeRoutingPoint=function(e,t,r){this.writeRoutingLink(e,t),this.writeRoutingPosition(e,r);},o.prototype.writeEditState=function(e,t){},o.prototype.readFeatureHeight=function(e){return null},o.prototype.writeFeatureHeight=function(e,t){throw new Error(Je)},o.prototype.reserveId=function(e,t){for(var o,n=e.length,i=[];n--;)\"string\"==typeof(o=e[n].id)&&o.length>15?i.push(e[n].id):i.push(r.JSUtils.String.random(16));setTimeout((function(){t(i.reverse());}),0);},o.prototype.isDroppable=function(e){var t=e.editState&&e.editState();return !t||!t.modified&&!t.removed&&!t.split},o}(He),Ze=\"Method not implemented.\",We=function(e){function o(r){var o=this,n=r.loader;return n?n instanceof Pe||(n=new Pe(n)):n=new Pe(new t.HTTPLoader({url:r.url,withCredentials:r.withCredentials,headers:r.headers})),r.loader=n,(o=e.call(this,r)||this).setParams(r.params||{}),o.setHeaders(r.headers||{}),o}return t.__extends(o,e),o.prototype._httpLoader=function(){var e=this.remoteTileLoader.loader.src;return e[e.length-1]},o.prototype.getHeader=function(e){return this._httpLoader().headers[e]||null},o.prototype.getHeaders=function(){return r.JSUtils.clone(this._httpLoader().headers)},o.prototype.setHeader=function(e,t){var r=this.getHeaders();r[e]=t,this._httpLoader().headers=r,this.headers=r;},o.prototype.setHeaders=function(e){var t=this.getHeaders();r.JSUtils.extend(t,e),this._httpLoader().headers=t,this.headers=t;},o.prototype.getParams=function(){return this.params},o.prototype.getParam=function(e){return this.params[e]||null},o.prototype.setParams=function(e){var t=this._httpLoader(),o=t.baseUrl,n=this.params||{};if(r.JSUtils.extend(n,e),this.params=n,\"string\"==typeof o){n=r.JSUtils.extend(function(e,t){return t=t||{},e.split(/\\?|\\&/).slice(1).map((function(e){e=e.split(/\\=/),t[e[0]]=e[1];})),t}(o),n);var i=o.split(/\\?/)[0],a=\"?\";for(var s in n){var u=n[s];void 0===u?delete n[s]:(i+=a+s+\"=\"+u,a=\"&\");}t.setUrl(i);}},o.prototype.setParam=function(e,t){var r={};r[e]=t,this.setParams(r);},o.prototype.config=function(t){return e.prototype.config.call(this,t),t&&t.url&&this.setParams({}),this},o.prototype.commit=function(e,t,r,o){throw new Error(Ze)},o.prototype._requestFeatures=function(e,t,r,o){throw new Error(Ze)},o.prototype.readZLevels=function(e){throw new Error(Ze)},o.prototype.writeZLevels=function(e,t){throw new Error(Ze)},o}(Ve);We.prototype.getFeatureUrl=We.prototype.getLayerUrl=We.prototype.getTileUrl=function(){throw new Error(Ze)};var Ke=\"Method not implemented.\",Qe=function(e){function o(t){return t.level=t.level||13,t.headers=r.JSUtils.extend({Accept:\"application/geo+json\"},t.headers||{}),e.call(this,t)||this}return t.__extends(o,e),o.prototype.getFeatureUrl=function(e,t){throw new Error(Ke)},o.prototype.getLayerUrl=function(e){throw new Error(Ke)},o.prototype.getTileUrl=function(e){throw new Error(Ke)},o}(We),$e=\"Method not implemented.\",et=function(e){function r(r){var o=e.call(this,t.__assign({minLevel:8,maxLevel:20,storage:new Ae(512),editable:!1,size:512},r))||this;return o._clearOnCommit=!1,delete o.level,o.editable||(o.Feature=E,o.detectFeatureClass=function(){return null}),o}return t.__extends(r,e),r.prototype.cancel=function(e){},r.prototype.delete=function(e){this.tree.remove(e);},r.prototype.import=function(e){var t=this;t.tree.fromJSON(e);for(var r=(e=t.tree.all()).length;r--;)t._insert(e[r]);},r.prototype.initStorage=function(e){},r.prototype.commit=function(e,t,r){return \"function\"==typeof t&&setTimeout((function(){return t({})}),0),!0},r.prototype.readDirection=function(e){throw new Error($e)},r.prototype.readPedestrianOnly=function(e){throw new Error($e)},r.prototype.writeTurnRestriction=function(e,t,r){throw new Error($e)},r.prototype.readRoutingProvider=function(e,t){return this.id},r.prototype.readRoutingPosition=function(e){throw new Error($e)},r.prototype.readRoutingLink=function(e){throw new Error($e)},r.prototype.writeRoutingPosition=function(e,t){throw new Error($e)},r.prototype.writeRoutingLink=function(e,t){throw new Error($e)},r.prototype.readTurnRestriction=function(e,t){throw new Error($e)},r.prototype.writeRoutingPoint=function(e,t,r){this.writeRoutingLink(e,t),this.writeRoutingPosition(e,r);},r.prototype.readZLevels=function(e){throw new Error(\"Method not implemented.\")},r.prototype.writeZLevels=function(e,t){throw new Error(\"Method not implemented.\")},r.prototype.writeEditState=function(e,t){},r.prototype.readFeatureHeight=function(e){return null},r.prototype.writeFeatureHeight=function(e,t){throw new Error($e)},r}(He),tt={environment:\"prd\",space:\"\",credentials:{access_token:\"\"},withCredentials:!1,tags:!1,https:!0,clip:!1,url:null,headers:null,propertySearch:null,editable:!0,level:0},rt=\"@ns:com:here:xyz\",ot=\"http://\",nt={prd:ot+\"xyz.api.here.com/hub/spaces\"},it=function(e,t){return (e=r.JSUtils.extend(r.JSUtils.clone(tt),e)).params=r.JSUtils.extend(e.params||{},e.credentials),delete e.credentials,Be(t)&&(e.preProcessor=t),e.url||(e.url=nt[e.environment]),e.https&&(e.url=e.url.replace(ot,\"https://\")),e},at=function(e){function o(t){var r=e.call(this,it(t,arguments[1]))||this;return r.definition=null,r.setUrl(r.getTileUrl(r.space)),t.propertySearch&&r.setPropertySearch(t.propertySearch),r}return t.__extends(o,e),o.prototype.getHttpLoader=function(){var e=this.getLoader().src;return e[e.length-1]},o.prototype.config=function(t){var r=null==t?void 0:t.credentials;return r&&(delete t.credentials,this.setParams(r)),e.prototype.config.call(this,t)},o.prototype.commit=function(e,t,r){var o=this.getHttpLoader(),n=0,i=function(e){!--n&&t&&t(e);},a=function(e){r&&r(e);};if(\"object\"==typeof e){var s=e.put||[],u=e.remove||[];s.length&&(n++,o.send(this.createUpdateFeatureRequest(s,{success:i,error:a}))),u.length&&(n++,o.send(this.createRemoveFeatureRequest(u,{success:i,error:a})));}},o.prototype.getLayerUrl=function(e){return this.url+\"/\"+e},o.prototype.getTileUrl=function(e){return this._addUrlFilters(this.getLayerUrl(e)+\"/tile/quadkey/{QUADKEY}?margin=\"+this.margin+\"&clip=\"+!!this.clip)},o.prototype.getFeatureUrl=function(e,t){return t instanceof Array||(t=[t]),this.getLayerUrl(e)+\"/features?id=\"+t.join(\"&id=\")},o.prototype.createUpdateFeatureRequest=function(e,r){void 0===r&&(r={});var o=this,n=o._addUrlCredentials(o.getLayerUrl(o.space)+\"/features\",\"?\");return t.__assign({type:\"POST\",url:n,headers:t.__assign(t.__assign({},o.headers),{\"Content-Type\":\"application/geo+json\"}),data:JSON.stringify({type:\"FeatureCollection\",features:e})},r)},o.prototype.createRemoveFeatureRequest=function(e,r){void 0===r&&(r={});var o=this,n=o._addUrlCredentials(o.getLayerUrl(o.space)+\"/features\",\"?\");return t.__assign({type:\"DELETE\",url:n+\"&id=\"+e.map((function(e){return e.id})).join(\",\"),headers:t.__assign(t.__assign({},o.headers),{Accept:\"application/json\"})},r)},o.prototype.prepareFeature=function(t){var r=(t=e.prototype.prepareFeature.call(this,t)).properties;return r[rt]||(r[rt]={}),t},o.prototype.setMargin=function(e){Qe.prototype.setMargin.call(this,e),this.setUrl(this.getTileUrl(this.space));},o.prototype.setUrl=function(e){this._httpLoader().setUrl(this._addUrlCredentials(e));},o.prototype.setTags=function(e){\"string\"==typeof e&&(e=[e]),this.tags=e,this.setUrl(this.getTileUrl(this.space)),this.clear();},o.prototype.setPropertySearch=function(e,t,o){var n,i=\"\";for(var a in \"string\"==typeof e?(n={})[e]={operator:t,value:o}:n=e,n){var s=n[a];t=s.operator.replace(\">=\",\"=gte=\").replace(\"<=\",\"=lte=\").replace(\">\",\"=gt=\").replace(\"<\",\"=lt=\"),(o=null==s.values?s.value:s.values)instanceof Array||(o=[o]),o=o.map((function(e){return \"string\"==typeof e&&(r.JSUtils.isNumeric(e)||\"true\"==e||\"false\"==e||\"null\"==e)&&(e='\"'+e+'\"'),encodeURIComponent(e)}));var u=a.slice(0,2);\"f.\"!=u&&\"p.\"!=u&&(a=\"p.\"+a),i+=a+t+o+\"&\";}this.psf=i.slice(0,-1),this.setUrl(this.getTileUrl(this.space)),this.clear();},o.prototype.getCopyright=function(e,t){this.getDefinition((function(t){e&&e(t.copyright||[]);}),t);},o.prototype.getDefinition=function(e,o){var n=this,i=n.getHttpLoader(),a=n.definition;if(null==a){var s=new r.Queue;a=this.definition=s,i.send({url:n._addUrlCredentials(n.getLayerUrl(n.space),\"?\"),id:\"def\",success:function(e){n.definition=e,s.done(e);},error:function(e){n.definition=[],o&&o(e);},headers:t.__assign(t.__assign({},this.headers),{Accept:\"application/json\"})});}e&&(a instanceof r.Queue?a.add(e):e(a));},o.prototype._requestFeatures=function(e,t,r,o){this.getHttpLoader().send({id:e.join(\"&\"),url:this._addUrlCredentials(this.getFeatureUrl(this.space,e)),success:function(e){t(e.features);},headers:this.headers,error:r});},o.prototype._addUrlCredentials=function(e,t){return e=function(e,t,r){for(var o in t)e+=r+o+\"=\"+t[o],r=\"&\";return e}(e,this.params,t||\"&\"),e},o.prototype._addUrlFilters=function(e){var t=this.tags,r=this.psf;return t&&t.length&&(e+=\"&tags=\"+t.join(\",\")),r&&(e+=\"&\"+r),e},o}(Qe),st=function(e){function r(r){var o,n=this;return n=e.call(this,function(e){var r=t.__assign(t.__assign({url:\"http://interactive.data.api.platform.here.com/interactive/v1\",https:!0,space:e.layer},e),{credentials:t.__assign({},e.credentials)});return delete r.credentials.token,r}(r))||this,n.definition=[],n.token=null===(o=r.credentials)||void 0===o?void 0:o.token,n}return t.__extends(r,e),r.prototype.addRequestToken=function(e){return (e.headers=e.headers||{}).Authorization=\"Bearer \"+this.token,e},r.prototype.createUpdateFeatureRequest=function(t,r){return void 0===r&&(r={}),this.addRequestToken(e.prototype.createUpdateFeatureRequest.call(this,t,r))},r.prototype.createRemoveFeatureRequest=function(t,r){return void 0===r&&(r={}),this.addRequestToken(e.prototype.createRemoveFeatureRequest.call(this,t,r))},r.prototype.getLayerUrl=function(e){return this.url+\"/catalogs/\"+this.catalog+\"/layers/\"+e},r.prototype.config=function(t){var r,o=null===(r=null==t?void 0:t.credentials)||void 0===r?void 0:r.token;return o&&(this.token=o,delete t.credentials.token),e.prototype.config.call(this,t)},r}(at),ut=Z,pt=t.__assign({name:\"xyz-maps\"},{version:\"0.32.0\",revision:\"f28fa04\",date:\"2022-10-14T17:30:53Z\"}),lt=n.global.here.xyz.maps;lt.common=n;var ct=lt.geo={Point:s,Rect:u},ht=lt.pixel={Point:i,Rect:a},ft=lt.layers={TileLayer:b,MVTLayer:De,CustomLayer:Ye},dt=lt.features={Feature:E},yt=lt.tile={Tile:le,Utils:ie};lt.build=pt;var vt=lt.providers={ImageProvider:je,GeoJSONProvider:Qe,FeatureProvider:be,LocalProvider:et,RemoteTileProvider:Ce,EditableRemoteTileProvider:Ve,SpaceProvider:at,IMLProvider:st,MVTProvider:ze,EditableFeatureProvider:He},gt=lt.projection={webMercator:ut},mt=lt.loaders={HTTPLoader:t.HTTPLoader,Manager:Pe},xt=lt.service||{Geocoder:qe},_t={tile:yt,layers:ft,geo:ct,pixel:ht,features:dt,providers:vt,projection:gt,loaders:mt,service:xt,build:pt,common:n};e.CustomLayer=Ye,e.DEFAULT_LAYER_MAX_ZOOM=32,e.DEFAULT_LAYER_MIN_ZOOM=15,e.EditableFeatureProvider=He,e.EditableRemoteTileProvider=Ve,e.Feature=E,e.FeatureProvider=be,e.GeoCoder=qe,e.GeoJSONProvider=Qe,e.GeoPoint=s,e.GeoRect=u,e.HTTPProvider=We,e.IMLProvider=st,e.ImageProvider=je,e.Layer=v,e.LocalProvider=et,e.MVTLayer=De,e.MVTProvider=ze,e.PixelPoint=i,e.PixelRect=a,e.RemoteTileProvider=Ce,e.SpaceProvider=at,e.Tile=le,e.TileLayer=b,e.build=pt,e.default=_t,e.features=dt,e.layers=ft,e.loaders=mt,e.pixel=ht,e.projection=gt,e.providers=vt,e.service=xt,e.tile=yt,e.tileUtils=ie,e.utils=xe,e.webMercator=ut,Object.defineProperty(e,\"__esModule\",{value:!0});}));\n\n\tlet xyz = window;\n\t'here.xyz.maps'.split('.').forEach((ns) => xyz = (xyz[ns] = xyz[ns] || {}));\n\tvar xyz$1 = xyz;\n\n\treturn xyz$1;\n\n}));\n"},"lineCount":58}},"error":null,"hash":"9cd16846e058c7f0708f9db0596c2b11","cacheData":{"env":{}}}