{"id":"vIC4","dependencies":[{"name":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/lib/resolve-modules.js.map","includedInParent":true,"mtime":1688284132458},{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688495957541},{"name":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/package.json","includedInParent":true,"mtime":1688284132458},{"name":"./shader-module","loc":{"line":1,"column":25,"index":25},"parent":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/lib/resolve-modules.js","resolved":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/lib/shader-module.js"},{"name":"../utils","loc":{"line":2,"column":23,"index":67},"parent":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/lib/resolve-modules.js","resolved":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/utils/index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.TEST_EXPORTS=void 0,exports.resolveModules=d;var e=o(require(\"./shader-module\")),n=require(\"../utils\");function o(e){return e&&e.__esModule?e:{default:e}}function d(e){return t(s(e))}function t(e){const n={},o={};return r({modules:e,level:0,moduleMap:n,moduleDepth:o}),Object.keys(o).sort((e,n)=>o[n]-o[e]).map(e=>n[e])}function r(e){let{modules:n,level:o,moduleMap:d,moduleDepth:t}=e;if(o>=5)throw new Error(\"Possible loop in shader dependency graph\");for(const r of n)d[r.name]=r,(void 0===t[r.name]||t[r.name]<o)&&(t[r.name]=o);for(const s of n)s.dependencies&&r({modules:s.dependencies,level:o+1,moduleMap:d,moduleDepth:t})}function s(o,d){return o.map(o=>o instanceof e.default?o:((0,n.assert)(\"string\"!=typeof o,\"Shader module use by name is deprecated. Import shader module '\".concat(o,\"' and use it directly.\")),(0,n.assert)(o.name,\"shader module has no name\"),(o=new e.default(o)).dependencies=s(o.dependencies),o))}const u={getShaderDependencies:t,getDependencyGraph:r};exports.TEST_EXPORTS=u;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":0}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":13}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":20}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":35}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":43}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":56}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":57}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":64}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":68}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":76}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":94}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":96}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":104}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":119}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":121}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":125}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":127}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":129}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":137}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":157}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":159}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":167}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":179}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":188}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":190}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":193}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":200}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":203}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":205}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":216}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":218}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":219}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":227}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":5,"column":7},"generated":{"line":1,"column":230}},{"source":"../../../src/lib/resolve-modules.js","name":"resolveModules","original":{"line":5,"column":16},"generated":{"line":1,"column":239}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":5,"column":31},"generated":{"line":1,"column":241}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":6,"column":2},"generated":{"line":1,"column":244}},{"source":"../../../src/lib/resolve-modules.js","name":"getShaderDependencies","original":{"line":6,"column":9},"generated":{"line":1,"column":251}},{"source":"../../../src/lib/resolve-modules.js","name":"instantiateModules","original":{"line":6,"column":31},"generated":{"line":1,"column":253}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":6,"column":50},"generated":{"line":1,"column":255}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":21,"column":0},"generated":{"line":1,"column":259}},{"source":"../../../src/lib/resolve-modules.js","name":"getShaderDependencies","original":{"line":21,"column":9},"generated":{"line":1,"column":268}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":21,"column":31},"generated":{"line":1,"column":270}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":22,"column":2},"generated":{"line":1,"column":273}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":22,"column":8},"generated":{"line":1,"column":279}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":22,"column":20},"generated":{"line":1,"column":281}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":23,"column":8},"generated":{"line":1,"column":284}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":23,"column":22},"generated":{"line":1,"column":286}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":27,"column":2},"generated":{"line":1,"column":289}},{"source":"../../../src/lib/resolve-modules.js","name":"getDependencyGraph","original":{"line":24,"column":2},"generated":{"line":1,"column":296}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":24,"column":21},"generated":{"line":1,"column":298}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":24,"column":22},"generated":{"line":1,"column":299}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":24,"column":22},"generated":{"line":1,"column":307}},{"source":"../../../src/lib/resolve-modules.js","name":"level","original":{"line":24,"column":31},"generated":{"line":1,"column":309}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":24,"column":38},"generated":{"line":1,"column":315}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":24,"column":41},"generated":{"line":1,"column":317}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":24,"column":41},"generated":{"line":1,"column":327}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":24,"column":52},"generated":{"line":1,"column":329}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":24,"column":52},"generated":{"line":1,"column":341}},{"source":"../../../src/lib/resolve-modules.js","name":"Object","original":{"line":27,"column":9},"generated":{"line":1,"column":345}},{"source":"../../../src/lib/resolve-modules.js","name":"keys","original":{"line":27,"column":16},"generated":{"line":1,"column":352}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":27,"column":21},"generated":{"line":1,"column":357}},{"source":"../../../src/lib/resolve-modules.js","name":"sort","original":{"line":28,"column":5},"generated":{"line":1,"column":360}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":28,"column":10},"generated":{"line":1,"column":365}},{"source":"../../../src/lib/resolve-modules.js","name":"a","original":{"line":28,"column":11},"generated":{"line":1,"column":366}},{"source":"../../../src/lib/resolve-modules.js","name":"b","original":{"line":28,"column":14},"generated":{"line":1,"column":368}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":28,"column":20},"generated":{"line":1,"column":372}},{"source":"../../../src/lib/resolve-modules.js","name":"b","original":{"line":28,"column":32},"generated":{"line":1,"column":374}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":28,"column":37},"generated":{"line":1,"column":377}},{"source":"../../../src/lib/resolve-modules.js","name":"a","original":{"line":28,"column":49},"generated":{"line":1,"column":379}},{"source":"../../../src/lib/resolve-modules.js","name":"map","original":{"line":29,"column":5},"generated":{"line":1,"column":383}},{"source":"../../../src/lib/resolve-modules.js","name":"name","original":{"line":29,"column":9},"generated":{"line":1,"column":387}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":29,"column":17},"generated":{"line":1,"column":390}},{"source":"../../../src/lib/resolve-modules.js","name":"name","original":{"line":29,"column":27},"generated":{"line":1,"column":392}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":0},"generated":{"line":1,"column":396}},{"source":"../../../src/lib/resolve-modules.js","name":"getDependencyGraph","original":{"line":44,"column":9},"generated":{"line":1,"column":405}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":0},"generated":{"line":1,"column":407}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":70},"generated":{"line":1,"column":410}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":28},"generated":{"line":1,"column":414}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":44,"column":29},"generated":{"line":1,"column":422}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":28},"generated":{"line":1,"column":424}},{"source":"../../../src/lib/resolve-modules.js","name":"level","original":{"line":44,"column":38},"generated":{"line":1,"column":430}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":28},"generated":{"line":1,"column":432}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":44,"column":45},"generated":{"line":1,"column":442}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":28},"generated":{"line":1,"column":444}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":44,"column":56},"generated":{"line":1,"column":456}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":44,"column":70},"generated":{"line":1,"column":459}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":45,"column":2},"generated":{"line":1,"column":461}},{"source":"../../../src/lib/resolve-modules.js","name":"level","original":{"line":45,"column":6},"generated":{"line":1,"column":464}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":45,"column":15},"generated":{"line":1,"column":467}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":46,"column":4},"generated":{"line":1,"column":469}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":46,"column":10},"generated":{"line":1,"column":475}},{"source":"../../../src/lib/resolve-modules.js","name":"Error","original":{"line":46,"column":14},"generated":{"line":1,"column":479}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":46,"column":20},"generated":{"line":1,"column":485}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":50,"column":2},"generated":{"line":1,"column":529}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":50,"column":7},"generated":{"line":1,"column":533}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":50,"column":13},"generated":{"line":1,"column":539}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":50,"column":23},"generated":{"line":1,"column":544}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":51,"column":4},"generated":{"line":1,"column":546}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":51,"column":14},"generated":{"line":1,"column":548}},{"source":"../../../src/lib/resolve-modules.js","name":"name","original":{"line":51,"column":21},"generated":{"line":1,"column":550}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":51,"column":29},"generated":{"line":1,"column":556}},{"source":"../../../src/lib/resolve-modules.js","name":"undefined","original":{"line":52,"column":37},"generated":{"line":1,"column":564}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":52,"column":8},"generated":{"line":1,"column":568}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":52,"column":20},"generated":{"line":1,"column":570}},{"source":"../../../src/lib/resolve-modules.js","name":"name","original":{"line":52,"column":27},"generated":{"line":1,"column":572}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":52,"column":50},"generated":{"line":1,"column":579}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":52,"column":62},"generated":{"line":1,"column":581}},{"source":"../../../src/lib/resolve-modules.js","name":"name","original":{"line":52,"column":69},"generated":{"line":1,"column":583}},{"source":"../../../src/lib/resolve-modules.js","name":"level","original":{"line":52,"column":77},"generated":{"line":1,"column":589}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":53,"column":6},"generated":{"line":1,"column":594}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":53,"column":18},"generated":{"line":1,"column":596}},{"source":"../../../src/lib/resolve-modules.js","name":"name","original":{"line":53,"column":25},"generated":{"line":1,"column":598}},{"source":"../../../src/lib/resolve-modules.js","name":"level","original":{"line":53,"column":33},"generated":{"line":1,"column":604}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":58,"column":2},"generated":{"line":1,"column":607}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":58,"column":7},"generated":{"line":1,"column":611}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":58,"column":13},"generated":{"line":1,"column":617}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":58,"column":23},"generated":{"line":1,"column":622}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":59,"column":8},"generated":{"line":1,"column":624}},{"source":"../../../src/lib/resolve-modules.js","name":"dependencies","original":{"line":59,"column":15},"generated":{"line":1,"column":626}},{"source":"../../../src/lib/resolve-modules.js","name":"getDependencyGraph","original":{"line":60,"column":6},"generated":{"line":1,"column":640}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":60,"column":25},"generated":{"line":1,"column":642}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":60,"column":26},"generated":{"line":1,"column":643}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":60,"column":35},"generated":{"line":1,"column":651}},{"source":"../../../src/lib/resolve-modules.js","name":"dependencies","original":{"line":60,"column":42},"generated":{"line":1,"column":653}},{"source":"../../../src/lib/resolve-modules.js","name":"level","original":{"line":60,"column":56},"generated":{"line":1,"column":666}},{"source":"../../../src/lib/resolve-modules.js","name":"level","original":{"line":60,"column":63},"generated":{"line":1,"column":672}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":60,"column":71},"generated":{"line":1,"column":674}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":60,"column":74},"generated":{"line":1,"column":676}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleMap","original":{"line":60,"column":74},"generated":{"line":1,"column":686}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":60,"column":85},"generated":{"line":1,"column":688}},{"source":"../../../src/lib/resolve-modules.js","name":"moduleDepth","original":{"line":60,"column":85},"generated":{"line":1,"column":700}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":65,"column":0},"generated":{"line":1,"column":704}},{"source":"../../../src/lib/resolve-modules.js","name":"instantiateModules","original":{"line":65,"column":9},"generated":{"line":1,"column":713}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":65,"column":28},"generated":{"line":1,"column":715}},{"source":"../../../src/lib/resolve-modules.js","name":"seen","original":{"line":65,"column":37},"generated":{"line":1,"column":717}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":66,"column":2},"generated":{"line":1,"column":720}},{"source":"../../../src/lib/resolve-modules.js","name":"modules","original":{"line":66,"column":9},"generated":{"line":1,"column":727}},{"source":"../../../src/lib/resolve-modules.js","name":"map","original":{"line":66,"column":17},"generated":{"line":1,"column":729}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":66,"column":21},"generated":{"line":1,"column":733}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":67,"column":8},"generated":{"line":1,"column":736}},{"source":"../../../src/lib/resolve-modules.js","name":"ShaderModule","original":{"line":67,"column":26},"generated":{"line":1,"column":749}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":67,"column":4},"generated":{"line":1,"column":751}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":68,"column":13},"generated":{"line":1,"column":759}},{"source":"../../../src/lib/resolve-modules.js","name":"assert","original":{"line":71,"column":4},"generated":{"line":1,"column":763}},{"source":"../../../src/lib/resolve-modules.js","name":"assert","original":{"line":71,"column":4},"generated":{"line":1,"column":765}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":71,"column":10},"generated":{"line":1,"column":767}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":72,"column":24},"generated":{"line":1,"column":775}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":72,"column":13},"generated":{"line":1,"column":792}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":71,"column":10},"generated":{"line":1,"column":794}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":71,"column":10},"generated":{"line":1,"column":860}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":73,"column":72},"generated":{"line":1,"column":867}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":71,"column":10},"generated":{"line":1,"column":869}},{"source":"../../../src/lib/resolve-modules.js","name":"assert","original":{"line":75,"column":4},"generated":{"line":1,"column":897}},{"source":"../../../src/lib/resolve-modules.js","name":"assert","original":{"line":75,"column":4},"generated":{"line":1,"column":899}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":75,"column":10},"generated":{"line":1,"column":901}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":75,"column":11},"generated":{"line":1,"column":909}},{"source":"../../../src/lib/resolve-modules.js","name":"name","original":{"line":75,"column":18},"generated":{"line":1,"column":911}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":75,"column":24},"generated":{"line":1,"column":916}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":77,"column":4},"generated":{"line":1,"column":946}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":77,"column":13},"generated":{"line":1,"column":948}},{"source":"../../../src/lib/resolve-modules.js","name":"ShaderModule","original":{"line":77,"column":17},"generated":{"line":1,"column":952}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":77,"column":13},"generated":{"line":1,"column":954}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":77,"column":30},"generated":{"line":1,"column":962}},{"source":"../../../src/lib/resolve-modules.js","name":"dependencies","original":{"line":78,"column":11},"generated":{"line":1,"column":966}},{"source":"../../../src/lib/resolve-modules.js","name":"instantiateModules","original":{"line":78,"column":26},"generated":{"line":1,"column":979}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":78,"column":45},"generated":{"line":1,"column":981}},{"source":"../../../src/lib/resolve-modules.js","name":"dependencies","original":{"line":78,"column":52},"generated":{"line":1,"column":983}},{"source":"../../../src/lib/resolve-modules.js","name":"module","original":{"line":80,"column":11},"generated":{"line":1,"column":997}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":1001}},{"source":"../../../src/lib/resolve-modules.js","name":"TEST_EXPORTS","original":{"line":84,"column":13},"generated":{"line":1,"column":1007}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":28},"generated":{"line":1,"column":1009}},{"source":"../../../src/lib/resolve-modules.js","name":"getShaderDependencies","original":{"line":85,"column":2},"generated":{"line":1,"column":1010}},{"source":"../../../src/lib/resolve-modules.js","name":"getShaderDependencies","original":{"line":85,"column":2},"generated":{"line":1,"column":1032}},{"source":"../../../src/lib/resolve-modules.js","name":"getDependencyGraph","original":{"line":86,"column":2},"generated":{"line":1,"column":1034}},{"source":"../../../src/lib/resolve-modules.js","name":"getDependencyGraph","original":{"line":86,"column":2},"generated":{"line":1,"column":1053}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":1056}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":1064}},{"source":"../../../src/lib/resolve-modules.js","name":null,"original":{"line":84,"column":7},"generated":{"line":1,"column":1077}}],"sources":{"../../../src/lib/resolve-modules.js":"import ShaderModule from './shader-module';\nimport {assert} from '../utils';\n\n// Instantiate shader modules and any dependencies resolve dependencies\nexport function resolveModules(modules) {\n  return getShaderDependencies(instantiateModules(modules));\n}\n\n/**\n * Takes a list of shader module names and returns a new list of\n * shader module names that includes all dependencies, sorted so\n * that modules that are dependencies of other modules come first.\n *\n * If the shader glsl code from the returned modules is concatenated\n * in the reverse order, it is guaranteed that all functions be resolved and\n * that all function and variable definitions come before use.\n *\n * @param {String[]} modules - Array of modules (inline modules or module names)\n * @return {String[]} - Array of modules\n */\nfunction getShaderDependencies(modules) {\n  const moduleMap = {};\n  const moduleDepth = {};\n  getDependencyGraph({modules, level: 0, moduleMap, moduleDepth});\n\n  // Return a reverse sort so that dependencies come before the modules that use them\n  return Object.keys(moduleDepth)\n    .sort((a, b) => moduleDepth[b] - moduleDepth[a])\n    .map(name => moduleMap[name]);\n}\n\n/**\n * Recursively checks module dpendencies to calculate dependency\n * level of each module.\n *\n * @param {object} options\n * @param {object[]} options.modules - Array of modules\n * @param {number} options.level - Current level\n * @param {object} options.moduleMap -\n * @param {object} options.moduleDepth - Current level\n * @return {object} - Map of module name to its level\n */\n// Adds another level of dependencies to the result map\nfunction getDependencyGraph({modules, level, moduleMap, moduleDepth}) {\n  if (level >= 5) {\n    throw new Error('Possible loop in shader dependency graph');\n  }\n\n  // Update level on all current modules\n  for (const module of modules) {\n    moduleMap[module.name] = module;\n    if (moduleDepth[module.name] === undefined || moduleDepth[module.name] < level) {\n      moduleDepth[module.name] = level;\n    }\n  }\n\n  // Recurse\n  for (const module of modules) {\n    if (module.dependencies) {\n      getDependencyGraph({modules: module.dependencies, level: level + 1, moduleMap, moduleDepth});\n    }\n  }\n}\n\nfunction instantiateModules(modules, seen) {\n  return modules.map(module => {\n    if (module instanceof ShaderModule) {\n      return module;\n    }\n\n    assert(\n      typeof module !== 'string',\n      `Shader module use by name is deprecated. Import shader module '${module}' and use it directly.`\n    );\n    assert(module.name, 'shader module has no name');\n\n    module = new ShaderModule(module);\n    module.dependencies = instantiateModules(module.dependencies);\n\n    return module;\n  });\n}\n\nexport const TEST_EXPORTS = {\n  getShaderDependencies,\n  getDependencyGraph\n};\n"},"lineCount":null}},"error":null,"hash":"3c9a6ea5a619f00a0ba1ee4a82411b9f","cacheData":{"env":{}}}