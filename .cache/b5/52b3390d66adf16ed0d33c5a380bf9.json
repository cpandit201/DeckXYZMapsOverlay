{"id":"STtv","dependencies":[{"name":"/project/deck-gl-examples-01/node_modules/@deck.gl/core/dist/esm/passes/shadow-pass.js.map","includedInParent":true,"mtime":1688284130514},{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688495957541},{"name":"/project/deck-gl-examples-01/node_modules/@deck.gl/core/package.json","includedInParent":true,"mtime":1688284130514},{"name":"@babel/runtime/helpers/esm/defineProperty","loc":{"line":1,"column":28,"index":28},"parent":"/project/deck-gl-examples-01/node_modules/@deck.gl/core/dist/esm/passes/shadow-pass.js","resolved":"/project/deck-gl-examples-01/node_modules/@babel/runtime/helpers/esm/defineProperty.js"},{"name":"./layers-pass","loc":{"line":2,"column":38,"index":111},"parent":"/project/deck-gl-examples-01/node_modules/@deck.gl/core/dist/esm/passes/shadow-pass.js","resolved":"/project/deck-gl-examples-01/node_modules/@deck.gl/core/dist/esm/passes/layers-pass.js"},{"name":"@luma.gl/core","loc":{"line":3,"column":87,"index":215},"parent":"/project/deck-gl-examples-01/node_modules/@deck.gl/core/dist/esm/passes/shadow-pass.js","resolved":"/project/deck-gl-examples-01/node_modules/@luma.gl/core/dist/esm/index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=h(require(\"@babel/runtime/helpers/esm/defineProperty\")),t=h(require(\"./layers-pass\")),s=require(\"@luma.gl/core\");function h(e){return e&&e.__esModule?e:{default:e}}class r extends t.default{constructor(t,h){super(t,h),(0,e.default)(this,\"shadowMap\",void 0),(0,e.default)(this,\"depthBuffer\",void 0),(0,e.default)(this,\"fbo\",void 0),this.shadowMap=new s.Texture2D(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new s.Renderbuffer(t,{format:33189,width:1,height:1}),this.fbo=new s.Framebuffer(t,{id:\"shadowmap\",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;(0,s.withParameters)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const h=e.viewports[0],r=(0,s.cssToDeviceRatio)(this.gl),d=h.width*r,a=h.height*r;d===t.width&&a===t.height||t.resize({width:d,height:a}),super.render({...e,target:t,pass:\"shadow\"})})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}exports.default=r;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":0}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":13}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":20}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":35}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":43}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":56}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":57}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":64}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":68}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":76}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":89}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":91}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":95}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":97}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":99}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":107}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":153}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":155}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":157}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":165}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":183}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":185}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":193}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":210}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":219}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":221}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":224}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":231}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":234}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":236}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":247}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":249}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":250}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":258}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":15},"generated":{"line":1,"column":261}},{"source":"../../../src/passes/shadow-pass.ts","name":"ShadowPass","original":{"line":10,"column":21},"generated":{"line":1,"column":267}},{"source":"../../../src/passes/shadow-pass.ts","name":"LayersPass","original":{"line":10,"column":40},"generated":{"line":1,"column":277}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":15},"generated":{"line":1,"column":279}},{"source":"../../../src/passes/shadow-pass.ts","name":"constructor","original":{"line":15,"column":2},"generated":{"line":1,"column":287}},{"source":"../../../src/passes/shadow-pass.ts","name":"gl","original":{"line":16,"column":4},"generated":{"line":1,"column":299}},{"source":"../../../src/passes/shadow-pass.ts","name":"props","original":{"line":17,"column":4},"generated":{"line":1,"column":301}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":21,"column":4},"generated":{"line":1,"column":304}},{"source":"../../../src/passes/shadow-pass.ts","name":"gl","original":{"line":21,"column":10},"generated":{"line":1,"column":310}},{"source":"../../../src/passes/shadow-pass.ts","name":"props","original":{"line":21,"column":14},"generated":{"line":1,"column":312}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":316}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":318}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":320}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":329}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":334}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":351}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":355}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":357}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":359}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":368}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":373}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":392}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":396}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":398}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":400}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":409}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":414}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":425}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":24,"column":4},"generated":{"line":1,"column":428}},{"source":"../../../src/passes/shadow-pass.ts","name":"shadowMap","original":{"line":24,"column":9},"generated":{"line":1,"column":433}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":24,"column":21},"generated":{"line":1,"column":443}},{"source":"../../../src/passes/shadow-pass.ts","name":"Texture2D","original":{"line":24,"column":25},"generated":{"line":1,"column":447}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":24,"column":21},"generated":{"line":1,"column":449}},{"source":"../../../src/passes/shadow-pass.ts","name":"gl","original":{"line":24,"column":35},"generated":{"line":1,"column":459}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":24,"column":39},"generated":{"line":1,"column":461}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":25,"column":6},"generated":{"line":1,"column":462}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":25,"column":13},"generated":{"line":1,"column":468}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":26,"column":6},"generated":{"line":1,"column":470}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":26,"column":14},"generated":{"line":1,"column":477}},{"source":"../../../src/passes/shadow-pass.ts","name":"parameters","original":{"line":27,"column":6},"generated":{"line":1,"column":479}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":27,"column":18},"generated":{"line":1,"column":490}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":1,"column":491}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":1,"column":497}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":29,"column":8},"generated":{"line":1,"column":502}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":29,"column":8},"generated":{"line":1,"column":508}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":30,"column":8},"generated":{"line":1,"column":513}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":30,"column":8},"generated":{"line":1,"column":519}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":31,"column":8},"generated":{"line":1,"column":525}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":31,"column":8},"generated":{"line":1,"column":531}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":35,"column":4},"generated":{"line":1,"column":540}},{"source":"../../../src/passes/shadow-pass.ts","name":"depthBuffer","original":{"line":35,"column":9},"generated":{"line":1,"column":545}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":35,"column":23},"generated":{"line":1,"column":557}},{"source":"../../../src/passes/shadow-pass.ts","name":"Renderbuffer","original":{"line":35,"column":27},"generated":{"line":1,"column":561}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":35,"column":23},"generated":{"line":1,"column":563}},{"source":"../../../src/passes/shadow-pass.ts","name":"gl","original":{"line":35,"column":40},"generated":{"line":1,"column":576}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":35,"column":44},"generated":{"line":1,"column":578}},{"source":"../../../src/passes/shadow-pass.ts","name":"format","original":{"line":36,"column":6},"generated":{"line":1,"column":579}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":36,"column":12},"generated":{"line":1,"column":586}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":37,"column":6},"generated":{"line":1,"column":592}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":37,"column":13},"generated":{"line":1,"column":598}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":38,"column":6},"generated":{"line":1,"column":600}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":38,"column":14},"generated":{"line":1,"column":607}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":41,"column":4},"generated":{"line":1,"column":611}},{"source":"../../../src/passes/shadow-pass.ts","name":"fbo","original":{"line":41,"column":9},"generated":{"line":1,"column":616}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":41,"column":15},"generated":{"line":1,"column":620}},{"source":"../../../src/passes/shadow-pass.ts","name":"Framebuffer","original":{"line":41,"column":19},"generated":{"line":1,"column":624}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":41,"column":15},"generated":{"line":1,"column":626}},{"source":"../../../src/passes/shadow-pass.ts","name":"gl","original":{"line":41,"column":31},"generated":{"line":1,"column":638}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":41,"column":35},"generated":{"line":1,"column":640}},{"source":"../../../src/passes/shadow-pass.ts","name":"id","original":{"line":42,"column":6},"generated":{"line":1,"column":641}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":42,"column":10},"generated":{"line":1,"column":644}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":43,"column":6},"generated":{"line":1,"column":656}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":43,"column":13},"generated":{"line":1,"column":662}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":44,"column":6},"generated":{"line":1,"column":664}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":44,"column":14},"generated":{"line":1,"column":671}},{"source":"../../../src/passes/shadow-pass.ts","name":"attachments","original":{"line":45,"column":6},"generated":{"line":1,"column":673}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":45,"column":19},"generated":{"line":1,"column":685}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":46,"column":8},"generated":{"line":1,"column":686}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":46,"column":32},"generated":{"line":1,"column":692}},{"source":"../../../src/passes/shadow-pass.ts","name":"shadowMap","original":{"line":46,"column":37},"generated":{"line":1,"column":697}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":48,"column":8},"generated":{"line":1,"column":707}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":48,"column":31},"generated":{"line":1,"column":713}},{"source":"../../../src/passes/shadow-pass.ts","name":"depthBuffer","original":{"line":48,"column":36},"generated":{"line":1,"column":718}},{"source":"../../../src/passes/shadow-pass.ts","name":"render","original":{"line":53,"column":2},"generated":{"line":1,"column":733}},{"source":"../../../src/passes/shadow-pass.ts","name":"params","original":{"line":53,"column":9},"generated":{"line":1,"column":740}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":54,"column":4},"generated":{"line":1,"column":743}},{"source":"../../../src/passes/shadow-pass.ts","name":"target","original":{"line":54,"column":10},"generated":{"line":1,"column":749}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":54,"column":19},"generated":{"line":1,"column":751}},{"source":"../../../src/passes/shadow-pass.ts","name":"fbo","original":{"line":54,"column":24},"generated":{"line":1,"column":756}},{"source":"../../../src/passes/shadow-pass.ts","name":"withParameters","original":{"line":56,"column":4},"generated":{"line":1,"column":761}},{"source":"../../../src/passes/shadow-pass.ts","name":"withParameters","original":{"line":56,"column":4},"generated":{"line":1,"column":763}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":56,"column":18},"generated":{"line":1,"column":765}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":57,"column":6},"generated":{"line":1,"column":781}},{"source":"../../../src/passes/shadow-pass.ts","name":"gl","original":{"line":57,"column":11},"generated":{"line":1,"column":786}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":58,"column":6},"generated":{"line":1,"column":789}},{"source":"../../../src/passes/shadow-pass.ts","name":"depthRange","original":{"line":59,"column":8},"generated":{"line":1,"column":790}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":59,"column":20},"generated":{"line":1,"column":801}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":1,"column":802}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":59,"column":24},"generated":{"line":1,"column":804}},{"source":"../../../src/passes/shadow-pass.ts","name":"depthTest","original":{"line":60,"column":8},"generated":{"line":1,"column":807}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":60,"column":19},"generated":{"line":1,"column":818}},{"source":"../../../src/passes/shadow-pass.ts","name":"blend","original":{"line":61,"column":8},"generated":{"line":1,"column":820}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":61,"column":15},"generated":{"line":1,"column":827}},{"source":"../../../src/passes/shadow-pass.ts","name":"clearColor","original":{"line":62,"column":8},"generated":{"line":1,"column":829}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":62,"column":20},"generated":{"line":1,"column":840}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":62,"column":21},"generated":{"line":1,"column":841}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":62,"column":24},"generated":{"line":1,"column":843}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":62,"column":27},"generated":{"line":1,"column":845}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":62,"column":30},"generated":{"line":1,"column":847}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":64,"column":6},"generated":{"line":1,"column":851}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":65,"column":8},"generated":{"line":1,"column":856}},{"source":"../../../src/passes/shadow-pass.ts","name":"viewport","original":{"line":65,"column":14},"generated":{"line":1,"column":862}},{"source":"../../../src/passes/shadow-pass.ts","name":"params","original":{"line":65,"column":25},"generated":{"line":1,"column":864}},{"source":"../../../src/passes/shadow-pass.ts","name":"viewports","original":{"line":65,"column":32},"generated":{"line":1,"column":866}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":65,"column":42},"generated":{"line":1,"column":876}},{"source":"../../../src/passes/shadow-pass.ts","name":"pixelRatio","original":{"line":66,"column":14},"generated":{"line":1,"column":879}},{"source":"../../../src/passes/shadow-pass.ts","name":"cssToDeviceRatio","original":{"line":66,"column":27},"generated":{"line":1,"column":882}},{"source":"../../../src/passes/shadow-pass.ts","name":"cssToDeviceRatio","original":{"line":66,"column":27},"generated":{"line":1,"column":884}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":66,"column":43},"generated":{"line":1,"column":886}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":66,"column":44},"generated":{"line":1,"column":904}},{"source":"../../../src/passes/shadow-pass.ts","name":"gl","original":{"line":66,"column":49},"generated":{"line":1,"column":909}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":67,"column":14},"generated":{"line":1,"column":913}},{"source":"../../../src/passes/shadow-pass.ts","name":"viewport","original":{"line":67,"column":22},"generated":{"line":1,"column":915}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":67,"column":31},"generated":{"line":1,"column":917}},{"source":"../../../src/passes/shadow-pass.ts","name":"pixelRatio","original":{"line":67,"column":39},"generated":{"line":1,"column":923}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":68,"column":14},"generated":{"line":1,"column":925}},{"source":"../../../src/passes/shadow-pass.ts","name":"viewport","original":{"line":68,"column":23},"generated":{"line":1,"column":927}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":68,"column":32},"generated":{"line":1,"column":929}},{"source":"../../../src/passes/shadow-pass.ts","name":"pixelRatio","original":{"line":68,"column":41},"generated":{"line":1,"column":936}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":69,"column":12},"generated":{"line":1,"column":938}},{"source":"../../../src/passes/shadow-pass.ts","name":"target","original":{"line":69,"column":22},"generated":{"line":1,"column":942}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":69,"column":29},"generated":{"line":1,"column":944}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":69,"column":38},"generated":{"line":1,"column":951}},{"source":"../../../src/passes/shadow-pass.ts","name":"target","original":{"line":69,"column":49},"generated":{"line":1,"column":955}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":69,"column":56},"generated":{"line":1,"column":957}},{"source":"../../../src/passes/shadow-pass.ts","name":"target","original":{"line":70,"column":10},"generated":{"line":1,"column":965}},{"source":"../../../src/passes/shadow-pass.ts","name":"resize","original":{"line":70,"column":17},"generated":{"line":1,"column":967}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":70,"column":24},"generated":{"line":1,"column":974}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":70,"column":25},"generated":{"line":1,"column":975}},{"source":"../../../src/passes/shadow-pass.ts","name":"width","original":{"line":70,"column":25},"generated":{"line":1,"column":981}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":70,"column":32},"generated":{"line":1,"column":983}},{"source":"../../../src/passes/shadow-pass.ts","name":"height","original":{"line":70,"column":32},"generated":{"line":1,"column":990}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":73,"column":8},"generated":{"line":1,"column":994}},{"source":"../../../src/passes/shadow-pass.ts","name":"render","original":{"line":73,"column":14},"generated":{"line":1,"column":1000}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":73,"column":21},"generated":{"line":1,"column":1007}},{"source":"../../../src/passes/shadow-pass.ts","name":"params","original":{"line":73,"column":25},"generated":{"line":1,"column":1011}},{"source":"../../../src/passes/shadow-pass.ts","name":"target","original":{"line":73,"column":33},"generated":{"line":1,"column":1013}},{"source":"../../../src/passes/shadow-pass.ts","name":"target","original":{"line":73,"column":33},"generated":{"line":1,"column":1020}},{"source":"../../../src/passes/shadow-pass.ts","name":"pass","original":{"line":73,"column":41},"generated":{"line":1,"column":1022}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":73,"column":47},"generated":{"line":1,"column":1027}},{"source":"../../../src/passes/shadow-pass.ts","name":"shouldDrawLayer","original":{"line":78,"column":2},"generated":{"line":1,"column":1040}},{"source":"../../../src/passes/shadow-pass.ts","name":"layer","original":{"line":78,"column":18},"generated":{"line":1,"column":1056}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":79,"column":4},"generated":{"line":1,"column":1059}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":79,"column":41},"generated":{"line":1,"column":1066}},{"source":"../../../src/passes/shadow-pass.ts","name":"layer","original":{"line":79,"column":11},"generated":{"line":1,"column":1070}},{"source":"../../../src/passes/shadow-pass.ts","name":"props","original":{"line":79,"column":17},"generated":{"line":1,"column":1072}},{"source":"../../../src/passes/shadow-pass.ts","name":"shadowEnabled","original":{"line":79,"column":23},"generated":{"line":1,"column":1078}},{"source":"../../../src/passes/shadow-pass.ts","name":"getModuleParameters","original":{"line":82,"column":2},"generated":{"line":1,"column":1092}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":83,"column":4},"generated":{"line":1,"column":1114}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":83,"column":11},"generated":{"line":1,"column":1120}},{"source":"../../../src/passes/shadow-pass.ts","name":"drawToShadowMap","original":{"line":84,"column":6},"generated":{"line":1,"column":1121}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":84,"column":23},"generated":{"line":1,"column":1138}},{"source":"../../../src/passes/shadow-pass.ts","name":"delete","original":{"line":88,"column":2},"generated":{"line":1,"column":1141}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":89,"column":8},"generated":{"line":1,"column":1150}},{"source":"../../../src/passes/shadow-pass.ts","name":"fbo","original":{"line":89,"column":13},"generated":{"line":1,"column":1155}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":90,"column":6},"generated":{"line":1,"column":1161}},{"source":"../../../src/passes/shadow-pass.ts","name":"fbo","original":{"line":90,"column":11},"generated":{"line":1,"column":1166}},{"source":"../../../src/passes/shadow-pass.ts","name":"delete","original":{"line":90,"column":15},"generated":{"line":1,"column":1170}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":91,"column":6},"generated":{"line":1,"column":1179}},{"source":"../../../src/passes/shadow-pass.ts","name":"fbo","original":{"line":91,"column":11},"generated":{"line":1,"column":1184}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":91,"column":17},"generated":{"line":1,"column":1188}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":94,"column":8},"generated":{"line":1,"column":1194}},{"source":"../../../src/passes/shadow-pass.ts","name":"shadowMap","original":{"line":94,"column":13},"generated":{"line":1,"column":1199}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":95,"column":6},"generated":{"line":1,"column":1211}},{"source":"../../../src/passes/shadow-pass.ts","name":"shadowMap","original":{"line":95,"column":11},"generated":{"line":1,"column":1216}},{"source":"../../../src/passes/shadow-pass.ts","name":"delete","original":{"line":95,"column":21},"generated":{"line":1,"column":1226}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":96,"column":6},"generated":{"line":1,"column":1235}},{"source":"../../../src/passes/shadow-pass.ts","name":"shadowMap","original":{"line":96,"column":11},"generated":{"line":1,"column":1240}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":96,"column":23},"generated":{"line":1,"column":1250}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":99,"column":8},"generated":{"line":1,"column":1256}},{"source":"../../../src/passes/shadow-pass.ts","name":"depthBuffer","original":{"line":99,"column":13},"generated":{"line":1,"column":1261}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":100,"column":6},"generated":{"line":1,"column":1275}},{"source":"../../../src/passes/shadow-pass.ts","name":"depthBuffer","original":{"line":100,"column":11},"generated":{"line":1,"column":1280}},{"source":"../../../src/passes/shadow-pass.ts","name":"delete","original":{"line":100,"column":23},"generated":{"line":1,"column":1292}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":101,"column":6},"generated":{"line":1,"column":1301}},{"source":"../../../src/passes/shadow-pass.ts","name":"depthBuffer","original":{"line":101,"column":11},"generated":{"line":1,"column":1306}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":101,"column":25},"generated":{"line":1,"column":1318}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":1325}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":1333}},{"source":"../../../src/passes/shadow-pass.ts","name":null,"original":{"line":10,"column":51},"generated":{"line":1,"column":1341}}],"sources":{"../../../src/passes/shadow-pass.ts":"import {default as LayersPass} from './layers-pass';\nimport {\n  Framebuffer,\n  Texture2D,\n  Renderbuffer,\n  withParameters,\n  cssToDeviceRatio\n} from '@luma.gl/core';\n\nexport default class ShadowPass extends LayersPass {\n  shadowMap: Texture2D;\n  depthBuffer: Renderbuffer;\n  fbo: Framebuffer;\n\n  constructor(\n    gl: WebGLRenderingContext,\n    props?: {\n      id;\n    }\n  ) {\n    super(gl, props);\n\n    // The shadowMap texture\n    this.shadowMap = new Texture2D(gl, {\n      width: 1,\n      height: 1,\n      parameters: {\n        [gl.TEXTURE_MIN_FILTER]: gl.LINEAR,\n        [gl.TEXTURE_MAG_FILTER]: gl.LINEAR,\n        [gl.TEXTURE_WRAP_S]: gl.CLAMP_TO_EDGE,\n        [gl.TEXTURE_WRAP_T]: gl.CLAMP_TO_EDGE\n      }\n    });\n\n    this.depthBuffer = new Renderbuffer(gl, {\n      format: gl.DEPTH_COMPONENT16,\n      width: 1,\n      height: 1\n    });\n\n    this.fbo = new Framebuffer(gl, {\n      id: 'shadowmap',\n      width: 1,\n      height: 1,\n      attachments: {\n        [gl.COLOR_ATTACHMENT0]: this.shadowMap,\n        // Depth attachment has to be specified for depth test to work\n        [gl.DEPTH_ATTACHMENT]: this.depthBuffer\n      }\n    });\n  }\n\n  render(params) {\n    const target = this.fbo;\n\n    withParameters(\n      this.gl,\n      {\n        depthRange: [0, 1],\n        depthTest: true,\n        blend: false,\n        clearColor: [1, 1, 1, 1]\n      },\n      () => {\n        const viewport = params.viewports[0];\n        const pixelRatio = cssToDeviceRatio(this.gl);\n        const width = viewport.width * pixelRatio;\n        const height = viewport.height * pixelRatio;\n        if (width !== target.width || height !== target.height) {\n          target.resize({width, height});\n        }\n\n        super.render({...params, target, pass: 'shadow'});\n      }\n    );\n  }\n\n  shouldDrawLayer(layer) {\n    return layer.props.shadowEnabled !== false;\n  }\n\n  getModuleParameters() {\n    return {\n      drawToShadowMap: true\n    };\n  }\n\n  delete() {\n    if (this.fbo) {\n      this.fbo.delete();\n      this.fbo = null;\n    }\n\n    if (this.shadowMap) {\n      this.shadowMap.delete();\n      this.shadowMap = null;\n    }\n\n    if (this.depthBuffer) {\n      this.depthBuffer.delete();\n      this.depthBuffer = null;\n    }\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"9bf09e4afd667c2fdc9f75173dc2ce96","cacheData":{"env":{}}}