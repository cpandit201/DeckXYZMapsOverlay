{"id":"ob8R","dependencies":[{"name":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/modules/lights/lights.js.map","includedInParent":true,"mtime":1688284132458},{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688495957541},{"name":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/package.json","includedInParent":true,"mtime":1688284132458},{"name":"./lights.glsl","loc":{"line":1,"column":27,"index":27},"parent":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/modules/lights/lights.js","resolved":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/modules/lights/lights.glsl.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.lights=void 0;var t=i(require(\"./lights.glsl\"));function i(t){return t&&t.__esModule?t:{default:t}}const n={lightSources:{}};function e(){let{color:t=[0,0,0],intensity:i=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map(t=>t*i/255)}function o(t){let{ambientLight:i,pointLights:n=[],directionalLights:o=[]}=t;const g={};return g[\"lighting_uAmbientLight.color\"]=i?e(i):[0,0,0],n.forEach((t,i)=>{g[\"lighting_uPointLight[\".concat(i,\"].color\")]=e(t),g[\"lighting_uPointLight[\".concat(i,\"].position\")]=t.position,g[\"lighting_uPointLight[\".concat(i,\"].attenuation\")]=t.attenuation||[1,0,0]}),g.lighting_uPointLightCount=n.length,o.forEach((t,i)=>{g[\"lighting_uDirectionalLight[\".concat(i,\"].color\")]=e(t),g[\"lighting_uDirectionalLight[\".concat(i,\"].direction\")]=t.direction}),g.lighting_uDirectionalLightCount=o.length,g}function g(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;if(\"lightSources\"in t){const{ambientLight:i,pointLights:n,directionalLights:e}=t.lightSources||{};return i||n&&n.length>0||e&&e.length>0?Object.assign({},o({ambientLight:i,pointLights:n,directionalLights:e}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if(\"lights\"in t){const i={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case\"ambient\":i.ambientLight=n;break;case\"directional\":i.directionalLights.push(n);break;case\"point\":i.pointLights.push(n)}return g({lightSources:i})}return{}}const h={name:\"lights\",vs:t.default,fs:t.default,getUniforms:g,defines:{MAX_LIGHTS:3}};exports.lights=h;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":0}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":13}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":20}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":35}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":43}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":56}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":57}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":64}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":68}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":76}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":88}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":90}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":94}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":96}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":98}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":106}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":124}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":133}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":135}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":138}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":145}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":148}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":150}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":161}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":163}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":164}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":172}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":5,"column":0},"generated":{"line":1,"column":175}},{"source":"../../../../src/modules/lights/lights.js","name":"INITIAL_MODULE_OPTIONS","original":{"line":5,"column":6},"generated":{"line":1,"column":181}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":5,"column":31},"generated":{"line":1,"column":183}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":6,"column":2},"generated":{"line":1,"column":184}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":6,"column":16},"generated":{"line":1,"column":197}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":0},"generated":{"line":1,"column":201}},{"source":"../../../../src/modules/lights/lights.js","name":"convertColor","original":{"line":10,"column":9},"generated":{"line":1,"column":210}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":214}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":22},"generated":{"line":1,"column":218}},{"source":"../../../../src/modules/lights/lights.js","name":"color","original":{"line":10,"column":23},"generated":{"line":1,"column":224}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":31},"generated":{"line":1,"column":226}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":32},"generated":{"line":1,"column":227}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":35},"generated":{"line":1,"column":229}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":38},"generated":{"line":1,"column":231}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":22},"generated":{"line":1,"column":234}},{"source":"../../../../src/modules/lights/lights.js","name":"intensity","original":{"line":10,"column":42},"generated":{"line":1,"column":244}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":54},"generated":{"line":1,"column":246}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":249}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":259}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":266}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":274}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":278}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":288}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":291}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":65},"generated":{"line":1,"column":301}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":10,"column":61},"generated":{"line":1,"column":304}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":11,"column":2},"generated":{"line":1,"column":307}},{"source":"../../../../src/modules/lights/lights.js","name":"color","original":{"line":11,"column":9},"generated":{"line":1,"column":314}},{"source":"../../../../src/modules/lights/lights.js","name":"map","original":{"line":11,"column":15},"generated":{"line":1,"column":316}},{"source":"../../../../src/modules/lights/lights.js","name":"component","original":{"line":11,"column":19},"generated":{"line":1,"column":320}},{"source":"../../../../src/modules/lights/lights.js","name":"component","original":{"line":11,"column":33},"generated":{"line":1,"column":323}},{"source":"../../../../src/modules/lights/lights.js","name":"intensity","original":{"line":11,"column":45},"generated":{"line":1,"column":325}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":11,"column":58},"generated":{"line":1,"column":327}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":0},"generated":{"line":1,"column":332}},{"source":"../../../../src/modules/lights/lights.js","name":"getLightSourceUniforms","original":{"line":14,"column":9},"generated":{"line":1,"column":341}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":0},"generated":{"line":1,"column":343}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":90},"generated":{"line":1,"column":346}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":32},"generated":{"line":1,"column":350}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":14,"column":33},"generated":{"line":1,"column":363}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":32},"generated":{"line":1,"column":365}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":14,"column":47},"generated":{"line":1,"column":377}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":61},"generated":{"line":1,"column":379}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":32},"generated":{"line":1,"column":382}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":14,"column":65},"generated":{"line":1,"column":400}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":85},"generated":{"line":1,"column":402}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":14,"column":90},"generated":{"line":1,"column":406}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":15,"column":2},"generated":{"line":1,"column":408}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":15,"column":8},"generated":{"line":1,"column":414}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":15,"column":30},"generated":{"line":1,"column":416}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":43,"column":2},"generated":{"line":1,"column":419}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":18,"column":4},"generated":{"line":1,"column":426}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":18,"column":24},"generated":{"line":1,"column":428}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":17,"column":6},"generated":{"line":1,"column":460}},{"source":"../../../../src/modules/lights/lights.js","name":"convertColor","original":{"line":18,"column":58},"generated":{"line":1,"column":462}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":18,"column":71},"generated":{"line":1,"column":464}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":20,"column":58},"generated":{"line":1,"column":467}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":20,"column":59},"generated":{"line":1,"column":468}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":20,"column":62},"generated":{"line":1,"column":470}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":20,"column":65},"generated":{"line":1,"column":472}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":23,"column":2},"generated":{"line":1,"column":475}},{"source":"../../../../src/modules/lights/lights.js","name":"forEach","original":{"line":23,"column":14},"generated":{"line":1,"column":477}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":23,"column":22},"generated":{"line":1,"column":485}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLight","original":{"line":23,"column":23},"generated":{"line":1,"column":486}},{"source":"../../../../src/modules/lights/lights.js","name":"index","original":{"line":23,"column":35},"generated":{"line":1,"column":488}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":24,"column":4},"generated":{"line":1,"column":493}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":24,"column":23},"generated":{"line":1,"column":495}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":24,"column":23},"generated":{"line":1,"column":519}},{"source":"../../../../src/modules/lights/lights.js","name":"index","original":{"line":24,"column":48},"generated":{"line":1,"column":526}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":24,"column":23},"generated":{"line":1,"column":528}},{"source":"../../../../src/modules/lights/lights.js","name":"convertColor","original":{"line":24,"column":66},"generated":{"line":1,"column":540}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLight","original":{"line":24,"column":79},"generated":{"line":1,"column":542}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":25,"column":4},"generated":{"line":1,"column":545}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":25,"column":23},"generated":{"line":1,"column":547}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":25,"column":23},"generated":{"line":1,"column":571}},{"source":"../../../../src/modules/lights/lights.js","name":"index","original":{"line":25,"column":48},"generated":{"line":1,"column":578}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":25,"column":23},"generated":{"line":1,"column":580}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLight","original":{"line":25,"column":69},"generated":{"line":1,"column":595}},{"source":"../../../../src/modules/lights/lights.js","name":"position","original":{"line":25,"column":80},"generated":{"line":1,"column":597}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":26,"column":4},"generated":{"line":1,"column":606}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":26,"column":23},"generated":{"line":1,"column":608}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":26,"column":23},"generated":{"line":1,"column":632}},{"source":"../../../../src/modules/lights/lights.js","name":"index","original":{"line":26,"column":48},"generated":{"line":1,"column":639}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":26,"column":23},"generated":{"line":1,"column":641}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLight","original":{"line":26,"column":72},"generated":{"line":1,"column":659}},{"source":"../../../../src/modules/lights/lights.js","name":"attenuation","original":{"line":26,"column":83},"generated":{"line":1,"column":661}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":26,"column":98},"generated":{"line":1,"column":674}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":27,"column":6},"generated":{"line":1,"column":675}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":28,"column":6},"generated":{"line":1,"column":677}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":29,"column":6},"generated":{"line":1,"column":679}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":32,"column":2},"generated":{"line":1,"column":684}},{"source":"../../../../src/modules/lights/lights.js","name":"lighting_uPointLightCount","original":{"line":32,"column":22},"generated":{"line":1,"column":686}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":32,"column":50},"generated":{"line":1,"column":712}},{"source":"../../../../src/modules/lights/lights.js","name":"length","original":{"line":32,"column":62},"generated":{"line":1,"column":714}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":34,"column":2},"generated":{"line":1,"column":721}},{"source":"../../../../src/modules/lights/lights.js","name":"forEach","original":{"line":34,"column":20},"generated":{"line":1,"column":723}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":34,"column":28},"generated":{"line":1,"column":731}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLight","original":{"line":34,"column":29},"generated":{"line":1,"column":732}},{"source":"../../../../src/modules/lights/lights.js","name":"index","original":{"line":34,"column":47},"generated":{"line":1,"column":734}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":35,"column":4},"generated":{"line":1,"column":739}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":35,"column":23},"generated":{"line":1,"column":741}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":35,"column":23},"generated":{"line":1,"column":771}},{"source":"../../../../src/modules/lights/lights.js","name":"index","original":{"line":35,"column":54},"generated":{"line":1,"column":778}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":35,"column":23},"generated":{"line":1,"column":780}},{"source":"../../../../src/modules/lights/lights.js","name":"convertColor","original":{"line":35,"column":72},"generated":{"line":1,"column":792}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLight","original":{"line":36,"column":6},"generated":{"line":1,"column":794}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":38,"column":4},"generated":{"line":1,"column":797}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":38,"column":23},"generated":{"line":1,"column":799}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":38,"column":23},"generated":{"line":1,"column":829}},{"source":"../../../../src/modules/lights/lights.js","name":"index","original":{"line":38,"column":54},"generated":{"line":1,"column":836}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":38,"column":23},"generated":{"line":1,"column":838}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLight","original":{"line":39,"column":6},"generated":{"line":1,"column":854}},{"source":"../../../../src/modules/lights/lights.js","name":"direction","original":{"line":39,"column":23},"generated":{"line":1,"column":856}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":41,"column":2},"generated":{"line":1,"column":868}},{"source":"../../../../src/modules/lights/lights.js","name":"lighting_uDirectionalLightCount","original":{"line":41,"column":22},"generated":{"line":1,"column":870}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":41,"column":56},"generated":{"line":1,"column":902}},{"source":"../../../../src/modules/lights/lights.js","name":"length","original":{"line":41,"column":74},"generated":{"line":1,"column":904}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSourceUniforms","original":{"line":43,"column":9},"generated":{"line":1,"column":911}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":0},"generated":{"line":1,"column":913}},{"source":"../../../../src/modules/lights/lights.js","name":"getUniforms","original":{"line":47,"column":9},"generated":{"line":1,"column":922}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":926}},{"source":"../../../../src/modules/lights/lights.js","name":"opts","original":{"line":47,"column":21},"generated":{"line":1,"column":930}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":932}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":942}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":949}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":957}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":961}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":971}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":974}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":47,"column":52},"generated":{"line":1,"column":984}},{"source":"../../../../src/modules/lights/lights.js","name":"INITIAL_MODULE_OPTIONS","original":{"line":47,"column":28},"generated":{"line":1,"column":987}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":49,"column":2},"generated":{"line":1,"column":989}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":49,"column":6},"generated":{"line":1,"column":992}},{"source":"../../../../src/modules/lights/lights.js","name":"opts","original":{"line":49,"column":24},"generated":{"line":1,"column":1009}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":49,"column":30},"generated":{"line":1,"column":1011}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":50,"column":4},"generated":{"line":1,"column":1012}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":50,"column":10},"generated":{"line":1,"column":1018}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":50,"column":11},"generated":{"line":1,"column":1031}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":50,"column":10},"generated":{"line":1,"column":1033}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":50,"column":25},"generated":{"line":1,"column":1045}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":50,"column":10},"generated":{"line":1,"column":1047}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":50,"column":38},"generated":{"line":1,"column":1065}},{"source":"../../../../src/modules/lights/lights.js","name":"opts","original":{"line":50,"column":59},"generated":{"line":1,"column":1068}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":50,"column":64},"generated":{"line":1,"column":1070}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":50,"column":80},"generated":{"line":1,"column":1084}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":56,"column":4},"generated":{"line":1,"column":1087}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":52,"column":6},"generated":{"line":1,"column":1094}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":53,"column":7},"generated":{"line":1,"column":1097}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":53,"column":22},"generated":{"line":1,"column":1100}},{"source":"../../../../src/modules/lights/lights.js","name":"length","original":{"line":53,"column":34},"generated":{"line":1,"column":1102}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":53,"column":43},"generated":{"line":1,"column":1109}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":54,"column":7},"generated":{"line":1,"column":1112}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":54,"column":28},"generated":{"line":1,"column":1115}},{"source":"../../../../src/modules/lights/lights.js","name":"length","original":{"line":54,"column":46},"generated":{"line":1,"column":1117}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":54,"column":55},"generated":{"line":1,"column":1124}},{"source":"../../../../src/modules/lights/lights.js","name":"Object","original":{"line":60,"column":11},"generated":{"line":1,"column":1126}},{"source":"../../../../src/modules/lights/lights.js","name":"assign","original":{"line":60,"column":18},"generated":{"line":1,"column":1133}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":61,"column":6},"generated":{"line":1,"column":1140}},{"source":"../../../../src/modules/lights/lights.js","name":"getLightSourceUniforms","original":{"line":62,"column":6},"generated":{"line":1,"column":1143}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":62,"column":29},"generated":{"line":1,"column":1145}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":62,"column":30},"generated":{"line":1,"column":1146}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":62,"column":30},"generated":{"line":1,"column":1159}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":62,"column":44},"generated":{"line":1,"column":1161}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":62,"column":44},"generated":{"line":1,"column":1173}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":62,"column":57},"generated":{"line":1,"column":1175}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":62,"column":57},"generated":{"line":1,"column":1193}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":63,"column":6},"generated":{"line":1,"column":1197}},{"source":"../../../../src/modules/lights/lights.js","name":"lighting_uEnabled","original":{"line":64,"column":8},"generated":{"line":1,"column":1198}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":64,"column":27},"generated":{"line":1,"column":1217}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":57,"column":13},"generated":{"line":1,"column":1221}},{"source":"../../../../src/modules/lights/lights.js","name":"lighting_uEnabled","original":{"line":57,"column":14},"generated":{"line":1,"column":1222}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":57,"column":33},"generated":{"line":1,"column":1241}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":70,"column":2},"generated":{"line":1,"column":1244}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":70,"column":6},"generated":{"line":1,"column":1247}},{"source":"../../../../src/modules/lights/lights.js","name":"opts","original":{"line":70,"column":18},"generated":{"line":1,"column":1258}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":70,"column":24},"generated":{"line":1,"column":1260}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":71,"column":4},"generated":{"line":1,"column":1261}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":71,"column":10},"generated":{"line":1,"column":1267}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":71,"column":25},"generated":{"line":1,"column":1269}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":71,"column":26},"generated":{"line":1,"column":1270}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":71,"column":39},"generated":{"line":1,"column":1282}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":71,"column":43},"generated":{"line":1,"column":1285}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":71,"column":62},"generated":{"line":1,"column":1303}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":73,"column":4},"generated":{"line":1,"column":1307}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":73,"column":9},"generated":{"line":1,"column":1311}},{"source":"../../../../src/modules/lights/lights.js","name":"light","original":{"line":73,"column":15},"generated":{"line":1,"column":1317}},{"source":"../../../../src/modules/lights/lights.js","name":"opts","original":{"line":73,"column":24},"generated":{"line":1,"column":1322}},{"source":"../../../../src/modules/lights/lights.js","name":"lights","original":{"line":73,"column":29},"generated":{"line":1,"column":1324}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":73,"column":39},"generated":{"line":1,"column":1332}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":74,"column":6},"generated":{"line":1,"column":1335}},{"source":"../../../../src/modules/lights/lights.js","name":"light","original":{"line":74,"column":14},"generated":{"line":1,"column":1342}},{"source":"../../../../src/modules/lights/lights.js","name":"type","original":{"line":74,"column":20},"generated":{"line":1,"column":1344}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":75,"column":8},"generated":{"line":1,"column":1350}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":75,"column":13},"generated":{"line":1,"column":1354}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":78,"column":10},"generated":{"line":1,"column":1364}},{"source":"../../../../src/modules/lights/lights.js","name":"ambientLight","original":{"line":78,"column":23},"generated":{"line":1,"column":1366}},{"source":"../../../../src/modules/lights/lights.js","name":"light","original":{"line":78,"column":38},"generated":{"line":1,"column":1379}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":79,"column":10},"generated":{"line":1,"column":1381}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":80,"column":8},"generated":{"line":1,"column":1387}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":80,"column":13},"generated":{"line":1,"column":1391}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":81,"column":10},"generated":{"line":1,"column":1405}},{"source":"../../../../src/modules/lights/lights.js","name":"directionalLights","original":{"line":81,"column":23},"generated":{"line":1,"column":1407}},{"source":"../../../../src/modules/lights/lights.js","name":"push","original":{"line":81,"column":41},"generated":{"line":1,"column":1425}},{"source":"../../../../src/modules/lights/lights.js","name":"light","original":{"line":81,"column":46},"generated":{"line":1,"column":1430}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":82,"column":10},"generated":{"line":1,"column":1433}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":83,"column":8},"generated":{"line":1,"column":1439}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":83,"column":13},"generated":{"line":1,"column":1443}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":84,"column":10},"generated":{"line":1,"column":1451}},{"source":"../../../../src/modules/lights/lights.js","name":"pointLights","original":{"line":84,"column":23},"generated":{"line":1,"column":1453}},{"source":"../../../../src/modules/lights/lights.js","name":"push","original":{"line":84,"column":35},"generated":{"line":1,"column":1465}},{"source":"../../../../src/modules/lights/lights.js","name":"light","original":{"line":84,"column":40},"generated":{"line":1,"column":1470}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":93,"column":4},"generated":{"line":1,"column":1473}},{"source":"../../../../src/modules/lights/lights.js","name":"getUniforms","original":{"line":93,"column":11},"generated":{"line":1,"column":1480}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":93,"column":23},"generated":{"line":1,"column":1482}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":93,"column":24},"generated":{"line":1,"column":1483}},{"source":"../../../../src/modules/lights/lights.js","name":"lightSources","original":{"line":93,"column":24},"generated":{"line":1,"column":1496}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":96,"column":2},"generated":{"line":1,"column":1500}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":96,"column":9},"generated":{"line":1,"column":1506}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":1509}},{"source":"../../../../src/modules/lights/lights.js","name":"lights","original":{"line":100,"column":13},"generated":{"line":1,"column":1515}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":22},"generated":{"line":1,"column":1517}},{"source":"../../../../src/modules/lights/lights.js","name":"name","original":{"line":101,"column":2},"generated":{"line":1,"column":1518}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":101,"column":8},"generated":{"line":1,"column":1523}},{"source":"../../../../src/modules/lights/lights.js","name":"vs","original":{"line":102,"column":2},"generated":{"line":1,"column":1532}},{"source":"../../../../src/modules/lights/lights.js","name":"lightingShader","original":{"line":102,"column":6},"generated":{"line":1,"column":1535}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":22},"generated":{"line":1,"column":1537}},{"source":"../../../../src/modules/lights/lights.js","name":"fs","original":{"line":103,"column":2},"generated":{"line":1,"column":1545}},{"source":"../../../../src/modules/lights/lights.js","name":"lightingShader","original":{"line":103,"column":6},"generated":{"line":1,"column":1548}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":22},"generated":{"line":1,"column":1550}},{"source":"../../../../src/modules/lights/lights.js","name":"getUniforms","original":{"line":104,"column":2},"generated":{"line":1,"column":1558}},{"source":"../../../../src/modules/lights/lights.js","name":"getUniforms","original":{"line":104,"column":2},"generated":{"line":1,"column":1570}},{"source":"../../../../src/modules/lights/lights.js","name":"defines","original":{"line":105,"column":2},"generated":{"line":1,"column":1572}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":105,"column":11},"generated":{"line":1,"column":1580}},{"source":"../../../../src/modules/lights/lights.js","name":"MAX_LIGHTS","original":{"line":106,"column":4},"generated":{"line":1,"column":1581}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":106,"column":16},"generated":{"line":1,"column":1592}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":1596}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":1604}},{"source":"../../../../src/modules/lights/lights.js","name":null,"original":{"line":100,"column":7},"generated":{"line":1,"column":1611}}],"sources":{"../../../../src/modules/lights/lights.js":"/** @typedef {import('../../types').ShaderModule} ShaderModule */\n\nimport lightingShader from './lights.glsl';\n\nconst INITIAL_MODULE_OPTIONS = {\n  lightSources: {}\n};\n\n// Take color 0-255 and intensity as input and output 0.0-1.0 range\nfunction convertColor({color = [0, 0, 0], intensity = 1.0} = {}) {\n  return color.map(component => (component * intensity) / 255.0);\n}\n\nfunction getLightSourceUniforms({ambientLight, pointLights = [], directionalLights = []}) {\n  const lightSourceUniforms = {};\n\n  if (ambientLight) {\n    lightSourceUniforms['lighting_uAmbientLight.color'] = convertColor(ambientLight);\n  } else {\n    lightSourceUniforms['lighting_uAmbientLight.color'] = [0, 0, 0];\n  }\n\n  pointLights.forEach((pointLight, index) => {\n    lightSourceUniforms[`lighting_uPointLight[${index}].color`] = convertColor(pointLight);\n    lightSourceUniforms[`lighting_uPointLight[${index}].position`] = pointLight.position;\n    lightSourceUniforms[`lighting_uPointLight[${index}].attenuation`] = pointLight.attenuation || [\n      1,\n      0,\n      0\n    ];\n  });\n  lightSourceUniforms.lighting_uPointLightCount = pointLights.length;\n\n  directionalLights.forEach((directionalLight, index) => {\n    lightSourceUniforms[`lighting_uDirectionalLight[${index}].color`] = convertColor(\n      directionalLight\n    );\n    lightSourceUniforms[`lighting_uDirectionalLight[${index}].direction`] =\n      directionalLight.direction;\n  });\n  lightSourceUniforms.lighting_uDirectionalLightCount = directionalLights.length;\n\n  return lightSourceUniforms;\n}\n\n// eslint-disable-next-line complexity\nfunction getUniforms(opts = INITIAL_MODULE_OPTIONS) {\n  // Specify lights separately\n  if ('lightSources' in opts) {\n    const {ambientLight, pointLights, directionalLights} = opts.lightSources || {};\n    const hasLights =\n      ambientLight ||\n      (pointLights && pointLights.length > 0) ||\n      (directionalLights && directionalLights.length > 0);\n\n    if (!hasLights) {\n      return {lighting_uEnabled: false};\n    }\n\n    return Object.assign(\n      {},\n      getLightSourceUniforms({ambientLight, pointLights, directionalLights}),\n      {\n        lighting_uEnabled: true\n      }\n    );\n  }\n\n  // Support for array of lights. Type of light is detected by type field\n  if ('lights' in opts) {\n    const lightSources = {pointLights: [], directionalLights: []};\n    // @ts-ignore\n    for (const light of opts.lights || []) {\n      switch (light.type) {\n        case 'ambient':\n          // Note: Only uses last ambient light\n          // TODO - add ambient light sources on CPU?\n          lightSources.ambientLight = light;\n          break;\n        case 'directional':\n          lightSources.directionalLights.push(light);\n          break;\n        case 'point':\n          lightSources.pointLights.push(light);\n          break;\n        default:\n        // eslint-disable-next-line\n        // console.warn(light.type);\n      }\n    }\n\n    // Call the `opts.lightSources`` version\n    return getUniforms({lightSources});\n  }\n\n  return {};\n}\n\n/** @type {ShaderModule} */\nexport const lights = {\n  name: 'lights',\n  vs: lightingShader,\n  fs: lightingShader,\n  getUniforms,\n  defines: {\n    MAX_LIGHTS: 3\n  }\n};\n"},"lineCount":null}},"error":null,"hash":"c0cb2817563f47a1d5c3045ef75c18c4","cacheData":{"env":{}}}