{"id":"HD9x","dependencies":[{"name":"/project/deck-gl-examples-01/node_modules/@loaders.gl/core/dist/esm/lib/progress/fetch-progress.js.map","includedInParent":true,"mtime":1688284130527},{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688495957541},{"name":"/project/deck-gl-examples-01/node_modules/@loaders.gl/core/package.json","includedInParent":true,"mtime":1688284130527}],"generated":{"js":"\"use strict\";async function e(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};if(!(e=await e).ok)return e;const o=e.body;if(!o)return e;const s=e.headers.get(\"content-length\")||0,d=s?parseInt(s):0;if(!(d>0))return e;if(\"undefined\"==typeof ReadableStream||!o.getReader)return e;const i=new ReadableStream({async start(e){const s=o.getReader();await t(e,s,0,d,n,a,r)}});return new Response(i)}async function t(e,n,a,r,o,s,d){try{const{done:u,value:c}=await n.read();if(u)return s(),void e.close();a+=c.byteLength,o(Math.round(a/r*100),{loadedBytes:a,totalBytes:r}),e.enqueue(c),await t(e,n,a,r,o,s,d)}catch(i){e.error(i),d(i)}}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=e;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":0}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":6,"column":15},"generated":{"line":1,"column":13}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"fetchProgress","original":{"line":6,"column":30},"generated":{"line":1,"column":28}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":7,"column":2},"generated":{"line":1,"column":30}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onProgress","original":{"line":8,"column":2},"generated":{"line":1,"column":32}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":11,"column":2},"generated":{"line":1,"column":35}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onDone","original":{"line":9,"column":2},"generated":{"line":1,"column":39}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"arguments","original":{"line":9,"column":8},"generated":{"line":1,"column":41}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"length","original":{"line":9,"column":8},"generated":{"line":1,"column":51}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":9,"column":8},"generated":{"line":1,"column":58}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"undefined","original":{"line":9,"column":8},"generated":{"line":1,"column":66}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"arguments","original":{"line":9,"column":8},"generated":{"line":1,"column":70}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":9,"column":8},"generated":{"line":1,"column":80}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"arguments","original":{"line":9,"column":8},"generated":{"line":1,"column":83}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":9,"column":8},"generated":{"line":1,"column":93}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":9,"column":11},"generated":{"line":1,"column":96}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onError","original":{"line":10,"column":2},"generated":{"line":1,"column":103}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"arguments","original":{"line":10,"column":9},"generated":{"line":1,"column":105}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"length","original":{"line":10,"column":9},"generated":{"line":1,"column":115}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":10,"column":9},"generated":{"line":1,"column":122}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"undefined","original":{"line":10,"column":9},"generated":{"line":1,"column":130}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"arguments","original":{"line":10,"column":9},"generated":{"line":1,"column":134}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":10,"column":9},"generated":{"line":1,"column":144}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"arguments","original":{"line":10,"column":9},"generated":{"line":1,"column":147}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":10,"column":9},"generated":{"line":1,"column":157}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":10,"column":12},"generated":{"line":1,"column":160}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":13,"column":2},"generated":{"line":1,"column":167}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":12,"column":2},"generated":{"line":1,"column":172}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":12,"column":19},"generated":{"line":1,"column":180}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"ok","original":{"line":13,"column":16},"generated":{"line":1,"column":183}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":15,"column":4},"generated":{"line":1,"column":186}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":15,"column":11},"generated":{"line":1,"column":193}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":17,"column":2},"generated":{"line":1,"column":195}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"body","original":{"line":17,"column":8},"generated":{"line":1,"column":201}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":17,"column":15},"generated":{"line":1,"column":203}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"body","original":{"line":17,"column":24},"generated":{"line":1,"column":205}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":18,"column":2},"generated":{"line":1,"column":210}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"body","original":{"line":18,"column":7},"generated":{"line":1,"column":214}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":216}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":20,"column":11},"generated":{"line":1,"column":223}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":22,"column":2},"generated":{"line":1,"column":225}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"contentLength","original":{"line":22,"column":8},"generated":{"line":1,"column":231}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":22,"column":24},"generated":{"line":1,"column":233}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"headers","original":{"line":22,"column":33},"generated":{"line":1,"column":235}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"get","original":{"line":22,"column":41},"generated":{"line":1,"column":243}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":22,"column":45},"generated":{"line":1,"column":247}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":22,"column":66},"generated":{"line":1,"column":266}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":23,"column":8},"generated":{"line":1,"column":268}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"contentLength","original":{"line":23,"column":21},"generated":{"line":1,"column":270}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"parseInt","original":{"line":23,"column":37},"generated":{"line":1,"column":272}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"contentLength","original":{"line":23,"column":46},"generated":{"line":1,"column":281}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":23,"column":63},"generated":{"line":1,"column":284}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":24,"column":2},"generated":{"line":1,"column":286}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":24,"column":8},"generated":{"line":1,"column":291}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":24,"column":21},"generated":{"line":1,"column":293}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":25,"column":4},"generated":{"line":1,"column":296}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":25,"column":11},"generated":{"line":1,"column":303}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":28,"column":2},"generated":{"line":1,"column":305}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":28,"column":32},"generated":{"line":1,"column":308}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"ReadableStream","original":{"line":28,"column":13},"generated":{"line":1,"column":328}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"body","original":{"line":28,"column":48},"generated":{"line":1,"column":345}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"getReader","original":{"line":28,"column":53},"generated":{"line":1,"column":347}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":29,"column":4},"generated":{"line":1,"column":357}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"response","original":{"line":29,"column":11},"generated":{"line":1,"column":364}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":33,"column":2},"generated":{"line":1,"column":366}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"progressStream","original":{"line":33,"column":8},"generated":{"line":1,"column":372}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":33,"column":25},"generated":{"line":1,"column":374}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"ReadableStream","original":{"line":33,"column":29},"generated":{"line":1,"column":378}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":33,"column":44},"generated":{"line":1,"column":393}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":34,"column":4},"generated":{"line":1,"column":394}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"controller","original":{"line":34,"column":16},"generated":{"line":1,"column":406}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":35,"column":6},"generated":{"line":1,"column":409}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"reader","original":{"line":35,"column":12},"generated":{"line":1,"column":415}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"body","original":{"line":35,"column":21},"generated":{"line":1,"column":417}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"getReader","original":{"line":35,"column":26},"generated":{"line":1,"column":419}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"read","original":{"line":36,"column":12},"generated":{"line":1,"column":437}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"controller","original":{"line":36,"column":17},"generated":{"line":1,"column":439}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"reader","original":{"line":36,"column":29},"generated":{"line":1,"column":441}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":36,"column":37},"generated":{"line":1,"column":443}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":36,"column":40},"generated":{"line":1,"column":445}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onProgress","original":{"line":36,"column":52},"generated":{"line":1,"column":447}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onDone","original":{"line":36,"column":64},"generated":{"line":1,"column":449}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onError","original":{"line":36,"column":72},"generated":{"line":1,"column":451}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":40,"column":2},"generated":{"line":1,"column":457}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":40,"column":9},"generated":{"line":1,"column":464}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"Response","original":{"line":40,"column":13},"generated":{"line":1,"column":468}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"progressStream","original":{"line":40,"column":22},"generated":{"line":1,"column":477}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":46,"column":0},"generated":{"line":1,"column":480}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"read","original":{"line":46,"column":15},"generated":{"line":1,"column":495}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"controller","original":{"line":46,"column":20},"generated":{"line":1,"column":497}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"reader","original":{"line":46,"column":32},"generated":{"line":1,"column":499}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"loadedBytes","original":{"line":46,"column":40},"generated":{"line":1,"column":501}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":46,"column":53},"generated":{"line":1,"column":503}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onProgress","original":{"line":46,"column":65},"generated":{"line":1,"column":505}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onDone","original":{"line":46,"column":77},"generated":{"line":1,"column":507}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onError","original":{"line":46,"column":85},"generated":{"line":1,"column":509}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":512}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":48,"column":4},"generated":{"line":1,"column":516}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":48,"column":10},"generated":{"line":1,"column":522}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"done","original":{"line":48,"column":11},"generated":{"line":1,"column":527}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":48,"column":15},"generated":{"line":1,"column":529}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"value","original":{"line":48,"column":17},"generated":{"line":1,"column":535}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"reader","original":{"line":48,"column":32},"generated":{"line":1,"column":544}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"read","original":{"line":48,"column":39},"generated":{"line":1,"column":546}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":1,"column":553}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"done","original":{"line":49,"column":8},"generated":{"line":1,"column":556}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":52,"column":6},"generated":{"line":1,"column":558}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onDone","original":{"line":50,"column":6},"generated":{"line":1,"column":565}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"controller","original":{"line":51,"column":6},"generated":{"line":1,"column":574}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"close","original":{"line":51,"column":17},"generated":{"line":1,"column":576}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"loadedBytes","original":{"line":54,"column":4},"generated":{"line":1,"column":584}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"value","original":{"line":54,"column":19},"generated":{"line":1,"column":587}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"byteLength","original":{"line":54,"column":25},"generated":{"line":1,"column":589}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onProgress","original":{"line":56,"column":4},"generated":{"line":1,"column":600}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"Math","original":{"line":55,"column":20},"generated":{"line":1,"column":602}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"round","original":{"line":55,"column":25},"generated":{"line":1,"column":607}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"loadedBytes","original":{"line":55,"column":32},"generated":{"line":1,"column":613}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":55,"column":46},"generated":{"line":1,"column":615}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":55,"column":60},"generated":{"line":1,"column":617}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":56,"column":24},"generated":{"line":1,"column":622}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"loadedBytes","original":{"line":56,"column":25},"generated":{"line":1,"column":623}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"loadedBytes","original":{"line":56,"column":25},"generated":{"line":1,"column":635}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":56,"column":38},"generated":{"line":1,"column":637}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":56,"column":38},"generated":{"line":1,"column":648}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"controller","original":{"line":57,"column":4},"generated":{"line":1,"column":652}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"enqueue","original":{"line":57,"column":15},"generated":{"line":1,"column":654}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"value","original":{"line":57,"column":23},"generated":{"line":1,"column":662}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"read","original":{"line":58,"column":10},"generated":{"line":1,"column":671}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"controller","original":{"line":58,"column":15},"generated":{"line":1,"column":673}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"reader","original":{"line":58,"column":27},"generated":{"line":1,"column":675}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"loadedBytes","original":{"line":58,"column":35},"generated":{"line":1,"column":677}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"totalBytes","original":{"line":58,"column":48},"generated":{"line":1,"column":679}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onProgress","original":{"line":58,"column":60},"generated":{"line":1,"column":681}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onDone","original":{"line":58,"column":72},"generated":{"line":1,"column":683}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onError","original":{"line":58,"column":80},"generated":{"line":1,"column":685}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":59,"column":4},"generated":{"line":1,"column":688}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"error","original":{"line":59,"column":11},"generated":{"line":1,"column":694}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"controller","original":{"line":60,"column":4},"generated":{"line":1,"column":697}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"error","original":{"line":60,"column":15},"generated":{"line":1,"column":699}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"error","original":{"line":60,"column":21},"generated":{"line":1,"column":705}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"onError","original":{"line":61,"column":4},"generated":{"line":1,"column":708}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":"error","original":{"line":61,"column":12},"generated":{"line":1,"column":710}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":714}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":721}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":736}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":744}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":757}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":758}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":765}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":769}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":777}},{"source":"../../../../src/lib/progress/fetch-progress.ts","name":null,"original":{"line":63,"column":0},"generated":{"line":1,"column":785}}],"sources":{"../../../../src/lib/progress/fetch-progress.ts":"// Forked from github AnthumChris/fetch-progress-indicators under MIT license\n\n/**\n * Intercepts the Response stream and creates a new Response\n */\nexport default async function fetchProgress(\n  response: Response | Promise<Response>,\n  onProgress: any, // TODO better callback types\n  onDone = () => {},\n  onError = () => {}\n) {\n  response = await response;\n  if (!response.ok) {\n    // ERROR checking needs to be done separately\n    return response;\n  }\n  const body = response.body;\n  if (!body) {\n    // 'ReadableStream not yet supported in this browser.\n    return response;\n  }\n  const contentLength = response.headers.get('content-length') || 0;\n  const totalBytes = contentLength ? parseInt(contentLength) : 0;\n  if (!(totalBytes > 0)) {\n    return response;\n  }\n  // Currently override only implemented in browser\n  if (typeof ReadableStream === 'undefined' || !body.getReader) {\n    return response;\n  }\n\n  // Create a new stream that invisbly wraps original stream\n  const progressStream = new ReadableStream({\n    async start(controller) {\n      const reader = body.getReader();\n      await read(controller, reader, 0, totalBytes, onProgress, onDone, onError);\n    }\n  });\n\n  return new Response(progressStream);\n}\n\n// Forward to original streams controller\n// TODO - this causes a crazy deep \"async stack\"... rewrite as async iterator?\n// eslint-disable-next-line max-params\nasync function read(controller, reader, loadedBytes, totalBytes, onProgress, onDone, onError) {\n  try {\n    const {done, value} = await reader.read();\n    if (done) {\n      onDone();\n      controller.close();\n      return;\n    }\n    loadedBytes += value.byteLength;\n    const percent = Math.round((loadedBytes / totalBytes) * 100);\n    onProgress(percent, {loadedBytes, totalBytes});\n    controller.enqueue(value);\n    await read(controller, reader, loadedBytes, totalBytes, onProgress, onDone, onError);\n  } catch (error) {\n    controller.error(error);\n    onError(error);\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"cdbe976faf2fc5300a7d9f2f5b27b6a5","cacheData":{"env":{}}}