{"id":"tWMk","dependencies":[{"name":"/project/deck-gl-examples-01/node_modules/@loaders.gl/loader-utils/dist/esm/lib/request-utils/request-scheduler.js.map","includedInParent":true,"mtime":1688284132110},{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688495957541},{"name":"/project/deck-gl-examples-01/node_modules/@loaders.gl/loader-utils/package.json","includedInParent":true,"mtime":1688284132110},{"name":"@babel/runtime/helpers/esm/defineProperty","loc":{"line":1,"column":28,"index":28},"parent":"/project/deck-gl-examples-01/node_modules/@loaders.gl/loader-utils/dist/esm/lib/request-utils/request-scheduler.js","resolved":"/project/deck-gl-examples-01/node_modules/@babel/runtime/helpers/esm/defineProperty.js"},{"name":"@probe.gl/stats","loc":{"line":2,"column":22,"index":95},"parent":"/project/deck-gl-examples-01/node_modules/@loaders.gl/loader-utils/dist/esm/lib/request-utils/request-scheduler.js","resolved":"/project/deck-gl-examples-01/node_modules/@loaders.gl/loader-utils/node_modules/@probe.gl/stats/dist/index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=s(require(\"@babel/runtime/helpers/esm/defineProperty\")),t=require(\"@probe.gl/stats\");function s(e){return e&&e.__esModule?e:{default:e}}const u=\"Queued Requests\",i=\"Active Requests\",r=\"Cancelled Requests\",o=\"Queued Requests Ever\",h=\"Active Requests Ever\",l={id:\"request-scheduler\",throttleRequests:!0,maxRequests:6};class a{constructor(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,e.default)(this,\"props\",void 0),(0,e.default)(this,\"stats\",void 0),(0,e.default)(this,\"activeRequestCount\",0),(0,e.default)(this,\"requestQueue\",[]),(0,e.default)(this,\"requestMap\",new Map),(0,e.default)(this,\"deferredUpdate\",null),this.props={...l,...s},this.stats=new t.Stats({id:this.props.id}),this.stats.get(u),this.stats.get(i),this.stats.get(r),this.stats.get(o),this.stats.get(h)}scheduleRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const s={handle:e,priority:0,getPriority:t},u=new Promise(e=>(s.resolve=e,s));return this.requestQueue.push(s),this.requestMap.set(e,u),this._issueNewRequests(),u}_issueRequest(e){const{handle:t,resolve:s}=e;let u=!1;const i=()=>{u||(u=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,s?s({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const s=e[t];this._updateRequest(s)||(e.splice(t,1),this.requestMap.delete(s.handle),t--)}e.sort((e,t)=>e.priority-t.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}exports.default=a;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":0}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":13}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":20}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":35}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":43}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":56}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":57}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":64}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":68}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":76}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":89}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":91}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":95}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":97}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":99}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":107}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":153}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":155}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":163}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":182}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":191}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":193}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":196}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":203}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":206}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":208}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":219}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":221}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":222}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":1,"column":37},"generated":{"line":1,"column":230}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":17,"column":0},"generated":{"line":1,"column":233}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_QUEUED_REQUESTS","original":{"line":17,"column":6},"generated":{"line":1,"column":239}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":17,"column":29},"generated":{"line":1,"column":241}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_ACTIVE_REQUESTS","original":{"line":18,"column":6},"generated":{"line":1,"column":259}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":18,"column":29},"generated":{"line":1,"column":261}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_CANCELLED_REQUESTS","original":{"line":19,"column":6},"generated":{"line":1,"column":279}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":19,"column":32},"generated":{"line":1,"column":281}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_QUEUED_REQUESTS_EVER","original":{"line":20,"column":6},"generated":{"line":1,"column":302}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":20,"column":34},"generated":{"line":1,"column":304}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_ACTIVE_REQUESTS_EVER","original":{"line":21,"column":6},"generated":{"line":1,"column":327}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":21,"column":34},"generated":{"line":1,"column":329}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"DEFAULT_PROPS","original":{"line":23,"column":6},"generated":{"line":1,"column":352}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":23,"column":55},"generated":{"line":1,"column":354}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"id","original":{"line":24,"column":2},"generated":{"line":1,"column":355}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":24,"column":6},"generated":{"line":1,"column":358}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"throttleRequests","original":{"line":26,"column":2},"generated":{"line":1,"column":378}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":26,"column":20},"generated":{"line":1,"column":396}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"maxRequests","original":{"line":28,"column":2},"generated":{"line":1,"column":398}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":28,"column":15},"generated":{"line":1,"column":410}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":43,"column":15},"generated":{"line":1,"column":413}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"RequestScheduler","original":{"line":43,"column":21},"generated":{"line":1,"column":419}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"constructor","original":{"line":53,"column":2},"generated":{"line":1,"column":421}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":49},"generated":{"line":1,"column":435}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"props","original":{"line":53,"column":14},"generated":{"line":1,"column":439}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"arguments","original":{"line":53,"column":42},"generated":{"line":1,"column":441}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"length","original":{"line":53,"column":42},"generated":{"line":1,"column":451}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":42},"generated":{"line":1,"column":458}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"undefined","original":{"line":53,"column":42},"generated":{"line":1,"column":466}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"arguments","original":{"line":53,"column":42},"generated":{"line":1,"column":470}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":42},"generated":{"line":1,"column":480}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"arguments","original":{"line":53,"column":42},"generated":{"line":1,"column":483}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":42},"generated":{"line":1,"column":493}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":45},"generated":{"line":1,"column":496}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":53,"column":47},"generated":{"line":1,"column":500}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":53,"column":47},"generated":{"line":1,"column":502}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":504}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":513}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":518}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":531}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":53,"column":47},"generated":{"line":1,"column":535}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":53,"column":47},"generated":{"line":1,"column":537}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":539}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":548}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":553}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":566}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":53,"column":47},"generated":{"line":1,"column":570}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":53,"column":47},"generated":{"line":1,"column":572}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":574}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":583}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":53,"column":47},"generated":{"line":1,"column":588}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":46,"column":31},"generated":{"line":1,"column":609}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":46,"column":32},"generated":{"line":1,"column":613}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":46,"column":32},"generated":{"line":1,"column":615}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":46,"column":32},"generated":{"line":1,"column":617}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":46,"column":32},"generated":{"line":1,"column":626}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":46,"column":32},"generated":{"line":1,"column":631}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":49,"column":36},"generated":{"line":1,"column":646}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":49,"column":38},"generated":{"line":1,"column":651}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":49,"column":38},"generated":{"line":1,"column":653}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":49,"column":38},"generated":{"line":1,"column":655}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":49,"column":38},"generated":{"line":1,"column":664}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":49,"column":38},"generated":{"line":1,"column":669}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":50,"column":60},"generated":{"line":1,"column":682}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"Map","original":{"line":50,"column":64},"generated":{"line":1,"column":686}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":50,"column":69},"generated":{"line":1,"column":692}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_defineProperty","original":{"line":50,"column":69},"generated":{"line":1,"column":694}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":50,"column":69},"generated":{"line":1,"column":696}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":50,"column":69},"generated":{"line":1,"column":705}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":50,"column":69},"generated":{"line":1,"column":710}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":51,"column":32},"generated":{"line":1,"column":727}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":54,"column":4},"generated":{"line":1,"column":733}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"props","original":{"line":54,"column":9},"generated":{"line":1,"column":738}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":54,"column":17},"generated":{"line":1,"column":744}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"DEFAULT_PROPS","original":{"line":54,"column":21},"generated":{"line":1,"column":748}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"props","original":{"line":54,"column":39},"generated":{"line":1,"column":753}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":57,"column":4},"generated":{"line":1,"column":756}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"stats","original":{"line":57,"column":9},"generated":{"line":1,"column":761}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":57,"column":17},"generated":{"line":1,"column":767}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"Stats","original":{"line":57,"column":21},"generated":{"line":1,"column":771}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":57,"column":26},"generated":{"line":1,"column":773}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":57,"column":27},"generated":{"line":1,"column":779}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"id","original":{"line":57,"column":28},"generated":{"line":1,"column":780}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":57,"column":32},"generated":{"line":1,"column":783}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"props","original":{"line":57,"column":37},"generated":{"line":1,"column":788}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"id","original":{"line":57,"column":43},"generated":{"line":1,"column":794}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":58,"column":4},"generated":{"line":1,"column":799}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"stats","original":{"line":58,"column":9},"generated":{"line":1,"column":804}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"get","original":{"line":58,"column":15},"generated":{"line":1,"column":810}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_QUEUED_REQUESTS","original":{"line":58,"column":19},"generated":{"line":1,"column":814}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":59,"column":4},"generated":{"line":1,"column":817}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"stats","original":{"line":59,"column":9},"generated":{"line":1,"column":822}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"get","original":{"line":59,"column":15},"generated":{"line":1,"column":828}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_ACTIVE_REQUESTS","original":{"line":59,"column":19},"generated":{"line":1,"column":832}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":60,"column":4},"generated":{"line":1,"column":835}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"stats","original":{"line":60,"column":9},"generated":{"line":1,"column":840}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"get","original":{"line":60,"column":15},"generated":{"line":1,"column":846}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_CANCELLED_REQUESTS","original":{"line":60,"column":19},"generated":{"line":1,"column":850}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":61,"column":4},"generated":{"line":1,"column":853}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"stats","original":{"line":61,"column":9},"generated":{"line":1,"column":858}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"get","original":{"line":61,"column":15},"generated":{"line":1,"column":864}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_QUEUED_REQUESTS_EVER","original":{"line":61,"column":19},"generated":{"line":1,"column":868}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":62,"column":4},"generated":{"line":1,"column":871}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"stats","original":{"line":62,"column":9},"generated":{"line":1,"column":876}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"get","original":{"line":62,"column":15},"generated":{"line":1,"column":882}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"STAT_ACTIVE_REQUESTS_EVER","original":{"line":62,"column":19},"generated":{"line":1,"column":886}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"scheduleRequest","original":{"line":81,"column":2},"generated":{"line":1,"column":889}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":82,"column":4},"generated":{"line":1,"column":905}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":84,"column":28},"generated":{"line":1,"column":908}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"getPriority","original":{"line":83,"column":4},"generated":{"line":1,"column":912}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"arguments","original":{"line":83,"column":36},"generated":{"line":1,"column":914}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"length","original":{"line":83,"column":36},"generated":{"line":1,"column":924}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":83,"column":36},"generated":{"line":1,"column":931}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"undefined","original":{"line":83,"column":36},"generated":{"line":1,"column":939}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"arguments","original":{"line":83,"column":36},"generated":{"line":1,"column":943}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":83,"column":36},"generated":{"line":1,"column":953}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"arguments","original":{"line":83,"column":36},"generated":{"line":1,"column":956}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":83,"column":36},"generated":{"line":1,"column":966}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":83,"column":39},"generated":{"line":1,"column":969}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":83,"column":45},"generated":{"line":1,"column":973}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":86,"column":4},"generated":{"line":1,"column":975}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":86,"column":9},"generated":{"line":1,"column":979}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"props","original":{"line":86,"column":14},"generated":{"line":1,"column":984}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"throttleRequests","original":{"line":86,"column":20},"generated":{"line":1,"column":990}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":1007}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"Promise","original":{"line":87,"column":13},"generated":{"line":1,"column":1014}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":87,"column":21},"generated":{"line":1,"column":1022}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":87,"column":29},"generated":{"line":1,"column":1030}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":87,"column":30},"generated":{"line":1,"column":1031}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":87,"column":36},"generated":{"line":1,"column":1036}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":91,"column":4},"generated":{"line":1,"column":1045}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":91,"column":8},"generated":{"line":1,"column":1048}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestMap","original":{"line":91,"column":13},"generated":{"line":1,"column":1053}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"has","original":{"line":91,"column":24},"generated":{"line":1,"column":1064}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":91,"column":28},"generated":{"line":1,"column":1068}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":92,"column":6},"generated":{"line":1,"column":1071}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":92,"column":13},"generated":{"line":1,"column":1078}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestMap","original":{"line":92,"column":18},"generated":{"line":1,"column":1083}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"get","original":{"line":92,"column":29},"generated":{"line":1,"column":1094}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":92,"column":33},"generated":{"line":1,"column":1098}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":95,"column":4},"generated":{"line":1,"column":1101}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":95,"column":10},"generated":{"line":1,"column":1107}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":95,"column":29},"generated":{"line":1,"column":1109}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":95,"column":30},"generated":{"line":1,"column":1110}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":95,"column":30},"generated":{"line":1,"column":1117}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"priority","original":{"line":95,"column":38},"generated":{"line":1,"column":1119}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":95,"column":48},"generated":{"line":1,"column":1128}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"getPriority","original":{"line":95,"column":51},"generated":{"line":1,"column":1130}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"getPriority","original":{"line":95,"column":51},"generated":{"line":1,"column":1142}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"promise","original":{"line":96,"column":10},"generated":{"line":1,"column":1145}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":96,"column":20},"generated":{"line":1,"column":1147}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"Promise","original":{"line":96,"column":24},"generated":{"line":1,"column":1151}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":96,"column":48},"generated":{"line":1,"column":1159}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":98,"column":6},"generated":{"line":1,"column":1163}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":98,"column":14},"generated":{"line":1,"column":1165}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":98,"column":24},"generated":{"line":1,"column":1173}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":99,"column":13},"generated":{"line":1,"column":1175}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":105,"column":4},"generated":{"line":1,"column":1179}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":102,"column":4},"generated":{"line":1,"column":1186}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":102,"column":9},"generated":{"line":1,"column":1191}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"push","original":{"line":102,"column":22},"generated":{"line":1,"column":1204}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":102,"column":27},"generated":{"line":1,"column":1209}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":103,"column":4},"generated":{"line":1,"column":1212}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestMap","original":{"line":103,"column":9},"generated":{"line":1,"column":1217}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"set","original":{"line":103,"column":20},"generated":{"line":1,"column":1228}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":103,"column":24},"generated":{"line":1,"column":1232}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"promise","original":{"line":103,"column":32},"generated":{"line":1,"column":1234}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":104,"column":4},"generated":{"line":1,"column":1237}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_issueNewRequests","original":{"line":104,"column":9},"generated":{"line":1,"column":1242}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"promise","original":{"line":105,"column":11},"generated":{"line":1,"column":1262}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_issueRequest","original":{"line":110,"column":2},"generated":{"line":1,"column":1264}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":110,"column":16},"generated":{"line":1,"column":1278}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":111,"column":4},"generated":{"line":1,"column":1281}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":111,"column":10},"generated":{"line":1,"column":1287}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":111,"column":11},"generated":{"line":1,"column":1294}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":111,"column":17},"generated":{"line":1,"column":1296}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":111,"column":19},"generated":{"line":1,"column":1304}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":111,"column":30},"generated":{"line":1,"column":1307}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":112,"column":4},"generated":{"line":1,"column":1309}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"isDone","original":{"line":112,"column":8},"generated":{"line":1,"column":1313}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":112,"column":17},"generated":{"line":1,"column":1316}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":114,"column":4},"generated":{"line":1,"column":1318}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":114,"column":10},"generated":{"line":1,"column":1324}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":114,"column":17},"generated":{"line":1,"column":1326}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"isDone","original":{"line":116,"column":11},"generated":{"line":1,"column":1331}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"isDone","original":{"line":117,"column":8},"generated":{"line":1,"column":1335}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":117,"column":17},"generated":{"line":1,"column":1338}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":120,"column":8},"generated":{"line":1,"column":1340}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestMap","original":{"line":120,"column":13},"generated":{"line":1,"column":1345}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"delete","original":{"line":120,"column":24},"generated":{"line":1,"column":1356}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":120,"column":31},"generated":{"line":1,"column":1363}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":121,"column":8},"generated":{"line":1,"column":1366}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"activeRequestCount","original":{"line":121,"column":13},"generated":{"line":1,"column":1371}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":123,"column":8},"generated":{"line":1,"column":1392}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_issueNewRequests","original":{"line":123,"column":13},"generated":{"line":1,"column":1397}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":130,"column":4},"generated":{"line":1,"column":1419}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":128,"column":4},"generated":{"line":1,"column":1426}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"activeRequestCount","original":{"line":128,"column":9},"generated":{"line":1,"column":1431}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":130,"column":11},"generated":{"line":1,"column":1452}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":130,"column":21},"generated":{"line":1,"column":1454}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":130,"column":29},"generated":{"line":1,"column":1456}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":130,"column":30},"generated":{"line":1,"column":1457}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":130,"column":30},"generated":{"line":1,"column":1462}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"Promise","original":{"line":130,"column":39},"generated":{"line":1,"column":1466}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":130,"column":47},"generated":{"line":1,"column":1474}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":130,"column":55},"generated":{"line":1,"column":1482}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":130,"column":56},"generated":{"line":1,"column":1483}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"done","original":{"line":130,"column":56},"generated":{"line":1,"column":1488}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_issueNewRequests","original":{"line":134,"column":2},"generated":{"line":1,"column":1492}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":135,"column":9},"generated":{"line":1,"column":1512}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"deferredUpdate","original":{"line":135,"column":14},"generated":{"line":1,"column":1517}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":136,"column":6},"generated":{"line":1,"column":1534}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"deferredUpdate","original":{"line":136,"column":11},"generated":{"line":1,"column":1539}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"setTimeout","original":{"line":136,"column":28},"generated":{"line":1,"column":1554}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":136,"column":39},"generated":{"line":1,"column":1565}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":136,"column":45},"generated":{"line":1,"column":1569}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_issueNewRequestsAsync","original":{"line":136,"column":50},"generated":{"line":1,"column":1574}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":136,"column":76},"generated":{"line":1,"column":1599}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_issueNewRequestsAsync","original":{"line":141,"column":2},"generated":{"line":1,"column":1603}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":143,"column":4},"generated":{"line":1,"column":1628}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"deferredUpdate","original":{"line":143,"column":9},"generated":{"line":1,"column":1633}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":143,"column":26},"generated":{"line":1,"column":1648}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":145,"column":4},"generated":{"line":1,"column":1653}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"freeSlots","original":{"line":145,"column":10},"generated":{"line":1,"column":1659}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"Math","original":{"line":145,"column":22},"generated":{"line":1,"column":1661}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"max","original":{"line":145,"column":27},"generated":{"line":1,"column":1666}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":145,"column":31},"generated":{"line":1,"column":1670}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"props","original":{"line":145,"column":36},"generated":{"line":1,"column":1675}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"maxRequests","original":{"line":145,"column":42},"generated":{"line":1,"column":1681}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":145,"column":56},"generated":{"line":1,"column":1693}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"activeRequestCount","original":{"line":145,"column":61},"generated":{"line":1,"column":1698}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":145,"column":81},"generated":{"line":1,"column":1717}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":147,"column":4},"generated":{"line":1,"column":1720}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":147,"column":22},"generated":{"line":1,"column":1723}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"freeSlots","original":{"line":147,"column":8},"generated":{"line":1,"column":1727}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":147,"column":4},"generated":{"line":1,"column":1729}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":151,"column":4},"generated":{"line":1,"column":1730}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_updateAllRequests","original":{"line":151,"column":9},"generated":{"line":1,"column":1735}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":154,"column":4},"generated":{"line":1,"column":1756}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":154,"column":9},"generated":{"line":1,"column":1760}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":154,"column":13},"generated":{"line":1,"column":1764}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":154,"column":17},"generated":{"line":1,"column":1766}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":154,"column":20},"generated":{"line":1,"column":1768}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"freeSlots","original":{"line":154,"column":24},"generated":{"line":1,"column":1770}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":154,"column":37},"generated":{"line":1,"column":1774}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":154,"column":40},"generated":{"line":1,"column":1776}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":155,"column":6},"generated":{"line":1,"column":1777}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":155,"column":12},"generated":{"line":1,"column":1783}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":155,"column":22},"generated":{"line":1,"column":1785}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":155,"column":27},"generated":{"line":1,"column":1790}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"shift","original":{"line":155,"column":40},"generated":{"line":1,"column":1803}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":156,"column":10},"generated":{"line":1,"column":1811}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":157,"column":8},"generated":{"line":1,"column":1814}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_issueRequest","original":{"line":157,"column":13},"generated":{"line":1,"column":1819}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":157,"column":27},"generated":{"line":1,"column":1833}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_updateAllRequests","original":{"line":166,"column":2},"generated":{"line":1,"column":1838}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":167,"column":4},"generated":{"line":1,"column":1859}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":167,"column":10},"generated":{"line":1,"column":1865}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":167,"column":25},"generated":{"line":1,"column":1867}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":167,"column":30},"generated":{"line":1,"column":1872}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":168,"column":4},"generated":{"line":1,"column":1885}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":168,"column":9},"generated":{"line":1,"column":1889}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":168,"column":13},"generated":{"line":1,"column":1893}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":168,"column":17},"generated":{"line":1,"column":1895}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":168,"column":20},"generated":{"line":1,"column":1897}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":168,"column":24},"generated":{"line":1,"column":1899}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"length","original":{"line":168,"column":37},"generated":{"line":1,"column":1901}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":168,"column":47},"generated":{"line":1,"column":1910}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":168,"column":50},"generated":{"line":1,"column":1912}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":169,"column":6},"generated":{"line":1,"column":1913}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":169,"column":12},"generated":{"line":1,"column":1919}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":169,"column":22},"generated":{"line":1,"column":1921}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":169,"column":35},"generated":{"line":1,"column":1923}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":170,"column":11},"generated":{"line":1,"column":1926}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_updateRequest","original":{"line":170,"column":16},"generated":{"line":1,"column":1931}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":170,"column":31},"generated":{"line":1,"column":1946}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":172,"column":8},"generated":{"line":1,"column":1951}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"splice","original":{"line":172,"column":21},"generated":{"line":1,"column":1953}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":172,"column":28},"generated":{"line":1,"column":1960}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":172,"column":31},"generated":{"line":1,"column":1962}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":173,"column":8},"generated":{"line":1,"column":1965}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestMap","original":{"line":173,"column":13},"generated":{"line":1,"column":1970}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"delete","original":{"line":173,"column":24},"generated":{"line":1,"column":1981}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":173,"column":31},"generated":{"line":1,"column":1988}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":173,"column":39},"generated":{"line":1,"column":1990}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"i","original":{"line":174,"column":8},"generated":{"line":1,"column":1998}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"requestQueue","original":{"line":179,"column":4},"generated":{"line":1,"column":2003}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"sort","original":{"line":179,"column":17},"generated":{"line":1,"column":2005}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":179,"column":22},"generated":{"line":1,"column":2010}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"a","original":{"line":179,"column":23},"generated":{"line":1,"column":2011}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"b","original":{"line":179,"column":26},"generated":{"line":1,"column":2013}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"a","original":{"line":179,"column":32},"generated":{"line":1,"column":2017}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"priority","original":{"line":179,"column":34},"generated":{"line":1,"column":2019}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"b","original":{"line":179,"column":45},"generated":{"line":1,"column":2028}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"priority","original":{"line":179,"column":47},"generated":{"line":1,"column":2030}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"_updateRequest","original":{"line":183,"column":2},"generated":{"line":1,"column":2040}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":183,"column":17},"generated":{"line":1,"column":2055}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":187,"column":4},"generated":{"line":1,"column":2058}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":184,"column":4},"generated":{"line":1,"column":2065}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"priority","original":{"line":184,"column":12},"generated":{"line":1,"column":2067}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":184,"column":23},"generated":{"line":1,"column":2076}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"getPriority","original":{"line":184,"column":31},"generated":{"line":1,"column":2078}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":184,"column":43},"generated":{"line":1,"column":2090}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"handle","original":{"line":184,"column":51},"generated":{"line":1,"column":2092}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":187,"column":8},"generated":{"line":1,"column":2102}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"priority","original":{"line":187,"column":16},"generated":{"line":1,"column":2104}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":187,"column":27},"generated":{"line":1,"column":2113}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"request","original":{"line":188,"column":6},"generated":{"line":1,"column":2118}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":"resolve","original":{"line":188,"column":14},"generated":{"line":1,"column":2120}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":188,"column":22},"generated":{"line":1,"column":2128}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":189,"column":13},"generated":{"line":1,"column":2135}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":2139}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":2147}},{"source":"../../../../src/lib/request-utils/request-scheduler.ts","name":null,"original":{"line":193,"column":0},"generated":{"line":1,"column":2155}}],"sources":{"../../../../src/lib/request-utils/request-scheduler.ts":"import {Stats} from '@probe.gl/stats';\n\ntype Handle = any;\ntype DoneFunction = () => any;\ntype GetPriorityFunction = () => number;\ntype RequestResult = {\n  done: DoneFunction;\n} | null;\n\n/** RequestScheduler Options */\nexport type RequestSchedulerProps = {\n  id?: string;\n  throttleRequests?: boolean;\n  maxRequests?: number;\n};\n\nconst STAT_QUEUED_REQUESTS = 'Queued Requests';\nconst STAT_ACTIVE_REQUESTS = 'Active Requests';\nconst STAT_CANCELLED_REQUESTS = 'Cancelled Requests';\nconst STAT_QUEUED_REQUESTS_EVER = 'Queued Requests Ever';\nconst STAT_ACTIVE_REQUESTS_EVER = 'Active Requests Ever';\n\nconst DEFAULT_PROPS: Required<RequestSchedulerProps> = {\n  id: 'request-scheduler',\n  // Specifies if the request scheduler should throttle incoming requests, mainly for comparative testing\n  throttleRequests: true,\n  // The maximum number of simultaneous active requests. Un-throttled requests do not observe this limit.\n  maxRequests: 6\n};\n\n/** Tracks one request */\ntype Request = {\n  handle: Handle;\n  priority: number;\n  getPriority: GetPriorityFunction;\n  resolve?: (value: any) => any;\n};\n\n/**\n * Used to issue a request, without having them \"deeply queued\" by the browser.\n * @todo - Track requests globally, across multiple servers\n */\nexport default class RequestScheduler {\n  readonly props: Required<RequestSchedulerProps>;\n  readonly stats: Stats;\n  activeRequestCount: number = 0;\n\n  /** Tracks the number of active requests and prioritizes/cancels queued requests. */\n  private requestQueue: Request[] = [];\n  private requestMap: Map<Handle, Promise<RequestResult>> = new Map();\n  private deferredUpdate: any = null;\n\n  constructor(props: RequestSchedulerProps = {}) {\n    this.props = {...DEFAULT_PROPS, ...props};\n\n    // Returns the statistics used by the request scheduler.\n    this.stats = new Stats({id: this.props.id});\n    this.stats.get(STAT_QUEUED_REQUESTS);\n    this.stats.get(STAT_ACTIVE_REQUESTS);\n    this.stats.get(STAT_CANCELLED_REQUESTS);\n    this.stats.get(STAT_QUEUED_REQUESTS_EVER);\n    this.stats.get(STAT_ACTIVE_REQUESTS_EVER);\n  }\n\n  /**\n   * Called by an application that wants to issue a request, without having it deeply queued by the browser\n   *\n   * When the returned promise resolved, it is OK for the application to issue a request.\n   * The promise resolves to an object that contains a `done` method.\n   * When the application's request has completed (or failed), the application must call the `done` function\n   *\n   * @param handle\n   * @param getPriority will be called when request \"slots\" open up,\n   *    allowing the caller to update priority or cancel the request\n   *    Highest priority executes first, priority < 0 cancels the request\n   * @returns a promise\n   *   - resolves to a object (with a `done` field) when the request can be issued without queueing,\n   *   - resolves to `null` if the request has been cancelled (by the callback return < 0).\n   *     In this case the application should not issue the request\n   */\n  scheduleRequest(\n    handle: Handle,\n    getPriority: GetPriorityFunction = () => 0\n  ): Promise<RequestResult> {\n    // Allows throttling to be disabled\n    if (!this.props.throttleRequests) {\n      return Promise.resolve({done: () => {}});\n    }\n\n    // dedupe\n    if (this.requestMap.has(handle)) {\n      return this.requestMap.get(handle) as Promise<any>;\n    }\n\n    const request: Request = {handle, priority: 0, getPriority};\n    const promise = new Promise<RequestResult>((resolve) => {\n      // @ts-ignore\n      request.resolve = resolve;\n      return request;\n    });\n\n    this.requestQueue.push(request);\n    this.requestMap.set(handle, promise);\n    this._issueNewRequests();\n    return promise;\n  }\n\n  // PRIVATE\n\n  _issueRequest(request: Request): Promise<any> {\n    const {handle, resolve} = request;\n    let isDone = false;\n\n    const done = () => {\n      // can only be called once\n      if (!isDone) {\n        isDone = true;\n\n        // Stop tracking a request - it has completed, failed, cancelled etc\n        this.requestMap.delete(handle);\n        this.activeRequestCount--;\n        // A slot just freed up, see if any queued requests are waiting\n        this._issueNewRequests();\n      }\n    };\n\n    // Track this request\n    this.activeRequestCount++;\n\n    return resolve ? resolve({done}) : Promise.resolve({done});\n  }\n\n  /** We check requests asynchronously, to prevent multiple updates */\n  _issueNewRequests(): void {\n    if (!this.deferredUpdate) {\n      this.deferredUpdate = setTimeout(() => this._issueNewRequestsAsync(), 0);\n    }\n  }\n\n  /** Refresh all requests  */\n  _issueNewRequestsAsync() {\n    // TODO - shouldn't we clear the timeout?\n    this.deferredUpdate = null;\n\n    const freeSlots = Math.max(this.props.maxRequests - this.activeRequestCount, 0);\n\n    if (freeSlots === 0) {\n      return;\n    }\n\n    this._updateAllRequests();\n\n    // Resolve pending promises for the top-priority requests\n    for (let i = 0; i < freeSlots; ++i) {\n      const request = this.requestQueue.shift();\n      if (request) {\n        this._issueRequest(request); // eslint-disable-line @typescript-eslint/no-floating-promises\n      }\n    }\n\n    // Uncomment to debug\n    // console.log(`${freeSlots} free slots, ${this.requestQueue.length} queued requests`);\n  }\n\n  /** Ensure all requests have updated priorities, and that no longer valid requests are cancelled */\n  _updateAllRequests() {\n    const requestQueue = this.requestQueue;\n    for (let i = 0; i < requestQueue.length; ++i) {\n      const request = requestQueue[i];\n      if (!this._updateRequest(request)) {\n        // Remove the element and make sure to adjust the counter to account for shortened array\n        requestQueue.splice(i, 1);\n        this.requestMap.delete(request.handle);\n        i--;\n      }\n    }\n\n    // Sort the remaining requests based on priority\n    requestQueue.sort((a, b) => a.priority - b.priority);\n  }\n\n  /** Update a single request by calling the callback */\n  _updateRequest(request) {\n    request.priority = request.getPriority(request.handle); // eslint-disable-line callback-return\n\n    // by returning a negative priority, the callback cancels the request\n    if (request.priority < 0) {\n      request.resolve(null);\n      return false;\n    }\n    return true;\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"f65cb574e07099d3370cdc04f62aa471","cacheData":{"env":{}}}