{"id":"RiAQ","dependencies":[{"name":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/modules/image-fun-filters/edgework.js.map","includedInParent":true,"mtime":1688284132458},{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688495957541},{"name":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/package.json","includedInParent":true,"mtime":1688284132458},{"name":"../utils/random","loc":{"line":1,"column":23,"index":23},"parent":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/modules/image-fun-filters/edgework.js","resolved":"/project/deck-gl-examples-01/node_modules/@luma.gl/shadertools/dist/esm/modules/utils/random.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.edgeWork=void 0;var e=require(\"../utils/random\");const o=\"uniform float radius;\\nuniform vec2 delta;\\n\\nvec4 edgeWork_sampleColor1(sampler2D source, vec2 texSize, vec2 texCoord) {\\n  vec2 relativeDelta = radius * delta / texSize;\\n\\n  vec2 color = vec2(0.0);\\n  vec2 total = vec2(0.0);\\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\n\\n  for (float t = -30.0; t <= 30.0; t++) {\\n    float percent = (t + offset - 0.5) / 30.0;\\n    float weight = 1.0 - abs(percent);\\n    vec3 sampleColor = texture2D(source, texCoord + relativeDelta * percent).rgb;\\n    float average = (sampleColor.r + sampleColor.g + sampleColor.b) / 3.0;\\n    color.x += average * weight;\\n    total.x += weight;\\n    if (abs(t) < 15.0) {\\n      weight = weight * 2.0 - 1.0;\\n      color.y += average * weight;\\n      total.y += weight;\\n    }\\n  }\\n  return vec4(color / total, 0.0, 1.0);\\n}\\n\\nvec4 edgeWork_sampleColor2(sampler2D source, vec2 texSize, vec2 texCoord) {\\n  vec2 relativeDelta = radius * delta / texSize;\\n\\n  vec2 color = vec2(0.0);\\n  vec2 total = vec2(0.0);\\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\n\\n  for (float t = -30.0; t <= 30.0; t++) {\\n    float percent = (t + offset - 0.5) / 30.0;\\n    float weight = 1.0 - abs(percent);\\n    vec2 sampleColor = texture2D(source, texCoord + relativeDelta * percent).xy;\\n    color.x += sampleColor.x * weight;\\n    total.x += weight;\\n    if (abs(t) < 15.0) {\\n      weight = weight * 2.0 - 1.0;\\n      color.y += sampleColor.y * weight;\\n      total.y += weight;\\n    }\\n  }\\n  float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\\n  return vec4(c, c, c, 1.0);\\n}\\n\",t={radius:{value:2,min:1,softMax:50},delta:{value:[1,0],private:!0}},r={name:\"edgeWork\",uniforms:t,fs:o,dependencies:[e.random],passes:[{sampler:\"edgeWork_sampleColor1\",uniforms:{delta:[1,0]}},{sampler:\"edgeWork_sampleColor2\",uniforms:{delta:[0,1]}}]};exports.edgeWork=r;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":0}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":13}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":20}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":35}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":43}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":56}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":57}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":64}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":68}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":76}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":90}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":92}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":96}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":98}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":106}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":5,"column":0},"generated":{"line":1,"column":125}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"fs","original":{"line":5,"column":6},"generated":{"line":1,"column":131}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":5,"column":8},"generated":{"line":1,"column":133}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"uniforms","original":{"line":60,"column":6},"generated":{"line":1,"column":1749}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":60,"column":17},"generated":{"line":1,"column":1751}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"radius","original":{"line":61,"column":2},"generated":{"line":1,"column":1752}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":61,"column":10},"generated":{"line":1,"column":1759}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"value","original":{"line":61,"column":11},"generated":{"line":1,"column":1760}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":61,"column":18},"generated":{"line":1,"column":1766}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"min","original":{"line":61,"column":21},"generated":{"line":1,"column":1768}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":61,"column":26},"generated":{"line":1,"column":1772}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"softMax","original":{"line":61,"column":29},"generated":{"line":1,"column":1774}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":61,"column":38},"generated":{"line":1,"column":1782}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"delta","original":{"line":62,"column":2},"generated":{"line":1,"column":1786}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":62,"column":9},"generated":{"line":1,"column":1792}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"value","original":{"line":62,"column":10},"generated":{"line":1,"column":1793}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":62,"column":17},"generated":{"line":1,"column":1799}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":62,"column":18},"generated":{"line":1,"column":1800}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":62,"column":21},"generated":{"line":1,"column":1802}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"private","original":{"line":62,"column":25},"generated":{"line":1,"column":1805}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":62,"column":34},"generated":{"line":1,"column":1814}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"edgeWork","original":{"line":66,"column":13},"generated":{"line":1,"column":1818}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":24},"generated":{"line":1,"column":1820}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"name","original":{"line":67,"column":2},"generated":{"line":1,"column":1821}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":67,"column":8},"generated":{"line":1,"column":1826}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"uniforms","original":{"line":68,"column":2},"generated":{"line":1,"column":1837}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"uniforms","original":{"line":68,"column":2},"generated":{"line":1,"column":1846}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"fs","original":{"line":69,"column":2},"generated":{"line":1,"column":1848}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"fs","original":{"line":69,"column":2},"generated":{"line":1,"column":1851}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"dependencies","original":{"line":70,"column":2},"generated":{"line":1,"column":1853}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":70,"column":16},"generated":{"line":1,"column":1866}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"random","original":{"line":70,"column":17},"generated":{"line":1,"column":1867}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":70,"column":16},"generated":{"line":1,"column":1869}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"passes","original":{"line":71,"column":2},"generated":{"line":1,"column":1877}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":71,"column":10},"generated":{"line":1,"column":1884}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":72,"column":4},"generated":{"line":1,"column":1885}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"sampler","original":{"line":73,"column":6},"generated":{"line":1,"column":1886}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":73,"column":15},"generated":{"line":1,"column":1894}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"uniforms","original":{"line":74,"column":6},"generated":{"line":1,"column":1918}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":74,"column":16},"generated":{"line":1,"column":1927}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"delta","original":{"line":74,"column":17},"generated":{"line":1,"column":1928}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":74,"column":24},"generated":{"line":1,"column":1934}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":74,"column":25},"generated":{"line":1,"column":1935}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":74,"column":28},"generated":{"line":1,"column":1937}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":76,"column":4},"generated":{"line":1,"column":1942}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"sampler","original":{"line":77,"column":6},"generated":{"line":1,"column":1943}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":77,"column":15},"generated":{"line":1,"column":1951}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"uniforms","original":{"line":78,"column":6},"generated":{"line":1,"column":1975}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":78,"column":16},"generated":{"line":1,"column":1984}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":"delta","original":{"line":78,"column":17},"generated":{"line":1,"column":1985}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":78,"column":24},"generated":{"line":1,"column":1991}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":78,"column":25},"generated":{"line":1,"column":1992}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":78,"column":28},"generated":{"line":1,"column":1994}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":2001}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":2009}},{"source":"../../../../src/modules/image-fun-filters/edgework.js","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":2018}}],"sources":{"../../../../src/modules/image-fun-filters/edgework.js":"/** @typedef {import('../../types').ShaderPass} ShaderPass */\n\nimport {random} from '../utils/random';\n\nconst fs = `\\\nuniform float radius;\nuniform vec2 delta;\n\nvec4 edgeWork_sampleColor1(sampler2D source, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec3 sampleColor = texture2D(source, texCoord + relativeDelta * percent).rgb;\n    float average = (sampleColor.r + sampleColor.g + sampleColor.b) / 3.0;\n    color.x += average * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += average * weight;\n      total.y += weight;\n    }\n  }\n  return vec4(color / total, 0.0, 1.0);\n}\n\nvec4 edgeWork_sampleColor2(sampler2D source, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec2 sampleColor = texture2D(source, texCoord + relativeDelta * percent).xy;\n    color.x += sampleColor.x * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += sampleColor.y * weight;\n      total.y += weight;\n    }\n  }\n  float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\n  return vec4(c, c, c, 1.0);\n}\n`;\n\nconst uniforms = {\n  radius: {value: 2, min: 1, softMax: 50},\n  delta: {value: [1, 0], private: true}\n};\n\n/** @type {ShaderPass} */\nexport const edgeWork = {\n  name: 'edgeWork',\n  uniforms,\n  fs,\n  dependencies: [random],\n  passes: [\n    {\n      sampler: 'edgeWork_sampleColor1',\n      uniforms: {delta: [1, 0]}\n    },\n    {\n      sampler: 'edgeWork_sampleColor2',\n      uniforms: {delta: [0, 1]}\n    }\n  ]\n};\n"},"lineCount":null}},"error":null,"hash":"203108ad38d5ac036393e7fc6471a1db","cacheData":{"env":{}}}