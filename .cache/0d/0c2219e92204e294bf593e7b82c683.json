{"id":"PyjH","dependencies":[{"name":"/project/deck-gl-examples-01/node_modules/@loaders.gl/core/dist/esm/iterators/make-stream/make-dom-stream.js.map","includedInParent":true,"mtime":1688284130527},{"name":"/project/deck-gl-examples-01/package.json","includedInParent":true,"mtime":1688495957541},{"name":"/project/deck-gl-examples-01/node_modules/@loaders.gl/core/package.json","includedInParent":true,"mtime":1688284130527}],"generated":{"js":"\"use strict\";function e(e,t){const r=e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]();return new ReadableStream({type:\"bytes\",async pull(e){try{const{done:a,value:n}=await r.next();a?e.close():e.enqueue(new Uint8Array(n))}catch(t){e.error(t)}},async cancel(){var e;await(null==r?void 0:null===(e=r.return)||void 0===e?void 0:e.call(r))}},{highWaterMark:2**24,...t})}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.makeStream=e;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":0}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":14,"column":7},"generated":{"line":1,"column":13}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"makeStream","original":{"line":14,"column":16},"generated":{"line":1,"column":22}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"source","original":{"line":15,"column":2},"generated":{"line":1,"column":24}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"options","original":{"line":16,"column":2},"generated":{"line":1,"column":26}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":18,"column":2},"generated":{"line":1,"column":29}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"iterator","original":{"line":18,"column":8},"generated":{"line":1,"column":35}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"source","original":{"line":18,"column":19},"generated":{"line":1,"column":37}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"Symbol","original":{"line":18,"column":26},"generated":{"line":1,"column":39}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"asyncIterator","original":{"line":18,"column":33},"generated":{"line":1,"column":46}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"source","original":{"line":19,"column":7},"generated":{"line":1,"column":61}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"Symbol","original":{"line":19,"column":45},"generated":{"line":1,"column":63}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"asyncIterator","original":{"line":19,"column":52},"generated":{"line":1,"column":70}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"source","original":{"line":20,"column":7},"generated":{"line":1,"column":87}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"Symbol","original":{"line":20,"column":40},"generated":{"line":1,"column":89}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"iterator","original":{"line":20,"column":47},"generated":{"line":1,"column":96}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":22,"column":2},"generated":{"line":1,"column":108}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":22,"column":9},"generated":{"line":1,"column":115}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"ReadableStream","original":{"line":22,"column":13},"generated":{"line":1,"column":119}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":23,"column":4},"generated":{"line":1,"column":134}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"type","original":{"line":27,"column":6},"generated":{"line":1,"column":135}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":27,"column":12},"generated":{"line":1,"column":140}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":29,"column":6},"generated":{"line":1,"column":148}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"controller","original":{"line":29,"column":17},"generated":{"line":1,"column":159}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":30,"column":8},"generated":{"line":1,"column":162}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":31,"column":10},"generated":{"line":1,"column":166}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":31,"column":16},"generated":{"line":1,"column":172}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"done","original":{"line":31,"column":17},"generated":{"line":1,"column":177}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":31,"column":21},"generated":{"line":1,"column":179}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"value","original":{"line":31,"column":23},"generated":{"line":1,"column":185}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"iterator","original":{"line":31,"column":38},"generated":{"line":1,"column":194}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"next","original":{"line":31,"column":47},"generated":{"line":1,"column":196}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"done","original":{"line":32,"column":14},"generated":{"line":1,"column":203}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"controller","original":{"line":33,"column":12},"generated":{"line":1,"column":205}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"close","original":{"line":33,"column":23},"generated":{"line":1,"column":207}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"controller","original":{"line":37,"column":12},"generated":{"line":1,"column":215}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"enqueue","original":{"line":37,"column":23},"generated":{"line":1,"column":217}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":37,"column":31},"generated":{"line":1,"column":225}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"Uint8Array","original":{"line":37,"column":35},"generated":{"line":1,"column":229}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"value","original":{"line":37,"column":46},"generated":{"line":1,"column":240}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":39,"column":10},"generated":{"line":1,"column":244}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"error","original":{"line":39,"column":17},"generated":{"line":1,"column":250}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"controller","original":{"line":40,"column":10},"generated":{"line":1,"column":253}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"error","original":{"line":40,"column":21},"generated":{"line":1,"column":255}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"error","original":{"line":40,"column":27},"generated":{"line":1,"column":261}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":44,"column":6},"generated":{"line":1,"column":266}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":44,"column":21},"generated":{"line":1,"column":281}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"_iterator$return","original":{"line":44,"column":21},"generated":{"line":1,"column":285}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"iterator","original":{"line":45,"column":14},"generated":{"line":1,"column":293}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"iterator","original":{"line":45,"column":14},"generated":{"line":1,"column":299}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":45,"column":22},"generated":{"line":1,"column":306}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":45,"column":30},"generated":{"line":1,"column":308}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"_iterator$return","original":{"line":45,"column":22},"generated":{"line":1,"column":316}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"iterator","original":{"line":45,"column":14},"generated":{"line":1,"column":318}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"return","original":{"line":45,"column":24},"generated":{"line":1,"column":320}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":45,"column":30},"generated":{"line":1,"column":334}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"_iterator$return","original":{"line":45,"column":30},"generated":{"line":1,"column":338}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":45,"column":30},"generated":{"line":1,"column":345}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"_iterator$return","original":{"line":45,"column":14},"generated":{"line":1,"column":347}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"call","original":{"line":45,"column":14},"generated":{"line":1,"column":349}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"iterator","original":{"line":45,"column":14},"generated":{"line":1,"column":354}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":1,"column":360}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"highWaterMark","original":{"line":51,"column":6},"generated":{"line":1,"column":361}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":51,"column":21},"generated":{"line":1,"column":375}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":51,"column":26},"generated":{"line":1,"column":378}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":"options","original":{"line":52,"column":9},"generated":{"line":1,"column":384}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":388}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":395}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":410}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":418}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":431}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":432}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":439}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":443}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":451}},{"source":"../../../../src/iterators/make-stream/make-dom-stream.ts","name":null,"original":{"line":55,"column":0},"generated":{"line":1,"column":462}}],"sources":{"../../../../src/iterators/make-stream/make-dom-stream.ts":"export type MakeStreamOptions = {\n  /** Stream allocates an arrayBuffer. Enables use of a default reader. */\n  autoAllocateChunkSize?: number;\n  /** Total number of chunks in queue before back pressure is applied */\n  highWaterMark?: number;\n};\n\n/**\n * Builds a DOM stream from an iterator\n * This stream is currently used in browsers only,\n * but note that Web stream support is present in Node from Node 16\n * https://nodejs.org/api/webstreams.html#webstreams_web_streams_api\n */\nexport function makeStream<ArrayBuffer>(\n  source: Iterable<ArrayBuffer> | AsyncIterable<ArrayBuffer>,\n  options?: MakeStreamOptions\n): ReadableStream {\n  const iterator = source[Symbol.asyncIterator]\n    ? (source as AsyncIterable<ArrayBuffer>)[Symbol.asyncIterator]()\n    : (source as Iterable<ArrayBuffer>)[Symbol.iterator]();\n\n  return new ReadableStream<Uint8Array>(\n    {\n      // Create a byte stream (enables `Response(stream).arrayBuffer()`)\n      // Only supported on Chrome\n      // See: https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController\n      type: 'bytes',\n\n      async pull(controller) {\n        try {\n          const {done, value} = await iterator.next();\n          if (done) {\n            controller.close();\n          } else {\n            // TODO - ignores controller.desiredSize\n            // @ts-expect-error Unclear why value is not correctly typed\n            controller.enqueue(new Uint8Array(value));\n          }\n        } catch (error) {\n          controller.error(error);\n        }\n      },\n\n      async cancel() {\n        await iterator?.return?.();\n      }\n    },\n    // options: QueingStrategy<Uint8Array>\n    {\n      // This is bytes, not chunks\n      highWaterMark: 2 ** 24,\n      ...options\n    }\n  );\n}\n"},"lineCount":null}},"error":null,"hash":"7b76c134ebae5508cb70d29d0621709e","cacheData":{"env":{}}}