parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"H1SE":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,i=arguments[3];!function(i,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof t&&t.amd?t(["exports"],e):e((i="undefined"!=typeof globalThis?globalThis:i||self).leaflet={})}(this,function(t){"use strict";function i(t){var i,e,n,o;for(e=1,n=arguments.length;e<n;e++)for(i in o=arguments[e])t[i]=o[i];return t}var e=Object.create||function(){function t(){}return function(i){return t.prototype=i,new t}}();function n(t,i){var e=Array.prototype.slice;if(t.bind)return t.bind.apply(t,e.call(arguments,1));var n=e.call(arguments,2);return function(){return t.apply(i,n.length?n.concat(e.call(arguments)):arguments)}}var o=0;function s(t){return"_leaflet_id"in t||(t._leaflet_id=++o),t._leaflet_id}function r(t,i,e){var n,o,s,r;return r=function(){n=!1,o&&(s.apply(e,o),o=!1)},s=function(){n?o=arguments:(t.apply(e,arguments),setTimeout(r,i),n=!0)}}function a(t,i,e){var n=i[1],o=i[0],s=n-o;return t===n&&e?t:((t-o)%s+s)%s+o}function h(){return!1}function l(t,i){if(!1===i)return t;var e=Math.pow(10,void 0===i?6:i);return Math.round(t*e)/e}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function c(t){return u(t).split(/\s+/)}function d(t,i){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?e(t.options):{}),i)t.options[n]=i[n];return t.options}function _(t,i,e){var n=[];for(var o in t)n.push(encodeURIComponent(e?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(i&&-1!==i.indexOf("?")?"&":"?")+n.join("&")}var p=/\{ *([\w_ -]+) *\}/g;function m(t,i){return t.replace(p,function(t,e){var n=i[e];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(i)),n})}var f=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function g(t,i){for(var e=0;e<t.length;e++)if(t[e]===i)return e;return-1}var v="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function y(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var x=0;function w(t){var i=+new Date,e=Math.max(0,16-(i-x));return x=i+e,window.setTimeout(t,e)}var b=window.requestAnimationFrame||y("RequestAnimationFrame")||w,P=window.cancelAnimationFrame||y("CancelAnimationFrame")||y("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function T(t,i,e){if(!e||b!==w)return b.call(window,n(t,i));t.call(i)}function M(t){t&&P.call(window,t)}var z={__proto__:null,extend:i,create:e,bind:n,get lastId(){return o},stamp:s,throttle:r,wrapNum:a,falseFn:h,formatNum:l,trim:u,splitWords:c,setOptions:d,getParamString:_,template:m,isArray:f,indexOf:g,emptyImageUrl:v,requestFn:b,cancelFn:P,requestAnimFrame:T,cancelAnimFrame:M};function C(){}C.extend=function(t){var n=function(){d(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},o=n.__super__=this.prototype,s=e(o);for(var r in s.constructor=n,n.prototype=s,this)Object.prototype.hasOwnProperty.call(this,r)&&"prototype"!==r&&"__super__"!==r&&(n[r]=this[r]);return t.statics&&i(n,t.statics),t.includes&&(!function(t){if("undefined"==typeof L||!L||!L.Mixin)return;t=f(t)?t:[t];for(var i=0;i<t.length;i++)t[i]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}(t.includes),i.apply(null,[s].concat(t.includes))),i(s,t),delete s.statics,delete s.includes,s.options&&(s.options=o.options?e(o.options):{},i(s.options,t.options)),s._initHooks=[],s.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,i=s._initHooks.length;t<i;t++)s._initHooks[t].call(this)}},n},C.include=function(t){var e=this.prototype.options;return i(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},C.mergeOptions=function(t){return i(this.prototype.options,t),this},C.addInitHook=function(t){var i=Array.prototype.slice.call(arguments,1),e="function"==typeof t?t:function(){this[t].apply(this,i)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(e),this};var Z={on:function(t,i,e){if("object"==typeof t)for(var n in t)this._on(n,t[n],i);else for(var o=0,s=(t=c(t)).length;o<s;o++)this._on(t[o],i,e);return this},off:function(t,i,e){if(arguments.length)if("object"==typeof t)for(var n in t)this._off(n,t[n],i);else{t=c(t);for(var o=1===arguments.length,s=0,r=t.length;s<r;s++)o?this._off(t[s]):this._off(t[s],i,e)}else delete this._events;return this},_on:function(t,i,e,n){if("function"==typeof i){if(!1===this._listens(t,i,e)){e===this&&(e=void 0);var o={fn:i,ctx:e};n&&(o.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(o)}}else console.warn("wrong listener type: "+typeof i)},_off:function(t,i,e){var n,o,s;if(this._events&&(n=this._events[t]))if(1!==arguments.length)if("function"==typeof i){var r=this._listens(t,i,e);if(!1!==r){var a=n[r];this._firingCount&&(a.fn=h,this._events[t]=n=n.slice()),n.splice(r,1)}}else console.warn("wrong listener type: "+typeof i);else{if(this._firingCount)for(o=0,s=n.length;o<s;o++)n[o].fn=h;delete this._events[t]}},fire:function(t,e,n){if(!this.listens(t,n))return this;var o=i({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var s=this._events[t];if(s){this._firingCount=this._firingCount+1||1;for(var r=0,a=s.length;r<a;r++){var h=s[r],l=h.fn;h.once&&this.off(t,l,h.ctx),l.call(h.ctx||this,o)}this._firingCount--}}return n&&this._propagateEvent(o),this},listens:function(t,i,e,n){"string"!=typeof t&&console.warn('"string" type argument expected');var o=i;"function"!=typeof i&&(n=!!i,o=void 0,e=void 0);var s=this._events&&this._events[t];if(s&&s.length&&!1!==this._listens(t,o,e))return!0;if(n)for(var r in this._eventParents)if(this._eventParents[r].listens(t,i,e,n))return!0;return!1},_listens:function(t,i,e){if(!this._events)return!1;var n=this._events[t]||[];if(!i)return!!n.length;e===this&&(e=void 0);for(var o=0,s=n.length;o<s;o++)if(n[o].fn===i&&n[o].ctx===e)return o;return!1},once:function(t,i,e){if("object"==typeof t)for(var n in t)this._on(n,t[n],i,!0);else for(var o=0,s=(t=c(t)).length;o<s;o++)this._on(t[o],i,e,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[s(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[s(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,i({layer:t.target,propagatedFrom:t.target},t),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var S=C.extend(Z);function E(t,i,e){this.x=e?Math.round(t):t,this.y=e?Math.round(i):i}var k=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function O(t,i,e){return t instanceof E?t:f(t)?new E(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new E(t.x,t.y):new E(t,i,e)}function A(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function B(t,i){return!t||t instanceof A?t:new A(t,i)}function I(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function R(t,i){return t instanceof I?t:new I(t,i)}function N(t,i,e){if(isNaN(t)||isNaN(i))throw new Error("Invalid LatLng object: ("+t+", "+i+")");this.lat=+t,this.lng=+i,void 0!==e&&(this.alt=+e)}function D(t,i,e){return t instanceof N?t:f(t)&&"object"!=typeof t[0]?3===t.length?new N(t[0],t[1],t[2]):2===t.length?new N(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new N(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===i?null:new N(t,i,e)}E.prototype={clone:function(){return new E(this.x,this.y)},add:function(t){return this.clone()._add(O(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(O(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new E(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new E(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=k(this.x),this.y=k(this.y),this},distanceTo:function(t){var i=(t=O(t)).x-this.x,e=t.y-this.y;return Math.sqrt(i*i+e*e)},equals:function(t){return(t=O(t)).x===this.x&&t.y===this.y},contains:function(t){return t=O(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+l(this.x)+", "+l(this.y)+")"}},A.prototype={extend:function(t){var i,e;if(!t)return this;if(t instanceof E||"number"==typeof t[0]||"x"in t)i=e=O(t);else if(i=(t=B(t)).min,e=t.max,!i||!e)return this;return this.min||this.max?(this.min.x=Math.min(i.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(i.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=i.clone(),this.max=e.clone()),this},getCenter:function(t){return O((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return O(this.min.x,this.max.y)},getTopRight:function(){return O(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var i,e;return(t="number"==typeof t[0]||t instanceof E?O(t):B(t))instanceof A?(i=t.min,e=t.max):i=e=t,i.x>=this.min.x&&e.x<=this.max.x&&i.y>=this.min.y&&e.y<=this.max.y},intersects:function(t){t=B(t);var i=this.min,e=this.max,n=t.min,o=t.max,s=o.x>=i.x&&n.x<=e.x,r=o.y>=i.y&&n.y<=e.y;return s&&r},overlaps:function(t){t=B(t);var i=this.min,e=this.max,n=t.min,o=t.max,s=o.x>i.x&&n.x<e.x,r=o.y>i.y&&n.y<e.y;return s&&r},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var i=this.min,e=this.max,n=Math.abs(i.x-e.x)*t,o=Math.abs(i.y-e.y)*t;return B(O(i.x-n,i.y-o),O(e.x+n,e.y+o))},equals:function(t){return!!t&&(t=B(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},I.prototype={extend:function(t){var i,e,n=this._southWest,o=this._northEast;if(t instanceof N)i=t,e=t;else{if(!(t instanceof I))return t?this.extend(D(t)||R(t)):this;if(i=t._southWest,e=t._northEast,!i||!e)return this}return n||o?(n.lat=Math.min(i.lat,n.lat),n.lng=Math.min(i.lng,n.lng),o.lat=Math.max(e.lat,o.lat),o.lng=Math.max(e.lng,o.lng)):(this._southWest=new N(i.lat,i.lng),this._northEast=new N(e.lat,e.lng)),this},pad:function(t){var i=this._southWest,e=this._northEast,n=Math.abs(i.lat-e.lat)*t,o=Math.abs(i.lng-e.lng)*t;return new I(new N(i.lat-n,i.lng-o),new N(e.lat+n,e.lng+o))},getCenter:function(){return new N((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new N(this.getNorth(),this.getWest())},getSouthEast:function(){return new N(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof N||"lat"in t?D(t):R(t);var i,e,n=this._southWest,o=this._northEast;return t instanceof I?(i=t.getSouthWest(),e=t.getNorthEast()):i=e=t,i.lat>=n.lat&&e.lat<=o.lat&&i.lng>=n.lng&&e.lng<=o.lng},intersects:function(t){t=R(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>=i.lat&&n.lat<=e.lat,r=o.lng>=i.lng&&n.lng<=e.lng;return s&&r},overlaps:function(t){t=R(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>i.lat&&n.lat<e.lat,r=o.lng>i.lng&&n.lng<e.lng;return s&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,i){return!!t&&(t=R(t),this._southWest.equals(t.getSouthWest(),i)&&this._northEast.equals(t.getNorthEast(),i))},isValid:function(){return!(!this._southWest||!this._northEast)}},N.prototype={equals:function(t,i){return!!t&&(t=D(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===i?1e-9:i))},toString:function(t){return"LatLng("+l(this.lat,t)+", "+l(this.lng,t)+")"},distanceTo:function(t){return W.distance(this,D(t))},wrap:function(){return W.wrapLatLng(this)},toBounds:function(t){var i=180*t/40075017,e=i/Math.cos(Math.PI/180*this.lat);return R([this.lat-i,this.lng-e],[this.lat+i,this.lng+e])},clone:function(){return new N(this.lat,this.lng,this.alt)}};var j,H={latLngToPoint:function(t,i){var e=this.projection.project(t),n=this.scale(i);return this.transformation._transform(e,n)},pointToLatLng:function(t,i){var e=this.scale(i),n=this.transformation.untransform(t,e);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var i=this.projection.bounds,e=this.scale(t);return new A(this.transformation.transform(i.min,e),this.transformation.transform(i.max,e))},infinite:!1,wrapLatLng:function(t){var i=this.wrapLng?a(t.lng,this.wrapLng,!0):t.lng;return new N(this.wrapLat?a(t.lat,this.wrapLat,!0):t.lat,i,t.alt)},wrapLatLngBounds:function(t){var i=t.getCenter(),e=this.wrapLatLng(i),n=i.lat-e.lat,o=i.lng-e.lng;if(0===n&&0===o)return t;var s=t.getSouthWest(),r=t.getNorthEast();return new I(new N(s.lat-n,s.lng-o),new N(r.lat-n,r.lng-o))}},W=i({},H,{wrapLng:[-180,180],R:6371e3,distance:function(t,i){var e=Math.PI/180,n=t.lat*e,o=i.lat*e,s=Math.sin((i.lat-t.lat)*e/2),r=Math.sin((i.lng-t.lng)*e/2),a=s*s+Math.cos(n)*Math.cos(o)*r*r,h=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*h}}),F={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var i=Math.PI/180,e=this.MAX_LATITUDE,n=Math.max(Math.min(e,t.lat),-e),o=Math.sin(n*i);return new E(this.R*t.lng*i,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var i=180/Math.PI;return new N((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*i,t.x*i/this.R)},bounds:(j=6378137*Math.PI,new A([-j,-j],[j,j]))};function U(t,i,e,n){if(f(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=i,this._c=e,this._d=n}function V(t,i,e,n){return new U(t,i,e,n)}U.prototype={transform:function(t,i){return this._transform(t.clone(),i)},_transform:function(t,i){return i=i||1,t.x=i*(this._a*t.x+this._b),t.y=i*(this._c*t.y+this._d),t},untransform:function(t,i){return i=i||1,new E((t.x/i-this._b)/this._a,(t.y/i-this._d)/this._c)}};var q=i({},W,{code:"EPSG:3857",projection:F,transformation:function(){var t=.5/(Math.PI*F.R);return V(t,.5,-t,.5)}()}),G=i({},q,{code:"EPSG:900913"});function K(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Y(t,i){var e,n,o,s,r,a,h="";for(e=0,o=t.length;e<o;e++){for(n=0,s=(r=t[e]).length;n<s;n++)h+=(n?"L":"M")+(a=r[n]).x+" "+a.y;h+=i?kt.svg?"z":"x":""}return h||"M0 0"}var X,J=document.documentElement.style,$="ActiveXObject"in window,Q=$&&!document.addEventListener,tt="msLaunchUri"in navigator&&!("documentMode"in document),it=Et("webkit"),et=Et("android"),nt=Et("android 2")||Et("android 3"),ot=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),st=et&&Et("Google")&&ot<537&&!("AudioNode"in window),rt=!!window.opera,at=!tt&&Et("chrome"),ht=Et("gecko")&&!it&&!rt&&!$,lt=!at&&Et("safari"),ut=Et("phantom"),ct="OTransition"in J,dt=0===navigator.platform.indexOf("Win"),_t=$&&"transition"in J,pt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!nt,mt="MozPerspective"in J,ft=!window.L_DISABLE_3D&&(_t||pt||mt)&&!ct&&!ut,gt="undefined"!=typeof orientation||Et("mobile"),vt=gt&&it,yt=gt&&pt,xt=!window.PointerEvent&&window.MSPointerEvent,wt=!(!window.PointerEvent&&!xt),bt="ontouchstart"in window||!!window.TouchEvent,Pt=!window.L_NO_TOUCH&&(bt||wt),Lt=gt&&rt,Tt=gt&&ht,Mt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,zt=function(){var t=!1;try{var i=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",h,i),window.removeEventListener("testPassiveEventSupport",h,i)}catch(e){}return t}(),Ct=!!document.createElement("canvas").getContext,Zt=!(!document.createElementNS||!K("svg").createSVGRect),St=!!Zt&&((X=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(X.firstChild&&X.firstChild.namespaceURI));function Et(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var kt={ie:$,ielt9:Q,edge:tt,webkit:it,android:et,android23:nt,androidStock:st,opera:rt,chrome:at,gecko:ht,safari:lt,phantom:ut,opera12:ct,win:dt,ie3d:_t,webkit3d:pt,gecko3d:mt,any3d:ft,mobile:gt,mobileWebkit:vt,mobileWebkit3d:yt,msPointer:xt,pointer:wt,touch:Pt,touchNative:bt,mobileOpera:Lt,mobileGecko:Tt,retina:Mt,passiveEvents:zt,canvas:Ct,svg:Zt,vml:!Zt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(e){return!1}}(),inlineSvg:St,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},Ot=kt.msPointer?"MSPointerDown":"pointerdown",At=kt.msPointer?"MSPointerMove":"pointermove",Bt=kt.msPointer?"MSPointerUp":"pointerup",It=kt.msPointer?"MSPointerCancel":"pointercancel",Rt={touchstart:Ot,touchmove:At,touchend:Bt,touchcancel:It},Nt={touchstart:function(t,i){i.MSPOINTER_TYPE_TOUCH&&i.pointerType===i.MSPOINTER_TYPE_TOUCH&&Ii(i);Vt(t,i)},touchmove:Vt,touchend:Vt,touchcancel:Vt},Dt={},jt=!1;function Ht(t,i,e){return"touchstart"===i&&(jt||(document.addEventListener(Ot,Wt,!0),document.addEventListener(At,Ft,!0),document.addEventListener(Bt,Ut,!0),document.addEventListener(It,Ut,!0),jt=!0)),Nt[i]?(e=Nt[i].bind(this,e),t.addEventListener(Rt[i],e,!1),e):(console.warn("wrong event specified:",i),h)}function Wt(t){Dt[t.pointerId]=t}function Ft(t){Dt[t.pointerId]&&(Dt[t.pointerId]=t)}function Ut(t){delete Dt[t.pointerId]}function Vt(t,i){if(i.pointerType!==(i.MSPOINTER_TYPE_MOUSE||"mouse")){for(var e in i.touches=[],Dt)i.touches.push(Dt[e]);i.changedTouches=[i],t(i)}}var qt=200;var Gt,Kt,Yt,Xt,Jt,$t=pi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qt=pi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ti="webkitTransition"===Qt||"OTransition"===Qt?Qt+"End":"transitionend";function ii(t){return"string"==typeof t?document.getElementById(t):t}function ei(t,i){var e=t.style[i]||t.currentStyle&&t.currentStyle[i];if((!e||"auto"===e)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);e=n?n[i]:null}return"auto"===e?null:e}function ni(t,i,e){var n=document.createElement(t);return n.className=i||"",e&&e.appendChild(n),n}function oi(t){var i=t.parentNode;i&&i.removeChild(t)}function si(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ri(t){var i=t.parentNode;i&&i.lastChild!==t&&i.appendChild(t)}function ai(t){var i=t.parentNode;i&&i.firstChild!==t&&i.insertBefore(t,i.firstChild)}function hi(t,i){if(void 0!==t.classList)return t.classList.contains(i);var e=di(t);return e.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(e)}function li(t,i){if(void 0!==t.classList)for(var e=c(i),n=0,o=e.length;n<o;n++)t.classList.add(e[n]);else if(!hi(t,i)){var s=di(t);ci(t,(s?s+" ":"")+i)}}function ui(t,i){void 0!==t.classList?t.classList.remove(i):ci(t,u((" "+di(t)+" ").replace(" "+i+" "," ")))}function ci(t,i){void 0===t.className.baseVal?t.className=i:t.className.baseVal=i}function di(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function _i(t,i){"opacity"in t.style?t.style.opacity=i:"filter"in t.style&&function(t,i){var e=!1,n="DXImageTransform.Microsoft.Alpha";try{e=t.filters.item(n)}catch(o){if(1===i)return}i=Math.round(100*i),e?(e.Enabled=100!==i,e.Opacity=i):t.style.filter+=" progid:"+n+"(opacity="+i+")"}(t,i)}function pi(t){for(var i=document.documentElement.style,e=0;e<t.length;e++)if(t[e]in i)return t[e];return!1}function mi(t,i,e){var n=i||new E(0,0);t.style[$t]=(kt.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(e?" scale("+e+")":"")}function fi(t,i){t._leaflet_pos=i,kt.any3d?mi(t,i):(t.style.left=i.x+"px",t.style.top=i.y+"px")}function gi(t){return t._leaflet_pos||new E(0,0)}if("onselectstart"in document)Gt=function(){Mi(window,"selectstart",Ii)},Kt=function(){Ci(window,"selectstart",Ii)};else{var vi=pi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Gt=function(){if(vi){var t=document.documentElement.style;Yt=t[vi],t[vi]="none"}},Kt=function(){vi&&(document.documentElement.style[vi]=Yt,Yt=void 0)}}function yi(){Mi(window,"dragstart",Ii)}function xi(){Ci(window,"dragstart",Ii)}function wi(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(bi(),Xt=t,Jt=t.style.outlineStyle,t.style.outlineStyle="none",Mi(window,"keydown",bi))}function bi(){Xt&&(Xt.style.outlineStyle=Jt,Xt=void 0,Jt=void 0,Ci(window,"keydown",bi))}function Pi(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Li(t){var i=t.getBoundingClientRect();return{x:i.width/t.offsetWidth||1,y:i.height/t.offsetHeight||1,boundingClientRect:i}}var Ti={__proto__:null,TRANSFORM:$t,TRANSITION:Qt,TRANSITION_END:ti,get:ii,getStyle:ei,create:ni,remove:oi,empty:si,toFront:ri,toBack:ai,hasClass:hi,addClass:li,removeClass:ui,setClass:ci,getClass:di,setOpacity:_i,testProp:pi,setTransform:mi,setPosition:fi,getPosition:gi,get disableTextSelection(){return Gt},get enableTextSelection(){return Kt},disableImageDrag:yi,enableImageDrag:xi,preventOutline:wi,restoreOutline:bi,getSizedParentNode:Pi,getScale:Li};function Mi(t,i,e,n){if(i&&"object"==typeof i)for(var o in i)Ei(t,o,i[o],e);else for(var s=0,r=(i=c(i)).length;s<r;s++)Ei(t,i[s],e,n);return this}var zi="_leaflet_events";function Ci(t,i,e,n){if(1===arguments.length)Zi(t),delete t[zi];else if(i&&"object"==typeof i)for(var o in i)ki(t,o,i[o],e);else if(i=c(i),2===arguments.length)Zi(t,function(t){return-1!==g(i,t)});else for(var s=0,r=i.length;s<r;s++)ki(t,i[s],e,n);return this}function Zi(t,i){for(var e in t[zi]){var n=e.split(/\d/)[0];i&&!i(n)||ki(t,n,null,null,e)}}var Si={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ei(t,i,e,n){var o=i+s(e)+(n?"_"+s(n):"");if(t[zi]&&t[zi][o])return this;var r=function(i){return e.call(n||t,i||window.event)},a=r;!kt.touchNative&&kt.pointer&&0===i.indexOf("touch")?r=Ht(t,i,r):kt.touch&&"dblclick"===i?r=function(t,i){t.addEventListener("dblclick",i);var e,n=0;function o(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var o=Ni(t);if(!o.some(function(t){return t instanceof HTMLLabelElement&&t.attributes.for})||o.some(function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement})){var s=Date.now();s-n<=qt?2==++e&&i(function(t){var i,e,n={};for(e in t)i=t[e],n[e]=i&&i.bind?i.bind(t):i;return t=n,n.type="dblclick",n.detail=2,n.isTrusted=!1,n._simulated=!0,n}(t)):e=1,n=s}}}else e=t.detail}return t.addEventListener("click",o),{dblclick:i,simDblclick:o}}(t,r):"addEventListener"in t?"touchstart"===i||"touchmove"===i||"wheel"===i||"mousewheel"===i?t.addEventListener(Si[i]||i,r,!!kt.passiveEvents&&{passive:!1}):"mouseenter"===i||"mouseleave"===i?(r=function(i){i=i||window.event,Wi(t,i)&&a(i)},t.addEventListener(Si[i],r,!1)):t.addEventListener(i,a,!1):t.attachEvent("on"+i,r),t[zi]=t[zi]||{},t[zi][o]=r}function ki(t,i,e,n,o){o=o||i+s(e)+(n?"_"+s(n):"");var r=t[zi]&&t[zi][o];if(!r)return this;!kt.touchNative&&kt.pointer&&0===i.indexOf("touch")?function(t,i,e){Rt[i]?t.removeEventListener(Rt[i],e,!1):console.warn("wrong event specified:",i)}(t,i,r):kt.touch&&"dblclick"===i?function(t,i){t.removeEventListener("dblclick",i.dblclick),t.removeEventListener("click",i.simDblclick)}(t,r):"removeEventListener"in t?t.removeEventListener(Si[i]||i,r,!1):t.detachEvent("on"+i,r),t[zi][o]=null}function Oi(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Ai(t){return Ei(t,"wheel",Oi),this}function Bi(t){return Mi(t,"mousedown touchstart dblclick contextmenu",Oi),t._leaflet_disable_click=!0,this}function Ii(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ri(t){return Ii(t),Oi(t),this}function Ni(t){if(t.composedPath)return t.composedPath();for(var i=[],e=t.target;e;)i.push(e),e=e.parentNode;return i}function Di(t,i){if(!i)return new E(t.clientX,t.clientY);var e=Li(i),n=e.boundingClientRect;return new E((t.clientX-n.left)/e.x-i.clientLeft,(t.clientY-n.top)/e.y-i.clientTop)}var ji=kt.linux&&kt.chrome?window.devicePixelRatio:kt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Hi(t){return kt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/ji:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function Wi(t,i){var e=i.relatedTarget;if(!e)return!0;try{for(;e&&e!==t;)e=e.parentNode}catch(n){return!1}return e!==t}var Fi={__proto__:null,on:Mi,off:Ci,stopPropagation:Oi,disableScrollPropagation:Ai,disableClickPropagation:Bi,preventDefault:Ii,stop:Ri,getPropagationPath:Ni,getMousePosition:Di,getWheelDelta:Hi,isExternalTarget:Wi,addListener:Mi,removeListener:Ci},Ui=S.extend({run:function(t,i,e,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=e||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=gi(t),this._offset=i.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=T(this._animate,this),this._step()},_step:function(t){var i=+new Date-this._startTime,e=1e3*this._duration;i<e?this._runFrame(this._easeOut(i/e),t):(this._runFrame(1),this._complete())},_runFrame:function(t,i){var e=this._startPos.add(this._offset.multiplyBy(t));i&&e._round(),fi(this._el,e),this.fire("step")},_complete:function(){M(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Vi=S.extend({options:{crs:q,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,i){i=d(this,i),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=n(this._onResize,this),this._initEvents(),i.maxBounds&&this.setMaxBounds(i.maxBounds),void 0!==i.zoom&&(this._zoom=this._limitZoom(i.zoom)),i.center&&void 0!==i.zoom&&this.setView(D(i.center),i.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qt&&kt.any3d&&!kt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Mi(this._proxy,ti,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){if((e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(D(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n)&&(void 0!==n.animate&&(n.zoom=i({animate:n.animate},n.zoom),n.pan=i({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e,n.pan&&n.pan.noMoveStart),this},setZoom:function(t,i){return this._loaded?this.setView(this.getCenter(),t,{zoom:i}):(this._zoom=t,this)},zoomIn:function(t,i){return t=t||(kt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,i)},zoomOut:function(t,i){return t=t||(kt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,i)},setZoomAround:function(t,i,e){var n=this.getZoomScale(i),o=this.getSize().divideBy(2),s=(t instanceof E?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),r=this.containerPointToLatLng(o.add(s));return this.setView(r,i,{zoom:e})},_getBoundsCenterZoom:function(t,i){i=i||{},t=t.getBounds?t.getBounds():R(t);var e=O(i.paddingTopLeft||i.padding||[0,0]),n=O(i.paddingBottomRight||i.padding||[0,0]),o=this.getBoundsZoom(t,!1,e.add(n));if((o="number"==typeof i.maxZoom?Math.min(i.maxZoom,o):o)===1/0)return{center:t.getCenter(),zoom:o};var s=n.subtract(e).divideBy(2),r=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o);return{center:this.unproject(r.add(a).divideBy(2).add(s),o),zoom:o}},fitBounds:function(t,i){if(!(t=R(t)).isValid())throw new Error("Bounds are not valid.");var e=this._getBoundsCenterZoom(t,i);return this.setView(e.center,e.zoom,i)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,i){return this.setView(t,this._zoom,{pan:i})},panBy:function(t,i){if(i=i||{},!(t=O(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==i.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ui,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.noMoveStart||this.fire("movestart"),!1!==i.animate){li(this._mapPane,"leaflet-pan-anim");var e=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,e,i.duration||.25,i.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,i,e){if(!1===(e=e||{}).animate||!kt.any3d)return this.setView(t,i,e);this._stop();var n=this.project(this.getCenter()),o=this.project(t),s=this.getSize(),r=this._zoom;t=D(t),i=void 0===i?r:i;var a=Math.max(s.x,s.y),h=a*this.getZoomScale(r,i),l=o.distanceTo(n)||1,u=1.42,c=u*u;function d(t){var i=(h*h-a*a+(t?-1:1)*c*c*l*l)/(2*(t?h:a)*c*l),e=Math.sqrt(i*i+1)-i;return e<1e-9?-18:Math.log(e)}function _(t){return(Math.exp(t)-Math.exp(-t))/2}function p(t){return(Math.exp(t)+Math.exp(-t))/2}var m=d(0);function f(t){return a*(p(m)*(_(i=m+u*t)/p(i))-_(m))/c;var i}var g=Date.now(),v=(d(1)-m)/u,y=e.duration?1e3*e.duration:1e3*v*.8;return this._moveStart(!0,e.noMoveStart),function e(){var s=(Date.now()-g)/y,h=function(t){return 1-Math.pow(1-t,1.5)}(s)*v;s<=1?(this._flyToFrame=T(e,this),this._move(this.unproject(n.add(o.subtract(n).multiplyBy(f(h)/l)),r),this.getScaleZoom(a/function(t){return a*(p(m)/p(m+u*t))}(h),r),{flyTo:!0})):this._move(t,i)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,i){var e=this._getBoundsCenterZoom(t,i);return this.flyTo(e.center,e.zoom,i)},setMaxBounds:function(t){return t=R(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var i=this.options.minZoom;return this.options.minZoom=t,this._loaded&&i!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var i=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&i!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,i){this._enforcingBounds=!0;var e=this.getCenter(),n=this._limitCenter(e,this._zoom,R(t));return e.equals(n)||this.panTo(n,i),this._enforcingBounds=!1,this},panInside:function(t,i){var e=O((i=i||{}).paddingTopLeft||i.padding||[0,0]),n=O(i.paddingBottomRight||i.padding||[0,0]),o=this.project(this.getCenter()),s=this.project(t),r=this.getPixelBounds(),a=B([r.min.add(e),r.max.subtract(n)]),h=a.getSize();if(!a.contains(s)){this._enforcingBounds=!0;var l=s.subtract(a.getCenter()),u=a.extend(s).getSize().subtract(h);o.x+=l.x<0?-u.x:u.x,o.y+=l.y<0?-u.y:u.y,this.panTo(this.unproject(o),i),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=i({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var o=this.getSize(),s=e.divideBy(2).round(),r=o.divideBy(2).round(),a=s.subtract(r);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(n(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:o})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=i({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=n(this._handleGeolocationResponse,this),o=n(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,o,t):navigator.geolocation.getCurrentPosition(e,o,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var i=t.code,e=t.message||(1===i?"permission denied":2===i?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:i,message:"Geolocation error: "+e+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var i=new N(t.coords.latitude,t.coords.longitude),e=i.toBounds(2*t.coords.accuracy),n=this._locateOptions;if(n.setView){var o=this.getBoundsZoom(e);this.setView(i,n.maxZoom?Math.min(o,n.maxZoom):o)}var s={latlng:i,bounds:e,timestamp:t.timestamp};for(var r in t.coords)"number"==typeof t.coords[r]&&(s[r]=t.coords[r]);this.fire("locationfound",s)}},addHandler:function(t,i){if(!i)return this;var e=this[t]=new i(this);return this._handlers.push(e),this.options[t]&&e.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(i){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),oi(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(M(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)oi(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,i){var e=ni("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),i||this._mapPane);return t&&(this._panes[t]=e),e},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new I(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,i,e){t=R(t),e=O(e||[0,0]);var n=this.getZoom()||0,o=this.getMinZoom(),s=this.getMaxZoom(),r=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(e),l=B(this.project(a,n),this.project(r,n)).getSize(),u=kt.any3d?this.options.zoomSnap:1,c=h.x/l.x,d=h.y/l.y,_=i?Math.max(c,d):Math.min(c,d);return n=this.getScaleZoom(_,n),u&&(n=Math.round(n/(u/100))*(u/100),n=i?Math.ceil(n/u)*u:Math.floor(n/u)*u),Math.max(o,Math.min(s,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new E(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,i){var e=this._getTopLeftPoint(t,i);return new A(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,i){var e=this.options.crs;return i=void 0===i?this._zoom:i,e.scale(t)/e.scale(i)},getScaleZoom:function(t,i){var e=this.options.crs;i=void 0===i?this._zoom:i;var n=e.zoom(t*e.scale(i));return isNaN(n)?1/0:n},project:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.latLngToPoint(D(t),i)},unproject:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.pointToLatLng(O(t),i)},layerPointToLatLng:function(t){var i=O(t).add(this.getPixelOrigin());return this.unproject(i)},latLngToLayerPoint:function(t){return this.project(D(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(D(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(R(t))},distance:function(t,i){return this.options.crs.distance(D(t),D(i))},containerPointToLayerPoint:function(t){return O(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return O(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var i=this.containerPointToLayerPoint(O(t));return this.layerPointToLatLng(i)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(D(t)))},mouseEventToContainerPoint:function(t){return Di(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var i=this._container=ii(t);if(!i)throw new Error("Map container not found.");if(i._leaflet_id)throw new Error("Map container is already initialized.");Mi(i,"scroll",this._onScroll,this),this._containerId=s(i)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&kt.any3d,li(t,"leaflet-container"+(kt.touch?" leaflet-touch":"")+(kt.retina?" leaflet-retina":"")+(kt.ielt9?" leaflet-oldie":"")+(kt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var i=ei(t,"position");"absolute"!==i&&"relative"!==i&&"fixed"!==i&&"sticky"!==i&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),fi(this._mapPane,new E(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(li(t.markerPane,"leaflet-zoom-hide"),li(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,i,e){fi(this._mapPane,new E(0,0));var n=!this._loaded;this._loaded=!0,i=this._limitZoom(i),this.fire("viewprereset");var o=this._zoom!==i;this._moveStart(o,e)._move(t,i)._moveEnd(o),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,i){return t&&this.fire("zoomstart"),i||this.fire("movestart"),this},_move:function(t,i,e,n){void 0===i&&(i=this._zoom);var o=this._zoom!==i;return this._zoom=i,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),n?e&&e.pinch&&this.fire("zoom",e):((o||e&&e.pinch)&&this.fire("zoom",e),this.fire("move",e)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return M(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){fi(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[s(this._container)]=this;var i=t?Ci:Mi;i(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&i(window,"resize",this._onResize,this),kt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){M(this._resizeRequest),this._resizeRequest=T(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,i){for(var e,n=[],o="mouseout"===i||"mouseover"===i,r=t.target||t.srcElement,a=!1;r;){if((e=this._targets[s(r)])&&("click"===i||"preclick"===i)&&this._draggableMoved(e)){a=!0;break}if(e&&e.listens(i,!0)){if(o&&!Wi(r,t))break;if(n.push(e),o)break}if(r===this._container)break;r=r.parentNode}return n.length||a||o||!this.listens(i,!0)||(n=[this]),n},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var i=t.target||t.srcElement;if(!(!this._loaded||i._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(i))){var e=t.type;"mousedown"===e&&wi(i),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,n){if("click"===t.type){var o=i({},t);o.type="preclick",this._fireDOMEvent(o,o.type,n)}var s=this._findEventTargets(t,e);if(n){for(var r=[],a=0;a<n.length;a++)n[a].listens(e,!0)&&r.push(n[a]);s=r.concat(s)}if(s.length){"contextmenu"===e&&Ii(t);var h=s[0],l={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var u=h.getLatLng&&(!h._radius||h._radius<=10);l.containerPoint=u?this.latLngToContainerPoint(h.getLatLng()):this.mouseEventToContainerPoint(t),l.layerPoint=this.containerPointToLayerPoint(l.containerPoint),l.latlng=u?h.getLatLng():this.layerPointToLatLng(l.layerPoint)}for(a=0;a<s.length;a++)if(s[a].fire(e,l,!0),l.originalEvent._stopped||!1===s[a].options.bubblingMouseEvents&&-1!==g(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,i=this._handlers.length;t<i;t++)this._handlers[t].disable()},whenReady:function(t,i){return this._loaded?t.call(i||this,{target:this}):this.on("load",t,i),this},_getMapPanePos:function(){return gi(this._mapPane)||new E(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,i){return(t&&void 0!==i?this._getNewPixelOrigin(t,i):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,i){var e=this.getSize()._divideBy(2);return this.project(t,i)._subtract(e)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,i,e){var n=this._getNewPixelOrigin(e,i);return this.project(t,i)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,i,e){var n=this._getNewPixelOrigin(e,i);return B([this.project(t.getSouthWest(),i)._subtract(n),this.project(t.getNorthWest(),i)._subtract(n),this.project(t.getSouthEast(),i)._subtract(n),this.project(t.getNorthEast(),i)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,i,e){if(!e)return t;var n=this.project(t,i),o=this.getSize().divideBy(2),s=new A(n.subtract(o),n.add(o)),r=this._getBoundsOffset(s,e,i);return Math.abs(r.x)<=1&&Math.abs(r.y)<=1?t:this.unproject(n.add(r),i)},_limitOffset:function(t,i){if(!i)return t;var e=this.getPixelBounds(),n=new A(e.min.add(t),e.max.add(t));return t.add(this._getBoundsOffset(n,i))},_getBoundsOffset:function(t,i,e){var n=B(this.project(i.getNorthEast(),e),this.project(i.getSouthWest(),e)),o=n.min.subtract(t.min),s=n.max.subtract(t.max);return new E(this._rebound(o.x,-s.x),this._rebound(o.y,-s.y))},_rebound:function(t,i){return t+i>0?Math.round(t-i)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(i))},_limitZoom:function(t){var i=this.getMinZoom(),e=this.getMaxZoom(),n=kt.any3d?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(i,Math.min(e,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ui(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,i){var e=this._getCenterOffset(t)._trunc();return!(!0!==(i&&i.animate)&&!this.getSize().contains(e))&&(this.panBy(e,i),!0)},_createAnimProxy:function(){var t=this._proxy=ni("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var i=$t,e=this._proxy.style[i];mi(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),e===this._proxy.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){oi(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),i=this.getZoom();mi(this._proxy,this.project(t,i),this.getZoomScale(i,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,i,e){if(this._animatingZoom)return!0;if(e=e||{},!this._zoomAnimated||!1===e.animate||this._nothingToAnimate()||Math.abs(i-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(i),o=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==e.animate&&!this.getSize().contains(o))&&(T(function(){this._moveStart(!0,e.noMoveStart||!1)._animateZoom(t,i,!0)},this),!0)},_animateZoom:function(t,i,e,o){this._mapPane&&(e&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=i,li(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:i,noUpdate:o}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(n(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ui(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});var qi=C.extend({options:{position:"topright"},initialize:function(t){d(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var i=this._map;return i&&i.removeControl(this),this.options.position=t,i&&i.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var i=this._container=this.onAdd(t),e=this.getPosition(),n=t._controlCorners[e];return li(i,"leaflet-control"),-1!==e.indexOf("bottom")?n.insertBefore(i,n.firstChild):n.appendChild(i),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(oi(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Gi=function(t){return new qi(t)};Vi.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},i="leaflet-",e=this._controlContainer=ni("div",i+"control-container",this._container);function n(n,o){var s=i+n+" "+i+o;t[n+o]=ni("div",s,e)}n("top","left"),n("top","right"),n("bottom","left"),n("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)oi(this._controlCorners[t]);oi(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ki=qi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,i,e,n){return e<n?-1:n<e?1:0}},initialize:function(t,i,e){for(var n in d(this,e),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,t)this._addLayer(t[n],n);for(n in i)this._addLayer(i[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return qi.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,i){return this._addLayer(t,i),this._map?this._update():this},addOverlay:function(t,i){return this._addLayer(t,i,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var i=this._getLayer(s(t));return i&&this._layers.splice(this._layers.indexOf(i),1),this._map?this._update():this},expand:function(){li(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(li(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ui(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ui(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",i=this._container=ni("div",t),e=this.options.collapsed;i.setAttribute("aria-haspopup",!0),Bi(i),Ai(i);var n=this._section=ni("section",t+"-list");e&&(this._map.on("click",this.collapse,this),Mi(i,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var o=this._layersLink=ni("a",t+"-toggle",i);o.href="#",o.title="Layers",o.setAttribute("role","button"),Mi(o,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){Ii(t),this._expandSafely()}},this),e||this.expand(),this._baseLayersList=ni("div",t+"-base",n),this._separator=ni("div",t+"-separator",n),this._overlaysList=ni("div",t+"-overlays",n),i.appendChild(n)},_getLayer:function(t){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&s(this._layers[i].layer)===t)return this._layers[i]},_addLayer:function(t,i,e){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:i,overlay:e}),this.options.sortLayers&&this._layers.sort(n(function(t,i){return this.options.sortFunction(t.layer,i.layer,t.name,i.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;si(this._baseLayersList),si(this._overlaysList),this._layerControlInputs=[];var t,i,e,n,o=0;for(e=0;e<this._layers.length;e++)n=this._layers[e],this._addItem(n),i=i||n.overlay,t=t||!n.overlay,o+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&o>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=i&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var i=this._getLayer(s(t.target)),e=i.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;e&&this._map.fire(e,i)},_createRadioElement:function(t,i){var e='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=e,n.firstChild},_addItem:function(t){var i,e=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((i=document.createElement("input")).type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=n):i=this._createRadioElement("leaflet-base-layers_"+s(this),n),this._layerControlInputs.push(i),i.layerId=s(t.layer),Mi(i,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var r=document.createElement("span");return e.appendChild(r),r.appendChild(i),r.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){if(!this._preventClick){var t,i,e=this._layerControlInputs,n=[],o=[];this._handlingClick=!0;for(var s=e.length-1;s>=0;s--)t=e[s],i=this._getLayer(t.layerId).layer,t.checked?n.push(i):t.checked||o.push(i);for(s=0;s<o.length;s++)this._map.hasLayer(o[s])&&this._map.removeLayer(o[s]);for(s=0;s<n.length;s++)this._map.hasLayer(n[s])||this._map.addLayer(n[s]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t,i,e=this._layerControlInputs,n=this._map.getZoom(),o=e.length-1;o>=0;o--)t=e[o],i=this._getLayer(t.layerId).layer,t.disabled=void 0!==i.options.minZoom&&n<i.options.minZoom||void 0!==i.options.maxZoom&&n>i.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Mi(t,"click",Ii),this.expand();var i=this;setTimeout(function(){Ci(t,"click",Ii),i._preventClick=!1})}}),Yi=qi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var i="leaflet-control-zoom",e=ni("div",i+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,i+"-in",e,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,i+"-out",e,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),e},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,i,e,n,o){var s=ni("a",e,n);return s.innerHTML=t,s.href="#",s.title=i,s.setAttribute("role","button"),s.setAttribute("aria-label",i),Bi(s),Mi(s,"click",Ri),Mi(s,"click",o,this),Mi(s,"click",this._refocusOnMap,this),s},_updateDisabled:function(){var t=this._map,i="leaflet-disabled";ui(this._zoomInButton,i),ui(this._zoomOutButton,i),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(li(this._zoomOutButton,i),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(li(this._zoomInButton,i),this._zoomInButton.setAttribute("aria-disabled","true"))}});Vi.mergeOptions({zoomControl:!0}),Vi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Yi,this.addControl(this.zoomControl))});var Xi=qi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var i=ni("div","leaflet-control-scale"),e=this.options;return this._addScales(e,"leaflet-control-scale-line",i),t.on(e.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,i,e){t.metric&&(this._mScale=ni("div",i,e)),t.imperial&&(this._iScale=ni("div",i,e))},_update:function(){var t=this._map,i=t.getSize().y/2,e=t.distance(t.containerPointToLatLng([0,i]),t.containerPointToLatLng([this.options.maxWidth,i]));this._updateScales(e)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var i=this._getRoundNum(t),e=i<1e3?i+" m":i/1e3+" km";this._updateScale(this._mScale,e,i/t)},_updateImperial:function(t){var i,e,n,o=3.2808399*t;o>5280?(i=o/5280,e=this._getRoundNum(i),this._updateScale(this._iScale,e+" mi",e/i)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,i,e){t.style.width=Math.round(this.options.maxWidth*e)+"px",t.innerHTML=i},_getRoundNum:function(t){var i=Math.pow(10,(Math.floor(t)+"").length-1),e=t/i;return i*(e=e>=10?10:e>=5?5:e>=3?3:e>=2?2:1)}}),Ji=qi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(kt.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(t){d(this,t),this._attributions={}},onAdd:function(t){for(var i in t.attributionControl=this,this._container=ni("div","leaflet-control-attribution"),Bi(this._container),t._layers)t._layers[i].getAttribution&&this.addAttribution(t._layers[i].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var i in this._attributions)this._attributions[i]&&t.push(i);var e=[];this.options.prefix&&e.push(this.options.prefix),t.length&&e.push(t.join(", ")),this._container.innerHTML=e.join(' <span aria-hidden="true">|</span> ')}}});Vi.mergeOptions({attributionControl:!0}),Vi.addInitHook(function(){this.options.attributionControl&&(new Ji).addTo(this)});qi.Layers=Ki,qi.Zoom=Yi,qi.Scale=Xi,qi.Attribution=Ji,Gi.layers=function(t,i,e){return new Ki(t,i,e)},Gi.zoom=function(t){return new Yi(t)},Gi.scale=function(t){return new Xi(t)},Gi.attribution=function(t){return new Ji(t)};var $i=C.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});$i.addTo=function(t,i){return t.addHandler(i,this),this};var Qi={Events:Z},te=kt.touch?"touchstart mousedown":"mousedown",ie=S.extend({options:{clickTolerance:3},initialize:function(t,i,e,n){d(this,n),this._element=t,this._dragStartTarget=i||t,this._preventOutline=e},enable:function(){this._enabled||(Mi(this._dragStartTarget,te,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ie._dragging===this&&this.finishDrag(!0),Ci(this._dragStartTarget,te,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!hi(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)ie._dragging===this&&this.finishDrag();else if(!(ie._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(ie._dragging=this,this._preventOutline&&wi(this._element),yi(),Gt(),this._moving))){this.fire("down");var i=t.touches?t.touches[0]:t,e=Pi(this._element);this._startPoint=new E(i.clientX,i.clientY),this._startPos=gi(this._element),this._parentScale=Li(e);var n="mousedown"===t.type;Mi(document,n?"mousemove":"touchmove",this._onMove,this),Mi(document,n?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var i=t.touches&&1===t.touches.length?t.touches[0]:t,e=new E(i.clientX,i.clientY)._subtract(this._startPoint);(e.x||e.y)&&(Math.abs(e.x)+Math.abs(e.y)<this.options.clickTolerance||(e.x/=this._parentScale.x,e.y/=this._parentScale.y,Ii(t),this._moved||(this.fire("dragstart"),this._moved=!0,li(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),li(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(e),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),fi(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){ui(document.body,"leaflet-dragging"),this._lastTarget&&(ui(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ci(document,"mousemove touchmove",this._onMove,this),Ci(document,"mouseup touchend touchcancel",this._onUp,this),xi(),Kt();var i=this._moved&&this._moving;this._moving=!1,ie._dragging=!1,i&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ee(t,i,e){var n,o,s,r,a,h,l,u,c,d=[1,4,2,8];for(o=0,l=t.length;o<l;o++)t[o]._code=ce(t[o],i);for(r=0;r<4;r++){for(u=d[r],n=[],o=0,s=(l=t.length)-1;o<l;s=o++)a=t[o],h=t[s],a._code&u?h._code&u||((c=ue(h,a,u,i,e))._code=ce(c,i),n.push(c)):(h._code&u&&((c=ue(h,a,u,i,e))._code=ce(c,i),n.push(c)),n.push(a));t=n}return t}function ne(t,i){var e,n,o,s,r,a,h,l,u;if(!t||0===t.length)throw new Error("latlngs not passed");_e(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var c=D([0,0]),d=R(t);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(c=oe(t));var _=t.length,p=[];for(e=0;e<_;e++){var m=D(t[e]);p.push(i.project(D([m.lat-c.lat,m.lng-c.lng])))}for(a=h=l=0,e=0,n=_-1;e<_;n=e++)o=p[e],s=p[n],r=o.y*s.x-s.y*o.x,h+=(o.x+s.x)*r,l+=(o.y+s.y)*r,a+=3*r;u=0===a?p[0]:[h/a,l/a];var f=i.unproject(O(u));return D([f.lat+c.lat,f.lng+c.lng])}function oe(t){for(var i=0,e=0,n=0,o=0;o<t.length;o++){var s=D(t[o]);i+=s.lat,e+=s.lng,n++}return D([i/n,e/n])}var se,re={__proto__:null,clipPolygon:ee,polygonCenter:ne,centroid:oe};function ae(t,i){if(!i||!t.length)return t.slice();var e=i*i;return t=function(t,i){var e=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(e);n[0]=n[e-1]=1,function t(i,e,n,o,s){var r,a,h,l=0;for(a=o+1;a<=s-1;a++)(h=de(i[a],i[o],i[s],!0))>l&&(r=a,l=h);l>n&&(e[r]=1,t(i,e,n,o,r),t(i,e,n,r,s))}(t,n,i,0,e-1);var o,s=[];for(o=0;o<e;o++)n[o]&&s.push(t[o]);return s}(t=function(t,i){for(var e=[t[0]],n=1,o=0,s=t.length;n<s;n++)r=t[n],a=t[o],h=void 0,l=void 0,h=a.x-r.x,l=a.y-r.y,h*h+l*l>i&&(e.push(t[n]),o=n);var r,a,h,l;o<s-1&&e.push(t[s-1]);return e}(t,e),e)}function he(t,i,e){return Math.sqrt(de(t,i,e,!0))}function le(t,i,e,n,o){var s,r,a,h=n?se:ce(t,e),l=ce(i,e);for(se=l;;){if(!(h|l))return[t,i];if(h&l)return!1;a=ce(r=ue(t,i,s=h||l,e,o),e),s===h?(t=r,h=a):(i=r,l=a)}}function ue(t,i,e,n,o){var s,r,a=i.x-t.x,h=i.y-t.y,l=n.min,u=n.max;return 8&e?(s=t.x+a*(u.y-t.y)/h,r=u.y):4&e?(s=t.x+a*(l.y-t.y)/h,r=l.y):2&e?(s=u.x,r=t.y+h*(u.x-t.x)/a):1&e&&(s=l.x,r=t.y+h*(l.x-t.x)/a),new E(s,r,o)}function ce(t,i){var e=0;return t.x<i.min.x?e|=1:t.x>i.max.x&&(e|=2),t.y<i.min.y?e|=4:t.y>i.max.y&&(e|=8),e}function de(t,i,e,n){var o,s=i.x,r=i.y,a=e.x-s,h=e.y-r,l=a*a+h*h;return l>0&&((o=((t.x-s)*a+(t.y-r)*h)/l)>1?(s=e.x,r=e.y):o>0&&(s+=a*o,r+=h*o)),a=t.x-s,h=t.y-r,n?a*a+h*h:new E(s,r)}function _e(t){return!f(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function pe(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),_e(t)}function me(t,i){var e,n,o,s,r,a,h,l;if(!t||0===t.length)throw new Error("latlngs not passed");_e(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var u=D([0,0]),c=R(t);c.getNorthWest().distanceTo(c.getSouthWest())*c.getNorthEast().distanceTo(c.getNorthWest())<1700&&(u=oe(t));var d=t.length,_=[];for(e=0;e<d;e++){var p=D(t[e]);_.push(i.project(D([p.lat-u.lat,p.lng-u.lng])))}for(e=0,n=0;e<d-1;e++)n+=_[e].distanceTo(_[e+1])/2;if(0===n)l=_[0];else for(e=0,s=0;e<d-1;e++)if(r=_[e],a=_[e+1],(s+=o=r.distanceTo(a))>n){h=(s-n)/o,l=[a.x-h*(a.x-r.x),a.y-h*(a.y-r.y)];break}var m=i.unproject(O(l));return D([m.lat+u.lat,m.lng+u.lng])}var fe={__proto__:null,simplify:ae,pointToSegmentDistance:he,closestPointOnSegment:function(t,i,e){return de(t,i,e)},clipSegment:le,_getEdgeIntersection:ue,_getBitCode:ce,_sqClosestPointOnSegment:de,isFlat:_e,_flat:pe,polylineCenter:me},ge={project:function(t){return new E(t.lng,t.lat)},unproject:function(t){return new N(t.y,t.x)},bounds:new A([-180,-90],[180,90])},ve={R:6378137,R_MINOR:6356752.314245179,bounds:new A([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var i=Math.PI/180,e=this.R,n=t.lat*i,o=this.R_MINOR/e,s=Math.sqrt(1-o*o),r=s*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-r)/(1+r),s/2);return n=-e*Math.log(Math.max(a,1e-10)),new E(t.lng*i*e,n)},unproject:function(t){for(var i,e=180/Math.PI,n=this.R,o=this.R_MINOR/n,s=Math.sqrt(1-o*o),r=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(r),h=0,l=.1;h<15&&Math.abs(l)>1e-7;h++)i=s*Math.sin(a),i=Math.pow((1-i)/(1+i),s/2),a+=l=Math.PI/2-2*Math.atan(r*i)-a;return new N(a*e,t.x*e/n)}},ye={__proto__:null,LonLat:ge,Mercator:ve,SphericalMercator:F},xe=i({},W,{code:"EPSG:3395",projection:ve,transformation:function(){var t=.5/(Math.PI*ve.R);return V(t,.5,-t,.5)}()}),we=i({},W,{code:"EPSG:4326",projection:ge,transformation:V(1/180,1,-1/180,.5)}),be=i({},H,{projection:ge,transformation:V(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,i){var e=i.lng-t.lng,n=i.lat-t.lat;return Math.sqrt(e*e+n*n)},infinite:!0});H.Earth=W,H.EPSG3395=xe,H.EPSG3857=q,H.EPSG900913=G,H.EPSG4326=we,H.Simple=be;var Pe=S.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[s(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[s(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var i=t.target;if(i.hasLayer(this)){if(this._map=i,this._zoomAnimated=i._zoomAnimated,this.getEvents){var e=this.getEvents();i.on(e,this),this.once("remove",function(){i.off(e,this)},this)}this.onAdd(i),this.fire("add"),i.fire("layeradd",{layer:this})}}});Vi.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var i=s(t);return this._layers[i]?this:(this._layers[i]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var i=s(t);return this._layers[i]?(this._loaded&&t.onRemove(this),delete this._layers[i],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return s(t)in this._layers},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},_addLayers:function(t){for(var i=0,e=(t=t?f(t)?t:[t]:[]).length;i<e;i++)this.addLayer(t[i])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[s(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var i=s(t);this._zoomBoundLayers[i]&&(delete this._zoomBoundLayers[i],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,i=-1/0,e=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=void 0===o.minZoom?t:Math.min(t,o.minZoom),i=void 0===o.maxZoom?i:Math.max(i,o.maxZoom)}this._layersMaxZoom=i===-1/0?void 0:i,this._layersMinZoom=t===1/0?void 0:t,e!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Le=Pe.extend({initialize:function(t,i){var e,n;if(d(this,i),this._layers={},t)for(e=0,n=t.length;e<n;e++)this.addLayer(t[e])},addLayer:function(t){var i=this.getLayerId(t);return this._layers[i]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var i=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[i]&&this._map.removeLayer(this._layers[i]),delete this._layers[i],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var i,e,n=Array.prototype.slice.call(arguments,1);for(i in this._layers)(e=this._layers[i])[t]&&e[t].apply(e,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s(t)}}),Te=Le.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Le.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Le.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new I;for(var i in this._layers){var e=this._layers[i];t.extend(e.getBounds?e.getBounds():e.getLatLng())}return t}}),Me=C.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){d(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,i){var e=this._getIconUrl(t);if(!e){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(e,i&&"IMG"===i.tagName?i:null);return this._setIconStyles(n,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n},_setIconStyles:function(t,i){var e=this.options,n=e[i+"Size"];"number"==typeof n&&(n=[n,n]);var o=O(n),s=O("shadow"===i&&e.shadowAnchor||e.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+i+" "+(e.className||""),s&&(t.style.marginLeft=-s.x+"px",t.style.marginTop=-s.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,i){return(i=i||document.createElement("img")).src=t,i},_getIconUrl:function(t){return kt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var ze=Me.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof ze.imagePath&&(ze.imagePath=this._detectIconPath()),(this.options.imagePath||ze.imagePath)+Me.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var i=function(t,i,e){var n=i.exec(t);return n&&n[e]};return(t=i(t,/^url\((['"])?(.+)\1\)$/,2))&&i(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=ni("div","leaflet-default-icon-path",document.body),i=ei(t,"background-image")||ei(t,"backgroundImage");if(document.body.removeChild(t),i=this._stripUrl(i))return i;var e=document.querySelector('link[href$="leaflet.css"]');return e?e.href.substring(0,e.href.length-"leaflet.css".length-1):""}}),Ce=$i.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new ie(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),li(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ui(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var i=this._marker,e=i._map,n=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,s=gi(i._icon),r=e.getPixelBounds(),a=e.getPixelOrigin(),h=B(r.min._subtract(a).add(o),r.max._subtract(a).subtract(o));if(!h.contains(s)){var l=O((Math.max(h.max.x,s.x)-h.max.x)/(r.max.x-h.max.x)-(Math.min(h.min.x,s.x)-h.min.x)/(r.min.x-h.min.x),(Math.max(h.max.y,s.y)-h.max.y)/(r.max.y-h.max.y)-(Math.min(h.min.y,s.y)-h.min.y)/(r.min.y-h.min.y)).multiplyBy(n);e.panBy(l,{animate:!1}),this._draggable._newPos._add(l),this._draggable._startPos._add(l),fi(i._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=T(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(M(this._panRequest),this._panRequest=T(this._adjustPan.bind(this,t)))},_onDrag:function(t){var i=this._marker,e=i._shadow,n=gi(i._icon),o=i._map.layerPointToLatLng(n);e&&fi(e,n),i._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,i.fire("move",t).fire("drag",t)},_onDragEnd:function(t){M(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Ze=Pe.extend({options:{icon:new ze,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,i){d(this,i),this._latlng=D(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var i=this._latlng;return this._latlng=D(t),this.update(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,i="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),e=t.icon.createIcon(this._icon),n=!1;e!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(e.title=t.title),"IMG"===e.tagName&&(e.alt=t.alt||"")),li(e,i),t.keyboard&&(e.tabIndex="0",e.setAttribute("role","button")),this._icon=e,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Mi(e,"focus",this._panOnFocus,this);var o=t.icon.createShadow(this._shadow),s=!1;o!==this._shadow&&(this._removeShadow(),s=!0),o&&(li(o,i),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&s&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ci(this._icon,"focus",this._panOnFocus,this),oi(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&oi(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&fi(this._icon,t),this._shadow&&fi(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(i)},_initInteraction:function(){if(this.options.interactive&&(li(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ce)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ce(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&_i(this._icon,t),this._shadow&&_i(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var i=this.options.icon.options,e=i.iconSize?O(i.iconSize):O(0,0),n=i.iconAnchor?O(i.iconAnchor):O(0,0);t.panInside(this._latlng,{paddingTopLeft:n,paddingBottomRight:e.subtract(n)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Se=Pe.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return d(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ee=Se.extend({options:{fill:!0,radius:10},initialize:function(t,i){d(this,i),this._latlng=D(t),this._radius=this.options.radius},setLatLng:function(t){var i=this._latlng;return this._latlng=D(t),this.redraw(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var i=t&&t.radius||this._radius;return Se.prototype.setStyle.call(this,t),this.setRadius(i),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,i=this._radiusY||t,e=this._clickTolerance(),n=[t+e,i+e];this._pxBounds=new A(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var ke=Ee.extend({initialize:function(t,e,n){if("number"==typeof e&&(e=i({},n,{radius:e})),d(this,e),this._latlng=D(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new I(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Se.prototype.setStyle,_project:function(){var t=this._latlng.lng,i=this._latlng.lat,e=this._map,n=e.options.crs;if(n.distance===W.distance){var o=Math.PI/180,s=this._mRadius/W.R/o,r=e.project([i+s,t]),a=e.project([i-s,t]),h=r.add(a).divideBy(2),l=e.unproject(h).lat,u=Math.acos((Math.cos(s*o)-Math.sin(i*o)*Math.sin(l*o))/(Math.cos(i*o)*Math.cos(l*o)))/o;(isNaN(u)||0===u)&&(u=s/Math.cos(Math.PI/180*i)),this._point=h.subtract(e.getPixelOrigin()),this._radius=isNaN(u)?0:h.x-e.project([l,t-u]).x,this._radiusY=h.y-r.y}else{var c=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=e.latLngToLayerPoint(this._latlng),this._radius=this._point.x-e.latLngToLayerPoint(c).x}this._updateBounds()}});var Oe=Se.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,i){d(this,i),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var i,e,n=1/0,o=null,s=de,r=0,a=this._parts.length;r<a;r++)for(var h=this._parts[r],l=1,u=h.length;l<u;l++){var c=s(t,i=h[l-1],e=h[l],!0);c<n&&(n=c,o=s(t,i,e))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return me(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,i){return i=i||this._defaultShape(),t=D(t),i.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new I,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return _e(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var i=[],e=_e(t),n=0,o=t.length;n<o;n++)e?(i[n]=D(t[n]),this._bounds.extend(i[n])):i[n]=this._convertLatLngs(t[n]);return i},_project:function(){var t=new A;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),i=new E(t,t);this._rawPxBounds&&(this._pxBounds=new A([this._rawPxBounds.min.subtract(i),this._rawPxBounds.max.add(i)]))},_projectLatlngs:function(t,i,e){var n,o,s=t[0]instanceof N,r=t.length;if(s){for(o=[],n=0;n<r;n++)o[n]=this._map.latLngToLayerPoint(t[n]),e.extend(o[n]);i.push(o)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],i,e)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var i,e,n,o,s,r,a,h=this._parts;for(i=0,n=0,o=this._rings.length;i<o;i++)for(e=0,s=(a=this._rings[i]).length;e<s-1;e++)(r=le(a[e],a[e+1],t,e,!0))&&(h[n]=h[n]||[],h[n].push(r[0]),r[1]===a[e+1]&&e!==s-2||(h[n].push(r[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,i=this.options.smoothFactor,e=0,n=t.length;e<n;e++)t[e]=ae(t[e],i)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,i){var e,n,o,s,r,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(e=0,s=this._parts.length;e<s;e++)for(n=0,o=(r=(a=this._parts[e]).length)-1;n<r;o=n++)if((i||0!==n)&&he(t,a[o],a[n])<=h)return!0;return!1}});Oe._flat=pe;var Ae=Oe.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ne(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var i=Oe.prototype._convertLatLngs.call(this,t),e=i.length;return e>=2&&i[0]instanceof N&&i[0].equals(i[e-1])&&i.pop(),i},_setLatLngs:function(t){Oe.prototype._setLatLngs.call(this,t),_e(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return _e(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,i=this.options.weight,e=new E(i,i);if(t=new A(t.min.subtract(e),t.max.add(e)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,o=0,s=this._rings.length;o<s;o++)(n=ee(this._rings[o],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var i,e,n,o,s,r,a,h,l=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(s=0,r=(h=(i=this._parts[o]).length)-1;s<h;r=s++)e=i[s],n=i[r],e.y>t.y!=n.y>t.y&&t.x<(n.x-e.x)*(t.y-e.y)/(n.y-e.y)+e.x&&(l=!l);return l||Oe.prototype._containsPoint.call(this,t,!0)}});var Be=Te.extend({initialize:function(t,i){d(this,i),this._layers={},t&&this.addData(t)},addData:function(t){var i,e,n,o=f(t)?t:t.features;if(o){for(i=0,e=o.length;i<e;i++)((n=o[i]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var s=this.options;if(s.filter&&!s.filter(t))return this;var r=Ie(t,s);return r?(r.feature=Fe(t),r.defaultOptions=r.options,this.resetStyle(r),s.onEachFeature&&s.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=i({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(i){this._setLayerStyle(i,t)},this)},_setLayerStyle:function(t,i){t.setStyle&&("function"==typeof i&&(i=i(t.feature)),t.setStyle(i))}});function Ie(t,i){var e,n,o,s,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,h=[],l=i&&i.pointToLayer,u=i&&i.coordsToLatLng||Ne;if(!a&&!r)return null;switch(r.type){case"Point":return Re(l,t,e=u(a),i);case"MultiPoint":for(o=0,s=a.length;o<s;o++)e=u(a[o]),h.push(Re(l,t,e,i));return new Te(h);case"LineString":case"MultiLineString":return n=De(a,"LineString"===r.type?0:1,u),new Oe(n,i);case"Polygon":case"MultiPolygon":return n=De(a,"Polygon"===r.type?1:2,u),new Ae(n,i);case"GeometryCollection":for(o=0,s=r.geometries.length;o<s;o++){var c=Ie({geometry:r.geometries[o],type:"Feature",properties:t.properties},i);c&&h.push(c)}return new Te(h);case"FeatureCollection":for(o=0,s=r.features.length;o<s;o++){var d=Ie(r.features[o],i);d&&h.push(d)}return new Te(h);default:throw new Error("Invalid GeoJSON object.")}}function Re(t,i,e,n){return t?t(i,e):new Ze(e,n&&n.markersInheritOptions&&n)}function Ne(t){return new N(t[1],t[0],t[2])}function De(t,i,e){for(var n,o=[],s=0,r=t.length;s<r;s++)n=i?De(t[s],i-1,e):(e||Ne)(t[s]),o.push(n);return o}function je(t,i){return void 0!==(t=D(t)).alt?[l(t.lng,i),l(t.lat,i),l(t.alt,i)]:[l(t.lng,i),l(t.lat,i)]}function He(t,i,e,n){for(var o=[],s=0,r=t.length;s<r;s++)o.push(i?He(t[s],_e(t[s])?0:i-1,e,n):je(t[s],n));return!i&&e&&o.length>0&&o.push(o[0].slice()),o}function We(t,e){return t.feature?i({},t.feature,{geometry:e}):Fe(e)}function Fe(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Ue={toGeoJSON:function(t){return We(this,{type:"Point",coordinates:je(this.getLatLng(),t)})}};function Ve(t,i){return new Be(t,i)}Ze.include(Ue),ke.include(Ue),Ee.include(Ue),Oe.include({toGeoJSON:function(t){var i=!_e(this._latlngs);return We(this,{type:(i?"Multi":"")+"LineString",coordinates:He(this._latlngs,i?1:0,!1,t)})}}),Ae.include({toGeoJSON:function(t){var i=!_e(this._latlngs),e=i&&!_e(this._latlngs[0]),n=He(this._latlngs,e?2:i?1:0,!0,t);return i||(n=[n]),We(this,{type:(e?"Multi":"")+"Polygon",coordinates:n})}}),Le.include({toMultiPoint:function(t){var i=[];return this.eachLayer(function(e){i.push(e.toGeoJSON(t).geometry.coordinates)}),We(this,{type:"MultiPoint",coordinates:i})},toGeoJSON:function(t){var i=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===i)return this.toMultiPoint(t);var e="GeometryCollection"===i,n=[];return this.eachLayer(function(i){if(i.toGeoJSON){var o=i.toGeoJSON(t);if(e)n.push(o.geometry);else{var s=Fe(o);"FeatureCollection"===s.type?n.push.apply(n,s.features):n.push(s)}}}),e?We(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var qe=Ve,Ge=Pe.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,i,e){this._url=t,this._bounds=R(i),d(this,e)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(li(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){oi(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ri(this._image),this},bringToBack:function(){return this._map&&ai(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=R(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,i=this._image=t?this._url:ni("img");li(i,"leaflet-image-layer"),this._zoomAnimated&&li(i,"leaflet-zoom-animated"),this.options.className&&li(i,this.options.className),i.onselectstart=h,i.onmousemove=h,i.onload=n(this.fire,this,"load"),i.onerror=n(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=i.src:(i.src=this._url,i.alt=this.options.alt)},_animateZoom:function(t){var i=this._map.getZoomScale(t.zoom),e=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;mi(this._image,e,i)},_reset:function(){var t=this._image,i=new A(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),e=i.getSize();fi(t,i.min),t.style.width=e.x+"px",t.style.height=e.y+"px"},_updateOpacity:function(){_i(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Ke=Ge.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,i=this._image=t?this._url:ni("video");if(li(i,"leaflet-image-layer"),this._zoomAnimated&&li(i,"leaflet-zoom-animated"),this.options.className&&li(i,this.options.className),i.onselectstart=h,i.onmousemove=h,i.onloadeddata=n(this.fire,this,"load"),t){for(var e=i.getElementsByTagName("source"),o=[],s=0;s<e.length;s++)o.push(e[s].src);this._url=e.length>0?o:[i.src]}else{f(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(i.style,"objectFit")&&(i.style.objectFit="fill"),i.autoplay=!!this.options.autoplay,i.loop=!!this.options.loop,i.muted=!!this.options.muted,i.playsInline=!!this.options.playsInline;for(var r=0;r<this._url.length;r++){var a=ni("source");a.src=this._url[r],i.appendChild(a)}}}});var Ye=Ge.extend({_initImage:function(){var t=this._image=this._url;li(t,"leaflet-image-layer"),this._zoomAnimated&&li(t,"leaflet-zoom-animated"),this.options.className&&li(t,this.options.className),t.onselectstart=h,t.onmousemove=h}});var Xe=Pe.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,i){t&&(t instanceof N||f(t))?(this._latlng=D(t),d(this,i)):(d(this,t),this._source=i),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&_i(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&_i(this._container,1),this.bringToFront(),this.options.interactive&&(li(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(_i(this._container,0),this._removeTimeout=setTimeout(n(oi,void 0,this._container),200)):oi(this._container),this.options.interactive&&(ui(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=D(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ri(this._container),this},bringToBack:function(){return this._map&&ai(this._container),this},_prepareOpen:function(t){var i=this._source;if(!i._map)return!1;if(i instanceof Te){i=null;var e=this._source._layers;for(var n in e)if(e[n]._map){i=e[n];break}if(!i)return!1;this._source=i}if(!t)if(i.getCenter)t=i.getCenter();else if(i.getLatLng)t=i.getLatLng();else{if(!i.getBounds)throw new Error("Unable to get source layer LatLng.");t=i.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,i="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof i)t.innerHTML=i;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(i)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),i=O(this.options.offset),e=this._getAnchor();this._zoomAnimated?fi(this._container,t.add(e)):i=i.add(t).add(e);var n=this._containerBottom=-i.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+i.x;this._container.style.bottom=n+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}});Vi.include({_initOverlay:function(t,i,e,n){var o=i;return o instanceof t||(o=new t(n).setContent(i)),e&&o.setLatLng(e),o}}),Pe.include({_initOverlay:function(t,i,e,n){var o=e;return o instanceof t?(d(o,n),o._source=this):(o=i&&!n?i:new t(n,this)).setContent(e),o}});var Je=Xe.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Xe.prototype.openOn.call(this,t)},onAdd:function(t){Xe.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Se||this._source.on("preclick",Oi))},onRemove:function(t){Xe.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Se||this._source.off("preclick",Oi))},getEvents:function(){var t=Xe.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",i=this._container=ni("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),e=this._wrapper=ni("div",t+"-content-wrapper",i);if(this._contentNode=ni("div",t+"-content",e),Bi(i),Ai(this._contentNode),Mi(i,"contextmenu",Oi),this._tipContainer=ni("div",t+"-tip-container",i),this._tip=ni("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=ni("a",t+"-close-button",i);n.setAttribute("role","button"),n.setAttribute("aria-label","Close popup"),n.href="#close",n.innerHTML='<span aria-hidden="true">&#215;</span>',Mi(n,"click",function(t){Ii(t),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,i=t.style;i.width="",i.whiteSpace="nowrap";var e=t.offsetWidth;e=Math.min(e,this.options.maxWidth),e=Math.max(e,this.options.minWidth),i.width=e+1+"px",i.whiteSpace="",i.height="";var n=t.offsetHeight,o=this.options.maxHeight;o&&n>o?(i.height=o+"px",li(t,"leaflet-popup-scrolled")):ui(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),e=this._getAnchor();fi(this._container,i.add(e))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,i=parseInt(ei(this._container,"marginBottom"),10)||0,e=this._container.offsetHeight+i,n=this._containerWidth,o=new E(this._containerLeft,-e-this._containerBottom);o._add(gi(this._container));var s=t.layerPointToContainerPoint(o),r=O(this.options.autoPanPadding),a=O(this.options.autoPanPaddingTopLeft||r),h=O(this.options.autoPanPaddingBottomRight||r),l=t.getSize(),u=0,c=0;s.x+n+h.x>l.x&&(u=s.x+n-l.x+h.x),s.x-u-a.x<0&&(u=s.x-a.x),s.y+e+h.y>l.y&&(c=s.y+e-l.y+h.y),s.y-c-a.y<0&&(c=s.y-a.y),(u||c)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([u,c]))}},_getAnchor:function(){return O(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Vi.mergeOptions({closePopupOnClick:!0}),Vi.include({openPopup:function(t,i,e){return this._initOverlay(Je,t,i,e).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Pe.include({bindPopup:function(t,i){return this._popup=this._initOverlay(Je,this._popup,t,i),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Te||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){Ri(t);var i=t.layer||t.target;this._popup._source!==i||i instanceof Se?(this._popup._source=i,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var $e=Xe.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Xe.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Xe.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Xe.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ni("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+s(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var i,e,n=this._map,o=this._container,s=n.latLngToContainerPoint(n.getCenter()),r=n.layerPointToContainerPoint(t),a=this.options.direction,h=o.offsetWidth,l=o.offsetHeight,u=O(this.options.offset),c=this._getAnchor();"top"===a?(i=h/2,e=l):"bottom"===a?(i=h/2,e=0):"center"===a?(i=h/2,e=l/2):"right"===a?(i=0,e=l/2):"left"===a?(i=h,e=l/2):r.x<s.x?(a="right",i=0,e=l/2):(a="left",i=h+2*(u.x+c.x),e=l/2),t=t.subtract(O(i,e,!0)).add(u).add(c),ui(o,"leaflet-tooltip-right"),ui(o,"leaflet-tooltip-left"),ui(o,"leaflet-tooltip-top"),ui(o,"leaflet-tooltip-bottom"),li(o,"leaflet-tooltip-"+a),fi(o,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&_i(this._container,t)},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(i)},_getAnchor:function(){return O(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Vi.include({openTooltip:function(t,i,e){return this._initOverlay($e,t,i,e).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Pe.include({bindTooltip:function(t,i){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay($e,this._tooltip,t,i),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var i=t?"off":"on",e={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?e.add=this._openTooltip:(e.mouseover=this._openTooltip,e.mouseout=this.closeTooltip,e.click=this._openTooltip,this._map?this._addFocusListeners():e.add=this._addFocusListeners),this._tooltip.options.sticky&&(e.mousemove=this._moveTooltip),this[i](e),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Te||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var i="function"==typeof t.getElement&&t.getElement();i&&(Mi(i,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),Mi(i,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var i="function"==typeof t.getElement&&t.getElement();i&&i.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var i=this;this._map.once("moveend",function(){i._openOnceFlag=!1,i._openTooltip(t)})}else this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var i,e,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(i=this._map.mouseEventToContainerPoint(t.originalEvent),e=this._map.containerPointToLayerPoint(i),n=this._map.layerPointToLatLng(e)),this._tooltip.setLatLng(n)}});var Qe=Me.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:document.createElement("div"),e=this.options;if(e.html instanceof Element?(si(i),i.appendChild(e.html)):i.innerHTML=!1!==e.html?e.html:"",e.bgPos){var n=O(e.bgPos);i.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(i,"icon"),i},createShadow:function(){return null}});Me.Default=ze;var tn=Pe.extend({options:{tileSize:256,opacity:1,updateWhenIdle:kt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){d(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),oi(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ri(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ai(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=r(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof E?t:new E(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var i,e=this.getPane().children,n=-t(-1/0,1/0),o=0,s=e.length;o<s;o++)i=e[o].style.zIndex,e[o]!==this._container&&i&&(n=t(n,+i));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!kt.ielt9){_i(this._container,this.options.opacity);var t=+new Date,i=!1,e=!1;for(var n in this._tiles){var o=this._tiles[n];if(o.current&&o.loaded){var s=Math.min(1,(t-o.loaded)/200);_i(o.el,s),s<1?i=!0:(o.active?e=!0:this._onOpaqueTile(o),o.active=!0)}}e&&!this._noPrune&&this._pruneTiles(),i&&(M(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=ni("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,i=this.options.maxZoom;if(void 0!==t){for(var e in this._levels)e=Number(e),this._levels[e].el.children.length||e===t?(this._levels[e].el.style.zIndex=i-Math.abs(t-e),this._onUpdateLevel(e)):(oi(this._levels[e].el),this._removeTilesAtZoom(e),this._onRemoveLevel(e),delete this._levels[e]);var n=this._levels[t],o=this._map;return n||((n=this._levels[t]={}).el=ni("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=i,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),n.el.offsetWidth,this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var t,i,e=this._map.getZoom();if(e>this.options.maxZoom||e<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(i=this._tiles[t]).retain=i.current;for(t in this._tiles)if((i=this._tiles[t]).current&&!i.active){var n=i.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var i in this._tiles)this._tiles[i].coords.z===t&&this._removeTile(i)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)oi(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,i,e,n){var o=Math.floor(t/2),s=Math.floor(i/2),r=e-1,a=new E(+o,+s);a.z=+r;var h=this._tileCoordsToKey(a),l=this._tiles[h];return l&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),r>n&&this._retainParent(o,s,r,n))},_retainChildren:function(t,i,e,n){for(var o=2*t;o<2*t+2;o++)for(var s=2*i;s<2*i+2;s++){var r=new E(o,s);r.z=e+1;var a=this._tileCoordsToKey(r),h=this._tiles[a];h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),e+1<n&&this._retainChildren(o,s,e+1,n))}},_resetView:function(t){var i=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),i,i)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var i=this.options;return void 0!==i.minNativeZoom&&t<i.minNativeZoom?i.minNativeZoom:void 0!==i.maxNativeZoom&&i.maxNativeZoom<t?i.maxNativeZoom:t},_setView:function(t,i,e,n){var o=Math.round(i);o=void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom?void 0:this._clampZoom(o);var s=this.options.updateWhenZooming&&o!==this._tileZoom;n&&!s||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),e||this._pruneTiles(),this._noPrune=!!e),this._setZoomTransforms(t,i)},_setZoomTransforms:function(t,i){for(var e in this._levels)this._setZoomTransform(this._levels[e],t,i)},_setZoomTransform:function(t,i,e){var n=this._map.getZoomScale(e,t.zoom),o=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(i,e)).round();kt.any3d?mi(t.el,o,n):fi(t.el,o)},_resetGrid:function(){var t=this._map,i=t.options.crs,e=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=i.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,i.wrapLng[0]],n).x/e.x),Math.ceil(t.project([0,i.wrapLng[1]],n).x/e.y)],this._wrapY=i.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([i.wrapLat[0],0],n).y/e.x),Math.ceil(t.project([i.wrapLat[1],0],n).y/e.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var i=this._map,e=i._animatingZoom?Math.max(i._animateToZoom,i.getZoom()):i.getZoom(),n=i.getZoomScale(e,this._tileZoom),o=i.project(t,this._tileZoom).floor(),s=i.getSize().divideBy(2*n);return new A(o.subtract(s),o.add(s))},_update:function(t){var i=this._map;if(i){var e=this._clampZoom(i.getZoom());if(void 0===t&&(t=i.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(n),s=o.getCenter(),r=[],a=this.options.keepBuffer,h=new A(o.getBottomLeft().subtract([a,-a]),o.getTopRight().add([a,-a]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var l in this._tiles){var u=this._tiles[l].coords;u.z===this._tileZoom&&h.contains(new E(u.x,u.y))||(this._tiles[l].current=!1)}if(Math.abs(e-this._tileZoom)>1)this._setView(t,e);else{for(var c=o.min.y;c<=o.max.y;c++)for(var d=o.min.x;d<=o.max.x;d++){var _=new E(d,c);if(_.z=this._tileZoom,this._isValidTile(_)){var p=this._tiles[this._tileCoordsToKey(_)];p?p.current=!0:r.push(_)}}if(r.sort(function(t,i){return t.distanceTo(s)-i.distanceTo(s)}),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<r.length;d++)this._addTile(r[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var i=this._map.options.crs;if(!i.infinite){var e=this._globalTileRange;if(!i.wrapLng&&(t.x<e.min.x||t.x>e.max.x)||!i.wrapLat&&(t.y<e.min.y||t.y>e.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return R(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var i=this._map,e=this.getTileSize(),n=t.scaleBy(e),o=n.add(e);return[i.unproject(n,t.z),i.unproject(o,t.z)]},_tileCoordsToBounds:function(t){var i=this._tileCoordsToNwSe(t),e=new I(i[0],i[1]);return this.options.noWrap||(e=this._map.wrapLatLngBounds(e)),e},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var i=t.split(":"),e=new E(+i[0],+i[1]);return e.z=+i[2],e},_removeTile:function(t){var i=this._tiles[t];i&&(oi(i.el),delete this._tiles[t],this.fire("tileunload",{tile:i.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){li(t,"leaflet-tile");var i=this.getTileSize();t.style.width=i.x+"px",t.style.height=i.y+"px",t.onselectstart=h,t.onmousemove=h,kt.ielt9&&this.options.opacity<1&&_i(t,this.options.opacity)},_addTile:function(t,i){var e=this._getTilePos(t),o=this._tileCoordsToKey(t),s=this.createTile(this._wrapCoords(t),n(this._tileReady,this,t));this._initTile(s),this.createTile.length<2&&T(n(this._tileReady,this,t,null,s)),fi(s,e),this._tiles[o]={el:s,coords:t,current:!0},i.appendChild(s),this.fire("tileloadstart",{tile:s,coords:t})},_tileReady:function(t,i,e){i&&this.fire("tileerror",{error:i,tile:e,coords:t});var o=this._tileCoordsToKey(t);(e=this._tiles[o])&&(e.loaded=+new Date,this._map._fadeAnimated?(_i(e.el,0),M(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this)):(e.active=!0,this._pruneTiles()),i||(li(e.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:e.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),kt.ielt9||!this._map._fadeAnimated?T(this._pruneTiles,this):setTimeout(n(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var i=new E(this._wrapX?a(t.x,this._wrapX):t.x,this._wrapY?a(t.y,this._wrapY):t.y);return i.z=t.z,i},_pxBoundsToTileRange:function(t){var i=this.getTileSize();return new A(t.min.unscaleBy(i).floor(),t.max.unscaleBy(i).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var en=tn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,i){this._url=t,(i=d(this,i)).detectRetina&&kt.retina&&i.maxZoom>0?(i.tileSize=Math.floor(i.tileSize/2),i.zoomReverse?(i.zoomOffset--,i.minZoom=Math.min(i.maxZoom,i.minZoom+1)):(i.zoomOffset++,i.maxZoom=Math.max(i.minZoom,i.maxZoom-1)),i.minZoom=Math.max(0,i.minZoom)):i.zoomReverse?i.minZoom=Math.min(i.maxZoom,i.minZoom):i.maxZoom=Math.max(i.minZoom,i.maxZoom),"string"==typeof i.subdomains&&(i.subdomains=i.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,i){return this._url===t&&void 0===i&&(i=!0),this._url=t,i||this.redraw(),this},createTile:function(t,i){var e=document.createElement("img");return Mi(e,"load",n(this._tileOnLoad,this,i,e)),Mi(e,"error",n(this._tileOnError,this,i,e)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(e.referrerPolicy=this.options.referrerPolicy),e.alt="",e.src=this.getTileUrl(t),e},getTileUrl:function(t){var e={r:kt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=n),e["-y"]=n}return m(this._url,i(e,this.options))},_tileOnLoad:function(t,i){kt.ielt9?setTimeout(n(t,this,null,i),0):t(null,i)},_tileOnError:function(t,i,e){var n=this.options.errorTileUrl;n&&i.getAttribute("src")!==n&&(i.src=n),t(e,i)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,i=this.options.maxZoom;return this.options.zoomReverse&&(t=i-t),t+this.options.zoomOffset},_getSubdomain:function(t){var i=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[i]},_abortLoading:function(){var t,i;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((i=this._tiles[t].el).onload=h,i.onerror=h,!i.complete)){i.src=v;var e=this._tiles[t].coords;oi(i),delete this._tiles[t],this.fire("tileabort",{tile:i,coords:e})}},_removeTile:function(t){var i=this._tiles[t];if(i)return i.el.setAttribute("src",v),tn.prototype._removeTile.call(this,t)},_tileReady:function(t,i,e){if(this._map&&(!e||e.getAttribute("src")!==v))return tn.prototype._tileReady.call(this,t,i,e)}});function nn(t,i){return new en(t,i)}var on=en.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var n=i({},this.defaultWmsParams);for(var o in e)o in this.options||(n[o]=e[o]);var s=(e=d(this,e)).detectRetina&&kt.retina?2:1,r=this.getTileSize();n.width=r.x*s,n.height=r.y*s,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var i=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[i]=this._crs.code,en.prototype.onAdd.call(this,t)},getTileUrl:function(t){var i=this._tileCoordsToNwSe(t),e=this._crs,n=B(e.project(i[0]),e.project(i[1])),o=n.min,s=n.max,r=(this._wmsVersion>=1.3&&this._crs===we?[o.y,o.x,s.y,s.x]:[o.x,o.y,s.x,s.y]).join(","),a=en.prototype.getTileUrl.call(this,t);return a+_(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+r},setParams:function(t,e){return i(this.wmsParams,t),e||this.redraw(),this}});en.WMS=on,nn.wms=function(t,i){return new on(t,i)};var sn=Pe.extend({options:{padding:.1},initialize:function(t){d(this,t),s(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),li(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,i){var e=this._map.getZoomScale(i,this._zoom),n=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,i),s=n.multiplyBy(-e).add(o).subtract(this._map._getNewPixelOrigin(t,i));kt.any3d?mi(this._container,s,e):fi(this._container,s)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,i=this._map.getSize(),e=this._map.containerPointToLayerPoint(i.multiplyBy(-t)).round();this._bounds=new A(e,e.add(i.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),rn=sn.extend({options:{tolerance:0},getEvents:function(){var t=sn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){sn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Mi(t,"mousemove",this._onMouseMove,this),Mi(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Mi(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){M(this._redrawRequest),delete this._ctx,oi(this._container),Ci(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){sn.prototype._update.call(this);var t=this._bounds,i=this._container,e=t.getSize(),n=kt.retina?2:1;fi(i,t.min),i.width=n*e.x,i.height=n*e.y,i.style.width=e.x+"px",i.style.height=e.y+"px",kt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){sn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[s(t)]=t;var i=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=i),this._drawLast=i,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var i=t._order,e=i.next,n=i.prev;e?e.prev=n:this._drawLast=n,n?n.next=e:this._drawFirst=e,delete t._order,delete this._layers[s(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var i,e,n=t.options.dashArray.split(/[, ]+/),o=[];for(e=0;e<n.length;e++){if(i=Number(n[e]),isNaN(i))return;o.push(i)}t.options._dashArray=o}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||T(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var i=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new A,this._redrawBounds.extend(t._pxBounds.min.subtract([i,i])),this._redrawBounds.extend(t._pxBounds.max.add([i,i]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var i=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,i.x,i.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,i=this._redrawBounds;if(this._ctx.save(),i){var e=i.getSize();this._ctx.beginPath(),this._ctx.rect(i.min.x,i.min.y,e.x,e.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!i||t._pxBounds&&t._pxBounds.intersects(i))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,i){if(this._drawing){var e,n,o,s,r=t._parts,a=r.length,h=this._ctx;if(a){for(h.beginPath(),e=0;e<a;e++){for(n=0,o=r[e].length;n<o;n++)s=r[e][n],h[n?"lineTo":"moveTo"](s.x,s.y);i&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var i=t._point,e=this._ctx,n=Math.max(Math.round(t._radius),1),o=(Math.max(Math.round(t._radiusY),1)||n)/n;1!==o&&(e.save(),e.scale(1,o)),e.beginPath(),e.arc(i.x,i.y/o,n,0,2*Math.PI,!1),1!==o&&e.restore(),this._fillStroke(e,t)}},_fillStroke:function(t,i){var e=i.options;e.fill&&(t.globalAlpha=e.fillOpacity,t.fillStyle=e.fillColor||e.color,t.fill(e.fillRule||"evenodd")),e.stroke&&0!==e.weight&&(t.setLineDash&&t.setLineDash(i.options&&i.options._dashArray||[]),t.globalAlpha=e.opacity,t.lineWidth=e.weight,t.strokeStyle=e.color,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.stroke())},_onClick:function(t){for(var i,e,n=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(i=o.layer).options.interactive&&i._containsPoint(n)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(i))&&(e=i);this._fireEvent(!!e&&[e],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var i=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,i)}},_handleMouseOut:function(t){var i=this._hoveredLayer;i&&(ui(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,i){if(!this._mouseHoverThrottled){for(var e,o,s=this._drawFirst;s;s=s.next)(e=s.layer).options.interactive&&e._containsPoint(i)&&(o=e);o!==this._hoveredLayer&&(this._handleMouseOut(t),o&&(li(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseover"),this._hoveredLayer=o)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(n(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,i,e){this._map._fireDOMEvent(i,e||i.type,t)},_bringToFront:function(t){var i=t._order;if(i){var e=i.next,n=i.prev;e&&(e.prev=n,n?n.next=e:e&&(this._drawFirst=e),i.prev=this._drawLast,this._drawLast.next=i,i.next=null,this._drawLast=i,this._requestRedraw(t))}},_bringToBack:function(t){var i=t._order;if(i){var e=i.next,n=i.prev;n&&(n.next=e,e?e.prev=n:n&&(this._drawLast=n),i.prev=null,i.next=this._drawFirst,this._drawFirst.prev=i,this._drawFirst=i,this._requestRedraw(t))}}});function an(t){return kt.canvas?new rn(t):null}var hn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ln={_initContainer:function(){this._container=ni("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(sn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var i=t._container=hn("shape");li(i,"leaflet-vml-shape "+(this.options.className||"")),i.coordsize="1 1",t._path=hn("path"),i.appendChild(t._path),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){var i=t._container;this._container.appendChild(i),t.options.interactive&&t.addInteractiveTarget(i)},_removePath:function(t){var i=t._container;oi(i),t.removeInteractiveTarget(i),delete this._layers[s(t)]},_updateStyle:function(t){var i=t._stroke,e=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(i||(i=t._stroke=hn("stroke")),o.appendChild(i),i.weight=n.weight+"px",i.color=n.color,i.opacity=n.opacity,n.dashArray?i.dashStyle=f(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):i.dashStyle="",i.endcap=n.lineCap.replace("butt","flat"),i.joinstyle=n.lineJoin):i&&(o.removeChild(i),t._stroke=null),n.fill?(e||(e=t._fill=hn("fill")),o.appendChild(e),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(o.removeChild(e),t._fill=null)},_updateCircle:function(t){var i=t._point.round(),e=Math.round(t._radius),n=Math.round(t._radiusY||e);this._setPath(t,t._empty()?"M0 0":"AL "+i.x+","+i.y+" "+e+","+n+" 0,23592600")},_setPath:function(t,i){t._path.v=i},_bringToFront:function(t){ri(t._container)},_bringToBack:function(t){ai(t._container)}},un=kt.vml?hn:K,cn=sn.extend({_initContainer:function(){this._container=un("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=un("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){oi(this._container),Ci(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){sn.prototype._update.call(this);var t=this._bounds,i=t.getSize(),e=this._container;this._svgSize&&this._svgSize.equals(i)||(this._svgSize=i,e.setAttribute("width",i.x),e.setAttribute("height",i.y)),fi(e,t.min),e.setAttribute("viewBox",[t.min.x,t.min.y,i.x,i.y].join(" ")),this.fire("update")}},_initPath:function(t){var i=t._path=un("path");t.options.className&&li(i,t.options.className),t.options.interactive&&li(i,"leaflet-interactive"),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){oi(t._path),t.removeInteractiveTarget(t._path),delete this._layers[s(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var i=t._path,e=t.options;i&&(e.stroke?(i.setAttribute("stroke",e.color),i.setAttribute("stroke-opacity",e.opacity),i.setAttribute("stroke-width",e.weight),i.setAttribute("stroke-linecap",e.lineCap),i.setAttribute("stroke-linejoin",e.lineJoin),e.dashArray?i.setAttribute("stroke-dasharray",e.dashArray):i.removeAttribute("stroke-dasharray"),e.dashOffset?i.setAttribute("stroke-dashoffset",e.dashOffset):i.removeAttribute("stroke-dashoffset")):i.setAttribute("stroke","none"),e.fill?(i.setAttribute("fill",e.fillColor||e.color),i.setAttribute("fill-opacity",e.fillOpacity),i.setAttribute("fill-rule",e.fillRule||"evenodd")):i.setAttribute("fill","none"))},_updatePoly:function(t,i){this._setPath(t,Y(t._parts,i))},_updateCircle:function(t){var i=t._point,e=Math.max(Math.round(t._radius),1),n="a"+e+","+(Math.max(Math.round(t._radiusY),1)||e)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(i.x-e)+","+i.y+n+2*e+",0 "+n+2*-e+",0 ";this._setPath(t,o)},_setPath:function(t,i){t._path.setAttribute("d",i)},_bringToFront:function(t){ri(t._path)},_bringToBack:function(t){ai(t._path)}});function dn(t){return kt.svg||kt.vml?new cn(t):null}kt.vml&&cn.include(ln),Vi.include({getRenderer:function(t){var i=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return i||(i=this._renderer=this._createRenderer()),this.hasLayer(i)||this.addLayer(i),i},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var i=this._paneRenderers[t];return void 0===i&&(i=this._createRenderer({pane:t}),this._paneRenderers[t]=i),i},_createRenderer:function(t){return this.options.preferCanvas&&an(t)||dn(t)}});var _n=Ae.extend({initialize:function(t,i){Ae.prototype.initialize.call(this,this._boundsToLatLngs(t),i)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=R(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});cn.create=un,cn.pointsToPath=Y,Be.geometryToLayer=Ie,Be.coordsToLatLng=Ne,Be.coordsToLatLngs=De,Be.latLngToCoords=je,Be.latLngsToCoords=He,Be.getFeature=We,Be.asFeature=Fe,Vi.mergeOptions({boxZoom:!0});var pn=$i.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Mi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ci(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){oi(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Gt(),yi(),this._startPoint=this._map.mouseEventToContainerPoint(t),Mi(document,{contextmenu:Ri,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ni("div","leaflet-zoom-box",this._container),li(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var i=new A(this._point,this._startPoint),e=i.getSize();fi(this._box,i.min),this._box.style.width=e.x+"px",this._box.style.height=e.y+"px"},_finish:function(){this._moved&&(oi(this._box),ui(this._container,"leaflet-crosshair")),Kt(),xi(),Ci(document,{contextmenu:Ri,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(n(this._resetState,this),0);var i=new I(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(i).fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Vi.addInitHook("addHandler","boxZoom",pn),Vi.mergeOptions({doubleClickZoom:!0});var mn=$i.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var i=this._map,e=i.getZoom(),n=i.options.zoomDelta,o=t.originalEvent.shiftKey?e-n:e+n;"center"===i.options.doubleClickZoom?i.setZoom(o):i.setZoomAround(t.containerPoint,o)}});Vi.addInitHook("addHandler","doubleClickZoom",mn),Vi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var fn=$i.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new ie(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}li(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ui(this._map._container,"leaflet-grab"),ui(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var i=R(this._map.options.maxBounds);this._offsetLimit=B(this._map.latLngToContainerPoint(i.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(i.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var i=this._lastTime=+new Date,e=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(e),this._times.push(i),this._prunePositions(i)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),i=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=i.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,i){return t-(t-i)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),i=this._offsetLimit;t.x<i.min.x&&(t.x=this._viscousLimit(t.x,i.min.x)),t.y<i.min.y&&(t.y=this._viscousLimit(t.y,i.min.y)),t.x>i.max.x&&(t.x=this._viscousLimit(t.x,i.max.x)),t.y>i.max.y&&(t.y=this._viscousLimit(t.y,i.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,i=Math.round(t/2),e=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-i+e)%t+i-e,s=(n+i+e)%t-i-e,r=Math.abs(o+e)<Math.abs(s+e)?o:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var i=this._map,e=i.options,n=!e.inertia||t.noInertia||this._times.length<2;if(i.fire("dragend",t),n)i.fire("moveend");else{this._prunePositions(+new Date);var o=this._lastPos.subtract(this._positions[0]),s=(this._lastTime-this._times[0])/1e3,r=e.easeLinearity,a=o.multiplyBy(r/s),h=a.distanceTo([0,0]),l=Math.min(e.inertiaMaxSpeed,h),u=a.multiplyBy(l/h),c=l/(e.inertiaDeceleration*r),d=u.multiplyBy(-c/2).round();d.x||d.y?(d=i._limitOffset(d,i.options.maxBounds),T(function(){i.panBy(d,{duration:c,easeLinearity:r,noMoveStart:!0,animate:!0})})):i.fire("moveend")}}});Vi.addInitHook("addHandler","dragging",fn),Vi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var gn=$i.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Mi(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ci(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,i=document.documentElement,e=t.scrollTop||i.scrollTop,n=t.scrollLeft||i.scrollLeft;this._map._container.focus(),window.scrollTo(n,e)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var i,e,n=this._panKeys={},o=this.keyCodes;for(i=0,e=o.left.length;i<e;i++)n[o.left[i]]=[-1*t,0];for(i=0,e=o.right.length;i<e;i++)n[o.right[i]]=[t,0];for(i=0,e=o.down.length;i<e;i++)n[o.down[i]]=[0,t];for(i=0,e=o.up.length;i<e;i++)n[o.up[i]]=[0,-1*t]},_setZoomDelta:function(t){var i,e,n=this._zoomKeys={},o=this.keyCodes;for(i=0,e=o.zoomIn.length;i<e;i++)n[o.zoomIn[i]]=t;for(i=0,e=o.zoomOut.length;i<e;i++)n[o.zoomOut[i]]=-t},_addHooks:function(){Mi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ci(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var i,e=t.keyCode,n=this._map;if(e in this._panKeys){if(!n._panAnim||!n._panAnim._inProgress)if(i=this._panKeys[e],t.shiftKey&&(i=O(i).multiplyBy(3)),n.options.maxBounds&&(i=n._limitOffset(O(i),n.options.maxBounds)),n.options.worldCopyJump){var o=n.wrapLatLng(n.unproject(n.project(n.getCenter()).add(i)));n.panTo(o)}else n.panBy(i)}else if(e in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else{if(27!==e||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Ri(t)}}});Vi.addInitHook("addHandler","keyboard",gn),Vi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var vn=$i.extend({addHooks:function(){Mi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ci(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var i=Hi(t),e=this._map.options.wheelDebounceTime;this._delta+=i,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(e-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(n(this._performZoom,this),o),Ri(t)},_performZoom:function(){var t=this._map,i=t.getZoom(),e=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,s=e?Math.ceil(o/e)*e:o,r=t._limitZoom(i+(this._delta>0?s:-s))-i;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(i+r):t.setZoomAround(this._lastMousePos,i+r))}});Vi.addInitHook("addHandler","scrollWheelZoom",vn);Vi.mergeOptions({tapHold:kt.touchNative&&kt.safari&&kt.mobile,tapTolerance:15});var yn=$i.extend({addHooks:function(){Mi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ci(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var i=t.touches[0];this._startPos=this._newPos=new E(i.clientX,i.clientY),this._holdTimeout=setTimeout(n(function(){this._cancel(),this._isTapValid()&&(Mi(document,"touchend",Ii),Mi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",i))},this),600),Mi(document,"touchend touchcancel contextmenu",this._cancel,this),Mi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Ci(document,"touchend",Ii),Ci(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Ci(document,"touchend touchcancel contextmenu",this._cancel,this),Ci(document,"touchmove",this._onMove,this)},_onMove:function(t){var i=t.touches[0];this._newPos=new E(i.clientX,i.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,i){var e=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY});e._simulated=!0,i.target.dispatchEvent(e)}});Vi.addInitHook("addHandler","tapHold",yn),Vi.mergeOptions({touchZoom:kt.touch,bounceAtZoomLimits:!0});var xn=$i.extend({addHooks:function(){li(this._map._container,"leaflet-touch-zoom"),Mi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ui(this._map._container,"leaflet-touch-zoom"),Ci(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var e=i.mouseEventToContainerPoint(t.touches[0]),n=i.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=i.getSize()._divideBy(2),this._startLatLng=i.containerPointToLatLng(this._centerPoint),"center"!==i.options.touchZoom&&(this._pinchStartLatLng=i.containerPointToLatLng(e.add(n)._divideBy(2))),this._startDist=e.distanceTo(n),this._startZoom=i.getZoom(),this._moved=!1,this._zooming=!0,i._stop(),Mi(document,"touchmove",this._onTouchMove,this),Mi(document,"touchend touchcancel",this._onTouchEnd,this),Ii(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var i=this._map,e=i.mouseEventToContainerPoint(t.touches[0]),o=i.mouseEventToContainerPoint(t.touches[1]),s=e.distanceTo(o)/this._startDist;if(this._zoom=i.getScaleZoom(s,this._startZoom),!i.options.bounceAtZoomLimits&&(this._zoom<i.getMinZoom()&&s<1||this._zoom>i.getMaxZoom()&&s>1)&&(this._zoom=i._limitZoom(this._zoom)),"center"===i.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var r=e._add(o)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===r.x&&0===r.y)return;this._center=i.unproject(i.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(i._moveStart(!0,!1),this._moved=!0),M(this._animRequest);var a=n(i._move,i,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=T(a,this,!0),Ii(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,M(this._animRequest),Ci(document,"touchmove",this._onTouchMove,this),Ci(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Vi.addInitHook("addHandler","touchZoom",xn),Vi.BoxZoom=pn,Vi.DoubleClickZoom=mn,Vi.Drag=fn,Vi.Keyboard=gn,Vi.ScrollWheelZoom=vn,Vi.TapHold=yn,Vi.TouchZoom=xn,t.Bounds=A,t.Browser=kt,t.CRS=H,t.Canvas=rn,t.Circle=ke,t.CircleMarker=Ee,t.Class=C,t.Control=qi,t.DivIcon=Qe,t.DivOverlay=Xe,t.DomEvent=Fi,t.DomUtil=Ti,t.Draggable=ie,t.Evented=S,t.FeatureGroup=Te,t.GeoJSON=Be,t.GridLayer=tn,t.Handler=$i,t.Icon=Me,t.ImageOverlay=Ge,t.LatLng=N,t.LatLngBounds=I,t.Layer=Pe,t.LayerGroup=Le,t.LineUtil=fe,t.Map=Vi,t.Marker=Ze,t.Mixin=Qi,t.Path=Se,t.Point=E,t.PolyUtil=re,t.Polygon=Ae,t.Polyline=Oe,t.Popup=Je,t.PosAnimation=Ui,t.Projection=ye,t.Rectangle=_n,t.Renderer=sn,t.SVG=cn,t.SVGOverlay=Ye,t.TileLayer=en,t.Tooltip=$e,t.Transformation=U,t.Util=z,t.VideoOverlay=Ke,t.bind=n,t.bounds=B,t.canvas=an,t.circle=function(t,i,e){return new ke(t,i,e)},t.circleMarker=function(t,i){return new Ee(t,i)},t.control=Gi,t.divIcon=function(t){return new Qe(t)},t.extend=i,t.featureGroup=function(t,i){return new Te(t,i)},t.geoJSON=Ve,t.geoJson=qe,t.gridLayer=function(t){return new tn(t)},t.icon=function(t){return new Me(t)},t.imageOverlay=function(t,i,e){return new Ge(t,i,e)},t.latLng=D,t.latLngBounds=R,t.layerGroup=function(t,i){return new Le(t,i)},t.map=function(t,i){return new Vi(t,i)},t.marker=function(t,i){return new Ze(t,i)},t.point=O,t.polygon=function(t,i){return new Ae(t,i)},t.polyline=function(t,i){return new Oe(t,i)},t.popup=function(t,i){return new Je(t,i)},t.rectangle=function(t,i){return new _n(t,i)},t.setOptions=d,t.stamp=s,t.svg=dn,t.svgOverlay=function(t,i,e){return new Ye(t,i,e)},t.tileLayer=nn,t.tooltip=function(t,i){return new $e(t,i)},t.transformation=V,t.version="1.9.4",t.videoOverlay=function(t,i,e){return new Ke(t,i,e)};var wn=window.L;t.noConflict=function(){return window.L=wn,this},window.L=t});
},{}],"E2ik":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)throw new Error(r||"loader assertion failed.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=e;
},{}],"g5IB":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"TqKA":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var o=arguments[3],e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.window=exports.self=exports.nodeVersion=exports.isWorker=exports.isBrowser=exports.global=exports.document=void 0;const s={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==o&&o,document:"undefined"!=typeof document&&document},t=s.self||s.window||s.global||{};exports.self=t;const n=s.window||s.self||s.global||{};exports.window=n;const r=s.global||s.self||s.window||{};exports.global=r;const i=s.document||{};exports.document=i;const d=Boolean("object"!=typeof e||"[object process]"!==String(e)||!0);exports.isBrowser=d;const p="function"==typeof importScripts;exports.isWorker=p;const l=void 0!==e&&e.version&&/v([0-9]*)/.exec(e.version),c=l&&parseFloat(l[1])||0;exports.nodeVersion=c;
},{"process":"g5IB"}],"MbYB":[function(require,module,exports) {
"use strict";function e(e,t){const o={...e};for(const[r,s]of Object.entries(t))s&&"object"==typeof s?(o[r]=o[r]||{},Object.assign(o[r],t[r])):o[r]=t[r];return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeLoaderOptions=e;
},{}],"CHrA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0;const e="latest",t="3.4.6";exports.VERSION="3.4.6";
},{}],"g1DB":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)throw new Error(r||"loaders.gl assertion failed.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=e;
},{}],"YRRp":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var o=arguments[3],e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.window=exports.self=exports.nodeVersion=exports.isWorker=exports.isMobile=exports.isBrowser=exports.global=exports.document=void 0;const s={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==o&&o,document:"undefined"!=typeof document&&document},t=s.self||s.window||s.global||{};exports.self=t;const n=s.window||s.self||s.global||{};exports.window=n;const r=s.global||s.self||s.window||{};exports.global=r;const i=s.document||{};exports.document=i;const d="object"!=typeof e||"[object process]"!==String(e)||!0;exports.isBrowser=d;const p="function"==typeof importScripts;exports.isWorker=p;const l="undefined"!=typeof window&&void 0!==window.orientation;exports.isMobile=l;const c=void 0!==e&&e.version&&/v([0-9]*)/.exec(e.version),w=c&&parseFloat(c[1])||0;exports.nodeVersion=w;
},{"process":"g5IB"}],"zsbK":[function(require,module,exports) {
"use strict";function t(o){return exports.default=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;
},{}],"YbuI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./typeof.js"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t){if("object"!==(0,e.default)(r)||null===r)return r;var u=r[Symbol.toPrimitive];if(void 0!==u){var i=u.call(r,t||"default");if("object"!==(0,e.default)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)}
},{"./typeof.js":"zsbK"}],"w3h7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=u;var e=r(require("./typeof.js")),t=r(require("./toPrimitive.js"));function r(e){return e&&e.__esModule?e:{default:e}}function u(r){var u=(0,t.default)(r,"string");return"symbol"===(0,e.default)(u)?u:String(u)}
},{"./typeof.js":"zsbK","./toPrimitive.js":"YbuI"}],"iDM3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./toPropertyKey.js"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t,u){return(t=(0,e.default)(t))in r?Object.defineProperty(r,t,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[t]=u,r}
},{"./toPropertyKey.js":"w3h7"}],"UKPw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("@babel/runtime/helpers/esm/defineProperty")),s=require("../env-utils/assert");function t(e){return e&&e.__esModule?e:{default:e}}class r{constructor(s,t){(0,e.default)(this,"name",void 0),(0,e.default)(this,"workerThread",void 0),(0,e.default)(this,"isRunning",!0),(0,e.default)(this,"result",void 0),(0,e.default)(this,"_resolve",()=>{}),(0,e.default)(this,"_reject",()=>{}),this.name=s,this.workerThread=t,this.result=new Promise((e,s)=>{this._resolve=e,this._reject=s})}postMessage(e,s){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:s})}done(e){(0,s.assert)(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){(0,s.assert)(this.isRunning),this.isRunning=!1,this._reject(e)}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../env-utils/assert":"g1DB"}],"ckSF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parentPort=exports.Worker=exports.NodeWorkerType=exports.NodeWorker=void 0;class e{terminate(){}}exports.NodeWorkerType=exports.NodeWorker=exports.Worker=e;const r=null;exports.parentPort=null;
},{}],"sL87":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLoadableWorkerURL=t;var r=require("../env-utils/assert");const e=new Map;function t(t){(0,r.assert)(t.source&&!t.url||!t.source&&t.url);let s=e.get(t.source||t.url);return s||(t.url&&(s=o(t.url),e.set(t.url,s)),t.source&&(s=n(t.source),e.set(t.source,s))),(0,r.assert)(s),s}function o(r){if(!r.startsWith("http"))return r;return n(s(r))}function n(r){const e=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(e)}function s(r){return"try {\n  importScripts('".concat(r,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")}
},{"../env-utils/assert":"g1DB"}],"eDdz":[function(require,module,exports) {
"use strict";function e(n){let f=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const s=r||new Set;if(n){if(t(n))s.add(n);else if(t(n.buffer))s.add(n.buffer);else if(ArrayBuffer.isView(n));else if(f&&"object"==typeof n)for(const t in n)e(n[t],f,s)}else;return void 0===r?Array.from(s):[]}function t(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}function n(e){if(null===e)return{};const t=Object.assign({},e);return Object.keys(t).forEach(f=>{"object"!=typeof e[f]||ArrayBuffer.isView(e[f])||e[f]instanceof Array?"function"==typeof t[f]||t[f]instanceof RegExp?t[f]={}:t[f]=e[f]:t[f]=n(e[f])}),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getTransferList=e,exports.getTransferListForWriter=n;
},{}],"IPZA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("@babel/runtime/helpers/esm/defineProperty")),r=require("../node/worker_threads"),o=require("../env-utils/globals"),t=require("../env-utils/assert"),s=require("../worker-utils/get-loadable-worker-url"),i=require("../worker-utils/get-transfer-list");function n(e){return e&&e.__esModule?e:{default:e}}const a=()=>{};class l{static isSupported(){return"undefined"!=typeof Worker&&o.isBrowser||void 0!==r.NodeWorker&&!o.isBrowser}constructor(r){(0,e.default)(this,"name",void 0),(0,e.default)(this,"source",void 0),(0,e.default)(this,"url",void 0),(0,e.default)(this,"terminated",!1),(0,e.default)(this,"worker",void 0),(0,e.default)(this,"onMessage",void 0),(0,e.default)(this,"onError",void 0),(0,e.default)(this,"_loadableURL","");const{name:s,source:i,url:n}=r;(0,t.assert)(i||n),this.name=s,this.source=i,this.url=n,this.onMessage=a,this.onError=(e=>console.log(e)),this.worker=o.isBrowser?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=a,this.onError=a,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,r){r=r||(0,i.getTransferList)(e),this.worker.postMessage(e,r)}_getErrorFromErrorEvent(e){let r="Failed to load ";return r+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(r+="".concat(e.message," in ")),e.lineno&&(r+=":".concat(e.lineno,":").concat(e.colno)),new Error(r)}_createBrowserWorker(){this._loadableURL=(0,s.getLoadableWorkerURL)({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=(e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))}),e.onerror=(e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0}),e.onmessageerror=(e=>console.error(e)),e}_createNodeWorker(){let e;if(this.url){const o=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new r.NodeWorker(o,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new r.NodeWorker(this.source,{eval:!0})}return e.on("message",e=>{this.onMessage(e)}),e.on("error",e=>{this.onError(e)}),e.on("exit",e=>{}),e}}exports.default=l;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../node/worker_threads":"ckSF","../env-utils/globals":"YRRp","../env-utils/assert":"g1DB","../worker-utils/get-loadable-worker-url":"sL87","../worker-utils/get-transfer-list":"eDdz"}],"Twrx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@babel/runtime/helpers/esm/defineProperty")),t=require("../env-utils/globals"),r=o(require("./worker-thread")),s=o(require("./worker-job"));function o(e){return e&&e.__esModule?e:{default:e}}class u{static isSupported(){return r.default.isSupported()}constructor(t){(0,e.default)(this,"name","unnamed"),(0,e.default)(this,"source",void 0),(0,e.default)(this,"url",void 0),(0,e.default)(this,"maxConcurrency",1),(0,e.default)(this,"maxMobileConcurrency",1),(0,e.default)(this,"onDebug",()=>{}),(0,e.default)(this,"reuseWorkers",!0),(0,e.default)(this,"props",{}),(0,e.default)(this,"jobQueue",[]),(0,e.default)(this,"idleQueue",[]),(0,e.default)(this,"count",0),(0,e.default)(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,r)=>e.done(r),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const s=new Promise(s=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:s}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new s.default(t.name,e);e.onMessage=(e=>t.onMessage(r,e.type,e.payload)),e.onError=(e=>t.onError(r,e)),t.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new r.default({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return t.isMobile?this.maxMobileConcurrency:this.maxConcurrency}}exports.default=u;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../env-utils/globals":"YRRp","./worker-thread":"IPZA","./worker-job":"UKPw"}],"K9DQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=s(require("@babel/runtime/helpers/esm/defineProperty")),e=s(require("./worker-pool")),o=s(require("./worker-thread"));function s(r){return r&&r.__esModule?r:{default:r}}const t={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class u{static isSupported(){return o.default.isSupported()}static getWorkerFarm(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u._workerFarm=u._workerFarm||new u({}),u._workerFarm.setProps(r),u._workerFarm}constructor(e){(0,r.default)(this,"props",void 0),(0,r.default)(this,"workerPools",new Map),this.props={...t},this.setProps(e),this.workerPools=new Map}destroy(){for(const r of this.workerPools.values())r.destroy();this.workerPools=new Map}setProps(r){this.props={...this.props,...r};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(r){const{name:o,source:s,url:t}=r;let u=this.workerPools.get(o);return u||((u=new e.default({name:o,source:s,url:t})).setProps(this._getWorkerPoolProps()),this.workerPools.set(o,u)),u}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}exports.default=u,(0,r.default)(u,"_workerFarm",void 0);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./worker-pool":"Twrx","./worker-thread":"IPZA"}],"iJjo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _getTransferList=require("../worker-utils/get-transfer-list");function getParentPort(){let parentPort;try{eval("globalThis.parentPort = require('worker_threads').parentPort"),parentPort=globalThis.parentPort}catch{}return parentPort}const onMessageWrapperMap=new Map;class WorkerBody{static inWorkerThread(){return"undefined"!=typeof self||Boolean(getParentPort())}static set onmessage(e){function t(t){const r=getParentPort(),{type:s,payload:o}=r?t:t.data;e(s,o)}const r=getParentPort();r?(r.on("message",t),r.on("exit",()=>console.debug("Node worker closing"))):globalThis.onmessage=t}static addEventListener(e){let t=onMessageWrapperMap.get(e);t||(t=(t=>{if(!isKnownMessage(t))return;const r=getParentPort(),{type:s,payload:o}=r?t:t.data;e(s,o)})),getParentPort()?console.error("not implemented"):globalThis.addEventListener("message",t)}static removeEventListener(e){const t=onMessageWrapperMap.get(e);onMessageWrapperMap.delete(e),getParentPort()?console.error("not implemented"):globalThis.removeEventListener("message",t)}static postMessage(e,t){const r={source:"loaders.gl",type:e,payload:t},s=(0,_getTransferList.getTransferList)(t),o=getParentPort();o?o.postMessage(r,s):globalThis.postMessage(r,s)}}function isKnownMessage(e){const{type:t,data:r}=e;return"message"===t&&r&&"string"==typeof r.source&&r.source.startsWith("loaders.gl")}exports.default=WorkerBody;
},{"../worker-utils/get-transfer-list":"eDdz"}],"wzlZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getWorkerName=c,exports.getWorkerURL=n;var e=require("../env-utils/assert"),t=require("../env-utils/version");const o="latest",r="3.4.6";function c(e){const t=e.version!==r?" (worker-utils@".concat(r,")"):"";return"".concat(e.name,"@").concat(e.version).concat(t)}function n(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const c=r[t.id]||{},n="".concat(t.id,"-worker.js");let s=c.workerUrl;if(s||"compression"!==t.id||(s=r.workerUrl),"test"===r._workerType&&(s="modules/".concat(t.module,"/dist/").concat(n)),!s){let e=t.version;"latest"===e&&(e=o);const r=e?"@".concat(e):"";s="https://unpkg.com/@loaders.gl/".concat(t.module).concat(r,"/dist/").concat(n)}return(0,e.assert)(s),s}
},{"../env-utils/assert":"g1DB","../env-utils/version":"CHrA"}],"Zax5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canProcessOnWorker=t,exports.processOnWorker=n;var r=s(require("../worker-farm/worker-farm")),e=require("./get-worker-url"),o=require("../worker-utils/get-transfer-list");function s(r){return r&&r.__esModule?r:{default:r}}function t(e,o){return!!r.default.isSupported()&&(e.worker&&(null==o?void 0:o.worker))}async function n(s,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c=(0,e.getWorkerName)(s),i=r.default.getWorkerFarm(n),{source:l}=n,p={name:c,source:l};l||(p.url=(0,e.getWorkerURL)(s,n));const d=i.getWorkerPool(p),k=n.jobName||s.name,f=await d.startJob(k,a.bind(null,u)),g=(0,o.getTransferListForWriter)(n);return f.postMessage("process",{input:t,options:g}),(await f.result).result}async function a(r,e,o,s){switch(o){case"done":e.done(s);break;case"error":e.error(new Error(s.error));break;case"process":const{id:n,input:a,options:u}=s;try{if(!r.process)return void e.postMessage("error",{id:n,error:"Worker not set up to process on main thread"});const o=await r.process(a,u);e.postMessage("done",{id:n,result:o})}catch(t){const r=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:n,error:r})}break;default:console.warn("process-on-worker: unknown message ".concat(o))}}
},{"../worker-farm/worker-farm":"K9DQ","./get-worker-url":"wzlZ","../worker-utils/get-transfer-list":"eDdz"}],"vJnt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("@babel/runtime/helpers/esm/defineProperty"));function t(e){return e&&e.__esModule?e:{default:e}}let s;s=Symbol.asyncIterator;class r{constructor(){(0,e.default)(this,"_values",void 0),(0,e.default)(this,"_settlers",void 0),(0,e.default)(this,"_closed",void 0),this._values=[],this._settlers=[],this._closed=!1}[s](){return this}push(e){return this.enqueue(e)}enqueue(e){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const t=this._settlers.shift();e instanceof Error?t.reject(e):t.resolve({value:e})}else this._values.push(e)}close(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0}next(){if(this._values.length>0){const e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((e,t)=>{this._settlers.push({resolve:e,reject:t})})}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"iNgB":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createWorker=a;var e=t(require("../async-queue/async-queue")),r=t(require("../worker-farm/worker-body"));function t(e){return e&&e.__esModule?e:{default:e}}let s,o,n=0;function a(t,n){if(!r.default.inWorkerThread())return;const a={process:u};r.default.onmessage=(async(u,c)=>{try{switch(u){case"process":if(!t)throw new Error("Worker does not support atomic processing");const i=await t(c.input,c.options||{},a);r.default.postMessage("done",{result:i});break;case"process-in-batches":if(!n)throw new Error("Worker does not support batched processing");s=new e.default,o=c.options||{};const d=n(s,o,a);for await(const e of d)r.default.postMessage("output-batch",{result:e});r.default.postMessage("done",{});break;case"input-batch":s.push(c.input);break;case"input-done":s.close()}}catch(i){const e=i instanceof Error?i.message:"";r.default.postMessage("error",{error:e})}})}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((s,o)=>{const a=n++,u=(e,t)=>{if(t.id===a)switch(e){case"done":r.default.removeEventListener(u),s(t.result);break;case"error":r.default.removeEventListener(u),o(t.error)}};r.default.addEventListener(u);const c={id:a,input:e,options:t};r.default.postMessage("process",c)})}
},{"../async-queue/async-queue":"vJnt","../worker-farm/worker-body":"iJjo"}],"Vopd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateWorkerVersion=t;var e=require("../env-utils/assert"),r=require("../env-utils/version");function t(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.VERSION;(0,e.assert)(t,"no worker provided");const n=t.version;return!(!o||!n)}function o(e){const r=e.split(".").map(Number);return{major:r[0],minor:r[1]}}
},{"../env-utils/assert":"g1DB","../env-utils/version":"CHrA"}],"sC8V":[function(require,module,exports) {

},{}],"fzhg":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLibraryUrl=l,exports.loadLibrary=s;var e=require("../env-utils/globals"),t=o(require("../node/require-utils.node")),r=require("../env-utils/assert"),n=require("../env-utils/version");function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(n,a,c):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}const a="latest",c="3.4.6",u={};async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t&&(e=l(e,t,r)),u[e]=u[e]||f(e),await u[e]}function l(t,n,i){if(t.startsWith("http"))return t;const o=i.modules||{};return o[t]?o[t]:e.isBrowser?i.CDN?((0,r.assert)(i.CDN.startsWith("http")),"".concat(i.CDN,"/").concat(n,"@").concat(c,"/dist/libs/").concat(t)):e.isWorker?"../src/libs/".concat(t):"modules/".concat(n,"/src/libs/").concat(t):"modules/".concat(n,"/dist/libs/").concat(t)}async function f(r){if(r.endsWith("wasm")){const e=await fetch(r);return await e.arrayBuffer()}if(!e.isBrowser)try{return t&&t.requireFromFile&&await t.requireFromFile(r)}catch{return null}if(e.isWorker)return importScripts(r);const n=await fetch(r);return d(await n.text(),r)}function d(r,n){if(!e.isBrowser)return t.requireFromString&&t.requireFromString(r,n);if(e.isWorker)return eval.call(e.global,r),null;const i=document.createElement("script");i.id=n;try{i.appendChild(document.createTextNode(r))}catch(o){i.text=r}return document.body.appendChild(i),null}
},{"../env-utils/globals":"YRRp","../node/require-utils.node":"sC8V","../env-utils/assert":"g1DB","../env-utils/version":"CHrA"}],"gqfu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AsyncQueue",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(exports,"ChildProcessProxy",{enumerable:!0,get:function(){return k.default}}),exports.NullWorker=void 0,Object.defineProperty(exports,"WorkerBody",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(exports,"WorkerFarm",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"WorkerJob",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"WorkerPool",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"WorkerThread",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return r.assert}}),Object.defineProperty(exports,"canProcessOnWorker",{enumerable:!0,get:function(){return l.canProcessOnWorker}}),Object.defineProperty(exports,"createWorker",{enumerable:!0,get:function(){return a.createWorker}}),Object.defineProperty(exports,"getLibraryUrl",{enumerable:!0,get:function(){return p.getLibraryUrl}}),Object.defineProperty(exports,"getTransferList",{enumerable:!0,get:function(){return f.getTransferList}}),Object.defineProperty(exports,"getTransferListForWriter",{enumerable:!0,get:function(){return f.getTransferListForWriter}}),Object.defineProperty(exports,"getWorkerURL",{enumerable:!0,get:function(){return b.getWorkerURL}}),Object.defineProperty(exports,"isBrowser",{enumerable:!0,get:function(){return t.isBrowser}}),Object.defineProperty(exports,"isWorker",{enumerable:!0,get:function(){return t.isWorker}}),Object.defineProperty(exports,"loadLibrary",{enumerable:!0,get:function(){return p.loadLibrary}}),Object.defineProperty(exports,"processOnWorker",{enumerable:!0,get:function(){return l.processOnWorker}}),Object.defineProperty(exports,"validateWorkerVersion",{enumerable:!0,get:function(){return c.validateWorkerVersion}});var e=require("./lib/env-utils/version"),r=require("./lib/env-utils/assert"),t=require("./lib/env-utils/globals"),o=y(require("./lib/worker-farm/worker-job")),n=y(require("./lib/worker-farm/worker-thread")),i=y(require("./lib/worker-farm/worker-farm")),u=y(require("./lib/worker-farm/worker-pool")),s=y(require("./lib/worker-farm/worker-body")),l=require("./lib/worker-api/process-on-worker"),a=require("./lib/worker-api/create-worker"),b=require("./lib/worker-api/get-worker-url"),c=require("./lib/worker-api/validate-worker-version"),f=require("./lib/worker-utils/get-transfer-list"),p=require("./lib/library-utils/library-utils"),d=y(require("./lib/async-queue/async-queue")),k=y(require("./lib/process-utils/child-process-proxy"));function y(e){return e&&e.__esModule?e:{default:e}}const g={id:"null",name:"null",module:"worker-utils",version:e.VERSION,options:{null:{}}};exports.NullWorker=g;
},{"./lib/env-utils/version":"CHrA","./lib/env-utils/assert":"g1DB","./lib/env-utils/globals":"YRRp","./lib/worker-farm/worker-job":"UKPw","./lib/worker-farm/worker-thread":"IPZA","./lib/worker-farm/worker-farm":"K9DQ","./lib/worker-farm/worker-pool":"Twrx","./lib/worker-farm/worker-body":"iJjo","./lib/worker-api/process-on-worker":"Zax5","./lib/worker-api/create-worker":"iNgB","./lib/worker-api/get-worker-url":"wzlZ","./lib/worker-api/validate-worker-version":"Vopd","./lib/worker-utils/get-transfer-list":"eDdz","./lib/library-utils/library-utils":"fzhg","./lib/async-queue/async-queue":"vJnt","./lib/process-utils/child-process-proxy":"sC8V"}],"jOTJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLoaderWorker=o;var e=require("@loaders.gl/worker-utils");let r=0;function o(r){e.WorkerBody.inWorkerThread()&&(e.WorkerBody.onmessage=(async(o,n)=>{switch(o){case"process":try{const{input:o,options:c={},context:i={}}=n,d=await s({loader:r,arrayBuffer:o,options:c,context:{...i,parse:t}});e.WorkerBody.postMessage("done",{result:d})}catch(a){const r=a instanceof Error?a.message:"";e.WorkerBody.postMessage("error",{error:r})}}}))}function t(o,t){return new Promise((s,n)=>{const a=r++,c=(r,o)=>{if(o.id===a)switch(r){case"done":e.WorkerBody.removeEventListener(c),s(o.result);break;case"error":e.WorkerBody.removeEventListener(c),n(o.error)}};e.WorkerBody.addEventListener(c);const i={id:a,input:o,options:t};e.WorkerBody.postMessage("process",i)})}async function s(e){let r,o,{loader:t,arrayBuffer:s,options:n,context:a}=e;if(t.parseSync||t.parse)r=s,o=t.parseSync||t.parse;else{if(!t.parseTextSync)throw new Error("Could not load data with ".concat(t.name," loader"));r=(new TextDecoder).decode(s),o=t.parseTextSync}return n={...n,modules:t&&t.options&&t.options.modules||{},worker:!1},await o(r,{...n},a,t)}
},{"@loaders.gl/worker-utils":"gqfu"}],"xrMV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canParseWithWorker=e,exports.parseWithWorker=o;var r=require("@loaders.gl/worker-utils");function e(e,o){return!!r.WorkerFarm.isSupported()&&(!!(r.isBrowser||null!=o&&o._nodeWorkers)&&(e.worker&&(null==o?void 0:o.worker)))}async function o(e,o,t,n,a){const i=e.id,c=(0,r.getWorkerURL)(e,t),u=r.WorkerFarm.getWorkerFarm(t).getWorkerPool({name:i,url:c});t=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(n||{}));const p=await u.startJob("process-on-worker",s.bind(null,a));p.postMessage("process",{input:o,options:t,context:n});const k=await p.result;return await k.result}async function s(r,e,o,s){switch(o){case"done":e.done(s);break;case"error":e.error(new Error(s.error));break;case"process":const{id:n,input:a,options:i}=s;try{const o=await r(a,i);e.postMessage("done",{id:n,result:o})}catch(t){const r=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:n,error:r})}break;default:console.warn("parse-with-worker unknown message ".concat(o))}}
},{"@loaders.gl/worker-utils":"gqfu"}],"Bs13":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canEncodeWithWorker=o;var r=require("@loaders.gl/worker-utils"),e=require("../env-utils/globals");function o(o,s){return!!r.WorkerFarm.isSupported()&&(!!(e.isBrowser||null!=s&&s._nodeWorkers)&&(o.worker&&(null==s?void 0:s.worker)))}
},{"@loaders.gl/worker-utils":"gqfu","../env-utils/globals":"TqKA"}],"BEhU":[function(require,module,exports) {
"use strict";function e(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,r);if(ArrayBuffer.isView(e))return t(e.buffer,e.byteOffset,r);if(e instanceof ArrayBuffer){return t(e,0,r)}return""}function t(e,t,r){if(e.byteLength<=t+r)return"";const n=new DataView(e);let i="";for(let f=0;f<r;f++)i+=String.fromCharCode(n.getUint8(t+f));return i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFirstCharacters=e,exports.getMagicString=t;
},{}],"icoB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseJSON=t;var r=require("../binary-utils/get-first-characters");function t(t){try{return JSON.parse(t)}catch(e){throw new Error('Failed to parse JSON from data starting with "'.concat((0,r.getFirstCharacters)(t),'"'))}}
},{"../binary-utils/get-first-characters":"BEhU"}],"nOgr":[function(require,module,exports) {
"use strict";function r(r,e,t){if(t=t||r.byteLength,r.byteLength<t||e.byteLength<t)return!1;const n=new Uint8Array(r),o=new Uint8Array(e);for(let a=0;a<n.length;++a)if(n[a]!==o[a])return!1;return!0}function e(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];const n=e.map(r=>r instanceof ArrayBuffer?new Uint8Array(r):r),o=n.reduce((r,e)=>r+e.byteLength,0),a=new Uint8Array(o);let c=0;for(const f of n)a.set(f,c),c+=f.byteLength;return a.buffer}function t(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];const n=e,o=n&&n.length>1&&n[0].constructor||null;if(!o)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');const a=new o(n.reduce((r,e)=>r+e.length,0));let c=0;for(const f of n)a.set(f,c),c+=f.length;return a}function n(r,e,t){const n=void 0!==t?new Uint8Array(r).subarray(e,e+t):new Uint8Array(r).subarray(e);return new Uint8Array(n).buffer}Object.defineProperty(exports,"__esModule",{value:!0}),exports.compareArrayBuffers=r,exports.concatenateArrayBuffers=e,exports.concatenateTypedArrays=t,exports.sliceArrayBuffer=n;
},{}],"FUVZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.copyArrayBuffer=t,exports.copyToArray=n,exports.padToNBytes=r;var e=require("../env-utils/assert");function r(r,t){return(0,e.assert)(r>=0),(0,e.assert)(t>0),r+(t-1)&~(t-1)}function t(e,r,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.byteLength;const s=new Uint8Array(e,t,n),o=new Uint8Array(r);return s.set(o),e}function n(e,t,n){let s;if(e instanceof ArrayBuffer)s=new Uint8Array(e);else{const r=e.byteOffset,t=e.byteLength;s=new Uint8Array(e.buffer||e.arrayBuffer,r,t)}return t.set(s,n),n+r(s.byteLength,4)}
},{"../env-utils/assert":"E2ik"}],"FcRu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.copyBinaryToDataView=n,exports.copyPaddedArrayBufferToDataView=o,exports.copyPaddedStringToDataView=i,exports.copyStringToDataView=r,exports.padStringToByteAlignment=t;var e=require("./memory-copy-utils");function t(e,t){const r=e.length,n=Math.ceil(r/t)*t-r;let o="";for(let i=0;i<n;++i)o+=" ";return e+o}function r(e,t,r,n){if(e)for(let o=0;o<n;o++)e.setUint8(t+o,r.charCodeAt(o));return t+n}function n(e,t,r,n){if(e)for(let o=0;o<n;o++)e.setUint8(t+o,r[o]);return t+n}function o(t,r,n,o){const i=(0,e.padToNBytes)(n.byteLength,o),a=i-n.byteLength;if(t){const e=new Uint8Array(t.buffer,t.byteOffset+r,n.byteLength),o=new Uint8Array(n);e.set(o);for(let i=0;i<a;++i)t.setUint8(r+n.byteLength+i,32)}return r+=i}function i(e,t,r,n){return t=o(e,t,(new TextEncoder).encode(r),n)}
},{"./memory-copy-utils":"FUVZ"}],"c4AR":[function(require,module,exports) {
"use strict";function e(e){try{let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const t=new TextDecoder(void 0,o);for await(const o of e)yield"string"==typeof o?o:t.decode(o,{stream:!0})}()}catch(t){return Promise.reject(t)}}async function*t(e){const t=new TextEncoder;for await(const o of e)yield"string"==typeof o?t.encode(o):o}async function*o(e){let t="";for await(const o of e){let e;for(t+=o;(e=t.indexOf("\n"))>=0;){const o=t.slice(0,e+1);t=t.slice(e+1),yield o}}t.length>0&&(yield t)}async function*n(e){let t=1;for await(const o of e)yield{counter:t,line:o},t++}Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeLineIterator=o,exports.makeNumberedLineIterator=n,exports.makeTextDecoderIterator=e,exports.makeTextEncoderIterator=t;
},{}],"T0TF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concatenateArrayBuffersAsync=n,exports.concatenateStringsAsync=e,exports.forEach=t;var r=require("../binary-utils/array-buffer-utils");async function t(r,t){for(;;){const{done:n,value:e}=await r.next();if(n)return void r.return();if(t(e))return}}async function n(t){const n=[];for await(const r of t)n.push(r);return(0,r.concatenateArrayBuffers)(...n)}async function e(r){const t=[];for await(const n of r)t.push(n);return t.join("")}
},{"../binary-utils/array-buffer-utils":"nOgr"}],"Qm3h":[function(require,module,exports) {
var process = require("process");
var e=require("process");function o(){let o;if("undefined"!=typeof window&&window.performance)o=window.performance.now();else if(void 0!==e&&e.hrtime){const r=e.hrtime();o=1e3*r[0]+r[1]/1e6}else o=Date.now();return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;
},{"process":"g5IB"}],"sXeQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("../utils/hi-res-timestamp.js"));function s(t){return t&&t.__esModule?t:{default:t}}class i{constructor(t,s){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=s,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=(0,t.default)(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime((0,t.default)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}exports.default=i;
},{"../utils/hi-res-timestamp.js":"Qm3h"}],"uFxO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./stat.js"));function e(t){return t&&t.__esModule?t:{default:t}}class s{constructor(t){this.id=void 0,this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t of Object.values(this.stats))t.reset();return this}forEach(t){for(const e of Object.values(this.stats))t(e)}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:s,type:i}=e;let a=this.stats[s];return a||(a=e instanceof t.default?e:new t.default(s,i),this.stats[s]=a),a}}exports.default=s;
},{"./stat.js":"sXeQ"}],"vfNS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Stat",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"Stats",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"_getHiResTimestamp",{enumerable:!0,get:function(){return r.default}});var e=u(require("./lib/stats.js")),t=u(require("./lib/stat.js")),r=u(require("./utils/hi-res-timestamp.js"));function u(e){return e&&e.__esModule?e:{default:e}}
},{"./lib/stats.js":"uFxO","./lib/stat.js":"sXeQ","./utils/hi-res-timestamp.js":"Qm3h"}],"tWMk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@probe.gl/stats");function s(e){return e&&e.__esModule?e:{default:e}}const u="Queued Requests",i="Active Requests",r="Cancelled Requests",o="Queued Requests Ever",h="Active Requests Ever",l={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class a{constructor(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,e.default)(this,"props",void 0),(0,e.default)(this,"stats",void 0),(0,e.default)(this,"activeRequestCount",0),(0,e.default)(this,"requestQueue",[]),(0,e.default)(this,"requestMap",new Map),(0,e.default)(this,"deferredUpdate",null),this.props={...l,...s},this.stats=new t.Stats({id:this.props.id}),this.stats.get(u),this.stats.get(i),this.stats.get(r),this.stats.get(o),this.stats.get(h)}scheduleRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const s={handle:e,priority:0,getPriority:t},u=new Promise(e=>(s.resolve=e,s));return this.requestQueue.push(s),this.requestMap.set(e,u),this._issueNewRequests(),u}_issueRequest(e){const{handle:t,resolve:s}=e;let u=!1;const i=()=>{u||(u=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,s?s({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const s=e[t];this._updateRequest(s)||(e.splice(t,1),this.requestMap.delete(s.handle),t--)}e.sort((e,t)=>e.priority-t.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@probe.gl/stats":"vfNS"}],"WQDH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addAliases=n,exports.getPathPrefix=r,exports.resolvePath=o,exports.setPathPrefix=s;let t="";const e={};function s(e){t=e}function r(){return t}function n(t){Object.assign(e,t)}function o(s){for(const t in e)if(s.startsWith(t)){const r=e[t];s=s.replace(t,r)}return s.startsWith("http://")||s.startsWith("https://")||(s="".concat(t).concat(s)),s}
},{}],"LFHS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._typecheckJSONLoader=exports.JSONLoader=void 0;const e="3.4.6",o={name:"JSON",id:"json",module:"json",version:"3.4.6",extensions:["json","geojson"],mimeTypes:["application/json"],category:"json",text:!0,parseTextSync:s,parse:async e=>s((new TextDecoder).decode(e)),options:{}};function s(e){return JSON.parse(e)}exports.JSONLoader=o;const t=o;exports._typecheckJSONLoader=t;
},{}],"tF2k":[function(require,module,exports) {
"use strict";function r(r){return r}function e(r){throw new Error("Buffer not supported in browser")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.toArrayBuffer=r,exports.toBuffer=e;
},{}],"cqIj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isBuffer=f,exports.toArrayBuffer=u,exports.toBuffer=n;var e=t(require("../node/buffer"));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,f=new WeakMap;return(r=function(e){return e?f:t})(e)}function t(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var f=r(t);if(f&&f.has(e))return f.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=u?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,f&&f.set(e,n),n}function f(e){return e&&"object"==typeof e&&e.isBuffer}function n(r){return e.toBuffer?e.toBuffer(r):r}function u(r){if(f(r))return e.toArrayBuffer(r);if(r instanceof ArrayBuffer)return r;if(ArrayBuffer.isView(r))return 0===r.byteOffset&&r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);if("string"==typeof r){const e=r;return(new TextEncoder).encode(e).buffer}if(r&&"object"==typeof r&&r._toArrayBuffer)return r._toArrayBuffer();throw new Error("toArrayBuffer")}
},{"../node/buffer":"tF2k"}],"ZSPB":[function(require,module,exports) {
"use strict";function e(e){return r=>new Promise((o,i)=>e(r,(e,r)=>e?i(e):o(r)))}function r(e){return(r,o)=>new Promise((i,t)=>e(r,o,(e,r)=>e?t(e):i(r)))}function o(e){return(r,o,i)=>new Promise((t,n)=>e(r,o,i,(e,r)=>e?n(e):t(r)))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.promisify1=e,exports.promisify2=r,exports.promisify3=o;
},{}],"Vadc":[function(require,module,exports) {
var process = require("process");
var e=require("process");function o(){var o;if(void 0!==e&&void 0!==e.cwd)return e.cwd();const r=null===(o=window.location)||void 0===o?void 0:o.pathname;return(null==r?void 0:r.slice(0,r.lastIndexOf("/")+1))||""}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCWD=o;
},{"process":"g5IB"}],"hewW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.dirname=n,exports.filename=t,exports.join=o,exports.resolve=r;var e=require("./get-cwd");function t(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function n(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=t.map((e,n)=>(n&&(e=e.replace(new RegExp("^".concat("/")),"")),n!==t.length-1&&(e=e.replace(new RegExp("".concat("/","$")),"")),e))).join("/")}function r(){const t=[];for(let e=0;e<arguments.length;e++)t[e]=e<0||arguments.length<=e?void 0:arguments[e];let n,o="",r=!1;for(let c=t.length-1;c>=-1&&!r;c--){let s;c>=0?s=t[c]:(void 0===n&&(n=(0,e.getCWD)()),s=n),0!==s.length&&(o="".concat(s,"/").concat(o),r=s.charCodeAt(0)===l)}return o=s(o,!r),r?"/".concat(o):o.length>0?o:"."}const l=47,c=46;function s(e,t){let n,o="",r=-1,s=0,i=!1;for(let a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(n===l)break;n=l}if(n===l){if(r===a-1||1===s);else if(r!==a-1&&2===s){if(o.length<2||!i||o.charCodeAt(o.length-1)!==c||o.charCodeAt(o.length-2)!==c)if(o.length>2){const e=o.length-1;let t=e;for(;t>=0&&o.charCodeAt(t)!==l;--t);if(t!==e){o=-1===t?"":o.slice(0,t),r=a,s=0,i=!1;continue}}else if(2===o.length||1===o.length){o="",r=a,s=0,i=!1;continue}t&&(o.length>0?o+="/..":o="..",i=!0)}else{const t=e.slice(r+1,a);o.length>0?o+="/".concat(t):o=t,i=!1}r=a,s=0}else n===c&&-1!==s?++s:s=-1}return o}
},{"./get-cwd":"Vadc"}],"FRly":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){var n,o,a=h(r),u=a[0],i=a[1],f=new e(c(r,u,i)),A=0,d=i>0?u-4:u;for(o=0;o<d;o+=4)n=t[r.charCodeAt(o)]<<18|t[r.charCodeAt(o+1)]<<12|t[r.charCodeAt(o+2)]<<6|t[r.charCodeAt(o+3)],f[A++]=n>>16&255,f[A++]=n>>8&255,f[A++]=255&n;return 2===i&&(n=t[r.charCodeAt(o)]<<2|t[r.charCodeAt(o+1)]>>4,f[A++]=255&n),1===i&&(n=t[r.charCodeAt(o)]<<10|t[r.charCodeAt(o+1)]<<4|t[r.charCodeAt(o+2)]>>2,f[A++]=n>>8&255,f[A++]=255&n),f}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"Quj6":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"aqZJ":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"aMB2":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"FRly","ieee754":"Quj6","isarray":"aqZJ","buffer":"aMB2"}],"SX3Q":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports._readToArrayBuffer=S,exports.writeFileSync=exports.writeFile=exports.stat=exports.readdir=exports.readFileSync=exports.readFile=exports.read=exports.open=exports.isSupported=exports.fstat=exports.createWriteStream=exports.close=void 0;var r=s(require("fs")),t=require("./buffer"),o=require("./promisify");function s(e){return e&&e.__esModule?e:{default:e}}let a,i,p,d,l,f,x,u,n,c,y;exports.readdir=a,exports.stat=i,exports.readFile=p,exports.readFileSync=d,exports.writeFile=l,exports.writeFileSync=f,exports.open=x,exports.close=u,exports.read=n,exports.fstat=c,exports.createWriteStream=y;let F=Boolean(r.default);exports.isSupported=F;try{exports.readdir=a=(0,o.promisify2)(r.default.readdir),exports.stat=i=(0,o.promisify2)(r.default.stat),exports.readFile=p=r.default.readFile,exports.readFileSync=d=r.default.readFileSync,exports.writeFile=l=(0,o.promisify3)(r.default.writeFile),exports.writeFileSync=f=r.default.writeFileSync,exports.open=x=r.default.open,exports.close=u=(e=>new Promise((t,o)=>r.default.close(e,e=>e?o(e):t()))),exports.read=n=r.default.read,exports.fstat=c=r.default.fstat,exports.createWriteStream=y=r.default.createWriteStream,exports.isSupported=F=Boolean(r.default)}catch{}async function S(r,o,s){const a=e.alloc(s),{bytesRead:i}=await n(r,a,0,s,o);if(i!==s)throw new Error("fs.read failed");return(0,t.toArrayBuffer)(a)}
},{"fs":"sC8V","./buffer":"tF2k","./promisify":"ZSPB","buffer":"aMB2"}],"scuV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isSupported=exports.Transform=void 0;var e=r(require("stream"));function r(e){return e&&e.__esModule?e:{default:e}}let t;exports.Transform=t;const o=Boolean(e.default);exports.isSupported=o;try{exports.Transform=t=e.default.Transform}catch{}
},{"stream":"sC8V"}],"BLgH":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function r(r){if(r instanceof ArrayBuffer){return{read:async(a,s)=>e.from(r,a,s),close:async()=>{},size:r.byteLength}}const a=r;return{read:async(r,s)=>{const n=await a.slice(r,r+s).arrayBuffer();return e.from(n)},close:async()=>{},size:a.size}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeReadableFile=r;
},{"buffer":"aMB2"}],"qesQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeWritableFile=o;var e=require("../env-utils/globals"),r=n(require("../node/fs"));function t(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(t=function(e){return e?n:r})(e)}function n(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=t(r);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var a=i?Object.getOwnPropertyDescriptor(e,u):null;a&&(a.get||a.set)?Object.defineProperty(o,u,a):o[u]=e[u]}return o.default=e,n&&n.set(e,o),o}function o(t,n){if(e.isBrowser)return{write:async()=>{},close:async()=>{}};const o="string"==typeof t?r.createWriteStream(t,n):t;return{write:async e=>new Promise((r,t)=>{o.write(e,e=>e?t(e):r())}),close:()=>new Promise((e,r)=>{o.close(t=>t?r(t):e())})}}
},{"../env-utils/globals":"TqKA","../node/fs":"SX3Q"}],"Oou1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("../node/fs"));function t(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(t=function(e){return e?n:r})(e)}function r(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=t(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var f=o?Object.getOwnPropertyDescriptor(e,s):null;f&&(f.get||f.set)?Object.defineProperty(a,s,f):a[s]=e[s]}return a.default=e,n&&n.set(e,a),a}class n{constructor(e){this.fetch=e._fetch}async readdir(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".",r=arguments.length>1?arguments[1]:void 0;return await e.readdir(t,r)}async stat(t,r){const n=await e.stat(t,r);return{size:Number(n.size),isDirectory:()=>!1,info:n}}async fetch(e,t){return(t.fetch||this.fetch)(e,t)}async open(t,r,n){return await e.open(t,r)}async close(t){return await e.close(t)}async fstat(t){return await e.fstat(t)}async read(t,r){let{buffer:n=null,offset:a=0,length:o=n.byteLength,position:s=null}=r,f=0;for(;f<o;){const{bytesRead:r}=await e.read(t,n,a+f,o-f,s+f);f+=r}return{bytesRead:f,buffer:n}}}exports.default=n;
},{"../node/fs":"SX3Q"}],"oHIH":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"JSONLoader",{enumerable:!0,get:function(){return m.JSONLoader}}),Object.defineProperty(exports,"RequestScheduler",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(exports,"_NodeFileSystem",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(exports,"_addAliases",{enumerable:!0,get:function(){return y.addAliases}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return r.assert}}),Object.defineProperty(exports,"canEncodeWithWorker",{enumerable:!0,get:function(){return u.canEncodeWithWorker}}),Object.defineProperty(exports,"canParseWithWorker",{enumerable:!0,get:function(){return i.canParseWithWorker}}),Object.defineProperty(exports,"compareArrayBuffers",{enumerable:!0,get:function(){return f.compareArrayBuffers}}),Object.defineProperty(exports,"concatenateArrayBuffers",{enumerable:!0,get:function(){return f.concatenateArrayBuffers}}),Object.defineProperty(exports,"concatenateArrayBuffersAsync",{enumerable:!0,get:function(){return b.concatenateArrayBuffersAsync}}),Object.defineProperty(exports,"concatenateTypedArrays",{enumerable:!0,get:function(){return f.concatenateTypedArrays}}),Object.defineProperty(exports,"copyArrayBuffer",{enumerable:!0,get:function(){return s.copyArrayBuffer}}),Object.defineProperty(exports,"copyBinaryToDataView",{enumerable:!0,get:function(){return c.copyBinaryToDataView}}),Object.defineProperty(exports,"copyPaddedArrayBufferToDataView",{enumerable:!0,get:function(){return c.copyPaddedArrayBufferToDataView}}),Object.defineProperty(exports,"copyPaddedStringToDataView",{enumerable:!0,get:function(){return c.copyPaddedStringToDataView}}),Object.defineProperty(exports,"copyStringToDataView",{enumerable:!0,get:function(){return c.copyStringToDataView}}),Object.defineProperty(exports,"copyToArray",{enumerable:!0,get:function(){return s.copyToArray}}),Object.defineProperty(exports,"createLoaderWorker",{enumerable:!0,get:function(){return o.createLoaderWorker}}),Object.defineProperty(exports,"document",{enumerable:!0,get:function(){return t.document}}),Object.defineProperty(exports,"forEach",{enumerable:!0,get:function(){return b.forEach}}),exports.fs=void 0,Object.defineProperty(exports,"getFirstCharacters",{enumerable:!0,get:function(){return p.getFirstCharacters}}),Object.defineProperty(exports,"getMagicString",{enumerable:!0,get:function(){return p.getMagicString}}),Object.defineProperty(exports,"getPathPrefix",{enumerable:!0,get:function(){return y.getPathPrefix}}),Object.defineProperty(exports,"global",{enumerable:!0,get:function(){return t.global}}),Object.defineProperty(exports,"isBrowser",{enumerable:!0,get:function(){return t.isBrowser}}),Object.defineProperty(exports,"isBuffer",{enumerable:!0,get:function(){return g.isBuffer}}),Object.defineProperty(exports,"isWorker",{enumerable:!0,get:function(){return t.isWorker}}),Object.defineProperty(exports,"makeLineIterator",{enumerable:!0,get:function(){return l.makeLineIterator}}),Object.defineProperty(exports,"makeNumberedLineIterator",{enumerable:!0,get:function(){return l.makeNumberedLineIterator}}),Object.defineProperty(exports,"makeReadableFile",{enumerable:!0,get:function(){return k.makeReadableFile}}),Object.defineProperty(exports,"makeTextDecoderIterator",{enumerable:!0,get:function(){return l.makeTextDecoderIterator}}),Object.defineProperty(exports,"makeTextEncoderIterator",{enumerable:!0,get:function(){return l.makeTextEncoderIterator}}),Object.defineProperty(exports,"makeWritableFile",{enumerable:!0,get:function(){return w.makeWritableFile}}),Object.defineProperty(exports,"mergeLoaderOptions",{enumerable:!0,get:function(){return n.mergeLoaderOptions}}),Object.defineProperty(exports,"nodeVersion",{enumerable:!0,get:function(){return t.nodeVersion}}),Object.defineProperty(exports,"padStringToByteAlignment",{enumerable:!0,get:function(){return c.padStringToByteAlignment}}),Object.defineProperty(exports,"padToNBytes",{enumerable:!0,get:function(){return s.padToNBytes}}),Object.defineProperty(exports,"parseJSON",{enumerable:!0,get:function(){return a.parseJSON}}),Object.defineProperty(exports,"parseWithWorker",{enumerable:!0,get:function(){return i.parseWithWorker}}),exports.path=void 0,Object.defineProperty(exports,"promisify1",{enumerable:!0,get:function(){return P.promisify1}}),Object.defineProperty(exports,"promisify2",{enumerable:!0,get:function(){return P.promisify2}}),Object.defineProperty(exports,"resolvePath",{enumerable:!0,get:function(){return y.resolvePath}}),Object.defineProperty(exports,"self",{enumerable:!0,get:function(){return t.self}}),Object.defineProperty(exports,"setPathPrefix",{enumerable:!0,get:function(){return y.setPathPrefix}}),Object.defineProperty(exports,"sliceArrayBuffer",{enumerable:!0,get:function(){return f.sliceArrayBuffer}}),exports.stream=void 0,Object.defineProperty(exports,"toArrayBuffer",{enumerable:!0,get:function(){return g.toArrayBuffer}}),Object.defineProperty(exports,"toBuffer",{enumerable:!0,get:function(){return g.toBuffer}}),Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return t.window}});var r=require("./lib/env-utils/assert"),t=require("./lib/env-utils/globals"),n=require("./lib/option-utils/merge-loader-options"),o=require("./lib/worker-loader-utils/create-loader-worker"),i=require("./lib/worker-loader-utils/parse-with-worker"),u=require("./lib/worker-loader-utils/encode-with-worker"),a=require("./lib/parser-utils/parse-json"),f=require("./lib/binary-utils/array-buffer-utils"),s=require("./lib/binary-utils/memory-copy-utils"),c=require("./lib/binary-utils/dataview-copy-utils"),p=require("./lib/binary-utils/get-first-characters"),l=require("./lib/iterators/text-iterators"),b=require("./lib/iterators/async-iteration"),d=A(require("./lib/request-utils/request-scheduler")),y=require("./lib/path-utils/file-aliases"),m=require("./json-loader"),g=require("./lib/binary-utils/memory-conversion-utils"),P=require("./lib/node/promisify"),x=B(require("./lib/path-utils/path"));exports.path=x;var O=B(require("./lib/node/fs"));exports.fs=O;var j=B(require("./lib/node/stream"));exports.stream=j;var k=require("./lib/filesystems/readable-file"),w=require("./lib/filesystems/writable-file"),h=A(require("./lib/filesystems/node-filesystem"));function q(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(q=function(e){return e?t:r})(e)}function B(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=q(r);if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function A(e){return e&&e.__esModule?e:{default:e}}
},{"./lib/env-utils/assert":"E2ik","./lib/env-utils/globals":"TqKA","./lib/option-utils/merge-loader-options":"MbYB","./lib/worker-loader-utils/create-loader-worker":"jOTJ","./lib/worker-loader-utils/parse-with-worker":"xrMV","./lib/worker-loader-utils/encode-with-worker":"Bs13","./lib/parser-utils/parse-json":"icoB","./lib/binary-utils/array-buffer-utils":"nOgr","./lib/binary-utils/memory-copy-utils":"FUVZ","./lib/binary-utils/dataview-copy-utils":"FcRu","./lib/binary-utils/get-first-characters":"BEhU","./lib/iterators/text-iterators":"c4AR","./lib/iterators/async-iteration":"T0TF","./lib/request-utils/request-scheduler":"tWMk","./lib/path-utils/file-aliases":"WQDH","./json-loader":"LFHS","./lib/binary-utils/memory-conversion-utils":"cqIj","./lib/node/promisify":"ZSPB","./lib/path-utils/path":"hewW","./lib/node/fs":"SX3Q","./lib/node/stream":"scuV","./lib/filesystems/readable-file":"BLgH","./lib/filesystems/writable-file":"qesQ","./lib/filesystems/node-filesystem":"Oou1"}],"Oy8e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isWritableStream=exports.isWritableNodeStream=exports.isWritableDOMStream=exports.isResponse=exports.isReadableStream=exports.isReadableNodeStream=exports.isReadableDOMStream=exports.isPureObject=exports.isPromise=exports.isObject=exports.isIterator=exports.isIterable=exports.isFile=exports.isBuffer=exports.isBlob=exports.isAsyncIterable=void 0;const e=e=>"boolean"==typeof e,t=e=>"function"==typeof e,s=e=>null!==e&&"object"==typeof e;exports.isObject=s;const o=e=>s(e)&&e.constructor==={}.constructor;exports.isPureObject=o;const r=e=>s(e)&&t(e.then);exports.isPromise=r;const i=e=>e&&"function"==typeof e[Symbol.iterator];exports.isIterable=i;const a=e=>e&&"function"==typeof e[Symbol.asyncIterator];exports.isAsyncIterable=a;const n=e=>e&&t(e.next);exports.isIterator=n;const p=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json;exports.isResponse=p;const c=e=>"undefined"!=typeof File&&e instanceof File;exports.isFile=c;const l=e=>"undefined"!=typeof Blob&&e instanceof Blob;exports.isBlob=l;const b=e=>e&&"object"==typeof e&&e.isBuffer;exports.isBuffer=b;const x=e=>s(e)&&t(e.abort)&&t(e.getWriter);exports.isWritableDOMStream=x;const f=e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||s(e)&&t(e.tee)&&t(e.cancel)&&t(e.getReader);exports.isReadableDOMStream=f;const d=o=>s(o)&&t(o.end)&&t(o.write)&&e(o.writable);exports.isWritableNodeStream=d;const u=o=>s(o)&&t(o.read)&&t(o.pipe)&&e(o.readable);exports.isReadableNodeStream=u;const m=e=>f(e)||u(e);exports.isReadableStream=m;const y=e=>x(e)||d(e);exports.isWritableStream=y;
},{}],"P8kQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseMIMEType=r,exports.parseMIMETypeFromURL=o;const e=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,t=/^([-\w.]+\/[-\w.+]+)/;function r(e){const r=t.exec(e);return r?r[1]:e}function o(t){const r=e.exec(t);return r?r[1]:""}
},{}],"ysxf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractQueryString=e,exports.stripQueryString=r;const t=/\?.*/;function e(e){const r=e.match(t);return r&&r[0]}function r(e){return e.replace(t,"")}
},{}],"ABhg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getResourceContentLength=i,exports.getResourceMIMEType=n,exports.getResourceUrl=s;var e=require("../../javascript-utils/is-type"),r=require("./mime-type-utils"),t=require("./url-utils");function s(r){if((0,e.isResponse)(r)){return r.url}if((0,e.isBlob)(r)){return r.name||""}return"string"==typeof r?r:""}function n(s){if((0,e.isResponse)(s)){const e=s,n=e.headers.get("content-type")||"",i=(0,t.stripQueryString)(e.url);return(0,r.parseMIMEType)(n)||(0,r.parseMIMETypeFromURL)(i)}if((0,e.isBlob)(s)){return s.type||""}return"string"==typeof s?(0,r.parseMIMETypeFromURL)(s):""}function i(r){if((0,e.isResponse)(r)){return r.headers["content-length"]||-1}if((0,e.isBlob)(r)){return r.size}return"string"==typeof r?r.length:r instanceof ArrayBuffer?r.byteLength:ArrayBuffer.isView(r)?r.byteLength:-1}
},{"../../javascript-utils/is-type":"Oy8e","./mime-type-utils":"P8kQ","./url-utils":"ysxf"}],"KNrZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkResponse=r,exports.checkResponseSync=o,exports.makeResponse=n;var e=require("../../javascript-utils/is-type"),t=require("./resource-utils");async function n(n){if((0,e.isResponse)(n))return n;const r={},o=(0,t.getResourceContentLength)(n);o>=0&&(r["content-length"]=String(o));const c=(0,t.getResourceUrl)(n),a=(0,t.getResourceMIMEType)(n);a&&(r["content-type"]=a);const i=await s(n);i&&(r["x-first-bytes"]=i),"string"==typeof n&&(n=(new TextEncoder).encode(n));const u=new Response(n,{headers:r});return Object.defineProperty(u,"url",{value:c}),u}async function r(e){if(!e.ok){const t=await c(e);throw new Error(t)}}function o(e){if(!e.ok){let t="".concat(e.status," ").concat(e.statusText);throw t=t.length>60?"".concat(t.slice(0,60),"..."):t,new Error(t)}}async function c(e){let t="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): ");try{const r=e.headers.get("Content-Type");let o=e.statusText;r.includes("application/json")&&(o+=" ".concat(await e.text())),t=(t+=o).length>60?"".concat(t.slice(0,60),"..."):t}catch(n){}return t}async function s(e){if("string"==typeof e)return"data:,".concat(e.slice(0,5));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise(e=>{const n=new FileReader;n.onload=(t=>{var n;return e(null==t?void 0:null===(n=t.target)||void 0===n?void 0:n.result)}),n.readAsDataURL(t)})}if(e instanceof ArrayBuffer){const t=a(e.slice(0,5));return"data:base64,".concat(t)}return null}function a(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}
},{"../../javascript-utils/is-type":"Oy8e","./resource-utils":"ABhg"}],"b40H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fetchFile=r;var e=require("@loaders.gl/loader-utils"),t=require("../utils/response-utils");async function r(r,s){if("string"==typeof r){r=(0,e.resolvePath)(r);let t=s;return null!=s&&s.fetch&&"function"!=typeof(null==s?void 0:s.fetch)&&(t=s.fetch),await fetch(r,t)}return await(0,t.makeResponse)(r)}
},{"@loaders.gl/loader-utils":"oHIH","../utils/response-utils":"KNrZ"}],"Q1FV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.readArrayBuffer=e,exports.readBlob=o;var r=require("@loaders.gl/loader-utils");async function e(e,a,t){if("number"==typeof e)return await r.fs._readToArrayBuffer(e,a,t);e instanceof Blob||(e=new Blob([e]));const n=e.slice(a,a+t);return await o(n)}async function o(r){return await new Promise((e,o)=>{const a=new FileReader;a.onload=(r=>{var o;return e(null==r?void 0:null===(o=r.target)||void 0===o?void 0:o.result)}),a.onerror=(r=>o(r)),a.readAsArrayBuffer(r)})}
},{"@loaders.gl/loader-utils":"oHIH"}],"WRQd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.readFileSync=r;var e=require("@loaders.gl/loader-utils");function r(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r=(0,e.resolvePath)(r),!e.isBrowser){const o=e.fs.readFileSync(r,t);return"string"!=typeof o?(0,e.toArrayBuffer)(o):o}return t.nothrow||(0,e.assert)(!1),null}
},{"@loaders.gl/loader-utils":"oHIH"}],"YW6i":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.writeFile=r,exports.writeFileSync=s;var e=require("@loaders.gl/loader-utils");async function r(r,s,t){r=(0,e.resolvePath)(r),e.isBrowser||await e.fs.writeFile(r,(0,e.toBuffer)(s),{flag:"w"}),(0,e.assert)(!1)}function s(r,s,t){r=(0,e.resolvePath)(r),e.isBrowser||e.fs.writeFileSync(r,(0,e.toBuffer)(s),{flag:"w"}),(0,e.assert)(!1)}
},{"@loaders.gl/loader-utils":"oHIH"}],"a8Iz":[function(require,module,exports) {
var process = require("process");
var e=require("process");function o(o){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if(void 0!==e&&"object"==typeof e.versions&&Boolean(e.versions.electron))return!0;const r="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=o||r;return!!(t&&t.indexOf("Electron")>=0)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;
},{"process":"g5IB"}],"ourG":[function(require,module,exports) {
var process = require("process");
var e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o,exports.isBrowserMainThread=n;var r=t(require("./is-electron.js"));function t(e){return e&&e.__esModule?e:{default:e}}function o(){return!("object"==typeof e&&"[object process]"===String(e)&&!1)||(0,r.default)()}function n(){return o()&&"undefined"!=typeof document}
},{"./is-electron.js":"a8Iz","process":"g5IB"}],"Vaaf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.window=exports.self=exports.process=exports.navigator=exports.global=exports.document=exports.console=void 0;const o=globalThis;exports.global=o;const s=globalThis.self||globalThis.window||globalThis.global;exports.self=s;const l=globalThis.window||globalThis.self||globalThis.global;exports.window=l;const e=globalThis.document||{};exports.document=e;const t=globalThis.process||{};exports.process=t;const r=globalThis.console;exports.console=r;const a=globalThis.navigator||{};exports.navigator=a;
},{}],"PWKQ":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var e=arguments[3],r=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0,Object.defineProperty(exports,"console",{enumerable:!0,get:function(){return o.console}}),Object.defineProperty(exports,"document",{enumerable:!0,get:function(){return o.document}}),Object.defineProperty(exports,"global",{enumerable:!0,get:function(){return o.global}}),exports.isBrowser=void 0,Object.defineProperty(exports,"process",{enumerable:!0,get:function(){return o.process}}),Object.defineProperty(exports,"self",{enumerable:!0,get:function(){return o.self}}),Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return o.window}});var t=n(require("../lib/is-browser.js")),o=require("../lib/globals.js");function n(e){return e&&e.__esModule?e:{default:e}}const s="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";exports.VERSION=s;const u=(0,t.default)();exports.isBrowser=u;
},{"../lib/is-browser.js":"ourG","../lib/globals.js":"Vaaf","process":"g5IB"}],"VFvg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=s,exports.isMobile=i;var e=t(require("./is-browser.js")),r=t(require("./is-electron.js")),n=require("./globals.js");function t(e){return e&&e.__esModule?e:{default:e}}const o=globalThis;function i(){return void 0!==o.orientation}function s(t){if(!t&&!(0,e.default)())return"Node";if((0,r.default)(t))return"Electron";const i=t||n.navigator.userAgent||"";if(i.indexOf("Edge")>-1)return"Edge";const s=-1!==i.indexOf("MSIE "),u=-1!==i.indexOf("Trident/");return s||u?"IE":o.chrome?"Chrome":o.safari?"Safari":o.mozInnerScreenX?"Firefox":"Unknown"}
},{"./is-browser.js":"ourG","./is-electron.js":"a8Iz","./globals.js":"Vaaf"}],"F02Z":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)throw new Error(r||"Assertion failed")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"R4Vo":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var e=arguments[3],r=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"VERSION",{enumerable:!0,get:function(){return t.VERSION}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(exports,"console",{enumerable:!0,get:function(){return n.console}}),Object.defineProperty(exports,"document",{enumerable:!0,get:function(){return n.document}}),Object.defineProperty(exports,"getBrowser",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"global",{enumerable:!0,get:function(){return n.global}}),Object.defineProperty(exports,"isBrowser",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"isBrowserMainThread",{enumerable:!0,get:function(){return o.isBrowserMainThread}}),Object.defineProperty(exports,"isElectron",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"isMobile",{enumerable:!0,get:function(){return u.isMobile}}),Object.defineProperty(exports,"process",{enumerable:!0,get:function(){return n.process}}),Object.defineProperty(exports,"self",{enumerable:!0,get:function(){return n.self}}),Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return n.window}});var t=require("./utils/globals.js"),n=require("./lib/globals.js"),o=c(require("./lib/is-browser.js")),u=c(require("./lib/get-browser.js")),i=l(require("./lib/is-electron.js")),s=l(require("./utils/assert.js"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(f=function(e){return e?t:r})(e)}function c(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=f(r);if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=o?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}
},{"./utils/globals.js":"PWKQ","./lib/globals.js":"Vaaf","./lib/is-browser.js":"ourG","./lib/get-browser.js":"VFvg","./lib/is-electron.js":"a8Iz","./utils/assert.js":"F02Z","process":"g5IB"}],"pu7C":[function(require,module,exports) {
"use strict";function t(t){try{const s=window[t],o="__storage_test__";return s.setItem(o,o),s.removeItem(o),s}catch(i){return null}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocalStorage=void 0;class i{constructor(i,s){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=t(o),this.id=i,this.config=s,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let t={};if(this.storage){const i=this.storage.getItem(this.id);t=i?JSON.parse(i):{}}return Object.assign(this.config,t),this}}exports.LocalStorage=i;
},{}],"YvW4":[function(require,module,exports) {
"use strict";function t(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s")}function e(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(t).concat(" ".repeat(n))}function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return c(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const o=t.toPrecision(2);return o.indexOf(".0")===o.length-2?o.slice(0,-1):o}function c(t,e){const{maxElts:n=16,size:c=1}=e;let r="[";for(let i=0;i<t.length&&i<n;++i)i>0&&(r+=",".concat(i%c==0?" ":"")),r+=o(t[i],e);const a=t.length>n?"...":"]";return"".concat(r).concat(a)}function r(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const c=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>o&&(n=Math.min(n,o/t.width));const r=t.width*n,a=t.height*n,i=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(r/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(c,");"),"background-size:".concat(r,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),i]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatImage=r,exports.formatTime=t,exports.formatValue=o,exports.leftPad=e,exports.rightPad=n;
},{}],"XYrd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.COLOR=void 0,exports.addColor=o;var E=require("@probe.gl/env");let t;exports.COLOR=t,function(E){E[E.BLACK=30]="BLACK",E[E.RED=31]="RED",E[E.GREEN=32]="GREEN",E[E.YELLOW=33]="YELLOW",E[E.BLUE=34]="BLUE",E[E.MAGENTA=35]="MAGENTA",E[E.CYAN=36]="CYAN",E[E.WHITE=37]="WHITE",E[E.BRIGHT_BLACK=90]="BRIGHT_BLACK",E[E.BRIGHT_RED=91]="BRIGHT_RED",E[E.BRIGHT_GREEN=92]="BRIGHT_GREEN",E[E.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",E[E.BRIGHT_BLUE=94]="BRIGHT_BLUE",E[E.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",E[E.BRIGHT_CYAN=96]="BRIGHT_CYAN",E[E.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(t||(exports.COLOR=t={}));const R=10;function e(E){return"string"!=typeof E?E:(E=E.toUpperCase(),t[E]||t.WHITE)}function o(t,o,B){if(!E.isBrowser&&"string"==typeof t){if(o){const E=e(o);t="[".concat(E,"m").concat(t,"[39m")}if(B){const E=e(B);t="[".concat(E+R,"m").concat(t,"[49m")}}return t}
},{"@probe.gl/env":"R4Vo"}],"MrnN":[function(require,module,exports) {
"use strict";function t(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const o=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(o),c=t;for(const r of n){const o=c[r];"function"==typeof o&&(e.find(t=>r===t)||(c[r]=o.bind(t)))}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.autobind=t;
},{}],"vyx0":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getHiResTimestamp=o;var e=require("@probe.gl/env");function o(){let o;var i,r;if((0,e.isBrowser)()&&e.window.performance)o=null===e.window||void 0===e.window?void 0:null===(i=e.window.performance)||void 0===i?void 0:null===(r=i.now)||void 0===r?void 0:r.call(i);else if("hrtime"in e.process){var s;const i=null===e.process||void 0===e.process?void 0:null===(s=e.process.hrtime)||void 0===s?void 0:s.call(e.process);o=1e3*i[0]+i[1]/1e6}else o=Date.now();return o}
},{"@probe.gl/env":"R4Vo"}],"ENTa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Log=void 0,exports.normalizeArguments=f;var e=require("@probe.gl/env"),t=require("./utils/local-storage.js"),o=require("./utils/formatters.js"),s=require("./utils/color.js"),r=require("./utils/autobind.js"),n=a(require("./utils/assert.js")),i=require("./utils/hi-res-timestamp.js");function a(e){return e&&e.__esModule?e:{default:e}}const l={debug:(0,e.isBrowser)()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},g={enabled:!0,level:0};function c(){}const u={},m={once:!0};class d{constructor(){let{id:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};this.id=void 0,this.VERSION=e.VERSION,this._startTs=(0,i.getHiResTimestamp)(),this._deltaTs=(0,i.getHiResTimestamp)(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=o,this.userData={},this._storage=new t.LocalStorage("__probe-".concat(this.id,"__"),g),this.timeStamp("".concat(this.id," started")),(0,r.autobind)(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number(((0,i.getHiResTimestamp)()-this._startTs).toPrecision(10))}getDelta(){return Number(((0,i.getHiResTimestamp)()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){(0,n.default)(e,t)}warn(e){return this._getLogFunction(0,e,l.warn,arguments,m)}error(e){return this._getLogFunction(0,e,l.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,l.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,l.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,l.debug||l.info,arguments,m)}table(e,t,o){return t?this._getLogFunction(e,t,console.table||c,o&&[o],{tag:v(t)}):c}image(t){let{logLevel:o,priority:s,image:r,message:n="",scale:i=1}=t;return this._shouldLog(o||s)?(0,e.isBrowser)()?b({image:r,message:n,scale:i}):_({image:r,message:n,scale:i}):c}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||c)}group(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const s=f({logLevel:e,message:t,opts:o}),{collapsed:r}=o;return s.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},o,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||c)}withGroup(e,t,o){this.group(e,t)();try{o()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=h(e)}_getLogFunction(e,t,o,s,r){if(this._shouldLog(e)){r=f({logLevel:e,message:t,args:s,opts:r}),o=o||r.method,(0,n.default)(o),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=(0,i.getHiResTimestamp)();const a=r.tag||r.message;if(r.once&&a){if(u[a])return c;u[a]=(0,i.getHiResTimestamp)()}return t=p(this.id,r.message,r),o.bind(console,t,...r.args)}return c}}function h(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return(0,n.default)(Number.isFinite(t)&&t>=0),t}function f(e){const{logLevel:t,message:o}=e;e.logLevel=h(t);const s=e.args?Array.from(e.args):[];for(;s.length&&s.shift()!==o;);switch(typeof t){case"string":case"function":void 0!==o&&s.unshift(o),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const r=typeof e.message;return(0,n.default)("string"===r||"object"===r),Object.assign(e,{args:s},e.opts)}function p(e,t,r){if("string"==typeof t){const n=r.time?(0,o.leftPad)((0,o.formatTime)(r.total)):"";t=r.time?"".concat(e,": ").concat(n,"  ").concat(t):"".concat(e,": ").concat(t),t=(0,s.addColor)(t,r.color,r.background)}return t}function _(e){let{image:t,message:o="",scale:s=1}=e;return console.warn("removed"),c}function b(e){let{image:t,message:s="",scale:r=1}=e;if("string"==typeof t){const e=new Image;return e.onload=(()=>{const t=(0,o.formatImage)(e,s,r);console.log(...t)}),e.src=t,c}const n=t.nodeName||"";if("img"===n.toLowerCase())return console.log(...(0,o.formatImage)(t,s,r)),c;if("canvas"===n.toLowerCase()){const e=new Image;return e.onload=(()=>console.log(...(0,o.formatImage)(e,s,r))),e.src=t.toDataURL(),c}return c}function v(e){for(const t in e)for(const o in e[t])return o||"untitled";return"empty"}exports.Log=d,d.VERSION=e.VERSION;
},{"@probe.gl/env":"R4Vo","./utils/local-storage.js":"pu7C","./utils/formatters.js":"YvW4","./utils/color.js":"XYrd","./utils/autobind.js":"MrnN","./utils/assert.js":"F02Z","./utils/hi-res-timestamp.js":"vyx0"}],"iQbP":[function(require,module,exports) {
globalThis.probe={};
},{}],"QDw1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"COLOR",{enumerable:!0,get:function(){return r.COLOR}}),Object.defineProperty(exports,"LocalStorage",{enumerable:!0,get:function(){return n.LocalStorage}}),Object.defineProperty(exports,"Log",{enumerable:!0,get:function(){return e.Log}}),Object.defineProperty(exports,"addColor",{enumerable:!0,get:function(){return r.addColor}}),Object.defineProperty(exports,"autobind",{enumerable:!0,get:function(){return o.autobind}}),exports.default=void 0,Object.defineProperty(exports,"getHiResTimestamp",{enumerable:!0,get:function(){return i.getHiResTimestamp}}),Object.defineProperty(exports,"leftPad",{enumerable:!0,get:function(){return t.leftPad}}),Object.defineProperty(exports,"rightPad",{enumerable:!0,get:function(){return t.rightPad}});var e=require("./log.js"),r=require("./utils/color.js"),t=require("./utils/formatters.js"),o=require("./utils/autobind.js"),n=require("./utils/local-storage.js"),i=require("./utils/hi-res-timestamp.js");require("./init.js");var u=new e.Log({id:"@probe.gl/log"});exports.default=u;
},{"./log.js":"ENTa","./utils/color.js":"XYrd","./utils/formatters.js":"YvW4","./utils/autobind.js":"MrnN","./utils/local-storage.js":"pu7C","./utils/hi-res-timestamp.js":"vyx0","./init.js":"iQbP"}],"yfwR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.probeLog=exports.NullLog=exports.ConsoleLog=void 0;var r=o(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@probe.gl/log");function o(r){return r&&r.__esModule?r:{default:r}}const n=new e.Log({id:"loaders.gl"});exports.probeLog=n;class s{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}exports.NullLog=s;class t{constructor(){(0,r.default)(this,"console",void 0),this.console=console}log(){for(var r=arguments.length,e=new Array(r),o=0;o<r;o++)e[o]=arguments[o];return this.console.log.bind(this.console,...e)}info(){for(var r=arguments.length,e=new Array(r),o=0;o<r;o++)e[o]=arguments[o];return this.console.info.bind(this.console,...e)}warn(){for(var r=arguments.length,e=new Array(r),o=0;o<r;o++)e[o]=arguments[o];return this.console.warn.bind(this.console,...e)}error(){for(var r=arguments.length,e=new Array(r),o=0;o<r;o++)e[o]=arguments[o];return this.console.error.bind(this.console,...e)}}exports.ConsoleLog=t;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@probe.gl/log":"QDw1"}],"tLzt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.REMOVED_LOADER_OPTIONS=exports.DEFAULT_LOADER_OPTIONS=void 0;var e=require("@loaders.gl/loader-utils"),r=require("./loggers");const t={fetch:null,mimeType:void 0,nothrow:!1,log:new r.ConsoleLog,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:e.isBrowser,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]};exports.DEFAULT_LOADER_OPTIONS=t;const o={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};exports.REMOVED_LOADER_OPTIONS=o;
},{"@loaders.gl/loader-utils":"oHIH","./loggers":"yfwR"}],"Go4L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getGlobalLoaderOptions=void 0,exports.getGlobalLoaderState=e,exports.normalizeOptions=r,exports.setGlobalOptions=i;var o=require("../../javascript-utils/is-type"),t=require("./loggers"),n=require("./option-defaults");function e(){globalThis.loaders=globalThis.loaders||{};const{loaders:o}=globalThis;return o._state=o._state||{},o._state}const s=()=>{const o=e();return o.globalOptions=o.globalOptions||{...n.DEFAULT_LOADER_OPTIONS},o.globalOptions};function i(o){const t=e(),n=s();t.globalOptions=p(n,o)}function r(o,t,n,e){return n=n||[],c(o,n=Array.isArray(n)?n:[n]),p(t,o,e)}function c(o,t){a(o,null,n.DEFAULT_LOADER_OPTIONS,n.REMOVED_LOADER_OPTIONS,t);for(const n of t){const e=o&&o[n.id]||{},s=n.options&&n.options[n.id]||{},i=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};a(e,n.id,s,i,t)}}function a(n,e,s,i,r){const c=e||"Top level",a=e?"".concat(e,"."):"";for(const p in n){const u=!e&&(0,o.isObject)(n[p]),d="baseUri"===p&&!e,O="workerUrl"===p&&e;if(!(p in s||d||O))if(p in i)t.probeLog.warn("".concat(c," loader option '").concat(a).concat(p,"' no longer supported, use '").concat(i[p],"'"))();else if(!u){const o=l(p,r);t.probeLog.warn("".concat(c," loader option '").concat(a).concat(p,"' not recognized. ").concat(o))()}}}function l(o,t){const n=o.toLowerCase();let e="";for(const s of t)for(const t in s.options){if(o===t)return"Did you mean '".concat(s.id,".").concat(t,"'?");const i=t.toLowerCase();(n.startsWith(i)||i.startsWith(n))&&(e=e||"Did you mean '".concat(s.id,".").concat(t,"'?"))}return e}function p(o,n,e){const i={...o.options||{}};return d(i,e),null===i.log&&(i.log=new t.NullLog),u(i,s()),u(i,n),i}function u(t,n){for(const e in n)if(e in n){const s=n[e];(0,o.isPureObject)(s)&&(0,o.isPureObject)(t[e])?t[e]={...t[e],...n[e]}:t[e]=n[e]}}function d(o,t){!t||"baseUri"in o||(o.baseUri=t)}exports.getGlobalLoaderOptions=s;
},{"../../javascript-utils/is-type":"Oy8e","./loggers":"yfwR","./option-defaults":"tLzt"}],"oiG6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"getLoaderOptions",{enumerable:!0,get:function(){return e.getGlobalLoaderOptions}}),Object.defineProperty(exports,"setLoaderOptions",{enumerable:!0,get:function(){return e.setGlobalOptions}});var e=require("../loader-utils/option-utils");
},{"../loader-utils/option-utils":"Go4L"}],"iWwL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isLoaderObject=e,exports.normalizeLoader=t;var r=require("@loaders.gl/loader-utils");function e(r){var e;if(!r)return!1;return Array.isArray(r)&&(r=r[0]),Array.isArray(null===(e=r)||void 0===e?void 0:e.extensions)}function t(t){var a,o;let i;return(0,r.assert)(t,"null loader"),(0,r.assert)(e(t),"invalid loader"),Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),(null!==(a=t)&&void 0!==a&&a.parseTextSync||null!==(o=t)&&void 0!==o&&o.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}
},{"@loaders.gl/loader-utils":"oHIH"}],"k3wd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._unregisterLoaders=a,exports.getRegisteredLoaders=s,exports.registerLoaders=o;var e=require("../loader-utils/normalize-loader"),r=require("../loader-utils/option-utils");const t=()=>{const e=(0,r.getGlobalLoaderState)();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function o(r){const o=t();r=Array.isArray(r)?r:[r];for(const t of r){const r=(0,e.normalizeLoader)(t);o.find(e=>r===e)||o.unshift(r)}}function s(){return t()}function a(){(0,r.getGlobalLoaderState)().loaderRegistry=[]}
},{"../loader-utils/normalize-loader":"iWwL","../loader-utils/option-utils":"Go4L"}],"frQm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.log=void 0;var e=require("@probe.gl/log");const o=new e.Log({id:"loaders.gl"});exports.log=o;
},{"@probe.gl/log":"QDw1"}],"W9BO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.selectLoader=l,exports.selectLoaderSync=c;var e=require("@loaders.gl/loader-utils"),t=require("../loader-utils/normalize-loader"),r=require("../utils/log"),n=require("../utils/resource-utils"),o=require("./register-loaders"),i=require("../../javascript-utils/is-type"),u=require("../utils/url-utils");const s=/\.([^.]+)$/;async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!a(e))return null;let o=c(e,t,{...r,nothrow:!0},n);if(o)return o;if((0,i.isBlob)(e)&&(o=c(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!(o||null!=r&&r.nothrow))throw new Error(d(e));return o}function c(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!a(e))return null;if(r&&!Array.isArray(r))return(0,t.normalizeLoader)(r);let u=[];r&&(u=u.concat(r)),null!=n&&n.ignoreRegisteredLoaders||u.push(...(0,o.getRegisteredLoaders)()),y(u);const s=f(e,u,n,i);if(!(s||null!=n&&n.nothrow))throw new Error(d(e));return s}function f(e,t,o,i){const s=(0,n.getResourceUrl)(e),l=(0,n.getResourceMIMEType)(e),c=(0,u.stripQueryString)(s)||(null==i?void 0:i.url);let f=null,a="";var d;(null!=o&&o.mimeType&&(f=h(t,null==o?void 0:o.mimeType),a="match forced by supplied MIME type ".concat(null==o?void 0:o.mimeType)),f=f||p(t,c),a=a||(f?"matched url ".concat(c):""),f=f||h(t,l),a=a||(f?"matched MIME type ".concat(l):""),f=f||m(t,e),a=a||(f?"matched initial data ".concat(M(e)):""),f=f||h(t,null==o?void 0:o.fallbackMimeType),a=a||(f?"matched fallback MIME type ".concat(l):""))&&r.log.log(1,"selectLoader selected ".concat(null===(d=f)||void 0===d?void 0:d.name,": ").concat(a,"."));return f}function a(e){return!(e instanceof Response&&204===e.status)}function d(t){const r=(0,n.getResourceUrl)(t),o=(0,n.getResourceMIMEType)(t);let i="No valid loader found (";i+=r?"".concat(e.path.filename(r),", "):"no url provided, ",i+="MIME type: ".concat(o?'"'.concat(o,'"'):"not provided",", ");const u=t?M(t):"";return i+=u?' first bytes: "'.concat(u,'"'):"first bytes: not available",i+=")"}function y(e){for(const r of e)(0,t.normalizeLoader)(r)}function p(e,t){const r=t&&s.exec(t),n=r&&r[1];return n?g(e,n):null}function g(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}function h(e,t){for(const r of e){if(r.mimeTypes&&r.mimeTypes.includes(t))return r;if(t==="application/x.".concat(r.id))return r}return null}function m(e,t){if(!t)return null;for(const r of e)if("string"==typeof t){if(v(t,r))return r}else if(ArrayBuffer.isView(t)){if(w(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer){if(w(t,0,r))return r}return null}function v(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some(t=>e.startsWith(t))}function w(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(n=>b(e,t,r,n))}function b(t,r,n,o){if(o instanceof ArrayBuffer)return(0,e.compareArrayBuffers)(o,t,o.byteLength);switch(typeof o){case"function":return o(t,n);case"string":return o===A(t,r,o.length);default:return!1}}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return A(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return A(e,0,t)}return""}function A(e,t,r){if(e.byteLength<t+r)return"";const n=new DataView(e);let o="";for(let i=0;i<r;i++)o+=String.fromCharCode(n.getUint8(t+i));return o}
},{"@loaders.gl/loader-utils":"oHIH","../loader-utils/normalize-loader":"iWwL","../utils/log":"frQm","../utils/resource-utils":"ABhg","./register-loaders":"k3wd","../../javascript-utils/is-type":"Oy8e","../utils/url-utils":"ysxf"}],"tqSD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeStringIterator=t;const e=262144;function*t(t,n){const o=(null==n?void 0:n.chunkSize)||e;let c=0;const r=new TextEncoder;for(;c<t.length;){const e=Math.min(t.length-c,o),n=t.slice(c,c+e);c+=e,yield r.encode(n)}}
},{}],"xsAN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeArrayBufferIterator=t;const e=262144;function t(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=e}=r;let o=0;for(;o<t.byteLength;){const e=Math.min(t.byteLength-o,n),r=new ArrayBuffer(e),i=new Uint8Array(t,o,e);new Uint8Array(r).set(i),o+=e,yield r}}()}
},{}],"MI6f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeBlobIterator=t;const e=1048576;async function*t(t,o){const r=(null==o?void 0:o.chunkSize)||e;let s=0;for(;s<t.size;){const e=s+r,o=await t.slice(s,e).arrayBuffer();s=e,yield o}}
},{}],"a7BU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeStreamIterator=r;var e=require("@loaders.gl/loader-utils");function r(r,o){return e.isBrowser?t(r,o):a(r,o)}async function*t(r,t){const a=r.getReader();let o;try{for(;;){const r=o||a.read();null!=t&&t._streamReadAhead&&(o=a.read());const{done:n,value:s}=await r;if(n)return;yield(0,e.toArrayBuffer)(s)}}catch(n){a.releaseLock()}}async function*a(r,t){for await(const a of r)yield(0,e.toArrayBuffer)(a)}
},{"@loaders.gl/loader-utils":"oHIH"}],"wlle":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeIterator=o;var r=require("./make-string-iterator"),e=require("./make-array-buffer-iterator"),t=require("./make-blob-iterator"),a=require("./make-stream-iterator"),i=require("../../javascript-utils/is-type");function o(o,s){if("string"==typeof o)return(0,r.makeStringIterator)(o,s);if(o instanceof ArrayBuffer)return(0,e.makeArrayBufferIterator)(o,s);if((0,i.isBlob)(o))return(0,t.makeBlobIterator)(o,s);if((0,i.isReadableStream)(o))return(0,a.makeStreamIterator)(o,s);if((0,i.isResponse)(o)){const r=o;return(0,a.makeStreamIterator)(r.body,s)}throw new Error("makeIterator")}
},{"./make-string-iterator":"tqSD","./make-array-buffer-iterator":"xsAN","./make-blob-iterator":"MI6f","./make-stream-iterator":"a7BU","../../javascript-utils/is-type":"Oy8e"}],"IWzS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getArrayBufferOrStringFromData=s,exports.getArrayBufferOrStringFromDataSync=i,exports.getAsyncIterableFromData=o,exports.getReadableStream=f;var e=require("@loaders.gl/loader-utils"),r=require("../../javascript-utils/is-type"),t=require("../../iterators/make-iterator/make-iterator"),a=require("../utils/response-utils");const n="Cannot convert supplied data type";function i(e,t,a){if(t.text&&"string"==typeof e)return e;if((0,r.isBuffer)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;if(t.text&&!t.binary){return new TextDecoder("utf8").decode(r)}return r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary){return new TextDecoder("utf8").decode(e)}let r=e.buffer;const a=e.byteLength||e.length;return 0===e.byteOffset&&a===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+a)),r}throw new Error(n)}async function s(s,o,f){const u=s instanceof ArrayBuffer||ArrayBuffer.isView(s);if("string"==typeof s||u)return i(s,o,f);if((0,r.isBlob)(s)&&(s=await(0,a.makeResponse)(s)),(0,r.isResponse)(s)){const e=s;return await(0,a.checkResponse)(e),o.binary?await e.arrayBuffer():await e.text()}if((0,r.isReadableStream)(s)&&(s=(0,t.makeIterator)(s,f)),(0,r.isIterable)(s)||(0,r.isAsyncIterable)(s))return(0,e.concatenateArrayBuffersAsync)(s);throw new Error(n)}async function o(e,n){if((0,r.isIterator)(e))return e;if((0,r.isResponse)(e)){const r=e;await(0,a.checkResponse)(r);const i=await r.body;return(0,t.makeIterator)(i,n)}return(0,r.isBlob)(e)||(0,r.isReadableStream)(e)?(0,t.makeIterator)(e,n):(0,r.isAsyncIterable)(e)?e[Symbol.asyncIterator]():u(e)}async function f(e){if((0,r.isReadableStream)(e))return e;if((0,r.isResponse)(e))return e.body;return(await(0,a.makeResponse)(e)).body}function u(e){if(ArrayBuffer.isView(e))return function*(){yield e.buffer}();if(e instanceof ArrayBuffer)return function*(){yield e}();if((0,r.isIterator)(e))return e;if((0,r.isIterable)(e))return e[Symbol.iterator]();throw new Error(n)}
},{"@loaders.gl/loader-utils":"oHIH","../../javascript-utils/is-type":"Oy8e","../../iterators/make-iterator/make-iterator":"wlle","../utils/response-utils":"KNrZ"}],"snJZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFetchFunction=c;var e=require("../../javascript-utils/is-type"),t=require("../fetch/fetch-file"),i=require("./option-utils");function c(c,r){const o=(0,i.getGlobalLoaderOptions)(),f=c||o;return"function"==typeof f.fetch?f.fetch:(0,e.isObject)(f.fetch)?e=>(0,t.fetchFile)(e,f):null!=r&&r.fetch?null==r?void 0:r.fetch:t.fetchFile}
},{"../../javascript-utils/is-type":"Oy8e","../fetch/fetch-file":"b40H","./option-utils":"Go4L"}],"cO8m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLoaderContext=a,exports.getLoadersFromContext=l;var r=require("./get-fetch-function"),e=require("../utils/url-utils"),t=require("@loaders.gl/loader-utils");function a(a,l,i){if(i)return i;const n={fetch:(0,r.getFetchFunction)(l,a),...a};if(n.url){const r=(0,e.stripQueryString)(n.url);n.baseUrl=r,n.queryString=(0,e.extractQueryString)(n.url),n.filename=t.path.filename(r),n.baseUrl=t.path.dirname(r)}return Array.isArray(n.loaders)||(n.loaders=null),n}function l(r,e){if(!e&&r&&!Array.isArray(r))return r;let t;if(r&&(t=Array.isArray(r)?r:[r]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...r]:r}return t&&t.length?t:null}
},{"./get-fetch-function":"snJZ","../utils/url-utils":"ysxf","@loaders.gl/loader-utils":"oHIH"}],"t8Kj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parse=n;var e=require("@loaders.gl/worker-utils"),r=require("@loaders.gl/loader-utils"),t=require("../loader-utils/normalize-loader"),a=require("../../javascript-utils/is-type"),s=require("../loader-utils/option-utils"),i=require("../loader-utils/get-data"),o=require("../loader-utils/loader-context"),u=require("../utils/resource-utils"),l=require("./select-loader");async function n(r,a,i,p){(0,e.assert)(!p||"object"==typeof p),!a||Array.isArray(a)||(0,t.isLoaderObject)(a)||(p=void 0,i=a,a=void 0),r=await r,i=i||{};const c=(0,u.getResourceUrl)(r),y=a,f=(0,o.getLoadersFromContext)(y,p),x=await(0,l.selectLoader)(r,f,i);return x?(i=(0,s.normalizeOptions)(i,x,f,c),p=(0,o.getLoaderContext)({url:c,parse:n,loaders:f},i,p||null),await d(x,r,i,p)):null}async function d(t,s,o,u){if((0,e.validateWorkerVersion)(t),(0,a.isResponse)(s)){const e=s,{ok:r,redirected:t,status:a,statusText:i,type:o,url:l}=e,n=Object.fromEntries(e.headers.entries());u.response={headers:n,ok:r,redirected:t,status:a,statusText:i,type:o,url:l}}if(s=await(0,i.getArrayBufferOrStringFromData)(s,t,o),t.parseTextSync&&"string"==typeof s)return o.dataType="text",t.parseTextSync(s,o,u,t);if((0,r.canParseWithWorker)(t,o))return await(0,r.parseWithWorker)(t,s,o,u,n);if(t.parseText&&"string"==typeof s)return await t.parseText(s,o,u,t);if(t.parse)return await t.parse(s,o,u,t);throw(0,e.assert)(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}
},{"@loaders.gl/worker-utils":"gqfu","@loaders.gl/loader-utils":"oHIH","../loader-utils/normalize-loader":"iWwL","../../javascript-utils/is-type":"Oy8e","../loader-utils/option-utils":"Go4L","../loader-utils/get-data":"IWzS","../loader-utils/loader-context":"cO8m","../utils/resource-utils":"ABhg","./select-loader":"W9BO"}],"PAJp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseSync=i;var e=require("@loaders.gl/loader-utils"),r=require("./select-loader"),t=require("../loader-utils/normalize-loader"),o=require("../loader-utils/option-utils"),a=require("../loader-utils/get-data"),s=require("../loader-utils/loader-context"),n=require("../utils/resource-utils");function i(a,u,c,d){(0,e.assert)(!d||"object"==typeof d),Array.isArray(u)||(0,t.isLoaderObject)(u)||(d=void 0,c=u,u=void 0),c=c||{};const p=u,y=(0,s.getLoadersFromContext)(p,d),f=(0,r.selectLoaderSync)(a,y,c);if(!f)return null;c=(0,o.normalizeOptions)(c,f,y);const S=(0,n.getResourceUrl)(a);return l(f,a,c,d=(0,s.getLoaderContext)({url:S,parseSync:i,parse:()=>{throw new Error("parseSync called parse (which is async")},loaders:u},c,d||null))}function l(e,r,t,o){if(r=(0,a.getArrayBufferOrStringFromDataSync)(r,e,t),e.parseTextSync&&"string"==typeof r)return e.parseTextSync(r,t);if(e.parseSync&&r instanceof ArrayBuffer)return e.parseSync(r,t,o);throw new Error("".concat(e.name," loader: 'parseSync' not supported by this loader, use 'parse' instead. ").concat(o.url||""))}
},{"@loaders.gl/loader-utils":"oHIH","./select-loader":"W9BO","../loader-utils/normalize-loader":"iWwL","../loader-utils/option-utils":"Go4L","../loader-utils/get-data":"IWzS","../loader-utils/loader-context":"cO8m","../utils/resource-utils":"ABhg"}],"tR2z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseInBatches=l;var e=require("@loaders.gl/loader-utils"),a=require("../loader-utils/normalize-loader"),r=require("../loader-utils/option-utils"),t=require("../loader-utils/loader-context"),s=require("../loader-utils/get-data"),n=require("../utils/resource-utils"),i=require("./select-loader"),o=require("./parse");async function l(s,u,d,y){(0,e.assert)(!y||"object"==typeof y);const p=Array.isArray(u)?u:void 0;Array.isArray(u)||(0,a.isLoaderObject)(u)||(y=void 0,d=u,u=void 0),s=await s,d=d||{};const f=(0,n.getResourceUrl)(s),m=await(0,i.selectLoader)(s,u,d);return m?(d=(0,r.normalizeOptions)(d,m,p,f),y=(0,t.getLoaderContext)({url:f,parseInBatches:l,parse:o.parse,loaders:p},d,y||null),await c(m,s,d,y)):null}async function c(e,a,r,t){const s=await u(e,a,r,t);if(!r.metadata)return s;const n={batchType:"metadata",metadata:{_loader:e,_context:t},data:[],bytesUsed:0};return async function*(e){yield n,yield*e}(s)}async function u(a,r,t,n){const i=await(0,s.getAsyncIterableFromData)(r,t),l=await d(i,(null==t?void 0:t.transforms)||[]);if(a.parseInBatches)return a.parseInBatches(l,t,n);return async function*(){const r=await(0,e.concatenateArrayBuffersAsync)(l),s=await(0,o.parse)(r,a,{...t,mimeType:a.mimeTypes[0]},n),i={mimeType:a.mimeTypes[0],shape:Array.isArray(s)?"row-table":"unknown",batchType:"data",data:s,length:Array.isArray(s)?s.length:1};yield i}()}async function d(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e;for await(const t of a)r=t(r);return r}
},{"@loaders.gl/loader-utils":"oHIH","../loader-utils/normalize-loader":"iWwL","../loader-utils/option-utils":"Go4L","../loader-utils/loader-context":"cO8m","../loader-utils/get-data":"IWzS","../utils/resource-utils":"ABhg","./select-loader":"W9BO","./parse":"t8Kj"}],"CA4j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.load=a;var e=require("../../javascript-utils/is-type"),r=require("../loader-utils/normalize-loader"),t=require("../loader-utils/get-fetch-function"),i=require("./parse");async function a(a,o,s,u){Array.isArray(o)||(0,r.isLoaderObject)(o)||(void 0,s=o,o=void 0);const l=(0,t.getFetchFunction)(s);let n=a;return"string"==typeof a&&(n=await l(a)),(0,e.isBlob)(a)&&(n=await l(a)),await(0,i.parse)(n,o,s)}
},{"../../javascript-utils/is-type":"Oy8e","../loader-utils/normalize-loader":"iWwL","../loader-utils/get-fetch-function":"snJZ","./parse":"t8Kj"}],"C8HI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadInBatches=a;var e=require("../loader-utils/normalize-loader"),r=require("../loader-utils/get-fetch-function"),t=require("./parse-in-batches");function a(t,a,n,s){Array.isArray(a)||(0,e.isLoaderObject)(a)||(void 0,n=a,a=null);const o=(0,r.getFetchFunction)(n||{});return Array.isArray(t)?t.map(e=>i(e,a,n,o)):i(t,a,n,o)}async function i(e,r,a,i){if("string"==typeof e){const n=e,s=await i(n);return await(0,t.parseInBatches)(s,r,a)}return await(0,t.parseInBatches)(e,r,a)}
},{"../loader-utils/normalize-loader":"iWwL","../loader-utils/get-fetch-function":"snJZ","./parse-in-batches":"tR2z"}],"SWoI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.encode=c,exports.encodeInBatches=d,exports.encodeSync=a,exports.encodeText=i,exports.encodeURLtoURL=s;var e=require("@loaders.gl/loader-utils"),t=require("@loaders.gl/worker-utils"),r=require("../fetch/write-file"),n=require("../fetch/fetch-file"),o=require("./loader-options");async function c(c,a,i){if(i={...(0,o.getLoaderOptions)(),...i},(0,e.canEncodeWithWorker)(a,i))return await(0,t.processOnWorker)(a,c,i);if(a.encode)return await a.encode(c,i);if(a.encodeSync)return a.encodeSync(c,i);if(a.encodeText)return(new TextEncoder).encode(await a.encodeText(c,i));if(a.encodeInBatches){const t=d(c,a,i),r=[];for await(const e of t)r.push(e);return(0,e.concatenateArrayBuffers)(...r)}if(!e.isBrowser&&a.encodeURLtoURL){const e=f("input");await(0,r.writeFile)(e,c);const t=f("output"),o=await s(e,t,a,i);return(await(0,n.fetchFile)(o)).arrayBuffer()}throw new Error("Writer could not encode data")}function a(e,t,r){if(t.encodeSync)return t.encodeSync(e,r);throw new Error("Writer could not synchronously encode data")}async function i(e,t,r){if(t.text&&t.encodeText)return await t.encodeText(e,r);if(t.text&&(t.encode||t.encodeInBatches)){const n=await c(e,t,r);return(new TextDecoder).decode(n)}throw new Error("Writer could not encode data as text")}function d(e,t,r){if(t.encodeInBatches){const n=u(e);return t.encodeInBatches(n,r)}throw new Error("Writer could not encode data in batches")}async function s(t,r,n,o){if(t=(0,e.resolvePath)(t),r=(0,e.resolvePath)(r),e.isBrowser||!n.encodeURLtoURL)throw new Error;return await n.encodeURLtoURL(t,r,o)}function u(e){return[{table:e,start:0,end:e.length}]}function f(e){return"/tmp/".concat(e)}
},{"@loaders.gl/loader-utils":"oHIH","@loaders.gl/worker-utils":"gqfu","../fetch/write-file":"YW6i","../fetch/fetch-file":"b40H","./loader-options":"oiG6"}],"DUKs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.save=r,exports.saveSync=n;var e=require("./encode"),t=require("../fetch/write-file");async function r(r,n,c,i){const o=await(0,e.encode)(r,c,i);return await(0,t.writeFile)(n,o)}function n(r,n,c,i){const o=(0,e.encodeSync)(r,c,i);return(0,t.writeFileSync)(n,o)}
},{"./encode":"SWoI","../fetch/write-file":"YW6i"}],"PyjH":[function(require,module,exports) {
"use strict";function e(e,t){const r=e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]();return new ReadableStream({type:"bytes",async pull(e){try{const{done:a,value:n}=await r.next();a?e.close():e.enqueue(new Uint8Array(n))}catch(t){e.error(t)}},async cancel(){var e;await(null==r?void 0:null===(e=r.return)||void 0===e?void 0:e.call(r))}},{highWaterMark:2**24,...t})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeStream=e;
},{}],"aJIU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NullWorkerLoader=exports.NullLoader=void 0;const e="3.4.6",o={name:"Null loader",id:"null",module:"core",version:"3.4.6",worker:!0,mimeTypes:["application/x.empty"],extensions:["null"],tests:[()=>!1],options:{null:{}}};function r(e,o,r){return o.null.echoParameters?{arrayBuffer:e,options:o,context:r=r&&JSON.parse(JSON.stringify(r))}:null}exports.NullWorkerLoader=o;const l={name:"Null loader",id:"null",module:"core",version:"3.4.6",mimeTypes:["application/x.empty"],extensions:["null"],parse:async(e,o,l)=>r(e,o,l),parseSync:r,parseInBatches:async function*(e,o,l){for await(const n of e)yield r(n,o,l)},tests:[()=>!1],options:{null:{echoParameters:!1}}};exports.NullLoader=l;
},{}],"HD9x":[function(require,module,exports) {
"use strict";async function e(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};if(!(e=await e).ok)return e;const o=e.body;if(!o)return e;const s=e.headers.get("content-length")||0,d=s?parseInt(s):0;if(!(d>0))return e;if("undefined"==typeof ReadableStream||!o.getReader)return e;const i=new ReadableStream({async start(e){const s=o.getReader();await t(e,s,0,d,n,a,r)}});return new Response(i)}async function t(e,n,a,r,o,s,d){try{const{done:u,value:c}=await n.read();if(u)return s(),void e.close();a+=c.byteLength,o(Math.round(a/r*100),{loadedBytes:a,totalBytes:r}),e.enqueue(c),await t(e,n,a,r,o,s,d)}catch(i){e.error(i),d(i)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"EeUV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty"));function s(e){return e&&e.__esModule?e:{default:e}}class t{constructor(s,t){(0,e.default)(this,"_fetch",void 0),(0,e.default)(this,"files",{}),(0,e.default)(this,"lowerCaseFiles",{}),(0,e.default)(this,"usedFiles",{}),this._fetch=(null==t?void 0:t.fetch)||fetch;for(let e=0;e<s.length;++e){const t=s[e];this.files[t.name]=t,this.lowerCaseFiles[t.name.toLowerCase()]=t,this.usedFiles[t.name]=!1}this.fetch=this.fetch.bind(this)}async fetch(e,s){if(e.includes("://"))return this._fetch(e,s);const t=this.files[e];if(!t)return new Response(e,{status:400,statusText:"NOT FOUND"});const i=new Headers(null==s?void 0:s.headers).get("Range"),r=i&&/bytes=($1)-($2)/.exec(i);if(r){const s=parseInt(r[1]),i=parseInt(r[2]),n=await t.slice(s,i).arrayBuffer(),l=new Response(n);return Object.defineProperty(l,"url",{value:e}),l}const n=new Response(t);return Object.defineProperty(n,"url",{value:e}),n}async readdir(e){const s=[];for(const t in this.files)s.push(t);return s}async stat(e,s){const t=this.files[e];if(!t)throw new Error(e);return{size:t.size}}async unlink(e){delete this.files[e],delete this.lowerCaseFiles[e],this.usedFiles[e]=!0}async open(e,s,t){return this.files[e]}async read(e,s){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.byteLength;arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=e;return{bytesRead:t,buffer:await i.slice(0,0+t).arrayBuffer()}}async close(e){}_getFile(e,s){const t=this.files[e]||this.lowerCaseFiles[e];return t&&s&&(this.usedFiles[e]=!0),t}}exports.default=t;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"ikKD":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"JSONLoader",{enumerable:!0,get:function(){return m.JSONLoader}}),Object.defineProperty(exports,"NullLoader",{enumerable:!0,get:function(){return P.NullLoader}}),Object.defineProperty(exports,"NullWorkerLoader",{enumerable:!0,get:function(){return P.NullWorkerLoader}}),Object.defineProperty(exports,"RequestScheduler",{enumerable:!0,get:function(){return m.RequestScheduler}}),Object.defineProperty(exports,"_BrowserFileSystem",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(exports,"_fetchProgress",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(exports,"_unregisterLoaders",{enumerable:!0,get:function(){return u._unregisterLoaders}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return m.assert}}),Object.defineProperty(exports,"concatenateArrayBuffersAsync",{enumerable:!0,get:function(){return m.concatenateArrayBuffersAsync}}),Object.defineProperty(exports,"document",{enumerable:!0,get:function(){return m.document}}),Object.defineProperty(exports,"encode",{enumerable:!0,get:function(){return l.encode}}),Object.defineProperty(exports,"encodeInBatches",{enumerable:!0,get:function(){return l.encodeInBatches}}),Object.defineProperty(exports,"encodeSync",{enumerable:!0,get:function(){return l.encodeSync}}),Object.defineProperty(exports,"encodeText",{enumerable:!0,get:function(){return l.encodeText}}),Object.defineProperty(exports,"encodeURLtoURL",{enumerable:!0,get:function(){return l.encodeURLtoURL}}),Object.defineProperty(exports,"fetchFile",{enumerable:!0,get:function(){return r.fetchFile}}),Object.defineProperty(exports,"forEach",{enumerable:!0,get:function(){return m.forEach}}),Object.defineProperty(exports,"getLoaderOptions",{enumerable:!0,get:function(){return i.getLoaderOptions}}),Object.defineProperty(exports,"getPathPrefix",{enumerable:!0,get:function(){return m.getPathPrefix}}),Object.defineProperty(exports,"global",{enumerable:!0,get:function(){return m.global}}),Object.defineProperty(exports,"isAsyncIterable",{enumerable:!0,get:function(){return j.isAsyncIterable}}),Object.defineProperty(exports,"isBrowser",{enumerable:!0,get:function(){return m.isBrowser}}),Object.defineProperty(exports,"isIterable",{enumerable:!0,get:function(){return j.isIterable}}),Object.defineProperty(exports,"isIterator",{enumerable:!0,get:function(){return j.isIterator}}),Object.defineProperty(exports,"isPromise",{enumerable:!0,get:function(){return j.isPromise}}),Object.defineProperty(exports,"isPureObject",{enumerable:!0,get:function(){return j.isPureObject}}),Object.defineProperty(exports,"isReadableStream",{enumerable:!0,get:function(){return j.isReadableStream}}),Object.defineProperty(exports,"isResponse",{enumerable:!0,get:function(){return j.isResponse}}),Object.defineProperty(exports,"isWorker",{enumerable:!0,get:function(){return m.isWorker}}),Object.defineProperty(exports,"isWritableStream",{enumerable:!0,get:function(){return j.isWritableStream}}),Object.defineProperty(exports,"load",{enumerable:!0,get:function(){return b.load}}),Object.defineProperty(exports,"loadInBatches",{enumerable:!0,get:function(){return p.loadInBatches}}),Object.defineProperty(exports,"makeIterator",{enumerable:!0,get:function(){return y.makeIterator}}),Object.defineProperty(exports,"makeLineIterator",{enumerable:!0,get:function(){return m.makeLineIterator}}),Object.defineProperty(exports,"makeNumberedLineIterator",{enumerable:!0,get:function(){return m.makeNumberedLineIterator}}),Object.defineProperty(exports,"makeStream",{enumerable:!0,get:function(){return g.makeStream}}),Object.defineProperty(exports,"makeTextDecoderIterator",{enumerable:!0,get:function(){return m.makeTextDecoderIterator}}),Object.defineProperty(exports,"makeTextEncoderIterator",{enumerable:!0,get:function(){return m.makeTextEncoderIterator}}),Object.defineProperty(exports,"parse",{enumerable:!0,get:function(){return c.parse}}),Object.defineProperty(exports,"parseInBatches",{enumerable:!0,get:function(){return f.parseInBatches}}),Object.defineProperty(exports,"parseSync",{enumerable:!0,get:function(){return s.parseSync}}),Object.defineProperty(exports,"readArrayBuffer",{enumerable:!0,get:function(){return t.readArrayBuffer}}),Object.defineProperty(exports,"readFileSync",{enumerable:!0,get:function(){return n.readFileSync}}),Object.defineProperty(exports,"registerLoaders",{enumerable:!0,get:function(){return u.registerLoaders}}),Object.defineProperty(exports,"resolvePath",{enumerable:!0,get:function(){return m.resolvePath}}),Object.defineProperty(exports,"save",{enumerable:!0,get:function(){return d.save}}),Object.defineProperty(exports,"saveSync",{enumerable:!0,get:function(){return d.saveSync}}),Object.defineProperty(exports,"selectLoader",{enumerable:!0,get:function(){return a.selectLoader}}),Object.defineProperty(exports,"selectLoaderSync",{enumerable:!0,get:function(){return a.selectLoaderSync}}),Object.defineProperty(exports,"self",{enumerable:!0,get:function(){return m.self}}),Object.defineProperty(exports,"setLoaderOptions",{enumerable:!0,get:function(){return i.setLoaderOptions}}),Object.defineProperty(exports,"setPathPrefix",{enumerable:!0,get:function(){return m.setPathPrefix}}),Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return m.window}}),Object.defineProperty(exports,"writeFile",{enumerable:!0,get:function(){return o.writeFile}}),Object.defineProperty(exports,"writeFileSync",{enumerable:!0,get:function(){return o.writeFileSync}});var r=require("./lib/fetch/fetch-file"),t=require("./lib/fetch/read-array-buffer"),n=require("./lib/fetch/read-file"),o=require("./lib/fetch/write-file"),i=require("./lib/api/loader-options"),u=require("./lib/api/register-loaders"),a=require("./lib/api/select-loader"),c=require("./lib/api/parse"),s=require("./lib/api/parse-sync"),f=require("./lib/api/parse-in-batches"),b=require("./lib/api/load"),p=require("./lib/api/load-in-batches"),l=require("./lib/api/encode"),d=require("./lib/api/save"),m=require("@loaders.gl/loader-utils"),y=require("./iterators/make-iterator/make-iterator"),g=require("./iterators/make-stream/make-node-stream"),P=require("./null-loader"),x=h(require("./lib/progress/fetch-progress")),O=h(require("./lib/filesystems/browser-filesystem")),j=require("./javascript-utils/is-type");function h(e){return e&&e.__esModule?e:{default:e}}
},{"./lib/fetch/fetch-file":"b40H","./lib/fetch/read-array-buffer":"Q1FV","./lib/fetch/read-file":"WRQd","./lib/fetch/write-file":"YW6i","./lib/api/loader-options":"oiG6","./lib/api/register-loaders":"k3wd","./lib/api/select-loader":"W9BO","./lib/api/parse":"t8Kj","./lib/api/parse-sync":"PAJp","./lib/api/parse-in-batches":"tR2z","./lib/api/load":"CA4j","./lib/api/load-in-batches":"C8HI","./lib/api/encode":"SWoI","./lib/api/save":"DUKs","@loaders.gl/loader-utils":"oHIH","./iterators/make-iterator/make-iterator":"wlle","./iterators/make-stream/make-node-stream":"PyjH","./null-loader":"aJIU","./lib/progress/fetch-progress":"HD9x","./lib/filesystems/browser-filesystem":"EeUV","./javascript-utils/is-type":"Oy8e"}],"pSqu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0;const e="3.4.6";exports.VERSION="3.4.6";
},{}],"xUsy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDefaultImageType=n,exports.isImageTypeSupported=s;var e=require("@loaders.gl/loader-utils");const{_parseImageNode:r}=globalThis,t="undefined"!=typeof Image,a="undefined"!=typeof ImageBitmap,o=Boolean(r),i=!!e.isBrowser||o;function s(e){switch(e){case"auto":return a||t||i;case"imagebitmap":return a;case"image":return t;case"data":return i;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}function n(){if(a)return"imagebitmap";if(t)return"image";if(i)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}
},{"@loaders.gl/loader-utils":"oHIH"}],"fZkF":[function(require,module,exports) {
"use strict";function e(e){return Boolean(r(e))}function t(e){switch(a(e)){case"imagebitmap":e.close()}}function a(e){const t=r(e);if(!t)throw new Error("Not an image");return t}function n(e){return i(e)}function i(e){switch(a(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function r(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deleteImage=t,exports.getImageData=i,exports.getImageSize=n,exports.getImageType=a,exports.isImage=e;
},{}],"xgTF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBlob=r,exports.getBlobOrSVGDataUrl=o,exports.isSVG=n;const e=/^data:image\/svg\+xml/,t=/\.svg((\?|#).*)?$/;function n(n){return n&&(e.test(n)||t.test(n))}function o(e,t){if(n(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(o){throw new Error(o.message)}return"data:image/svg+xml;base64,".concat(btoa(t))}return r(e,t)}function r(e,t){if(n(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}
},{}],"ZjNq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t,exports.loadToImage=o;var e=require("./svg-utils");async function t(t,r,a){const c=(0,e.getBlobOrSVGDataUrl)(t,a),n=self.URL||self.webkitURL,s="string"!=typeof c&&n.createObjectURL(c);try{return await o(s||c,r)}finally{s&&n.revokeObjectURL(s)}}async function o(e,t){const o=new Image;return o.src=e,t.image&&t.image.decode&&o.decode?(await o.decode(),o):await new Promise((t,r)=>{try{o.onload=(()=>t(o)),o.onerror=(t=>r(new Error("Could not load image ".concat(e,": ").concat(t))))}catch(a){r(a)}})}
},{"./svg-utils":"xgTF"}],"Mwvl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=i;var e=require("./svg-utils"),t=r(require("./parse-to-image"));function r(e){return e&&e.__esModule?e:{default:e}}const a={};let n=!0;async function i(r,a,n){let i;if((0,e.isSVG)(n)){i=await(0,t.default)(r,a,n)}else i=(0,e.getBlob)(r,n);const l=a&&a.imagebitmap;return await u(i,l)}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!l(t)&&n||(t=null),t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),n=!1}return await createImageBitmap(e)}function l(e){for(const t in e||a)return!1;return!0}
},{"./svg-utils":"xgTF","./parse-to-image":"ZjNq"}],"UAAe":[function(require,module,exports) {
"use strict";function e(e){return i(e,"ftyp",4)?0==(96&e[8])?null:t(e):null}function t(e){switch(r(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function r(e,t,r){return String.fromCharCode(...e.slice(t,r))}function n(e){return[...e].map(e=>e.charCodeAt(0))}function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=n(t);for(let n=0;n<i.length;++n)if(i[n]!==e[n+r])return!1;return!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeMajorBrand=t,exports.getISOBMFFMediaType=e;
},{}],"XFGE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBinaryImageMetadata=i,exports.getBmpMetadata=u;var t=require("./parse-isobmff-binary");const e=!1,n=!0;function i(t){const e=s(t);return a(e)||o(e)||g(e)||u(e)||r(e)}function r(e){const n=new Uint8Array(e instanceof DataView?e.buffer:e),i=(0,t.getISOBMFFMediaType)(n);return i?{mimeType:i.mimeType,width:0,height:0}:null}function a(t){const n=s(t);return n.byteLength>=24&&2303741511===n.getUint32(0,e)?{mimeType:"image/png",width:n.getUint32(16,e),height:n.getUint32(20,e)}:null}function g(t){const i=s(t);return i.byteLength>=10&&1195984440===i.getUint32(0,e)?{mimeType:"image/gif",width:i.getUint16(6,n),height:i.getUint16(8,n)}:null}function u(t){const i=s(t);return i.byteLength>=14&&16973===i.getUint16(0,e)&&i.getUint32(2,n)===i.byteLength?{mimeType:"image/bmp",width:i.getUint32(18,n),height:i.getUint32(22,n)}:null}function o(t){const n=s(t);if(!(n.byteLength>=3&&65496===n.getUint16(0,e)&&255===n.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=f();let a=2;for(;a+9<n.byteLength;){const t=n.getUint16(a,e);if(r.has(t))return{mimeType:"image/jpeg",height:n.getUint16(a+5,e),width:n.getUint16(a+7,e)};if(!i.has(t))return null;a+=2,a+=n.getUint16(a,e)}return null}function f(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function s(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}
},{"./parse-isobmff-binary":"UAAe"}],"wlvc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=require("@loaders.gl/loader-utils"),a=require("../category-api/binary-image-api");async function r(r,t){const{mimeType:i}=(0,a.getBinaryImageMetadata)(r)||{},s=globalThis._parseImageNode;return(0,e.assert)(s),await s(r,i)}
},{"@loaders.gl/loader-utils":"oHIH","../category-api/binary-image-api":"XFGE"}],"acKO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;var e=require("@loaders.gl/loader-utils"),a=require("../category-api/image-type"),t=require("../category-api/parsed-image-api"),r=s(require("./parse-to-image")),i=s(require("./parse-to-image-bitmap")),u=s(require("./parse-to-node-image"));function s(e){return e&&e.__esModule?e:{default:e}}async function o(a,s,o){const p=((s=s||{}).image||{}).type||"auto",{url:l}=o||{};let c;switch(d(p)){case"imagebitmap":c=await(0,i.default)(a,s,l);break;case"image":c=await(0,r.default)(a,s,l);break;case"data":c=await(0,u.default)(a,s);break;default:(0,e.assert)(!1)}return"data"===p&&(c=(0,t.getImageData)(c)),c}function d(e){switch(e){case"auto":case"data":return(0,a.getDefaultImageType)();default:return(0,a.isImageTypeSupported)(e),e}}
},{"@loaders.gl/loader-utils":"oHIH","../category-api/image-type":"xUsy","../category-api/parsed-image-api":"fZkF","./parse-to-image":"ZjNq","./parse-to-image-bitmap":"Mwvl","./parse-to-node-image":"wlvc"}],"Aq3y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._typecheckImageLoader=exports.ImageLoader=void 0;var e=require("./lib/utils/version"),a=o(require("./lib/parsers/parse-image")),i=require("./lib/category-api/binary-image-api");function o(e){return e&&e.__esModule?e:{default:e}}const r=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],g=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],t={image:{type:"auto",decode:!0}},s={id:"image",module:"images",name:"Images",version:e.VERSION,mimeTypes:g,extensions:r,parse:a.default,tests:[e=>Boolean((0,i.getBinaryImageMetadata)(new DataView(e)))],options:t};exports.ImageLoader=s;const m=s;exports._typecheckImageLoader=m;
},{"./lib/utils/version":"pSqu","./lib/parsers/parse-image":"acKO","./lib/category-api/binary-image-api":"XFGE"}],"I3ae":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.encodeImage=a;var e=require("../category-api/parsed-image-api");const{_encodeImageNode:t}=globalThis;async function a(e,a){return(a=a||{}).image=a.image||{},t?t(e,{type:a.image.mimeType}):n(e,a)}let i=!0;async function n(t,a){const{mimeType:n,jpegQuality:o}=a.image,{width:m,height:g}=(0,e.getImageSize)(t),c=document.createElement("canvas");c.width=m,c.height=g,r(t,c);const d=await new Promise(e=>{if(o&&i)try{return void c.toBlob(e,n,o)}catch(t){i=!1}c.toBlob(e,n)});if(!d)throw new Error("image encoding failed");return await d.arrayBuffer()}function r(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(0===a&&0===i&&"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const a=t.getContext("bitmaprenderer");if(a)return a.transferFromImageBitmap(e),t}const n=t.getContext("2d");if(e.data){const a=new Uint8ClampedArray(e.data),i=new ImageData(a,e.width,e.height);return n.putImageData(i,0,0),t}return n.drawImage(e,0,0),t}
},{"../category-api/parsed-image-api":"fZkF"}],"iXQV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageWriter=void 0;var e=require("./lib/utils/version"),i=require("./lib/encoders/encode-image");const r={name:"Images",id:"image",module:"images",version:e.VERSION,extensions:["jpeg"],options:{image:{mimeType:"image/png",jpegQuality:null}},encode:i.encodeImage};exports.ImageWriter=r;
},{"./lib/utils/version":"pSqu","./lib/encoders/encode-image":"I3ae"}],"iD1E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSupportedImageFormats=t,exports.isImageFormatSupported=n;var A=require("@loaders.gl/loader-utils");const e=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/tiff","image/svg","image/svg+xml","image/bmp","image/vnd.microsoft.icon"],a=null;async function t(){if(a)return await a;const t=new Set;for(const a of e){(A.isBrowser?await s(a):o(a))&&t.add(a)}return t}const i={};function n(e){if(void 0===i[e]){const a=A.isBrowser?r(e):o(e);i[e]=a}return i[e]}function o(A){const e=["image/png","image/jpeg","image/gif"],{_parseImageNode:a,_imageFormatsNode:t=e}=globalThis;return Boolean(a)&&t.includes(A)}function r(A){switch(A){case"image/avif":case"image/webp":return c(A);default:return!0}}const g={"image/avif":"data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=","image/webp":"data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"};async function s(A){const e=g[A];return!e||await m(e)}function c(A){try{return 0===document.createElement("canvas").toDataURL(A).indexOf("data:".concat(A))}catch{return!1}}async function m(A){return new Promise(e=>{const a=new Image;a.src=A,a.onload=(()=>e(a.height>0)),a.onerror=(()=>e(!1))})}
},{"@loaders.gl/loader-utils":"oHIH"}],"kCQP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateUrl=t;var e=require("@loaders.gl/loader-utils");function t(t,r,o){let n=t;"function"==typeof t&&(n=t({...r,...o})),(0,e.assert)("string"==typeof n);const{baseUrl:c}=r;return c&&(n="/"===c[c.length-1]?"".concat(c).concat(n):"".concat(c,"/").concat(n)),(0,e.resolvePath)(n)}
},{"@loaders.gl/loader-utils":"oHIH"}],"tUfq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asyncDeepMap=e,exports.mapSubtree=n;const t=t=>t&&"object"==typeof t;async function e(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return await n(t,e,r)}async function n(e,n,o){if(Array.isArray(e))return await a(e,n,o);if(t(e))return await r(e,n,o);const s=e;return await n(s,o)}async function r(t,e,r){const a=[],o={};for(const s in t){const i=n(t[s],e,r).then(t=>{o[s]=t});a.push(i)}return await Promise.all(a),o}async function a(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=t.map(t=>n(t,e,r));return await Promise.all(a)}
},{}],"qUEG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deepLoad=a,exports.shallowLoad=t;var e=require("./async-deep-map");async function a(a,r,n){return await(0,e.asyncDeepMap)(a,e=>t(e,r,n))}async function t(e,a,t){const r=await fetch(e,t.fetch),n=await r.arrayBuffer();return await a(n,t)}
},{"./async-deep-map":"tUfq"}],"qXUM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getImageUrls=n,exports.getMipLevels=u,exports.loadImage=l;var e=require("@loaders.gl/loader-utils"),t=o(require("../parsers/parse-image")),r=require("../category-api/parsed-image-api"),a=require("./generate-url"),i=require("./deep-load");function o(e){return e&&e.__esModule?e:{default:e}}async function l(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=await n(e,r);return await(0,i.deepLoad)(a,t.default,r)}async function n(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=t&&t.image&&t.image.mipLevels||0;return 0!==i?await s(e,i,t,r):(0,a.generateUrl)(e,t,r)}async function s(o,l,n,s){const g=[];if("auto"===l){const e=(0,a.generateUrl)(o,n,{...s,lod:0}),d=await(0,i.shallowLoad)(e,t.default,n),{width:h,height:c}=(0,r.getImageSize)(d);l=u({width:h,height:c}),g.push(e)}(0,e.assert)(l>0);for(let e=g.length;e<l;++e){const t=(0,a.generateUrl)(o,n,{...s,lod:e});g.push(t)}return g}function u(e){let{width:t,height:r}=e;return 1+Math.floor(Math.log2(Math.max(t,r)))}
},{"@loaders.gl/loader-utils":"oHIH","../parsers/parse-image":"acKO","../category-api/parsed-image-api":"fZkF","./generate-url":"kCQP","./deep-load":"qUEG"}],"DNDh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ImageLoader",{enumerable:!0,get:function(){return e.ImageLoader}}),Object.defineProperty(exports,"ImageWriter",{enumerable:!0,get:function(){return r.ImageWriter}}),Object.defineProperty(exports,"getBinaryImageMetadata",{enumerable:!0,get:function(){return t.getBinaryImageMetadata}}),Object.defineProperty(exports,"getDefaultImageType",{enumerable:!0,get:function(){return a.getDefaultImageType}}),Object.defineProperty(exports,"getImageData",{enumerable:!0,get:function(){return i.getImageData}}),Object.defineProperty(exports,"getImageSize",{enumerable:!0,get:function(){return i.getImageSize}}),Object.defineProperty(exports,"getImageType",{enumerable:!0,get:function(){return i.getImageType}}),Object.defineProperty(exports,"getSupportedImageFormats",{enumerable:!0,get:function(){return n.getSupportedImageFormats}}),Object.defineProperty(exports,"isImage",{enumerable:!0,get:function(){return i.isImage}}),Object.defineProperty(exports,"isImageFormatSupported",{enumerable:!0,get:function(){return n.isImageFormatSupported}}),Object.defineProperty(exports,"isImageTypeSupported",{enumerable:!0,get:function(){return a.isImageTypeSupported}}),Object.defineProperty(exports,"loadImage",{enumerable:!0,get:function(){return o.loadImage}});var e=require("./image-loader"),r=require("./image-writer"),t=require("./lib/category-api/binary-image-api"),a=require("./lib/category-api/image-type"),i=require("./lib/category-api/parsed-image-api"),n=require("./lib/category-api/image-format"),o=require("./lib/texture-api/load-image");
},{"./image-loader":"Aq3y","./image-writer":"iXQV","./lib/category-api/binary-image-api":"XFGE","./lib/category-api/image-type":"xUsy","./lib/category-api/parsed-image-api":"fZkF","./lib/category-api/image-format":"iD1E","./lib/texture-api/load-image":"qXUM"}],"eaj5":[function(require,module,exports) {
var process = require("process");
var e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o,exports.isBrowserMainThread=n;var r=t(require("./is-electron"));function t(e){return e&&e.__esModule?e:{default:e}}function o(){return!("object"==typeof e&&"[object process]"===String(e)&&!1)||(0,r.default)()}function n(){return o()&&"undefined"!=typeof document}
},{"./is-electron":"a8Iz","process":"g5IB"}],"KIYD":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var o=arguments[3],e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.window=exports.self=exports.process=exports.global=exports.document=exports.console=void 0;const s={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==o&&o,document:"undefined"!=typeof document&&document,process:"object"==typeof e&&e},t=globalThis;exports.global=t;const n=s.self||s.window||s.global;exports.self=n;const l=s.window||s.self||s.global;exports.window=l;const r=s.document||{};exports.document=r;const d=s.process||{};exports.process=d;const p=console;exports.console=p;
},{"process":"g5IB"}],"ncEu":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var e=arguments[3],r=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0,Object.defineProperty(exports,"console",{enumerable:!0,get:function(){return o.console}}),Object.defineProperty(exports,"document",{enumerable:!0,get:function(){return o.document}}),Object.defineProperty(exports,"global",{enumerable:!0,get:function(){return o.global}}),exports.isBrowser=void 0,Object.defineProperty(exports,"process",{enumerable:!0,get:function(){return o.process}}),Object.defineProperty(exports,"self",{enumerable:!0,get:function(){return o.self}}),Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return o.window}});var t=n(require("../lib/is-browser")),o=require("../lib/globals");function n(e){return e&&e.__esModule?e:{default:e}}const s="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";exports.VERSION=s;const u=(0,t.default)();exports.isBrowser=u;
},{"../lib/is-browser":"eaj5","../lib/globals":"KIYD","process":"g5IB"}],"ms9j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=i,exports.isMobile=o;var e=n(require("./is-browser")),r=n(require("./is-electron"));function n(e){return e&&e.__esModule?e:{default:e}}const t=globalThis;function o(){return void 0!==t.orientation}function i(n){if(!n&&!(0,e.default)())return"Node";if((0,r.default)(n))return"Electron";const o="undefined"!=typeof navigator?navigator:{},i=n||o.userAgent||"";if(i.indexOf("Edge")>-1)return"Edge";const u=-1!==i.indexOf("MSIE "),f=-1!==i.indexOf("Trident/");return u||f?"IE":t.chrome?"Chrome":t.safari?"Safari":t.mozInnerScreenX?"Firefox":"Unknown"}
},{"./is-browser":"eaj5","./is-electron":"a8Iz"}],"Ps6r":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var e=arguments[3],r=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"VERSION",{enumerable:!0,get:function(){return t.VERSION}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(exports,"console",{enumerable:!0,get:function(){return n.console}}),Object.defineProperty(exports,"document",{enumerable:!0,get:function(){return n.document}}),Object.defineProperty(exports,"getBrowser",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"global",{enumerable:!0,get:function(){return n.global}}),Object.defineProperty(exports,"isBrowser",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"isBrowserMainThread",{enumerable:!0,get:function(){return o.isBrowserMainThread}}),Object.defineProperty(exports,"isElectron",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"isMobile",{enumerable:!0,get:function(){return u.isMobile}}),Object.defineProperty(exports,"process",{enumerable:!0,get:function(){return n.process}}),Object.defineProperty(exports,"self",{enumerable:!0,get:function(){return n.self}}),Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return n.window}});var t=require("./utils/globals"),n=require("./lib/globals"),o=c(require("./lib/is-browser")),u=c(require("./lib/get-browser")),i=l(require("./lib/is-electron")),s=l(require("./utils/assert"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(f=function(e){return e?t:r})(e)}function c(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=f(r);if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=o?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}
},{"./utils/globals":"ncEu","./lib/globals":"KIYD","./lib/is-browser":"eaj5","./lib/get-browser":"ms9j","./lib/is-electron":"a8Iz","./utils/assert":"F02Z","process":"g5IB"}],"d7CC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocalStorage=void 0;var t=e(require("@babel/runtime/helpers/esm/defineProperty"));function e(t){return t&&t.__esModule?t:{default:t}}function i(t){try{const i=window[t],s="__storage_test__";return i.setItem(s,s),i.removeItem(s),i}catch(e){return null}}class s{constructor(e,s){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";(0,t.default)(this,"storage",void 0),(0,t.default)(this,"id",void 0),(0,t.default)(this,"config",void 0),this.storage=i(o),this.id=e,this.config=s,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}exports.LocalStorage=s;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"BYZg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.COLOR=void 0,exports.addColor=B;var E=require("@probe.gl/env");let R;function e(E){return"string"==typeof E?R[E.toUpperCase()]||R.WHITE:E}function B(R,B,T){return E.isBrowser||"string"!=typeof R||(B&&(B=e(B),R="[".concat(B,"m").concat(R,"[39m")),T&&(B=e(T),R="[".concat(T+10,"m").concat(R,"[49m"))),R}exports.COLOR=R,function(E){E[E.BLACK=30]="BLACK",E[E.RED=31]="RED",E[E.GREEN=32]="GREEN",E[E.YELLOW=33]="YELLOW",E[E.BLUE=34]="BLUE",E[E.MAGENTA=35]="MAGENTA",E[E.CYAN=36]="CYAN",E[E.WHITE=37]="WHITE",E[E.BRIGHT_BLACK=90]="BRIGHT_BLACK",E[E.BRIGHT_RED=91]="BRIGHT_RED",E[E.BRIGHT_GREEN=92]="BRIGHT_GREEN",E[E.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",E[E.BRIGHT_BLUE=94]="BRIGHT_BLUE",E[E.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",E[E.BRIGHT_CYAN=96]="BRIGHT_CYAN",E[E.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(R||(exports.COLOR=R={}));
},{"@probe.gl/env":"Ps6r"}],"QILw":[function(require,module,exports) {
"use strict";function t(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const o=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(o);for(const r of n)"function"==typeof t[r]&&(e.find(t=>r===t)||(t[r]=t[r].bind(t)))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.autobind=t;
},{}],"GSWh":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getHiResTimestamp=o;var e=require("@probe.gl/env");function o(){let o;var i,r;if(e.isBrowser&&"performance"in e.window)o=null===e.window||void 0===e.window?void 0:null===(i=e.window.performance)||void 0===i?void 0:null===(r=i.now)||void 0===r?void 0:r.call(i);else if("hrtime"in e.process){var s;const i=null===e.process||void 0===e.process?void 0:null===(s=e.process.hrtime)||void 0===s?void 0:s.call(e.process);o=1e3*i[0]+i[1]/1e6}else o=Date.now();return o}
},{"@probe.gl/env":"Ps6r"}],"aAfy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Log=void 0,exports.normalizeArguments=p;var e=l(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@probe.gl/env"),o=require("./utils/local-storage"),s=require("./utils/formatters"),r=require("./utils/color"),n=require("./utils/autobind"),i=l(require("./utils/assert")),a=require("./utils/hi-res-timestamp");function l(e){return e&&e.__esModule?e:{default:e}}const g={debug:t.isBrowser&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},c={enabled:!0,level:0};function u(){}const d={},m={once:!0};class h{constructor(){let{id:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};(0,e.default)(this,"id",void 0),(0,e.default)(this,"VERSION",t.VERSION),(0,e.default)(this,"_startTs",(0,a.getHiResTimestamp)()),(0,e.default)(this,"_deltaTs",(0,a.getHiResTimestamp)()),(0,e.default)(this,"_storage",void 0),(0,e.default)(this,"userData",{}),(0,e.default)(this,"LOG_THROTTLE_TIMEOUT",0),this.id=s,this.userData={},this._storage=new o.LocalStorage("__probe-".concat(this.id,"__"),c),this.timeStamp("".concat(this.id," started")),(0,n.autobind)(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number(((0,a.getHiResTimestamp)()-this._startTs).toPrecision(10))}getDelta(){return Number(((0,a.getHiResTimestamp)()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){(0,i.default)(e,t)}warn(e){return this._getLogFunction(0,e,g.warn,arguments,m)}error(e){return this._getLogFunction(0,e,g.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,g.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,g.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var o=arguments.length,s=new Array(o>2?o-2:0),r=2;r<o;r++)s[r-2]=arguments[r];return this._getLogFunction(e,t,g.debug||g.info,arguments,m)}table(e,t,o){return t?this._getLogFunction(e,t,console.table||u,o&&[o],{tag:L(t)}):u}image(e){let{logLevel:o,priority:s,image:r,message:n="",scale:i=1}=e;return this._shouldLog(o||s)?t.isBrowser?v({image:r,message:n,scale:i}):b({image:r,message:n,scale:i}):u}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||u)}group(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const s=p({logLevel:e,message:t,opts:o}),{collapsed:r}=o;return s.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},o,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||u)}withGroup(e,t,o){this.group(e,t)();try{o()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=f(e)}_getLogFunction(e,t,o,s,r){if(this._shouldLog(e)){r=p({logLevel:e,message:t,args:s,opts:r}),o=o||r.method,(0,i.default)(o),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=(0,a.getHiResTimestamp)();const n=r.tag||r.message;if(r.once){if(d[n])return u;d[n]=(0,a.getHiResTimestamp)()}return t=_(this.id,r.message,r),o.bind(console,t,...r.args)}return u}}function f(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return(0,i.default)(Number.isFinite(t)&&t>=0),t}function p(e){const{logLevel:t,message:o}=e;e.logLevel=f(t);const s=e.args?Array.from(e.args):[];for(;s.length&&s.shift()!==o;);switch(typeof t){case"string":case"function":void 0!==o&&s.unshift(o),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const r=typeof e.message;return(0,i.default)("string"===r||"object"===r),Object.assign(e,{args:s},e.opts)}function _(e,t,o){if("string"==typeof t){const n=o.time?(0,s.leftPad)((0,s.formatTime)(o.total)):"";t=o.time?"".concat(e,": ").concat(n,"  ").concat(t):"".concat(e,": ").concat(t),t=(0,r.addColor)(t,o.color,o.background)}return t}function b(e){let{image:t,message:o="",scale:s=1}=e;return console.warn("removed"),u}function v(e){let{image:t,message:o="",scale:r=1}=e;if("string"==typeof t){const e=new Image;return e.onload=(()=>{const t=(0,s.formatImage)(e,o,r);console.log(...t)}),e.src=t,u}const n=t.nodeName||"";if("img"===n.toLowerCase())return console.log(...(0,s.formatImage)(t,o,r)),u;if("canvas"===n.toLowerCase()){const e=new Image;return e.onload=(()=>console.log(...(0,s.formatImage)(e,o,r))),e.src=t.toDataURL(),u}return u}function L(e){for(const t in e)for(const o in e[t])return o||"untitled";return"empty"}exports.Log=h,(0,e.default)(h,"VERSION",t.VERSION);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@probe.gl/env":"Ps6r","./utils/local-storage":"d7CC","./utils/formatters":"YvW4","./utils/color":"BYZg","./utils/autobind":"QILw","./utils/assert":"F02Z","./utils/hi-res-timestamp":"GSWh"}],"u3lK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"COLOR",{enumerable:!0,get:function(){return r.COLOR}}),Object.defineProperty(exports,"LocalStorage",{enumerable:!0,get:function(){return n.LocalStorage}}),Object.defineProperty(exports,"Log",{enumerable:!0,get:function(){return e.Log}}),Object.defineProperty(exports,"addColor",{enumerable:!0,get:function(){return r.addColor}}),Object.defineProperty(exports,"autobind",{enumerable:!0,get:function(){return o.autobind}}),exports.default=void 0,Object.defineProperty(exports,"getHiResTimestamp",{enumerable:!0,get:function(){return i.getHiResTimestamp}}),Object.defineProperty(exports,"leftPad",{enumerable:!0,get:function(){return t.leftPad}}),Object.defineProperty(exports,"rightPad",{enumerable:!0,get:function(){return t.rightPad}});var e=require("./log"),r=require("./utils/color"),t=require("./utils/formatters"),o=require("./utils/autobind"),n=require("./utils/local-storage"),i=require("./utils/hi-res-timestamp");require("./init");var u=new e.Log({id:"@probe.gl/log"});exports.default=u;
},{"./log":"aAfy","./utils/color":"BYZg","./utils/formatters":"YvW4","./utils/autobind":"QILw","./utils/local-storage":"d7CC","./utils/hi-res-timestamp":"GSWh","./init":"iQbP"}],"GVus":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@probe.gl/log"),r=new e.Log({id:"deck"});exports.default=r;
},{"@probe.gl/log":"u3lK"}],"Bw3o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLoggers=void 0;const t={attributeUpdateStart:-1,attributeManagerUpdateStart:-1,attributeUpdateMessages:[]},a=1,e=2,o=3,n=4,c=2,r=a=>({"layer.changeFlag":(t,e,o)=>{a.log(3,"".concat(t.id," ").concat(e,": "),o[e])()},"layer.initialize":t=>{a.log(1,"Initializing ".concat(t))()},"layer.update":(t,e)=>{if(e){const e=t.getChangeFlags();a.log(2,"Updating ".concat(t," because: ").concat(Object.keys(e).filter(t=>e[t]).join(", ")))()}else a.log(4,"".concat(t," does not need update"))()},"layer.matched":(t,e)=>{e&&a.log(4,"Matched ".concat(t,", state transfered"))()},"layer.finalize":t=>{a.log(1,"Finalizing ".concat(t))()},"compositeLayer.renderLayers":(t,e,o)=>{e?a.log(2,"Composite layer rendered new subLayers ".concat(t),o)():a.log(4,"Composite layer reused subLayers ".concat(t),o)()},"layerManager.setLayers":(t,e,o)=>{e&&a.log(2,"Updating ".concat(o.length," deck layers"))()},"layerManager.activateViewport":(t,e)=>{a.log(3,"Viewport changed",e)()},"attributeManager.invalidate":(t,e,o)=>{a.log(1,o?"invalidated attributes ".concat(o," (").concat(e,") for ").concat(t.id):"invalidated all attributes for ".concat(t.id))()},"attributeManager.updateStart":a=>{t.attributeUpdateMessages.length=0,t.attributeManagerUpdateStart=Date.now()},"attributeManager.updateEnd":(e,o)=>{const n=Math.round(Date.now()-t.attributeManagerUpdateStart);a.groupCollapsed(2,"Updated attributes for ".concat(o," instances in ").concat(e.id," in ").concat(n,"ms"))();for(const c of t.attributeUpdateMessages)a.log(3,c)();a.groupEnd(2)()},"attribute.updateStart":a=>{t.attributeUpdateStart=Date.now()},"attribute.allocate":(a,e)=>{const o="".concat(a.id," allocated ").concat(e);t.attributeUpdateMessages.push(o)},"attribute.updateEnd":(a,e)=>{const o=Math.round(Date.now()-t.attributeUpdateStart),n="".concat(a.id," updated ").concat(e," in ").concat(o,"ms");t.attributeUpdateMessages.push(n)},"deckRenderer.renderLayers":(t,e,o)=>{const{pass:n,redrawReason:c,stats:r}=o;for(const s of e){const{totalCount:e,visibleCount:o,compositeCount:i,pickableCount:d}=s,l=e-i-o;a.log(2,"RENDER #".concat(t.renderCount,"   ").concat(o," (of ").concat(e," layers) to ").concat(n," because ").concat(c,"   (").concat(l," hidden, ").concat(i," composite ").concat(d," pickable)"))(),r&&r.get("Redraw Layers").add(o)}}});exports.getLoggers=r;
},{}],"EEoF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o,exports.register=u;var e=l(require("../utils/log")),t=require("./loggers");function l(e){return e&&e.__esModule?e:{default:e}}let r={};function u(e){r=e}function o(t,l,u,o){e.default.level>0&&r[t]&&r[t].call(null,l,u,o)}
},{"../utils/log":"GVus","./loggers":"Bw3o"}],"DDDc":[function(require,module,exports) {
"use strict";function e(e){const o=e[0],t=e[e.length-1];return"{"===o&&"}"===t||"["===o&&"]"===t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:e,parseTextSync:JSON.parse};exports.default=o;
},{}],"N6pv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0;var e=require("@loaders.gl/core"),r=require("@loaders.gl/images"),o=s(require("../utils/log")),l=require("../debug"),t=s(require("../utils/json-loader"));function s(e){return e&&e.__esModule?e:{default:e}}function i(){const s=globalThis.deck&&globalThis.deck.VERSION;if(s&&"8.9.4"!==s)throw new Error("deck.gl - multiple versions detected: ".concat(s," vs ").concat("8.9.4"));return s||(o.default.log(1,"deck.gl ".concat("8.9.4"))(),globalThis.deck={...globalThis.deck,VERSION:"8.9.4",version:"8.9.4",log:o.default,_registerLoggers:l.register},(0,e.registerLoaders)([t.default,[r.ImageLoader,{imagebitmap:{premultiplyAlpha:"none"}}]])),"8.9.4"}const a=i();exports.VERSION=a;
},{"@loaders.gl/core":"ikKD","@loaders.gl/images":"DNDh","../utils/log":"GVus","../debug":"EEoF","../utils/json-loader":"DDDc"}],"ysbg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UNIT=exports.PROJECTION_MODE=exports.OPERATION=exports.EVENTS=exports.COORDINATE_SYSTEM=void 0;var e=E(require("../utils/log"));function E(e){return e&&e.__esModule?e:{default:e}}const r={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};exports.COORDINATE_SYSTEM=r,Object.defineProperty(r,"IDENTITY",{get:()=>(e.default.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const t={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0};exports.PROJECTION_MODE=t;const T={common:0,meters:1,pixels:2};exports.UNIT=T;const o={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};exports.EVENTS=o;const O={DRAW:"draw",MASK:"mask",TERRAIN:"terrain"};exports.OPERATION=O;
},{"../utils/log":"GVus"}],"Wd6X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.log=void 0;var e=require("@probe.gl/log");const o=new e.Log({id:"luma.gl"});exports.log=o;
},{"@probe.gl/log":"u3lK"}],"uPB9":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)throw new Error(r||"luma.gl: assertion failed.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=e;
},{}],"E5mh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ERR_WEBGL2=exports.ERR_WEBGL=void 0,exports.assertWebGL2Context=x,exports.assertWebGLContext=u,exports.getWebGL2Context=i,exports.isWebGL=r,exports.isWebGL2=s;var e=require("./assert");const n="Invalid WebGLRenderingContext",t=n;exports.ERR_WEBGL=t;const o="Requires WebGL2";function r(e){return"undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version)))}function s(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function i(e){return s(e)?e:null}function u(t){return(0,e.assert)(r(t),n),t}function x(n){return(0,e.assert)(s(n),o),n}exports.ERR_WEBGL2=o;
},{"./assert":"uPB9"}],"RzJJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.polyfillVertexArrayObject=c;const t={};function e(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function r(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function i(r,i){t[r]=!0,void 0!==i&&e(i)}function n(e){const r=e.getError;e.getError=function(){let i;do{0!==(i=r.apply(e))&&(t[i]=!0)}while(0!==i);for(i in t)if(t[i])return delete t[i],parseInt(i,10);return 0}}const a=function t(e){const r=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const e=new t.VertexAttrib(r);this.attribs[i]=e}this.maxAttrib=0};(a.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const s=function(t){const e=this;this.gl=t,n(t);const i=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:i.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;return r.maxAttrib=Math.max(r.maxAttrib,t),r.attribs[t].enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;return r.maxAttrib=Math.max(r.maxAttrib,t),r.attribs[t].enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,r){switch(t){case 34962:e.currentArrayBuffer=r;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=r}return i.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,r){const n=e.currentVertexArrayObject.attribs[t];switch(r){case 34975:return n.buffer;case 34338:return n.enabled;case 34339:return n.size;case 34340:return n.stride;case 34341:return n.type;case 34922:return n.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,r,n,a,s,c){const o=e.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,t);const l=o.attribs[t];return l.buffer=e.currentArrayBuffer,l.size=r,l.type=n,l.normalized=a,l.stride=s,l.offset=c,l.recache(),i.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",()=>{r("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};function c(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const r=t.getExtension;t.getExtension=function(e){const i=r.call(this,e);return i||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new s(this)),this.__OESVertexArrayObject))}}s.prototype.VERTEX_ARRAY_BINDING_OES=34229,s.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new a(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},s.prototype.createVertexArrayOES=function(){const t=new a(this);return this.vertexArrayObjects.push(t),t},s.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},s.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof a&&t.hasBeenBound&&t.ext===this)},s.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return void i(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const r=this.original,n=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const a=this.currentVertexArrayObject;if(n===a)return;n&&a.elementArrayBuffer===n.elementArrayBuffer||r.bindBuffer.call(e,34963,a.elementArrayBuffer);let s=this.currentArrayBuffer;const c=Math.max(n?n.maxAttrib:0,a.maxAttrib);for(let i=0;i<=c;i++){const t=a.attribs[i],c=n?n.attribs[i]:null;if(n&&t.enabled===c.enabled||(t.enabled?r.enableVertexAttribArray.call(e,i):r.disableVertexAttribArray.call(e,i)),t.enabled){let a=!1;n&&t.buffer===c.buffer||(s!==t.buffer&&(r.bindBuffer.call(e,34962,t.buffer),s=t.buffer),a=!0),(a||t.cached!==c.cached)&&r.vertexAttribPointer.call(e,i,t.size,t.type,t.normalized,t.stride,t.offset)}}this.currentArrayBuffer!==s&&r.bindBuffer.call(e,34962,this.currentArrayBuffer)};
},{}],"pXPX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getParameterPolyfill=W;var e=require("../utils/webgl-checks");const t="OES_element_index",n="WEBGL_draw_buffers",i="EXT_disjoint_timer_query",_="EXT_disjoint_timer_query_webgl2",r="EXT_texture_filter_anisotropic",o="WEBGL_debug_renderer_info",s=35723,E=4352,u=36795,c=34047,T=37445,x=37446,G=t=>(0,e.isWebGL2)(t)?void 0:0,L={3074:t=>(0,e.isWebGL2)(t)?void 0:36064,35723:t=>(0,e.isWebGL2)(t)?void 0:4352,35977:G,32937:G,36795:(t,n)=>{const r=(0,e.isWebGL2)(t)?t.getExtension(_):t.getExtension(i);return r&&r.GPU_DISJOINT_EXT?n(r.GPU_DISJOINT_EXT):0},37445:(e,t)=>{const n=e.getExtension(o);return t(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(e,t)=>{const n=e.getExtension(o);return t(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(e,t)=>{const n=e.luma.extensions.EXT_texture_filter_anisotropic;return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:G,35071:G,37447:G,36063:(t,i)=>{if(!(0,e.isWebGL2)(t)){const e=t.getExtension(n);return e?i(e.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:G,35374:G,35377:G,34852:t=>{if(!(0,e.isWebGL2)(t)){const e=t.getExtension(n);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:e=>e.getExtension(t)?2147483647:65535,33001:e=>e.getExtension(t)?16777216:65535,33e3:e=>16777216,37157:G,35373:G,35657:G,36183:G,37137:G,34045:G,35978:G,35979:G,35968:G,35376:G,35375:G,35659:G,37154:G,35371:G,35658:G,35076:G,35077:G,35380:G};function W(e,t,n){const i=L[n],_="function"==typeof i?i(e,t,n):i;return void 0!==_?_:t(n)}
},{"../utils/webgl-checks":"E5mh"}],"tsyS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WEBGL2_CONTEXT_POLYFILLS=exports.WEBGL2_CONTEXT_OVERRIDES=void 0;var e=require("../utils/assert"),r=require("../utils/webgl-checks"),t=require("./get-parameter-polyfill");const s="OES_vertex_array_object",a="ANGLE_instanced_arrays",i="WEBGL_draw_buffers",n="EXT_disjoint_timer_query",u="EXT_texture_filter_anisotropic",o="VertexArray requires WebGL2 or OES_vertex_array_object extension";function c(e,t){return{webgl2:(0,r.isWebGL2)(e),ext:e.getExtension(t)}}const _={[s]:{meta:{suffix:"OES"},createVertexArray:()=>{(0,e.assert)(!1,o)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[a]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(r,t){(0,e.assert)(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[i]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{(0,e.assert)(!1)}},[n]:{meta:{suffix:"EXT"},createQuery:()=>{(0,e.assert)(!1)},deleteQuery:()=>{(0,e.assert)(!1)},beginQuery:()=>{(0,e.assert)(!1)},endQuery:()=>{},getQuery(e,r){return this.getQueryObject(e,r)},getQueryParameter(e,r){return this.getQueryObject(e,r)},getQueryObject:()=>{}}};exports.WEBGL2_CONTEXT_POLYFILLS=_;const E={readBuffer:(e,t,s)=>{(0,r.isWebGL2)(e)&&t(s)},getVertexAttrib:(e,r,t,s)=>{const{webgl2:i,ext:n}=c(e,a);let u;switch(s){case 35069:u=!!i&&void 0;break;case 35070:u=i||n?void 0:0}return void 0!==u?u:r(t,s)},getProgramParameter:(e,t,s,a)=>{if(!(0,r.isWebGL2)(e))switch(a){case 35967:return 35981;case 35971:case 35382:return 0}return t(s,a)},getInternalformatParameter:(e,t,s,a,i)=>{if(!(0,r.isWebGL2)(e))switch(i){case 32937:return new Int32Array([0])}return e.getInternalformatParameter(s,a,i)},getTexParameter(e,r,t,s){switch(s){case 34046:const{extensions:r}=e.luma,t=r.EXT_texture_filter_anisotropic;s=t&&t.TEXTURE_MAX_ANISOTROPY_EXT||34046}return r(t,s)},getParameter:t.getParameterPolyfill,hint:(e,r,t,s)=>r(t,s)};exports.WEBGL2_CONTEXT_OVERRIDES=E;
},{"../utils/assert":"uPB9","../utils/webgl-checks":"E5mh","./get-parameter-polyfill":"pXPX"}],"FLAS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.polyfillContext=n;var t=require("./polyfill-vertex-array-object"),e=require("../utils/assert"),o=require("./polyfill-table");function n(e){e.luma=e.luma||{};const{luma:n}=e;return n.polyfilled||((0,t.polyfillVertexArrayObject)(e),r(e),i(e,o.WEBGL2_CONTEXT_POLYFILLS),l(e,{target:n,target2:e}),n.polyfilled=!0),e}function r(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const o of e)t.luma[o]=t.getExtension(o)}function l(t,e){let{target:n,target2:r}=e;Object.keys(o.WEBGL2_CONTEXT_OVERRIDES).forEach(e=>{if("function"==typeof o.WEBGL2_CONTEXT_OVERRIDES[e]){const l=t[e]?t[e].bind(t):()=>{},i=o.WEBGL2_CONTEXT_OVERRIDES[e].bind(null,t,l);n[e]=i,r[e]=i}})}function i(t,e){for(const o of Object.getOwnPropertyNames(e))"overrides"!==o&&s(t,{extension:o,target:t.luma,target2:t})}function s(t,n){let{extension:r,target:l,target2:i}=n;const s=o.WEBGL2_CONTEXT_POLYFILLS[r];(0,e.assert)(s);const{meta:f={}}=s,{suffix:c=""}=f,a=t.getExtension(r);for(const e of Object.keys(s)){const o="".concat(e).concat(c);let n=null;"meta"===e||"function"==typeof t[e]||(a&&"function"==typeof a[o]?n=function(){return a[o](...arguments)}:"function"==typeof s[e]&&(n=s[e].bind(l))),n&&(l[e]=n,i[e]=n)}}globalThis.polyfillContext=n;
},{"./polyfill-vertex-array-object":"RzJJ","../utils/assert":"uPB9","./polyfill-table":"tsyS"}],"tvxq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GL_PARAMETER_SETTERS=exports.GL_PARAMETER_GETTERS=exports.GL_PARAMETER_DEFAULTS=exports.GL_HOOKED_SETTERS=exports.GL_COMPOSITE_PARAMETER_SETTERS=void 0;var e=require("../utils/webgl-checks");const n={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0};exports.GL_PARAMETER_DEFAULTS=n;const t=(e,n,t)=>n?e.enable(t):e.disable(t),l=(e,n,t)=>e.hint(t,n),a=(e,n,t)=>e.pixelStorei(t,n),r=(n,t)=>{const l=(0,e.isWebGL2)(n)?36009:36160;return n.bindFramebuffer(l,t)},c=(e,n)=>e.bindFramebuffer(36008,n);function s(e){return Array.isArray(e)||ArrayBuffer.isView(e)}const o={3042:t,32773:(e,n)=>e.blendColor(...n),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,n)=>e.clearColor(...n),3107:(e,n)=>e.colorMask(...n),2884:t,2885:(e,n)=>e.cullFace(n),2929:t,2931:(e,n)=>e.clearDepth(n),2932:(e,n)=>e.depthFunc(n),2928:(e,n)=>e.depthRange(...n),2930:(e,n)=>e.depthMask(n),3024:t,35723:l,36006:r,2886:(e,n)=>e.frontFace(n),33170:l,2849:(e,n)=>e.lineWidth(n),32823:t,32824:"polygonOffset",10752:"polygonOffset",35977:t,32938:"sampleCoverage",32939:"sampleCoverage",3089:t,3088:(e,n)=>e.scissor(...n),2960:t,2961:(e,n)=>e.clearStencil(n),2968:(e,n)=>e.stencilMaskSeparate(1028,n),36005:(e,n)=>e.stencilMaskSeparate(1029,n),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,n)=>e.viewport(...n),3333:a,3317:a,37440:a,37441:a,37443:a,3330:a,3332:a,3331:a,36010:c,3314:a,32878:a,3316:a,3315:a,32877:a,framebuffer:(e,n)=>{const t=n&&"handle"in n?n.handle:n;return e.bindFramebuffer(36160,t)},blend:(e,n)=>n?e.enable(3042):e.disable(3042),blendColor:(e,n)=>e.blendColor(...n),blendEquation:(e,n)=>{n=s(n)?n:[n,n],e.blendEquationSeparate(...n)},blendFunc:(e,n)=>{n=s(n)&&2===n.length?[...n,...n]:n,e.blendFuncSeparate(...n)},clearColor:(e,n)=>e.clearColor(...n),clearDepth:(e,n)=>e.clearDepth(n),clearStencil:(e,n)=>e.clearStencil(n),colorMask:(e,n)=>e.colorMask(...n),cull:(e,n)=>n?e.enable(2884):e.disable(2884),cullFace:(e,n)=>e.cullFace(n),depthTest:(e,n)=>n?e.enable(2929):e.disable(2929),depthFunc:(e,n)=>e.depthFunc(n),depthMask:(e,n)=>e.depthMask(n),depthRange:(e,n)=>e.depthRange(...n),dither:(e,n)=>n?e.enable(3024):e.disable(3024),derivativeHint:(e,n)=>{e.hint(35723,n)},frontFace:(e,n)=>e.frontFace(n),mipmapHint:(e,n)=>e.hint(33170,n),lineWidth:(e,n)=>e.lineWidth(n),polygonOffsetFill:(e,n)=>n?e.enable(32823):e.disable(32823),polygonOffset:(e,n)=>e.polygonOffset(...n),sampleCoverage:(e,n)=>e.sampleCoverage(...n),scissorTest:(e,n)=>n?e.enable(3089):e.disable(3089),scissor:(e,n)=>e.scissor(...n),stencilTest:(e,n)=>n?e.enable(2960):e.disable(2960),stencilMask:(e,n)=>{n=s(n)?n:[n,n];const[t,l]=n;e.stencilMaskSeparate(1028,t),e.stencilMaskSeparate(1029,l)},stencilFunc:(e,n)=>{n=s(n)&&3===n.length?[...n,...n]:n;const[t,l,a,r,c,o]=n;e.stencilFuncSeparate(1028,t,l,a),e.stencilFuncSeparate(1029,r,c,o)},stencilOp:(e,n)=>{n=s(n)&&3===n.length?[...n,...n]:n;const[t,l,a,r,c,o]=n;e.stencilOpSeparate(1028,t,l,a),e.stencilOpSeparate(1029,r,c,o)},viewport:(e,n)=>e.viewport(...n)};function i(e,n,t){return void 0!==n[e]?n[e]:t[e]}exports.GL_PARAMETER_SETTERS=o;const p={blendEquation:(e,n,t)=>e.blendEquationSeparate(i(32777,n,t),i(34877,n,t)),blendFunc:(e,n,t)=>e.blendFuncSeparate(i(32969,n,t),i(32968,n,t),i(32971,n,t),i(32970,n,t)),polygonOffset:(e,n,t)=>e.polygonOffset(i(32824,n,t),i(10752,n,t)),sampleCoverage:(e,n,t)=>e.sampleCoverage(i(32938,n,t),i(32939,n,t)),stencilFuncFront:(e,n,t)=>e.stencilFuncSeparate(1028,i(2962,n,t),i(2967,n,t),i(2963,n,t)),stencilFuncBack:(e,n,t)=>e.stencilFuncSeparate(1029,i(34816,n,t),i(36003,n,t),i(36004,n,t)),stencilOpFront:(e,n,t)=>e.stencilOpSeparate(1028,i(2964,n,t),i(2965,n,t),i(2966,n,t)),stencilOpBack:(e,n,t)=>e.stencilOpSeparate(1029,i(34817,n,t),i(34818,n,t),i(34819,n,t))};exports.GL_COMPOSITE_PARAMETER_SETTERS=p;const u={enable:(e,n)=>e({[n]:!0}),disable:(e,n)=>e({[n]:!1}),pixelStorei:(e,n,t)=>e({[n]:t}),hint:(e,n,t)=>e({[n]:t}),bindFramebuffer:(e,n,t)=>{switch(n){case 36160:return e({36006:t,36010:t});case 36009:return e({36006:t});case 36008:return e({36010:t});default:return null}},blendColor:(e,n,t,l,a)=>e({32773:new Float32Array([n,t,l,a])}),blendEquation:(e,n)=>e({32777:n,34877:n}),blendEquationSeparate:(e,n,t)=>e({32777:n,34877:t}),blendFunc:(e,n,t)=>e({32969:n,32968:t,32971:n,32970:t}),blendFuncSeparate:(e,n,t,l,a)=>e({32969:n,32968:t,32971:l,32970:a}),clearColor:(e,n,t,l,a)=>e({3106:new Float32Array([n,t,l,a])}),clearDepth:(e,n)=>e({2931:n}),clearStencil:(e,n)=>e({2961:n}),colorMask:(e,n,t,l,a)=>e({3107:[n,t,l,a]}),cullFace:(e,n)=>e({2885:n}),depthFunc:(e,n)=>e({2932:n}),depthRange:(e,n,t)=>e({2928:new Float32Array([n,t])}),depthMask:(e,n)=>e({2930:n}),frontFace:(e,n)=>e({2886:n}),lineWidth:(e,n)=>e({2849:n}),polygonOffset:(e,n,t)=>e({32824:n,10752:t}),sampleCoverage:(e,n,t)=>e({32938:n,32939:t}),scissor:(e,n,t,l,a)=>e({3088:new Int32Array([n,t,l,a])}),stencilMask:(e,n)=>e({2968:n,36005:n}),stencilMaskSeparate:(e,n,t)=>e({[1028===n?2968:36005]:t}),stencilFunc:(e,n,t,l)=>e({2962:n,2967:t,2963:l,34816:n,36003:t,36004:l}),stencilFuncSeparate:(e,n,t,l,a)=>e({[1028===n?2962:34816]:t,[1028===n?2967:36003]:l,[1028===n?2963:36004]:a}),stencilOp:(e,n,t,l)=>e({2964:n,2965:t,2966:l,34817:n,34818:t,34819:l}),stencilOpSeparate:(e,n,t,l,a)=>e({[1028===n?2964:34817]:t,[1028===n?2965:34818]:l,[1028===n?2966:34819]:a}),viewport:(e,n,t,l,a)=>e({2978:[n,t,l,a]})};exports.GL_HOOKED_SETTERS=u;const d=(e,n)=>e.isEnabled(n),F={3042:d,2884:d,2929:d,3024:d,32823:d,32926:d,32928:d,3089:d,2960:d,35977:d};exports.GL_PARAMETER_GETTERS=F;
},{"../utils/webgl-checks":"E5mh"}],"sNqS":[function(require,module,exports) {
"use strict";function r(r){for(const e in r)return!1;return!0}function e(r,e){if(r===e)return!0;const t=Array.isArray(r)||ArrayBuffer.isView(r),n=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&n&&r.length===e.length){for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0}return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deepArrayEqual=e,exports.isObjectEmpty=r;
},{}],"XIFr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.popContextState=l,exports.pushContextState=h,exports.trackContextState=i;var t=require("./webgl-parameter-tables"),e=require("./unified-parameter-api"),a=require("../utils/assert"),s=require("../utils/utils");function n(t,e){const a=t[e].bind(t);t[e]=function(){const e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache&&t.state.enable?t.state.cache[e]:a(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function o(t,e,a){const s=t[e].bind(t);t[e]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];const{valueChanged:c,oldValue:r}=a(t.state._updateCache,...n);return c&&s(...n),r},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function c(t){const e=t.useProgram.bind(t);t.useProgram=function(a){t.state.program!==a&&(e(a),t.state.program=a)}}class r{constructor(a){let{copyState:s=!1,log:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=a,this.program=null,this.stateStack=[],this.enable=!0,this.cache=s?(0,e.getParameters)(a):Object.assign({},t.GL_PARAMETER_DEFAULTS),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stateStack.push({})}pop(){(0,a.assert)(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];(0,e.setParameters)(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const o=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const c in t){(0,a.assert)(void 0!==c);const r=t[c],i=this.cache[c];(0,s.deepArrayEqual)(r,i)||(n=!0,e=i,!o||c in o||(o[c]=i),this.cache[c]=r)}return{valueChanged:n,oldValue:e}}}function i(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:i=!0,copyState:h}=s;if((0,a.assert)(void 0!==h),!e.state){const{polyfillContext:a}=globalThis;a&&a(e),e.state=new r(e,{copyState:h}),c(e);for(const s in t.GL_HOOKED_SETTERS){o(e,s,t.GL_HOOKED_SETTERS[s])}n(e,"getParameter"),n(e,"isEnabled")}return e.state.enable=i,e}function h(t){t.state||i(t,{copyState:!1}),t.state.push()}function l(t){(0,a.assert)(t.state),t.state.pop()}
},{"./webgl-parameter-tables":"tvxq","./unified-parameter-api":"TZJt","../utils/assert":"uPB9","../utils/utils":"sNqS"}],"TZJt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getParameters=a,exports.resetParameters=i,exports.setParameters=o,exports.withParameters=c;var e=require("./webgl-parameter-tables"),t=require("./track-context-state"),r=require("../utils/assert"),s=require("../utils/webgl-checks"),n=require("../utils/utils");function o(t,o){if((0,r.assert)((0,s.isWebGL)(t),"setParameters requires a WebGL context"),(0,n.isObjectEmpty)(o))return;const a={};for(const r in o){const s=Number(r),n=e.GL_PARAMETER_SETTERS[r];n&&("string"==typeof n?a[n]=!0:n(t,o[r],s))}const i=t.state&&t.state.cache;if(i)for(const r in a){(0,e.GL_COMPOSITE_PARAMETER_SETTERS[r])(t,o,i)}}function a(t,r){if("number"==typeof(r=r||e.GL_PARAMETER_DEFAULTS)){const s=r,n=e.GL_PARAMETER_GETTERS[s];return n?n(t,s):t.getParameter(s)}const s=Array.isArray(r)?r:Object.keys(r),n={};for(const o of s){const r=e.GL_PARAMETER_GETTERS[o];n[o]=r?r(t,Number(o)):t.getParameter(Number(o))}return n}function i(t){o(t,e.GL_PARAMETER_DEFAULTS)}function c(e,r,s){if((0,n.isObjectEmpty)(r))return s(e);const{nocatch:a=!0}=r;let i;if((0,t.pushContextState)(e),o(e,r),a)i=s(e),(0,t.popContextState)(e);else try{i=s(e)}finally{(0,t.popContextState)(e)}return i}
},{"./webgl-parameter-tables":"tvxq","./track-context-state":"XIFr","../utils/assert":"uPB9","../utils/webgl-checks":"E5mh","../utils/utils":"sNqS"}],"LoQn":[function(require,module,exports) {
"use strict";function t(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function e(e,n){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return i(n,t(e),e.drawingBufferWidth,e.drawingBufferHeight,r)}function n(t){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function i(t,e,n,i,a){const c=r(t[0],e,n);let u=o(t[1],e,i,a),s=r(t[0]+1,e,n);const d=s===n-1?s:s-1;let h;return s=o(t[1]+1,e,i,a),a?(h=u,u=s=0===s?s:s+1):h=s===i-1?s:s-1,{x:c,y:u,width:Math.max(d-c+1,1),height:Math.max(h-u+1,1)}}function r(t,e,n){return Math.min(Math.round(t*e),n-1)}function o(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.cssToDevicePixels=e,exports.cssToDeviceRatio=t,exports.getDevicePixelRatio=n;
},{}],"Ijug":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createGLContext=s,exports.getContextDebugInfo=d,exports.instrumentGLContext=g,exports.resizeGLContext=u;var e=require("@probe.gl/env"),t=require("../state-tracker/track-context-state"),n=require("../utils/log"),o=require("../utils/assert"),r=require("../utils/device-pixels"),a=require("../utils/webgl-checks");const i=(0,e.isBrowser)(),l=i&&"undefined"!=typeof document,c={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.assert)(i,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),e=Object.assign({},c,e);const{width:t,height:n}=e;function r(t){if(e.throwOnError)throw new Error(t);return console.error(t),null}let a;e.onError=r;const{canvas:l}=e;return(a=h(v({canvas:l,width:t,height:n,onError:r}),e))?(f(a=g(a,e)),a):null}function g(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||e._instrumented)return e;e._version=e._version||b(e),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{},o=Object.assign({},c,o);const{manageState:r,debug:a}=o;return r&&(0,t.trackContextState)(e,{copyState:!1,log:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.log.log(1,...t)()}}),i&&a&&(globalThis.makeDebugContext?(e=globalThis.makeDebugContext(e,o),n.log.level=Math.max(n.log.level,1)):n.log.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),e._instrumented=!0,e}function d(e){const t=e.getParameter(7936),n=e.getParameter(7937),o=e.getExtension("WEBGL_debug_renderer_info");return{vendor:o&&e.getParameter(o.UNMASKED_VENDOR_WEBGL||7936)||t,renderer:o&&e.getParameter(o.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:t,rendererMasked:n,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.canvas){return void m(e,(0,r.getDevicePixelRatio)(t.useDevicePixels),t)}const n=e.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in t&&"height"in t&&n.resize(t.width,t.height)}function h(e,t){const{onError:n}=t;let o=null;const r=e=>o=e.statusMessage||o;e.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:a=!0,webgl2:i=!0}=t;let l=null;return i&&(l=(l=l||e.getContext("webgl2",t))||e.getContext("experimental-webgl2",t)),a&&(l=(l=l||e.getContext("webgl",t))||e.getContext("experimental-webgl",t)),e.removeEventListener("webglcontextcreationerror",r,!1),l?(t.onContextLost&&e.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&e.addEventListener("webglcontextrestored",t.onContextRestored,!1),l):n("Failed to create ".concat(i&&!a?"WebGL2":"WebGL"," context: ").concat(o||"Unknown error"))}function v(e){let t,{canvas:n,width:o=800,height:r=600,onError:a}=e;if("string"==typeof n){l&&"complete"===document.readyState||a("createGLContext called on canvas '".concat(n,"' before page was loaded")),t=document.getElementById(n)}else n?t=n:((t=document.createElement("canvas")).id="lumagl-canvas",t.style.width=Number.isFinite(o)?"".concat(o,"px"):"100%",t.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(t,document.body.firstChild));return t}function f(e){const t=(0,a.isWebGL2)(e)?"WebGL2":"WebGL1",o=d(e),r=o?"(".concat(o.vendor,",").concat(o.renderer,")"):"",i=e.debug?" debug":"";n.log.info(1,"".concat(t).concat(i," context ").concat(r))()}function b(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?2:1}function m(e,t,o){let r="width"in o?o.width:e.canvas.clientWidth,a="height"in o?o.height:e.canvas.clientHeight;r&&a||(n.log.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,r=e.canvas.width||1,a=e.canvas.height||1),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{};const i=e.luma.canvasSizeInfo;if(i.clientWidth!==r||i.clientHeight!==a||i.devicePixelRatio!==t){let o=t;const i=Math.floor(r*o),l=Math.floor(a*o);e.canvas.width=i,e.canvas.height=l,e.drawingBufferWidth===i&&e.drawingBufferHeight===l||(n.log.warn("Device pixel ratio clamped")(),o=Math.min(e.drawingBufferWidth/r,e.drawingBufferHeight/a),e.canvas.width=Math.floor(r*o),e.canvas.height=Math.floor(a*o)),Object.assign(e.luma.canvasSizeInfo,{clientWidth:r,clientHeight:a,devicePixelRatio:t})}}
},{"@probe.gl/env":"Ps6r","../state-tracker/track-context-state":"XIFr","../utils/log":"Wd6X","../utils/assert":"uPB9","../utils/device-pixels":"LoQn","../utils/webgl-checks":"E5mh"}],"lAom":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"assertWebGL2Context",{enumerable:!0,get:function(){return t.assertWebGL2Context}}),Object.defineProperty(exports,"assertWebGLContext",{enumerable:!0,get:function(){return t.assertWebGLContext}}),Object.defineProperty(exports,"createGLContext",{enumerable:!0,get:function(){return u.createGLContext}}),Object.defineProperty(exports,"cssToDevicePixels",{enumerable:!0,get:function(){return i.cssToDevicePixels}}),Object.defineProperty(exports,"cssToDeviceRatio",{enumerable:!0,get:function(){return i.cssToDeviceRatio}}),Object.defineProperty(exports,"getContextDebugInfo",{enumerable:!0,get:function(){return u.getContextDebugInfo}}),Object.defineProperty(exports,"getParameters",{enumerable:!0,get:function(){return n.getParameters}}),Object.defineProperty(exports,"getWebGL2Context",{enumerable:!0,get:function(){return t.getWebGL2Context}}),Object.defineProperty(exports,"instrumentGLContext",{enumerable:!0,get:function(){return u.instrumentGLContext}}),Object.defineProperty(exports,"isWebGL",{enumerable:!0,get:function(){return t.isWebGL}}),Object.defineProperty(exports,"isWebGL2",{enumerable:!0,get:function(){return t.isWebGL2}}),Object.defineProperty(exports,"log",{enumerable:!0,get:function(){return e.log}}),Object.defineProperty(exports,"polyfillContext",{enumerable:!0,get:function(){return r.polyfillContext}}),Object.defineProperty(exports,"popContextState",{enumerable:!0,get:function(){return o.popContextState}}),Object.defineProperty(exports,"pushContextState",{enumerable:!0,get:function(){return o.pushContextState}}),Object.defineProperty(exports,"resetParameters",{enumerable:!0,get:function(){return n.resetParameters}}),Object.defineProperty(exports,"resizeGLContext",{enumerable:!0,get:function(){return u.resizeGLContext}}),Object.defineProperty(exports,"setParameters",{enumerable:!0,get:function(){return n.setParameters}}),Object.defineProperty(exports,"trackContextState",{enumerable:!0,get:function(){return o.trackContextState}}),Object.defineProperty(exports,"withParameters",{enumerable:!0,get:function(){return n.withParameters}});var e=require("./utils/log"),t=require("./utils/webgl-checks"),r=require("./polyfill/polyfill-context"),n=require("./state-tracker/unified-parameter-api"),o=require("./state-tracker/track-context-state"),u=require("./context/context"),i=require("./utils/device-pixels");
},{"./utils/log":"Wd6X","./utils/webgl-checks":"E5mh","./polyfill/polyfill-context":"FLAS","./state-tracker/unified-parameter-api":"TZJt","./state-tracker/track-context-state":"XIFr","./context/context":"Ijug","./utils/device-pixels":"LoQn"}],"unm0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=i(require("@babel/runtime/helpers/esm/defineProperty")),e=i(require("../utils/hi-res-timestamp"));function i(t){return t&&t.__esModule?t:{default:t}}class s{constructor(e,i){(0,t.default)(this,"name",void 0),(0,t.default)(this,"type",void 0),(0,t.default)(this,"sampleSize",1),(0,t.default)(this,"time",void 0),(0,t.default)(this,"count",void 0),(0,t.default)(this,"samples",void 0),(0,t.default)(this,"lastTiming",void 0),(0,t.default)(this,"lastSampleTime",void 0),(0,t.default)(this,"lastSampleCount",void 0),(0,t.default)(this,"_count",0),(0,t.default)(this,"_time",0),(0,t.default)(this,"_samples",0),(0,t.default)(this,"_startTime",0),(0,t.default)(this,"_timerPending",!1),this.name=e,this.type=i,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=(0,e.default)(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime((0,e.default)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}exports.default=s;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../utils/hi-res-timestamp":"Qm3h"}],"LxIK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),e=s(require("./stat"));function s(t){return t&&t.__esModule?t:{default:t}}class i{constructor(e){(0,t.default)(this,"id",void 0),(0,t.default)(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(t){if(!t||!t.name)return null;const{name:s,type:i}=t;return this.stats[s]||(t instanceof e.default?this.stats[s]=t:this.stats[s]=new e.default(s,i)),this.stats[s]}}exports.default=i;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./stat":"unm0"}],"SZdt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Stat",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"Stats",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"_getHiResTimestamp",{enumerable:!0,get:function(){return r.default}});var e=u(require("./lib/stats")),t=u(require("./lib/stat")),r=u(require("./utils/hi-res-timestamp"));function u(e){return e&&e.__esModule?e:{default:e}}
},{"./lib/stats":"LxIK","./lib/stat":"unm0","./utils/hi-res-timestamp":"Qm3h"}],"HGnm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lumaStats=exports.default=exports.StatsManager=void 0;var t=require("@luma.gl/gltools"),s=require("@probe.gl/stats"),e=require("@probe.gl/env");const l="8.5.20",a="set luma.log.level=1 (or higher) to trace rendering";class o{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new s.Stats({id:t})),this.stats.get(t)}}exports.StatsManager=o;const r=new o;if(exports.lumaStats=r,globalThis.luma&&globalThis.luma.VERSION!==l)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(l));globalThis.luma||((0,e.isBrowser)()&&t.log.log(1,"luma.gl ".concat(l," - ").concat(a))(),globalThis.luma=globalThis.luma||{VERSION:l,version:l,log:t.log,stats:r,globals:{modules:{},nodeIO:{}}});var g=globalThis.luma;exports.default=g;
},{"@luma.gl/gltools":"lAom","@probe.gl/stats":"SZdt","@probe.gl/env":"Ps6r"}],"AGkC":[function(require,module,exports) {
"use strict";function e(e){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function n(e){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.cancelAnimationFrame=n,exports.requestAnimationFrame=e;
},{}],"UyRF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getKey=r,exports.getKeyType=n,exports.getKeyValue=t;var e=require("../utils/assert");function t(t,r){if("string"!=typeof r)return r;const n=Number(r);if(!isNaN(n))return n;const s=t[r=r.replace(/^.*\./,"")];return(0,e.assert)(void 0!==s,"Accessing undefined constant GL.".concat(r)),s}function r(e,t){t=Number(t);for(const r in e)if(e[r]===t)return"GL.".concat(r);return String(t)}function n(t,r){(0,e.assert)(void 0!==r,"undefined key"),r=Number(r);for(const e in t)if(t[e]===r)return"GL.".concat(e);return String(r)}
},{"../utils/assert":"uPB9"}],"OhKi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isObjectEmpty=o,exports.isPowerOfTwo=n,exports.uid=r;var e=require("./assert");const t={};function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";t[e]=t[e]||1;const r=t[e]++;return"".concat(e,"-").concat(r)}function n(t){return(0,e.assert)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function o(e){let t=!0;for(const r in e){t=!1;break}return t}
},{"./assert":"uPB9"}],"EgC4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stubRemovedMethods=o;var e=require("@luma.gl/gltools");function o(o,t,r,a){const c="See luma.gl ".concat(r," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),d=Object.getPrototypeOf(o);a.forEach(o=>{d.methodName||(d[o]=(()=>{throw e.log.removed("Calling removed method ".concat(t,".").concat(o,": "),c)(),new Error(o)}))})}
},{"@luma.gl/gltools":"lAom"}],"DwD3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@luma.gl/gltools"),e=require("../init"),s=require("../webgl-utils/constants-to-keys"),n=require("../utils/assert"),o=require("../utils/utils"),r=require("../utils/stub-methods");const i="Resource subclass must define virtual methods";class a{get[Symbol.toStringTag](){return"Resource"}constructor(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,t.assertWebGLContext)(e);const{id:n,userData:r={}}=s;this.gl=e,this.gl2=e,this.id=n||(0,o.uid)(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=s.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach(t=>t.delete()),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=(0,s.getKeyValue)(this.gl,e),(0,n.assert)(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const e=(0,t.isWebGL2)(this.gl);if(!((!("webgl2"in r)||e)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const t=r.webgl1,s="webgl2"in r?r.webgl2:r.webgl1;return e?s:t}}return this._getParameter(e,o)}getParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:n,keys:o}=e,r=this.constructor.PARAMETERS||{},i=(0,t.isWebGL2)(this.gl),a={},l=n||Object.keys(r);for(const t of l){const n=r[t];if(n&&(!("webgl2"in n)||i)&&(!("extension"in n)||this.gl.getExtension(n.extension))){const r=o?(0,s.getKey)(this.gl,t):t;a[r]=this.getParameter(t,e),o&&"GLenum"===n.type&&(a[r]=(0,s.getKey)(this.gl,a[r]))}}return a}setParameter(e,o){e=(0,s.getKeyValue)(this.gl,e),(0,n.assert)(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const e=(0,t.isWebGL2)(this.gl);if(!((!("webgl2"in r)||e)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(o=(0,s.getKeyValue)(o))}return this._setParameter(e,o),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,s){return(0,r.stubRemovedMethods)(this,t,e,s)}initialize(t){}_createHandle(){throw new Error(i)}_deleteHandle(){throw new Error(i)}_bindHandle(t){throw new Error(i)}_getOptsFromHandle(){throw new Error(i)}_getParameter(t,e){throw new Error(i)}_setParameter(t,e){throw new Error(i)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],s=e.lumaStats.get("Resource Counts");s.get("Resources Created").incrementCount(),s.get("".concat(t,"s Created")).incrementCount(),s.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];e.lumaStats.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const o=e.lumaStats.get("Memory Usage".concat(n));o.get("GPU Memory").addCount(t),o.get("".concat(s," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.lumaStats.get("Memory Usage".concat(s));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}}exports.default=a;
},{"@luma.gl/gltools":"lAom","../init":"HGnm","../webgl-utils/constants-to-keys":"UyRF","../utils/assert":"uPB9","../utils/utils":"OhKi","../utils/stub-methods":"EgC4"}],"MBUn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.flipRows=a,exports.getGLTypeFromTypedArray=t,exports.getTypedArrayFromGLType=e,exports.scalePixels=n;const r="Failed to deduce GL constant from typed array";function t(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(r)}}function e(r){let{clamped:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(r){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function a(r){let{data:t,width:e,height:a,bytesPerPixel:n=4,temp:s}=r;const o=e*n;s=s||new Uint8Array(o);for(let c=0;c<a/2;++c){const r=c*o,e=(a-c-1)*o;s.set(t.subarray(r,r+o)),t.copyWithin(r,e,e+o),t.set(s,e)}}function n(r){let{data:t,width:e,height:a}=r;const n=Math.round(e/2),s=Math.round(a/2),o=new Uint8Array(n*s*4);for(let c=0;c<s;c++)for(let r=0;r<n;r++)for(let a=0;a<4;a++)o[4*(c*n+r)+a]=t[4*(2*c*e+2*r)+a];return{data:o,width:n,height:s}}
},{}],"vBG1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkProps=o;var c=require("@luma.gl/gltools");function o(o,e,t){const{removedProps:n={},deprecatedProps:r={},replacedProps:a={}}=t;for(const i in n)if(i in e){const e=n[i]?"".concat(o,".").concat(n[i]):"N/A";c.log.removed("".concat(o,".").concat(i),e)()}for(const i in r)if(i in e){const e=r[i];c.log.deprecated("".concat(o,".").concat(i),"".concat(o,".").concat(e))()}let s=null;for(const i in a)if(i in e){const t=a[i];c.log.deprecated("".concat(o,".").concat(i),"".concat(o,".").concat(t))(),(s=s||Object.assign({},e))[t]=e[i],delete s[i]}return s||e}
},{"@luma.gl/gltools":"lAom"}],"OEzr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DEFAULT_ACCESSOR_VALUES=void 0;var e=require("../webgl-utils/typed-array-utils"),t=require("../utils/assert"),i=require("../utils/check-props");const r={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1};exports.DEFAULT_ACCESSOR_VALUES=r;const s={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class o{static getBytesPerElement(t){return(0,e.getTypedArrayFromGLType)(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(i){return(0,t.assert)(i.size),(0,e.getTypedArrayFromGLType)(i.type||5126).BYTES_PER_ELEMENT*i.size}static resolve(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new o(...[r,...t])}constructor(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(e=>this._assign(e)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return o.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return o.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0!==(e=(0,i.checkProps)("Accessor",e,s)).type&&(this.type=e.type,5124!==e.type&&5125!==e.type||(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&("boolean"==typeof e.index?this.index=e.index?1:0:this.index=e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}exports.default=o;
},{"../webgl-utils/typed-array-utils":"MBUn","../utils/assert":"uPB9","../utils/check-props":"vBG1"}],"d4ii":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("./resource")),t=n(require("./accessor")),s=require("../webgl-utils/typed-array-utils"),r=require("@luma.gl/gltools"),a=require("../utils/assert"),i=require("../utils/check-props");function n(e){return e&&e.__esModule?e:{default:e}}const h=10,l={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},u={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:l},c={removedProps:l};class d extends e.default{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/t.default.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/t.default.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=(0,i.checkProps)("Buffer",e,u),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=(0,i.checkProps)("Buffer",e,c))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new t.default(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:s=0,srcOffset:i=0}=e,n=e.byteLength||e.length;(0,a.assert)(t);const h=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(h,this.handle),0!==i||void 0!==n?((0,r.assertWebGL2Context)(this.gl),this.gl.bufferSubData(this.target,s,t,i,n)):this.gl.bufferSubData(h,s,t),this.gl.bindBuffer(h,null),this.debugData=null,this._inferType(t),this}copyData(e){let{sourceBuffer:t,readOffset:s=0,writeOffset:a=0,size:i}=e;const{gl:n}=this;return(0,r.assertWebGL2Context)(n),n.bindBuffer(36662,t.handle),n.bindBuffer(36663,this.handle),n.copyBufferSubData(36662,36663,s,a,i),n.bindBuffer(36662,null),n.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.assertWebGL2Context)(this.gl);const h=(0,s.getTypedArrayFromGLType)(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(t),u=i;let c,d;e?c=(d=e.length)-u:d=u+(c=Math.min(l,n||l));const o=Math.min(l,c);return n=n||o,(0,a.assert)(n<=o),e=e||new h(d),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,n),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:s=0,size:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,s,r):((0,a.assert)(0===s),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(h,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+r;(0,a.assert)(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const n=this._getTarget();this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,i,this.usage),this.gl.bufferSubData(n,r,e),this.gl.bindBuffer(n,null),this.debugData=e.slice(0,h),this.bytesUsed=i,this._trackAllocatedMemory(i);const l=(0,s.getGLTypeFromTypedArray)(e);return(0,a.assert)(l),this.setAccessor(new t.default(this.accessor,{type:l})),this}_setByteLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;(0,a.assert)(e>=0),this._trackDeallocatedMemory();let s=e;0===e&&(s=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,s,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const t=e/(0,s.getTypedArrayFromGLType)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-t}_inferType(e){this.accessor.type||this.setAccessor(new t.default(this.accessor,{type:(0,s.getGLTypeFromTypedArray)(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return r.log.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return r.log.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return r.log.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return r.log.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new t.default(this.accessor,e),this}}exports.default=d;
},{"./resource":"DwD3","./accessor":"OEzr","../webgl-utils/typed-array-utils":"MBUn","@luma.gl/gltools":"lAom","../utils/assert":"uPB9","../utils/check-props":"vBG1"}],"PH5D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TYPE_SIZES=exports.TEXTURE_FORMATS=exports.DATA_FORMAT_CHANNELS=void 0,exports.isFormatSupported=a,exports.isLinearFilteringSupported=s;var t=require("@luma.gl/gltools");const e={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}};exports.TEXTURE_FORMATS=e;const r={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2};exports.DATA_FORMAT_CHANNELS=r;const o={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function a(r,o){const a=e[o];if(!a)return!1;if(void 0===a.gl1&&void 0===a.gl2)return!0;const s=(0,t.isWebGL2)(r)&&a.gl2||a.gl1;return"string"==typeof s?r.getExtension(s):s}function s(t,r){const o=e[r];switch(o&&o.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}exports.TYPE_SIZES=o;
},{"@luma.gl/gltools":"lAom"}],"GqKp":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@luma.gl/gltools"),e=h(require("./resource")),i=h(require("./buffer")),a=require("./texture-formats"),s=require("../utils/assert"),r=require("../utils/utils");function h(t){return t&&t.__esModule?t:{default:t}}const d=[9729,9728],o=globalThis.WebGLBuffer||function(){};class n extends e.default{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:i,linearFiltering:s}=e;let r=!0;return i&&(r=(r=r&&(0,a.isFormatSupported)(t,i))&&(!s||(0,a.isLinearFilteringSupported)(t,i))),r}constructor(t,e){const{id:i=(0,r.uid)("texture"),handle:a,target:s}=e;super(t,{id:i,handle:a}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.data;if(i instanceof Promise)return i.then(t=>this.initialize(Object.assign({},e,{pixels:t,data:t}))),this;const a="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement;if(a&&i.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,i.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:s=null,format:r=6408,border:h=0,recreate:d=!1,parameters:o={},pixelStore:n={},textureUnit:l}=e;i||(i=s);let{width:u,height:g,dataFormat:m,type:p,compressed:c=!1,mipmaps:f=!0}=e;const{depth:T=0}=e;return({width:u,height:g,compressed:c,dataFormat:m,type:p}=this._deduceParameters({format:r,type:p,dataFormat:m,compressed:c,data:i,width:u,height:g})),this.width=u,this.height=g,this.depth=T,this.format=r,this.type=p,this.dataFormat=m,this.border=h,this.textureUnit=l,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),f&&this._isNPOT()&&(t.log.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),f=!1,this._updateForNPOT(o)),this.mipmaps=f,this.setImageData({data:i,width:u,height:g,depth:T,format:r,type:p,dataFormat:m,border:h,mipmaps:f,parameters:n,compressed:c}),f&&this.generateMipmap(),this.setParameters(o),d&&(this.data=i),a&&(this._video={video:i,parameters:o,lastTime:i.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?i.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:i}=this._video;if(i===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:i,mipmaps:a=!1}=t;return i!==this.width||e!==this.height?this.initialize({width:i,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:a}):this}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(t.log.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),(0,t.withParameters)(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:i=this.target,pixels:r=null,level:h=0,format:d=this.format,border:o=this.border,offset:n=0,parameters:l={}}=e;let{data:u=null,type:g=this.type,width:m=this.width,height:p=this.height,dataFormat:c=this.dataFormat,compressed:f=!1}=e;u||(u=r),({type:g,dataFormat:c,compressed:f,width:m,height:p}=this._deduceParameters({format:d,type:g,dataFormat:c,compressed:f,data:u,width:m,height:p}));const{gl:T}=this;T.bindTexture(this.target,this.handle);let x,b=null;({data:u,dataType:b}=this._getDataType({data:u,compressed:f}));let w=0;if((0,t.withParameters)(this.gl,l,()=>{switch(b){case"null":T.texImage2D(i,h,d,m,p,o,c,g,u);break;case"typed-array":T.texImage2D(i,h,d,m,p,o,c,g,u,n);break;case"buffer":(x=(0,t.assertWebGL2Context)(T)).bindBuffer(35052,u.handle||u),x.texImage2D(i,h,d,m,p,o,c,g,n),x.bindBuffer(35052,null);break;case"browser-object":(0,t.isWebGL2)(T)?T.texImage2D(i,h,d,m,p,o,c,g,u):T.texImage2D(i,h,d,c,g,u);break;case"compressed":for(const[t,e]of u.entries())T.compressedTexImage2D(i,t,e.format,e.width,e.height,o,e.data),w+=e.levelSize;break;default:(0,s.assert)(!1,"Unknown image data type")}}),"compressed"===b)this._trackAllocatedMemory(w,"Texture");else if(u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const t=a.DATA_FORMAT_CHANNELS[this.dataFormat]||4,e=a.TYPE_SIZES[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:a=this.target,pixels:r=null,data:h=null,x:d=0,y:n=0,width:l=this.width,height:u=this.height,level:g=0,format:m=this.format,type:p=this.type,dataFormat:c=this.dataFormat,compressed:f=!1,offset:T=0,border:x=this.border,parameters:b={}}=e;if(({type:p,dataFormat:c,compressed:f,width:l,height:u}=this._deduceParameters({format:m,type:p,dataFormat:c,compressed:f,data:h,width:l,height:u})),(0,s.assert)(0===this.depth,"texSubImage not supported for 3D textures"),h||(h=r),h&&h.data){const t=h;h=t.data,l=t.shape[0],u=t.shape[1]}h instanceof i.default&&(h=h.handle),this.gl.bindTexture(this.target,this.handle),(0,t.withParameters)(this.gl,b,()=>{if(f)this.gl.compressedTexSubImage2D(a,g,d,n,l,u,m,h);else if(null===h)this.gl.texSubImage2D(a,g,d,n,l,u,c,p,null);else if(ArrayBuffer.isView(h))this.gl.texSubImage2D(a,g,d,n,l,u,c,p,h,T);else if(h instanceof o){const e=(0,t.assertWebGL2Context)(this.gl);e.bindBuffer(35052,h),e.texSubImage2D(a,g,d,n,l,u,c,p,T),e.bindBuffer(35052,null)}else if((0,t.isWebGL2)(this.gl)){(0,t.assertWebGL2Context)(this.gl).texSubImage2D(a,g,d,n,l,u,c,p,h)}else this.gl.texSubImage2D(a,g,d,n,c,p,h)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t.log.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:a=!1}=t;return a?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof i.default?{data:e.handle,dataType:"buffer"}:e instanceof o?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:i}=t;let{width:s,height:r,dataFormat:h,type:d,compressed:o}=t;const n=a.TEXTURE_FORMATS[e];return h=h||n&&n.dataFormat,d=d||n&&n.types[0],o=o||n&&n.compressed,({width:s,height:r}=this._deduceImageSize(i,s,r)),{dataFormat:h,type:d,compressed:o,width:s,height:r,format:e,data:i}}_deduceImageSize(t,e,i){let a;return a="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?{width:t.width,height:t.height}:"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:i}:{width:e>=0?e:1,height:i>=0?i:1},(0,s.assert)(a,"Could not deduced texture size"),(0,s.assert)(void 0===e||a.width===e,"Deduced texture width does not match supplied width"),(0,s.assert)(void 0===i||a.height===i,"Deduced texture height does not match supplied height"),a}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:(0,s.assert)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(0,t.isWebGL2)(this.gl)&&(!(!this.width||!this.height)&&(!(0,r.isPowerOfTwo)(this.width)||!(0,r.isPowerOfTwo)(this.height)))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===d.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}exports.default=n;
},{"@luma.gl/gltools":"lAom","./resource":"DwD3","./buffer":"d4ii","./texture-formats":"PH5D","../utils/assert":"uPB9","../utils/utils":"OhKi"}],"QQ37":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFile=o,exports.loadImage=n,exports.setPathPrefix=r;var e=require("../utils/assert");let t="";function r(e){t=e}function o(r){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,e.assert)("string"==typeof r),r=t+r;const n=o.dataType||"text";return fetch(r,o).then(e=>e[n]())}function n(r,o){return(0,e.assert)("string"==typeof r),r=t+r,new Promise((e,t)=>{try{const s=new Image;s.onload=(()=>e(s)),s.onerror=(()=>t(new Error("Could not load image ".concat(r,".")))),s.crossOrigin=o&&o.crossOrigin||"anonymous",s.src=r}catch(n){t(n)}})}
},{"../utils/assert":"uPB9"}],"YE27":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/gltools"),t=s(require("./texture")),r=require("../utils/load-file");function s(e){return e&&e.__esModule?e:{default:e}}class a extends t.default{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,r){return t.default.isSupported(e,r)}constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,e.assertWebGLContext)(t),(s instanceof Promise||"string"==typeof s)&&(s={data:s}),"string"==typeof s.data&&(s=Object.assign({},s,{data:(0,r.loadImage)(s.data)})),super(t,Object.assign({},s,{target:3553})),this.initialize(s),Object.seal(this)}}exports.default=a;
},{"@luma.gl/gltools":"lAom","./texture":"GqKp","../utils/load-file":"QQ37"}],"eOjF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@luma.gl/gltools"),e=a(require("./texture"));function a(t){return t&&t.__esModule?t:{default:t}}const s=[34069,34070,34071,34072,34073,34074];class i extends e.default{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,t.assertWebGLContext)(e),super(e,Object.assign({},a,{target:34067})),this.initialize(a),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:e=!0,parameters:a={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(a)}),this}subImage(t){let{face:e,data:a,x:s=0,y:i=0,mipmapLevel:r=0}=t;return this._subImage({target:e,data:a,x:s,y:i,mipmapLevel:r})}async setCubeMapImageData(e){let{width:a,height:i,pixels:r,data:o,border:l=0,format:n=6408,type:h=5121}=e;const{gl:m}=this,g=r||o,p=await Promise.all(s.map(t=>{const e=g[t];return Promise.all(Array.isArray(e)?e:[e])}));this.bind(),s.forEach((e,s)=>{p[s].length>1&&!1!==this.opts.mipmaps&&t.log.warn("".concat(this.id," has mipmap and multiple LODs."))(),p[s].forEach((t,s)=>{a&&i?m.texImage2D(e,s,n,a,i,l,n,h,t):m.texImage2D(e,s,n,n,h,t)})}),this.unbind()}setImageDataForFace(t){const{face:e,width:a,height:s,pixels:i,data:r,border:o=0,format:l=6408,type:n=5121}=t,{gl:h}=this,m=i||r;return this.bind(),m instanceof Promise?m.then(a=>this.setImageDataForFace(Object.assign({},t,{face:e,data:a,pixels:a}))):this.width||this.height?h.texImage2D(e,0,l,a,s,o,l,n,m):h.texImage2D(e,0,l,l,n,m),this}}exports.default=i,i.FACES=s;
},{"@luma.gl/gltools":"lAom","./texture":"GqKp"}],"mmMI":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@luma.gl/gltools"),e=i(require("./texture")),r=require("./texture-formats"),a=i(require("./buffer"));function i(t){return t&&t.__esModule?t:{default:t}}class s extends e.default{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return(0,t.isWebGL2)(e)}constructor(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,t.assertWebGL2Context)(e),super(e,r=Object.assign({depth:1},r,{target:32879,unpackFlipY:!1})),this.initialize(r),Object.seal(this)}setImageData(e){let{level:i=0,dataFormat:s=6408,width:l,height:h,depth:u=1,border:o=0,format:d,type:n=5121,offset:g=0,data:f,parameters:c={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),(0,t.withParameters)(this.gl,c,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,i,s,l,h,u,o,d,n,f),f instanceof a.default&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,i,s,l,h,u,o,d,n,g))}),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const t=r.DATA_FORMAT_CHANNELS[this.dataFormat]||4,e=r.TYPE_SIZES[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}exports.default=s;
},{"@luma.gl/gltools":"lAom","./texture":"GqKp","./texture-formats":"PH5D","./buffer":"d4ii"}],"miHD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const p="EXT_color_buffer_float";var b={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:p,bpp:2},33327:{gl2:p,bpp:4},34842:{gl2:p,bpp:8},33326:{gl2:p,bpp:4},33328:{gl2:p,bpp:8},34836:{gl2:p,bpp:16},35898:{gl2:p,bpp:4}};exports.default=b;
},{}],"baET":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("./resource")),t=s(require("./renderbuffer-formats")),r=require("@luma.gl/gltools"),i=require("../utils/assert");function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i){const s=i[t];if(!s)return!1;const a=(0,r.isWebGL2)(e)&&s.gl2||s.gl1;return"string"==typeof a?e.getExtension(a):a}class h extends e.default{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!r||a(e,r,t.default)}static getSamplesForFormat(e,t){let{format:r}=t;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.initialize(t),Object.seal(this)}initialize(e){let{format:s,width:a=1,height:h=1,samples:l=0}=e;return(0,i.assert)(s,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==l&&(0,r.isWebGL2)(this.gl)?this.gl.renderbufferStorageMultisample(36161,l,s,a,h):this.gl.renderbufferStorage(36161,s,a,h),this.format=s,this.width=a,this.height=h,this.samples=l,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*t.default[this.format].bpp),this}resize(e){let{width:t,height:r}=e;return t!==this.width||r!==this.height?this.initialize({width:t,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}exports.default=h;
},{"./resource":"DwD3","./renderbuffer-formats":"miHD","@luma.gl/gltools":"lAom","../utils/assert":"uPB9"}],"ztYM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=o,exports.clearBuffer=i;var e=require("@luma.gl/gltools"),r=require("../utils/assert");const a=256,l=1024,t=16384,f=6144,c=6145,s=6146,u=34041,n="clear: bad arguments";function o(f){let{framebuffer:c=null,color:s=null,depth:u=null,stencil:o=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};c&&(i.framebuffer=c);let b=0;s&&(b|=t,!0!==s&&(i.clearColor=s)),u&&(b|=a,!0!==u&&(i.clearDepth=u)),o&&(b|=l,!0!==u&&(i.clearStencil=u)),(0,r.assert)(0!==b,n),(0,e.withParameters)(f,i,()=>{f.clear(b)})}function i(a){let{framebuffer:l=null,buffer:t=f,drawBuffer:o=0,value:i=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,e.assertWebGL2Context)(a),(0,e.withParameters)(a,{framebuffer:l},()=>{switch(t){case f:switch(i.constructor){case Int32Array:a.clearBufferiv(t,o,i);break;case Uint32Array:a.clearBufferuiv(t,o,i);break;case Float32Array:default:a.clearBufferfv(t,o,i)}break;case c:a.clearBufferfv(c,0,[i]);break;case s:a.clearBufferiv(s,0,[i]);break;case u:const[e,l]=i;a.clearBufferfi(u,0,e,l);break;default:(0,r.assert)(!1,n)}})}
},{"@luma.gl/gltools":"lAom","../utils/assert":"uPB9"}],"BCIn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.glFormatToComponents=r,exports.glTypeToBytes=s;var e=require("../utils/assert");function r(r){switch(r){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return(0,e.assert)(!1),0}}function s(r){switch(r){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return(0,e.assert)(!1),0}}
},{"../utils/assert":"uPB9"}],"DmZq":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.blit=m,exports.copyToDataUrl=c,exports.copyToImage=d,exports.copyToTexture=g,exports.readPixelsToArray=l,exports.readPixelsToBuffer=f;var e=i(require("./buffer")),t=i(require("./framebuffer")),r=i(require("./texture")),a=require("@luma.gl/gltools"),o=require("../webgl-utils/typed-array-utils"),u=require("../webgl-utils/format-utils"),s=require("../webgl-utils/texture-utils"),n=require("../utils/assert");function i(e){return e&&e.__esModule?e:{default:e}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:r=0,sourceY:a=0,sourceFormat:u=6408}=t;let{sourceAttachment:s=36064,target:i=null,sourceWidth:l,sourceHeight:f,sourceType:c}=t;const{framebuffer:d,deleteFramebuffer:g}=h(e);(0,n.assert)(d);const{gl:m,handle:p,attachments:F}=d;l=l||d.width,f=f||d.height,36064===s&&null===p&&(s=1028),(0,n.assert)(F[s]),i=b(i,c=c||F[s].type,u,l,f),c=c||(0,o.getGLTypeFromTypedArray)(i);const y=m.bindFramebuffer(36160,p);return m.readPixels(r,a,l,f,u,c,i),m.bindFramebuffer(36160,y||null),g&&d.delete(),i}function f(t,r){let{sourceX:o=0,sourceY:s=0,sourceFormat:i=6408,target:l=null,targetByteOffset:f=0,sourceWidth:c,sourceHeight:d,sourceType:g}=r;const{framebuffer:m,deleteFramebuffer:b}=h(t);(0,n.assert)(m),c=c||m.width,d=d||m.height;const p=(0,a.assertWebGL2Context)(m.gl);if(g=g||(l?l.type:5121),!l){const t=(0,u.glFormatToComponents)(i),r=(0,u.glTypeToBytes)(g),a=f+c*d*t*r;l=new e.default(p,{byteLength:a,accessor:{type:g,size:t}})}return l.bind({target:35051}),(0,a.withParameters)(p,{framebuffer:m},()=>{p.readPixels(o,s,c,d,i,g,f)}),l.unbind({target:35051}),b&&m.delete(),l}function c(e){let{sourceAttachment:t=36064,targetMaxHeight:r=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=l(e,{sourceAttachment:t}),{width:u,height:s}=e;for(;s>r;)({data:a,width:u,height:s}=(0,o.scalePixels)({data:a,width:u,height:s}));(0,o.flipRows)({data:a,width:u,height:s});const n=document.createElement("canvas");n.width=u,n.height=s;const i=n.getContext("2d"),f=i.createImageData(u,s);return f.data.set(a),i.putImageData(f,0,0),n.toDataURL()}function d(e){let{sourceAttachment:t=36064,targetImage:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=c(e,{sourceAttachment:t});return(r=r||new Image).src=a,r}function g(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:u=0,sourceY:s=0,targetMipmaplevel:i=0,targetInternalFormat:l=6408}=o;let{targetX:f,targetY:c,targetZ:d,width:g,height:m}=o;const{framebuffer:b,deleteFramebuffer:p}=h(e);(0,n.assert)(b);const{gl:F,handle:y}=b,x=void 0!==f||void 0!==c||void 0!==d;f=f||0,c=c||0,d=d||0;const T=F.bindFramebuffer(36160,y);(0,n.assert)(t);let w=null;if(t instanceof r.default&&(w=t,g=Number.isFinite(g)?g:w.width,m=Number.isFinite(m)?m:w.height,w.bind(0),t=w.target),x)switch(t){case 3553:case 34067:F.copyTexSubImage2D(t,i,f,c,u,s,g,m);break;case 35866:case 32879:(0,a.assertWebGL2Context)(F).copyTexSubImage3D(t,i,f,c,d,u,s,g,m)}else F.copyTexImage2D(t,i,l,u,s,g,m,0);return w&&w.unbind(),F.bindFramebuffer(36160,T||null),p&&b.delete(),w}function m(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX0:o=0,sourceY0:u=0,targetX0:s=0,targetY0:i=0,color:l=!0,depth:f=!1,stencil:c=!1,filter:d=9728}=r;let{sourceX1:g,sourceY1:m,targetX1:b,targetY1:p,sourceAttachment:F=36064,mask:y=0}=r;const{framebuffer:x,deleteFramebuffer:T}=h(e),{framebuffer:w,deleteFramebuffer:v}=h(t);(0,n.assert)(x),(0,n.assert)(w);const{gl:A,handle:I,width:B,height:L,readBuffer:X}=w,q=(0,a.assertWebGL2Context)(A);x.handle||36064!==F||(F=1028),l&&(y|=16384),f&&(y|=256),c&&(y|=1024),(T||v)&&1280&y&&(y=16384,a.log.warn("Blitting from or into a Texture object, forcing mask to GL.COLOR_BUFFER_BIT")()),(0,n.assert)(y),g=void 0===g?x.width:g,m=void 0===m?x.height:m,b=void 0===b?B:b,p=void 0===p?L:p;const Y=A.bindFramebuffer(36009,I),_=A.bindFramebuffer(36008,x.handle);return q.readBuffer(F),q.blitFramebuffer(o,u,g,m,s,i,b,p,y,d),q.readBuffer(X),q.bindFramebuffer(36008,_||null),q.bindFramebuffer(36009,Y||null),T&&x.delete(),v&&w.delete(),w}function h(e){return e instanceof t.default?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:(0,s.toFramebuffer)(e),deleteFramebuffer:!0}}function b(e,t,r,a,s){if(e)return e;return t=t||5121,new((0,o.getTypedArrayFromGLType)(t,{clamped:!1}))(a*s*(0,u.glFormatToComponents)(r))}
},{"./buffer":"d4ii","./framebuffer":"QRT8","./texture":"GqKp","@luma.gl/gltools":"lAom","../webgl-utils/typed-array-utils":"MBUn","../webgl-utils/format-utils":"BCIn","../webgl-utils/texture-utils":"oR6C","../utils/assert":"uPB9"}],"IlXB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l={33902:{gl1:new Float32Array([1,1])},33901:{gl1:new Float32Array([1,1])},3379:{gl1:64,gl2:2048},34076:{gl1:16},34930:{gl1:8},35661:{gl1:8},35660:{gl1:0},34024:{gl1:1},36348:{gl1:8},34921:{gl1:8},36347:{gl1:128},36349:{gl1:16},3386:{gl1:new Int32Array([0,0])},32883:{gl1:0,gl2:256},35071:{gl1:0,gl2:256},37447:{gl1:0,gl2:0},36063:{gl1:0,gl2:4},35379:{gl1:0,gl2:0},35374:{gl1:0,gl2:0},35377:{gl1:0,gl2:0},34852:{gl1:0,gl2:4},36203:{gl1:0,gl2:0},33001:{gl1:0,gl2:0},33e3:{gl1:0,gl2:0},37157:{gl1:0,gl2:0},35373:{gl1:0,gl2:0},35657:{gl1:0,gl2:0},36183:{gl1:0,gl2:0},37137:{gl1:0,gl2:0},34045:{gl1:0,gl2:0},35978:{gl1:0,gl2:0},35979:{gl1:0,gl2:0},35968:{gl1:0,gl2:0},35376:{gl1:0,gl2:0},35375:{gl1:0,gl2:0},35659:{gl1:0,gl2:0},37154:{gl1:0,gl2:0},35371:{gl1:0,gl2:0},35658:{gl1:0,gl2:0},35076:{gl1:0,gl2:-8,negative:!0},35077:{gl1:0,gl2:7},35380:{gl1:0,gl2:0}};exports.default=l;
},{}],"JRcT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getContextInfo=s,exports.getContextLimits=n,exports.getGLContextInfo=l;var e=t(require("./webgl-limits-table")),i=require("@luma.gl/gltools");function t(e){return e&&e.__esModule?e:{default:e}}function n(t){if(t.luma=t.luma||{},!t.luma.limits){t.luma.limits={},t.luma.webgl1MinLimits={},t.luma.webgl2MinLimits={};const n=(0,i.isWebGL2)(t);for(const i in e.default){const l=e.default[i],s=l.gl1,o="gl2"in l?l.gl2:l.gl1,u=n?o:s,m="gl2"in l&&!n||"extension"in l&&!t.getExtension(l.extension)?u:t.getParameter(i);t.luma.limits[i]=m,t.luma.webgl1MinLimits[i]=s,t.luma.webgl2MinLimits[i]=o}}return t.luma.limits}function l(e){e.luma=e.luma||{};const t=(0,i.getContextDebugInfo)(e);return e.luma.info||(e.luma.info={37445:t.vendor,37446:t.renderer,7936:t.vendorMasked,7937:t.rendererMasked,7938:t.version,35724:t.shadingLanguageVersion}),e.luma.info}function s(e){return Object.assign((0,i.getContextDebugInfo)(e),{limits:n(e),info:l(e),webgl1MinLimits:e.luma.webgl1MinLimits,webgl2MinLimits:e.luma.webgl2MinLimits})}
},{"./webgl-limits-table":"IlXB","@luma.gl/gltools":"lAom"}],"UMAV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.FEATURES=void 0;var _=T(require("../classes/framebuffer")),E=T(require("../classes/texture-2d"));function T(_){return _&&_.__esModule?_:{default:_}}const L={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function R(T){const L=new E.default(T,{format:6408,type:5126,dataFormat:6408}),R=new _.default(T,{id:"test-framebuffer",check:!1,attachments:{36064:L}}),A=R.getStatus();return L.delete(),R.delete(),36053===A}exports.FEATURES=L;var A={[L.WEBGL2]:[!1,!0],[L.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[L.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[L.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[L.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[L.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[L.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[L.FLOAT_BLEND]:["EXT_float_blend"],[L.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[L.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[L.TEXTURE_FLOAT]:["OES_texture_float",!0],[L.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[L.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[L.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[L.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[L.COLOR_ATTACHMENT_RGBA32F]:[R,"EXT_color_buffer_float"],[L.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[L.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[L.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[L.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[L.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[L.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]};exports.default=A;
},{"../classes/framebuffer":"QRT8","../classes/texture-2d":"YE27"}],"qa8S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFeatures=n,exports.hasFeature=u,exports.hasFeatures=o;var e=r(require("./webgl-features-table")),t=require("@luma.gl/gltools"),a=require("../utils/assert");function r(e){return e&&e.__esModule?e:{default:e}}const s=2;function u(e,t){return o(e,t)}function o(e,t){return(t=Array.isArray(t)?t:[t]).every(t=>l(e,t))}function n(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const a in e.default)void 0===t.luma.caps[a]&&(t.luma.caps[a]=l(t,a));return t.luma.caps}function l(e,a){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},void 0===e.luma.caps[a]&&(e.luma.caps[a]=c(e,a)),e.luma.caps[a]||t.log.log(s,"Feature: ".concat(a," not supported"))(),e.luma.caps[a]}function c(r,s){const u=e.default[s];let o;(0,a.assert)(u,s);const n=(0,t.isWebGL2)(r)&&u[1]||u[0];if("function"==typeof n)o=n(r);else if(Array.isArray(n)){o=!0;for(const e of n)o=o&&Boolean(r.getExtension(e))}else"string"==typeof n?o=Boolean(r.getExtension(n)):"boolean"==typeof n?o=n:(0,a.assert)(!1);return o}
},{"./webgl-features-table":"UMAV","@luma.gl/gltools":"lAom","../utils/assert":"uPB9"}],"tGta":[function(require,module,exports) {
"use strict";function e(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t="undefined"!=typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",d=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return d||i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"CuwP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=u;var e=a(require("./check-old-ie")),t=a(require("./webgl-features-table")),r=require("../utils/assert");function a(e){return e&&e.__esModule?e:{default:e}}const n={};function u(a,u){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=t.default[u];if((0,r.assert)(i,u),!(0,e.default)(o))return!0;if(u in n)return n[u];const s=i[0],d="#extension GL_".concat(s," : enable\nvoid main(void) {}"),l=a.createShader(35633);a.shaderSource(l,d),a.compileShader(l);const c=a.getShaderParameter(l,35713);return a.deleteShader(l),n[u]=c,c}
},{"./check-old-ie":"tGta","./webgl-features-table":"UMAV","../utils/assert":"uPB9"}],"QnT2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FEATURES",{enumerable:!0,get:function(){return t.FEATURES}}),Object.defineProperty(exports,"canCompileGLGSExtension",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"getContextInfo",{enumerable:!0,get:function(){return e.getContextInfo}}),Object.defineProperty(exports,"getContextLimits",{enumerable:!0,get:function(){return e.getContextLimits}}),Object.defineProperty(exports,"getFeatures",{enumerable:!0,get:function(){return r.getFeatures}}),Object.defineProperty(exports,"getGLContextInfo",{enumerable:!0,get:function(){return e.getGLContextInfo}}),Object.defineProperty(exports,"hasFeature",{enumerable:!0,get:function(){return r.hasFeature}}),Object.defineProperty(exports,"hasFeatures",{enumerable:!0,get:function(){return r.hasFeatures}});var e=require("./limits"),t=require("./webgl-features-table"),r=require("./features"),n=u(require("./check-glsl-extension"));function u(e){return e&&e.__esModule?e:{default:e}}
},{"./limits":"JRcT","./webgl-features-table":"UMAV","./features":"qa8S","./check-glsl-extension":"CuwP"}],"QRT8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.FRAMEBUFFER_ATTACHMENT_PARAMETERS=void 0;var e=require("@luma.gl/gltools"),t=u(require("./resource")),r=u(require("./texture-2d")),a=u(require("./renderbuffer")),s=require("./clear"),i=require("./copy-and-blit.js"),n=require("../features"),l=require("../webgl-utils/constants-to-keys"),h=require("../utils/assert");function u(e){return e&&e.__esModule?e:{default:e}}const f="Multiple render targets not supported";class o extends t.default{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:a}=t;let s=!0;return r&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),a&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new o(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=(0,e.assertWebGL2Context)(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=(0,e.assertWebGL2Context)(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:t=1,height:r=1,attachments:a=null,color:s=!0,depth:i=!0,stencil:n=!1,check:l=!0,readBuffer:u,drawBuffers:f}=e;if((0,h.assert)(t>=0&&r>=0,"Width and height need to be integers"),this.width=t,this.height=r,a)for(const h in a){const e=a[h];(Array.isArray(e)?e[0]:e).resize({width:t,height:r})}else a=this._createDefaultAttachments(s,i,n,t,r);this.update({clearAttachments:!0,attachments:a,readBuffer:u,drawBuffers:f}),a&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:t={},readBuffer:r,drawBuffers:a,clearAttachments:s=!1,resizeAttachments:i=!0}=e;this.attach(t,{clearAttachments:s,resizeAttachments:i});const{gl:n}=this,l=n.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),a&&this._setDrawBuffers(a),n.bindFramebuffer(36160,l||null),this}resize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:r,height:a}=t;if(null===this.handle)return(0,h.assert)(void 0===r&&void 0===a),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===r&&(r=this.gl.drawingBufferWidth),void 0===a&&(a=this.gl.drawingBufferHeight),r!==this.width&&a!==this.height&&e.log.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(r,"x").concat(a))();for(const e in this.attachments)this.attachments[e].resize({width:r,height:a});return this.width=r,this.height=a,this}attach(e){let{clearAttachments:t=!1,resizeAttachments:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={};t&&Object.keys(this.attachments).forEach(e=>{s[e]=null}),Object.assign(s,e);const i=this.gl.bindFramebuffer(36160,this.handle);for(const n in s){(0,h.assert)(void 0!==n,"Misspelled framebuffer binding point?");const e=Number(n),t=s[e];let i=t;if(i)if(i instanceof a.default)this._attachRenderbuffer({attachment:e,renderbuffer:i});else if(Array.isArray(t)){const[r,a=0,s=0]=t;i=r,this._attachTexture({attachment:e,texture:r,layer:a,level:s})}else this._attachTexture({attachment:e,texture:i,layer:0,level:0});else this._unattach(e);r&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(e=>!this.attachments[e]).forEach(e=>{delete this.attachments[e]})}checkStatus(){const{gl:e}=this,t=this.getStatus();if(36053!==t)throw new Error(d(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),r}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t,depth:r,stencil:a,drawBuffers:i=[]}=e,n=this.gl.bindFramebuffer(36160,this.handle);return(t||r||a)&&(0,s.clear)(this.gl,{color:t,depth:r,stencil:a}),i.forEach((e,t)=>{(0,s.clearBuffer)(this.gl,{drawBuffer:t,value:e})}),this.gl.bindFramebuffer(36160,n||null),this}readPixels(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.log.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.log.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.log.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.log.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.log.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.log.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:r=[],x:a=0,y:s=0,width:i,height:n}=t;const l=(0,e.assertWebGL2Context)(this.gl),h=l.bindFramebuffer(36008,this.handle);return 0===a&&0===s&&void 0===i&&void 0===n?l.invalidateFramebuffer(36008,r):l.invalidateFramebuffer(36008,r,a,s,i,n),l.bindFramebuffer(36008,h),this}getAttachmentParameter(e,t,r){let a=this._getAttachmentParameterFallback(t);return null===a&&(this.gl.bindFramebuffer(36160,this.handle),a=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),r&&a>1e3&&(a=(0,l.getKey)(this.gl,a)),a}getAttachmentParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const a={};for(const s of r){a[t?(0,l.getKey)(this.gl,s):s]=this.getAttachmentParameter(e,s,t)}return a}getParameters(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Object.keys(this.attachments),r={};for(const a of t){const t=Number(a);r[e?(0,l.getKey)(this.gl,t):t]=this.getAttachmentParameters(t,e)}return r}show(){return"undefined"!=typeof window&&window.open((0,i.copyToDataUrl)(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>e.log.level||"undefined"==typeof window)return this;r=r||"Framebuffer ".concat(this.id);const a=(0,i.copyToDataUrl)(this,{targetMaxHeight:100});return e.log.image({logLevel:t,message:r,image:a},r)(),this}bind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,s,i,n){let l=null;return e&&((l=l||{})[36064]=new r.default(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:n,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(l[36064])),t&&s?((l=l||{})[33306]=new a.default(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(l[33306])):t?((l=l||{})[36096]=new a.default(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:n}),this.ownResources.push(l[36096])):s&&(0,h.assert)(!1),l}_unattach(e){const t=this.attachments[e];t&&(t instanceof a.default?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:t=36064,renderbuffer:r}=e;const{gl:a}=this;a.framebufferRenderbuffer(36160,t,36161,r.handle),this.attachments[t]=r}_attachTexture(t){let{attachment:r=36064,texture:a,layer:s,level:i}=t;const{gl:n}=this;switch(n.bindTexture(a.target,a.handle),a.target){case 35866:case 32879:(0,e.assertWebGL2Context)(n).framebufferTextureLayer(36160,r,a.target,i,s);break;case 34067:const t=c(s);n.framebufferTexture2D(36160,r,t,a.handle,i);break;case 3553:n.framebufferTexture2D(36160,r,3553,a.handle,i);break;default:(0,h.assert)(!1,"Illegal texture type")}n.bindTexture(a.target,null),this.attachments[r]=a}_setReadBuffer(t){const r=(0,e.getWebGL2Context)(this.gl);r?r.readBuffer(t):(0,h.assert)(36064===t||1029===t,f),this.readBuffer=t}_setDrawBuffers(t){const{gl:r}=this,a=(0,e.assertWebGL2Context)(r);if(a)a.drawBuffers(t);else{const e=r.getExtension("WEBGL_draw_buffers");e?e.drawBuffersWEBGL(t):(0,h.assert)(1===t.length&&(36064===t[0]||1029===t[0]),f)}this.drawBuffers=t}_getAttachmentParameterFallback(e){const t=(0,n.getFeatures)(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function c(e){return e<34069?e+34069:e}function d(e){return(o.STATUS||{})[e]||"Framebuffer error ".concat(e)}exports.default=o;const g=[36049,36048,33296,33298,33299,33300,33301,33302,33303];exports.FRAMEBUFFER_ATTACHMENT_PARAMETERS=g,o.ATTACHMENT_PARAMETERS=g;
},{"@luma.gl/gltools":"lAom","./resource":"DwD3","./texture-2d":"YE27","./renderbuffer":"baET","./clear":"ztYM","./copy-and-blit.js":"DmZq","../features":"QnT2","../webgl-utils/constants-to-keys":"UyRF","../utils/assert":"uPB9"}],"oR6C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cloneTextureFrom=i,exports.toFramebuffer=o;var e=u(require("../classes/texture-2d")),t=u(require("../classes/texture-cube")),r=u(require("../classes/texture-3d")),s=u(require("../classes/framebuffer")),a=require("../utils/assert");function u(e){return e&&e.__esModule?e:{default:e}}function i(s,u){(0,a.assert)(s instanceof e.default||s instanceof t.default||s instanceof r.default);const i=s.constructor,{gl:o,width:n,height:c,format:f,type:d,dataFormat:l,border:h,mipmaps:m}=s;return new i(o,Object.assign({width:n,height:c,format:f,type:d,dataFormat:l,border:h,mipmaps:m},u))}function o(e,t){const{gl:r,width:a,height:u,id:i}=e;return new s.default(r,Object.assign({},t,{id:"framebuffer-for-".concat(i),width:a,height:u,attachments:{36064:e}}))}
},{"../classes/texture-2d":"YE27","../classes/texture-cube":"eOjF","../classes/texture-3d":"mmMI","../classes/framebuffer":"QRT8","../utils/assert":"uPB9"}],"WHl0":[function(require,module,exports) {
"use strict";function e(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=e.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"OBvR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;const e=35632,t=35633;function r(r){switch(r){case e:return"fragment";case t:return"vertex";default:return"unknown type"}}
},{}],"fowk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r,exports.parseGLSLCompilerError=o;var n=e(require("./get-shader-name")),t=e(require("./get-shader-type-name"));function e(n){return n&&n.__esModule?n:{default:n}}function r(n,t,e){const{shaderName:r,errors:c,warnings:a}=o(n,t,e);return"GLSL compilation error in ".concat(r,"\n\n").concat(c,"\n").concat(a)}function o(e,r,o,i){const s=e.split(/\r?\n/),l={},u={},f=i||(0,n.default)(r)||"(unnamed)",g="".concat((0,t.default)(o)," shader ").concat(f);for(let n=0;n<s.length;n++){const t=s[n];if(t.length<=1)continue;const r=t.split(":"),o=r[0],c=parseInt(r[2],10);if(isNaN(c))throw new Error("GLSL compilation error in ".concat(g,": ").concat(e));"WARNING"!==o?l[c]=t:u[c]=t}const p=a(r);return{shaderName:g,errors:c(l,p),warnings:c(u,p)}}function c(n,t){let e="";for(let r=0;r<t.length;r++){const o=t[r];if((n[r+3]||n[r+2]||n[r+1])&&(e+="".concat(o,"\n"),n[r+1])){const t=n[r+1],o=t.split(":",3),c=o[0],a=parseInt(o[1],10)||0,s=t.substring(o.join(":").length+1).trim();e+=i("^^^ ".concat(c,": ").concat(s,"\n\n"),a)}}return e}function a(n){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const r=n.split(/\r?\n/),o=String(r.length+t-1).length;return r.map((n,r)=>{const c=String(r+t),a=c.length;return i(c,o-a)+e+n})}function i(n,t){let e="";for(let r=0;r<t;++r)e+=" ";return"".concat(e).concat(n)}
},{"./get-shader-name":"WHl0","./get-shader-type-name":"OBvR"}],"ZDha":[function(require,module,exports) {
"use strict";function e(e){let t=100;const s=e.match(/[^\s]+/g);if(s.length>=2&&"#version"===s[0]){const e=parseInt(s[1],10);Number.isFinite(e)&&(t=e)}return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"bJJz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"formatGLSLCompilerError",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"getShaderName",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"getShaderTypeName",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"getShaderVersion",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"parseGLSLCompilerError",{enumerable:!0,get:function(){return e.parseGLSLCompilerError}});var e=a(require("./format-glsl-error")),r=o(require("./get-shader-name")),t=o(require("./get-shader-version")),n=o(require("./get-shader-type-name"));function o(e){return e&&e.__esModule?e:{default:e}}function u(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(u=function(e){return e?t:r})(e)}function a(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u(r);if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var f=o?Object.getOwnPropertyDescriptor(e,a):null;f&&(f.get||f.set)?Object.defineProperty(n,a,f):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}
},{"./format-glsl-error":"fowk","./get-shader-name":"WHl0","./get-shader-version":"ZDha","./get-shader-type-name":"OBvR"}],"Mfxg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VertexShader=exports.Shader=exports.FragmentShader=void 0;var e=require("@luma.gl/gltools"),r=require("../glsl-utils"),t=require("../utils/assert"),s=require("../utils/utils"),a=n(require("./resource"));function n(e){return e&&e.__esModule?e:{default:e}}const i="Shader: GLSL source code must be a JavaScript string";class o extends a.default{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return(0,t.assert)(!1),"unknown"}}constructor(a,n){(0,e.assertWebGLContext)(a),(0,t.assert)("string"==typeof n.source,i),super(a,{id:(0,r.getShaderName)(n.source,null)||n.id||(0,s.uid)("unnamed ".concat(o.getTypeName(n.shaderType)))}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:t}=e;const a=(0,r.getShaderName)(t,null);a&&(this.id=(0,s.uid)(a)),this._compile(t)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(o.getTypeName(this.shaderType),":").concat(this.id)}getName(){return(0,r.getShaderName)(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:s,errors:a,warnings:n}=(0,r.parseGLSLCompilerError)(t,this.source,this.shaderType,this.id);throw e.log.error("GLSL compilation errors in ".concat(s,"\n").concat(a))(),e.log.warn("GLSL compilation warnings in ".concat(s,"\n").concat(n))(),new Error("GLSL compilation errors in ".concat(s))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}exports.Shader=o;class h extends o{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,r){"string"==typeof r&&(r={source:r}),super(e,Object.assign({},r,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}exports.VertexShader=h;class d extends o{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,r){"string"==typeof r&&(r={source:r}),super(e,Object.assign({},r,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}exports.FragmentShader=d;
},{"@luma.gl/gltools":"lAom","../glsl-utils":"bJJz","../utils/assert":"uPB9","../utils/utils":"OhKi","./resource":"DwD3"}],"DC0O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkUniformValues=h,exports.copyUniform=g,exports.getUniformSetter=v,exports.parseUniformName=x;var n=require("@luma.gl/gltools"),r=u(require("./framebuffer")),i=u(require("./renderbuffer")),e=u(require("./texture")),t=require("../utils/assert");function u(n){return n&&n.__esModule?n:{default:n}}const o={5126:A.bind(null,"uniform1fv",m,1,M),35664:A.bind(null,"uniform2fv",m,2,M),35665:A.bind(null,"uniform3fv",m,3,M),35666:A.bind(null,"uniform4fv",m,4,M),5124:A.bind(null,"uniform1iv",d,1,M),35667:A.bind(null,"uniform2iv",d,2,M),35668:A.bind(null,"uniform3iv",d,3,M),35669:A.bind(null,"uniform4iv",d,4,M),35670:A.bind(null,"uniform1iv",d,1,M),35671:A.bind(null,"uniform2iv",d,2,M),35672:A.bind(null,"uniform3iv",d,3,M),35673:A.bind(null,"uniform4iv",d,4,M),35674:A.bind(null,"uniformMatrix2fv",m,4,U),35675:A.bind(null,"uniformMatrix3fv",m,9,U),35676:A.bind(null,"uniformMatrix4fv",m,16,U),35678:w,35680:w,5125:A.bind(null,"uniform1uiv",b,1,M),36294:A.bind(null,"uniform2uiv",b,2,M),36295:A.bind(null,"uniform3uiv",b,3,M),36296:A.bind(null,"uniform4uiv",b,4,M),35685:A.bind(null,"uniformMatrix2x3fv",m,6,U),35686:A.bind(null,"uniformMatrix2x4fv",m,8,U),35687:A.bind(null,"uniformMatrix3x2fv",m,6,U),35688:A.bind(null,"uniformMatrix3x4fv",m,12,U),35689:A.bind(null,"uniformMatrix4x2fv",m,8,U),35690:A.bind(null,"uniformMatrix4x3fv",m,12,U),35678:w,35680:w,35679:w,35682:w,36289:w,36292:w,36293:w,36298:w,36299:w,36300:w,36303:w,36306:w,36307:w,36308:w,36311:w},l={},f={},a={},c=[0];function s(r,i,e,t){1===i&&"boolean"==typeof r&&(r=r?1:0),Number.isFinite(r)&&(c[0]=r,r=c);const u=r.length;if(u%i&&n.log.warn("Uniform size should be multiples of ".concat(i),r)(),r instanceof e)return r;let o=t[u];o||(o=new e(u),t[u]=o);for(let n=0;n<u;n++)o[n]=r[n];return o}function m(n,r){return s(n,r,Float32Array,l)}function d(n,r){return s(n,r,Int32Array,f)}function b(n,r){return s(n,r,Uint32Array,a)}function v(n,r,i){const e=o[i.type];if(!e)throw new Error("Unknown GLSL uniform type ".concat(i.type));return e().bind(null,n,r)}function x(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const r=n.match(/([^[]*)(\[[0-9]+\])?/);if(!r||r.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(n));return{name:r[1],length:r[2]||1,isArray:Boolean(r[2])}}function h(n,r,i){for(const e in n){const t=n[e];if((!i||Boolean(i[e]))&&!y(t))throw r=r?"".concat(r," "):"",console.error("".concat(r," Bad uniform ").concat(e),t),new Error("".concat(r," Bad uniform ").concat(e))}return!0}function y(n){return Array.isArray(n)||ArrayBuffer.isView(n)?p(n):!!isFinite(n)||(!0===n||!1===n||(n instanceof e.default||(n instanceof i.default||n instanceof r.default&&Boolean(n.texture))))}function g(n,r,i){if(Array.isArray(i)||ArrayBuffer.isView(i))if(n[r]){const e=n[r];for(let n=0,r=i.length;n<r;++n)e[n]=i[n]}else n[r]=i.slice();else n[r]=i}function p(n){if(0===n.length)return!1;const r=Math.min(n.length,16);for(let i=0;i<r;++i)if(!Number.isFinite(n[i]))return!1;return!0}function w(){let n=null;return(r,i,e)=>{const t=n!==e;return t&&(r.uniform1i(i,e),n=e),t}}function A(n,r,i,e){let u=null,o=null;return(l,f,a)=>{const c=r(a,i),s=c.length;let m=!1;if(null===u)u=new Float32Array(s),o=s,m=!0;else{(0,t.assert)(o===s,"Uniform length cannot change.");for(let n=0;n<s;++n)if(c[n]!==u[n]){m=!0;break}}return m&&(e(l,n,f,c),u.set(c)),m}}function M(n,r,i,e){n[r](i,e)}function U(n,r,i,e){n[r](i,!1,e)}
},{"@luma.gl/gltools":"lAom","./framebuffer":"QRT8","./renderbuffer":"baET","./texture":"GqKp","../utils/assert":"uPB9"}],"r3DH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decomposeCompositeGLType=I,exports.getCompositeGLType=J,exports.getPrimitiveCount=F,exports.getPrimitiveDrawMode=E,exports.getVertexCount=H;var e=require("../utils/assert");const t=5120,r=5121,s=5122,c=5123,n=0,a=1,u=2,o=3,i=4,v=5,m=6,x=5126,l=35664,p=35665,d=35666,f=5124,w=35667,C=35668,b=35669,g=5125,y=36294,M=36295,h=36296,P=35670,T=35671,G=35672,L=35673,_=35674,j=35675,q=35676,D=35685,O=35686,V=35687,k=35688,z=35689,A=35690,B={[x]:[x,1,"float"],35664:[x,2,"vec2"],35665:[x,3,"vec3"],35666:[x,4,"vec4"],5124:[5124,1,"int"],35667:[5124,2,"ivec2"],35668:[5124,3,"ivec3"],35669:[5124,4,"ivec4"],5125:[5125,1,"uint"],36294:[5125,2,"uvec2"],36295:[5125,3,"uvec3"],36296:[5125,4,"uvec4"],35670:[x,1,"bool"],35671:[x,2,"bvec2"],35672:[x,3,"bvec3"],35673:[x,4,"bvec4"],35674:[x,8,"mat2"],35685:[x,8,"mat2x3"],35686:[x,8,"mat2x4"],35675:[x,12,"mat3"],35687:[x,12,"mat3x2"],35688:[x,12,"mat3x4"],35676:[x,16,"mat4"],35689:[x,16,"mat4x2"],35690:[x,16,"mat4x3"]};function E(t){switch(t){case n:return n;case a:case o:case u:return a;case i:case v:case m:return i;default:return(0,e.assert)(!1),0}}function F(t){let{drawMode:r,vertexCount:s}=t;switch(r){case n:case u:return s;case a:return s/2;case o:return s-1;case i:return s/3;case v:case m:return s-2;default:return(0,e.assert)(!1),0}}function H(t){let{drawMode:r,vertexCount:s}=t;const c=F({drawMode:r,vertexCount:s});switch(E(r)){case n:return c;case a:return 2*c;case i:return 3*c;default:return(0,e.assert)(!1),0}}function I(e){const t=B[e];if(!t)return null;const[r,s]=t;return{type:r,components:s}}function J(e,n){switch(e){case t:case r:case s:case c:e=x}for(const t in B){const[r,s,c]=B[t];if(r===e&&s===n)return{glType:t,name:c}}return null}
},{"../utils/assert":"uPB9"}],"MOlP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=i(require("./accessor")),e=require("@luma.gl/gltools"),r=require("../webgl-utils/attribute-utils");function i(t){return t&&t.__esModule?t:{default:t}}class s{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,r=e.getProgramParameter(t.handle,35721);for(let i=0;i<r;i++){const{name:r,type:s,size:o}=e.getActiveAttrib(t.handle,i),n=e.getAttribLocation(t.handle,r);n>=0&&this._addAttribute(n,r,s,o)}this.attributeInfos.sort((t,e)=>t.location-e.location)}_readVaryingsFromProgram(t){const{gl:r}=t;if(!(0,e.isWebGL2)(r))return;const i=r.getProgramParameter(t.handle,35971);for(let e=0;e<i;e++){const{name:i,type:s,size:o}=r.getTransformFeedbackVarying(t.handle,e);this._addVarying(e,i,s,o)}this.varyingInfos.sort((t,e)=>t.location-e.location)}_addAttribute(e,i,s,o){const{type:n,components:a}=(0,r.decomposeCompositeGLType)(s),c={type:n,size:o*a};this._inferProperties(e,i,c);const u={location:e,name:i,accessor:new t.default(c)};this.attributeInfos.push(u),this.attributeInfosByLocation[e]=u,this.attributeInfosByName[u.name]=u}_inferProperties(t,e,r){/instance/i.test(e)&&(r.divisor=1)}_addVarying(e,i,s,o){const{type:n,components:a}=(0,r.decomposeCompositeGLType)(s),c={location:e,name:i,accessor:new t.default({type:n,size:o*a})};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}exports.default=s;
},{"./accessor":"OEzr","@luma.gl/gltools":"lAom","../webgl-utils/attribute-utils":"r3DH"}],"mrLl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=g(require("./resource")),t=g(require("./texture")),r=g(require("./framebuffer")),i=require("./uniforms"),s=require("./shader"),n=g(require("./program-configuration")),o=require("@luma.gl/gltools"),a=require("../webgl-utils/constants-to-keys"),h=require("../webgl-utils/attribute-utils"),l=require("../utils/assert"),d=require("../utils/utils");function g(e){return e&&e.__esModule?e:{default:e}}const u=4,f=35981,m=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class c extends e.default{get[Symbol.toStringTag](){return"Program"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Program","v6.0",m),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:t,vs:r,fs:i,varyings:a,bufferMode:h=f}=e;return this.hash=t||"",this.vs="string"==typeof r?new s.VertexShader(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs="string"==typeof i?new s.FragmentShader(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,(0,l.assert)(this.vs instanceof s.VertexShader),(0,l.assert)(this.fs instanceof s.FragmentShader),this.uniforms={},this._textureUniforms={},a&&a.length>0&&((0,o.assertWebGL2Context)(this.gl),this.varyings=a,this.gl2.transformFeedbackVaryings(this.handle,a,h)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new n.default(this),this.setProps(e)}delete(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:t,drawMode:r=4,vertexCount:i,offset:s=0,start:n,end:d,isIndexed:g=!1,indexType:u=5123,instanceCount:f=0,isInstanced:m=f>0,vertexArray:c=null,transformFeedback:x,framebuffer:_,parameters:P={},uniforms:v,samplers:U}=e;if((v||U)&&(o.log.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(v||{})),o.log.priority>=t){const e=_?_.id:"default",s="mode=".concat((0,a.getKey)(this.gl,r)," verts=").concat(i," ")+"instances=".concat(f," indexType=").concat((0,a.getKey)(this.gl,u)," ")+"isInstanced=".concat(m," isIndexed=").concat(g," ")+"Framebuffer=".concat(e);o.log.log(t,s)()}return(0,l.assert)(c),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||m&&0===f)&&(c.bindForDraw(i,f,()=>{if(void 0!==_&&(P=Object.assign({},P,{framebuffer:_})),x){const e=(0,h.getPrimitiveDrawMode)(r);x.begin(e)}this._bindTextures(),(0,o.withParameters)(this.gl,P,()=>{g&&m?this.gl2.drawElementsInstanced(r,i,u,s,f):g&&(0,o.isWebGL2)(this.gl)&&!isNaN(n)&&!isNaN(d)?this.gl2.drawRangeElements(r,n,d,i,u,s):g?this.gl.drawElements(r,i,u,s):m?this.gl2.drawArraysInstanced(r,s,i,f):this.gl.drawArrays(r,s,i)}),x&&x.end()}),!0)}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o.log.priority>=2&&(0,i.checkUniformValues)(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const s in e){const n=e[s],o=this._uniformSetters[s];if(o){let e=n,a=!1;if(e instanceof r.default&&(e=e.texture),e instanceof t.default)if(a=this.uniforms[s]!==n){void 0===o.textureIndex&&(o.textureIndex=this._textureIndexCounter++);const t=e,{textureIndex:r}=o;t.bind(r),e=r,this._textureUniforms[s]=t}else e=o.textureIndex;else this._textureUniforms[s]&&delete this._textureUniforms[s];(o(e)||a)&&(0,i.copyUniform)(this.uniforms,s,n)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const r=this._textureUniforms[t];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const t=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(t)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),r={};for(const i of t){switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new s.VertexShader({handle:i});break;case 35632:r.fs=new s.FragmentShader({handle:i})}}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const e=this._getName();this.id=(0,d.uid)(e)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=(e=e.replace(/shader/i,""))?"".concat(e,"-program"):"program"}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),o.log.time(u,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),o.log.timeEnd(u,"linkProgram for ".concat(this._getName()))(),e.debug||o.log.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const r=this.gl.getActiveUniform(this.handle,t),{name:s}=(0,i.parseUniformName)(r.name);let n=e.getUniformLocation(this.handle,s);if(this._uniformSetters[s]=(0,i.getUniformSetter)(e,n,r),r.size>1)for(let t=0;t<r.size;t++)n=e.getUniformLocation(this.handle,"".concat(s,"[").concat(t,"]")),this._uniformSetters["".concat(s,"[").concat(t,"]")]=(0,i.getUniformSetter)(e,n,r)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}exports.default=c;
},{"./resource":"DwD3","./texture":"GqKp","./framebuffer":"QRT8","./uniforms":"DC0O","./shader":"Mfxg","./program-configuration":"MOlP","@luma.gl/gltools":"lAom","../webgl-utils/constants-to-keys":"UyRF","../webgl-utils/attribute-utils":"r3DH","../utils/assert":"uPB9","../utils/utils":"OhKi"}],"utYa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("./resource")),t=require("../features"),i=require("@luma.gl/gltools"),r=require("../utils/assert");function s(e){return e&&e.__esModule?e:{default:e}}const l=34918,n=34919,u=35007,a=36795,h=35976,o=35887,g=36202;class d extends e.default{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const l=(0,i.isWebGL2)(e),n=(0,t.hasFeatures)(e,t.FEATURES.TIMER_QUERY);let u=l||n;for(const t of s)switch(t){case"queries":u=u&&l;break;case"timers":u=u&&n;break;default:(0,r.assert)(!1)}return u}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(u)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(e?g:o)}beginTransformFeedbackQuery(){return this.begin(h)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,n);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(a)}getResult(){return this.gl2.getQueryParameter(this.handle,l)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return d.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}exports.default=d;
},{"./resource":"DwD3","../features":"QnT2","@luma.gl/gltools":"lAom","../utils/assert":"uPB9"}],"us29":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/gltools"),t=s(require("./resource")),i=s(require("./buffer")),n=require("../utils/utils");function s(e){return e&&e.__esModule?e:{default:e}}class r extends t.default{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return(0,e.isWebGL2)(t)}constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,e.assertWebGL2Context)(t),super(t,i),this.initialize(i),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,(0,n.isObjectEmpty)(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(t,i){const n=this._getVaryingIndex(t),{buffer:s,byteSize:r,byteOffset:f}=this._getBufferParams(i);return n<0?(this.unused[t]=s,e.log.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=i,this.bindOnUse||this._bindBuffer(n,s,f,r),this)}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,n,s;return e instanceof i.default==!1?(s=e.buffer,n=e.byteSize,t=e.byteOffset):s=e,void 0===t&&void 0===n||(t=t||0,n=n||s.byteLength-t),{buffer:s,byteOffset:t,byteSize:n}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:n}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,n,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;const s=t&&t.handle;return s&&void 0!==n?this.gl.bindBufferRange(35982,e,s,i,n):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}exports.default=r;
},{"@luma.gl/gltools":"lAom","./resource":"DwD3","./buffer":"d4ii","../utils/utils":"OhKi"}],"vUP6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fillArray=n,exports.getScratchArray=r,exports.getScratchArrayBuffer=e;let t=null;function e(e){return(!t||t.byteLength<e)&&(t=new ArrayBuffer(e)),t}function r(t,r){return new t(e(t.BYTES_PER_ELEMENT*r),0,r)}function n(t){let{target:e,source:r,start:n=0,count:o=1}=t;const c=r.length,u=o*c;let f=0;for(let l=n;f<c;f++)e[l++]=r[f];for(;f<u;)f<u-f?(e.copyWithin(n+f,n,n+f),f*=2):(e.copyWithin(n+f,n,n+u-f),f=u);return e}
},{}],"R2V4":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=n(require("./resource")),e=n(require("./buffer")),r=require("@luma.gl/gltools"),s=require("../utils/array-utils-flat"),a=require("../utils/assert"),i=require("@probe.gl/env");function n(t){return t&&t.__esModule?t:{default:t}}const l="elements must be GL.ELEMENT_ARRAY_BUFFER";class u extends t.default{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||((0,r.isWebGL2)(t)||"Chrome"===(0,i.getBrowser)())}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new u(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return u.MAX_ATTRIBUTES=u.MAX_ATTRIBUTES||t.getParameter(34921),u.MAX_ATTRIBUTES}static setConstant(t,e,r){switch(r.constructor){case Float32Array:u._setConstantFloatArray(t,e,r);break;case Int32Array:u._setConstantIntArray(t,e,r);break;case Uint32Array:u._setConstantUintArray(t,e,r);break;default:(0,a.assert)(!1)}}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return u.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,a.assert)(!t||34963===t.target,l),this.bind(()=>{this.gl.bindBuffer(34963,t?t.handle:null)}),this}setBuffer(t,e,s){if(34963===e.target)return this.setElementBuffer(e,s);const{size:i,type:n,stride:l,offset:u,normalized:b,integer:o,divisor:f}=s,{gl:h,gl2:A}=this;return t=Number(t),this.bind(()=>{h.bindBuffer(34962,e.handle),o?((0,a.assert)((0,r.isWebGL2)(h)),A.vertexAttribIPointer(t,i,n,l,u)):h.vertexAttribPointer(t,i,n,b,l,u),h.enableVertexAttribArray(t),A.vertexAttribDivisor(t,f||0)}),this}enable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e&&0===t&&!u.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))),this}getConstantBuffer(t,r){const a=this._normalizeConstantArrayValue(r),i=a.byteLength*t,n=a.length*t;let l=!this.buffer;if(this.buffer=this.buffer||new e.default(this.gl,i),l=(l=l||this.buffer.reallocate(i))||!this._compareConstantArrayValues(a,this.bufferValue)){const t=(0,s.getScratchArray)(r.constructor,n);(0,s.fillArray)({target:t,source:a,start:0,count:n}),this.buffer.subData(t),this.bufferValue=r}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}static _setConstantFloatArray(t,e,r){switch(r.length){case 1:t.vertexAttrib1fv(e,r);break;case 2:t.vertexAttrib2fv(e,r);break;case 3:t.vertexAttrib3fv(e,r);break;case 4:t.vertexAttrib4fv(e,r);break;default:(0,a.assert)(!1)}}static _setConstantIntArray(t,e,s){switch((0,a.assert)((0,r.isWebGL2)(t)),s.length){case 1:t.vertexAttribI1iv(e,s);break;case 2:t.vertexAttribI2iv(e,s);break;case 3:t.vertexAttribI3iv(e,s);break;case 4:t.vertexAttribI4iv(e,s);break;default:(0,a.assert)(!1)}}static _setConstantUintArray(t,e,s){switch((0,a.assert)((0,r.isWebGL2)(t)),s.length){case 1:t.vertexAttribI1uiv(e,s);break;case 2:t.vertexAttribI2uiv(e,s);break;case 3:t.vertexAttribI3uiv(e,s);break;case 4:t.vertexAttribI4uiv(e,s);break;default:(0,a.assert)(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:r}=e;return(0,a.assert)(Number.isFinite(r)),this.bind(()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(r,t);default:return this.gl.getVertexAttrib(r,t)}})}}exports.default=u;
},{"./resource":"DwD3","./buffer":"d4ii","@luma.gl/gltools":"lAom","../utils/array-utils-flat":"vUP6","../utils/assert":"uPB9","@probe.gl/env":"Ps6r"}],"uoYk":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@luma.gl/gltools"),e=a(require("./accessor")),s=a(require("./buffer")),r=a(require("./vertex-array-object")),i=require("../utils/assert"),n=require("../utils/stub-methods");function a(t){return t&&t.__esModule?t:{default:t}}const o="VertexArray: attributes must be Buffers or constants (i.e. typed array)",u=/^(.+)__LOCATION_([0-9]+)$/,l=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class c{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=e.id||e.program&&e.program.id;this.id=s,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new r.default(t),(0,n.stubRemovedMethods)(this,"VertexArray","v6.0",l),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind(()=>{for(const e in t){const s=t[e];this._setAttribute(e,s)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,s);const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,e.accessor,s);return r>=0&&(this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,e,i)),this}setConstant(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},s));return r>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new s.default(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof s.default&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof s.default&&this.setBuffer(t,e)}}),this}bindForDraw(t,e,s){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(t,e),r=s()}),r}_resolveLocationAndAccessor(s,r,n,a){const o={location:-1,accessor:null},{location:u,name:l}=this._getAttributeIndex(s);if(!Number.isFinite(u)||u<0)return this.unused[s]=r,t.log.once(3,()=>"unused value ".concat(s," in ").concat(this.id))(),o;const c=this._getAttributeInfo(l||u);if(!c)return o;const h=this.accessors[u]||{},f=e.default.resolve(c.accessor,h,n,a),{size:d,type:b}=f;return(0,i.assert)(Number.isFinite(d)&&Number.isFinite(b)),{location:u,accessor:f}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const s=u.exec(t),r=s?s[1]:t,i=s?Number(s[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(t,e){if(e instanceof s.default)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof s.default){const s=e[0],r=e[1];this.setBuffer(t,s,r)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const s=e;this.setConstant(t,s)}else{if(!(e.buffer instanceof s.default))throw new Error(o);{const s=e;this.setBuffer(t,s.buffer,s)}}}_setConstantAttributes(t,e){const s=Math.max(0|t,0|e);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,s);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}_setConstantAttributeZero(t,e){if(r.default.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const s=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,s,this.accessors[0])}_setConstantAttribute(t,e){r.default.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const r=this.values[e],i=this.accessors[e];if(!r)return;const{divisor:n}=i,a=n>0;if(t.isInstanced=t.isInstanced||a,r instanceof s.default){const e=r;if(a){const s=e.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,s)}else{const s=e.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,s)}}}setElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.log.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,s)}}exports.default=c;
},{"@luma.gl/gltools":"lAom","./accessor":"OEzr","./buffer":"d4ii","./vertex-array-object":"R2V4","../utils/assert":"uPB9","../utils/stub-methods":"EgC4"}],"ZKrJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("../webgl-utils/attribute-utils"),s=require("../utils/assert");const e="UniformBufferLayout illegal argument",i=5126,r=5124,a=5125;class o{constructor(t){this.layout={},this.size=0;for(const e in t)this._addUniform(e,t[e]);this.size+=(4-this.size%4)%4;const s=new Float32Array(this.size);this.typedArray={[i]:s,[r]:new Int32Array(s.buffer),[a]:new Uint32Array(s.buffer)}}getBytes(){return 4*this.size}getData(){return this.typedArray[i]}getSubData(t){let s,e;if(void 0===t)s=this.data,e=0;else{const i=this.offsets[t],r=i+this.sizes[t];s=this.data.subarray(i,r),e=4*i}return{data:s,offset:e}}setUniforms(t){for(const s in t)this._setValue(s,t[s]);return this}_setValue(t,e){const i=this.layout[t];(0,s.assert)(i,"UniformLayoutStd140 illegal argument");const r=this.typedArray[i.type];1===i.size?r[i.offset]=e:r.set(e,i.offset)}_addUniform(i,r){const a=(0,t.decomposeCompositeGLType)(r);(0,s.assert)(a,e);const{type:o,components:n}=a;this.size=this._alignTo(this.size,n);const u=this.size;this.size+=n,this.layout[i]={type:o,size:n,offset:u}}_alignTo(t,s){switch(s){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}}exports.default=o;
},{"../webgl-utils/attribute-utils":"r3DH","../utils/assert":"uPB9"}],"Ijwg":[function(require,module,exports) {
"use strict";function t(t,r){const{maxElts:n=16,size:i=1}=r;let o="[";for(let a=0;a<t.length&&a<n;++a)a>0&&(o+=",".concat(a%i==0?" ":"")),o+=e(t[a],r);const s=t.length>n?"...":"]";return"".concat(o).concat(s)}function e(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=r;if(Array.isArray(e)||ArrayBuffer.isView(e))return t(e,r);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return n?"0":"0.";if(n)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);const i=e.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatValue=e;
},{}],"VDWA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDebugTableForUniforms=r;var e=require("../utils/assert"),n=require("../utils/format-value");function r(r){let{header:o="Uniforms",program:u,uniforms:a,undefinedOnly:f=!1}=r;(0,e.assert)(u);const i=u._uniformSetters,s={},l=Object.keys(i).sort();let m=0;for(const e of l)e.match(".*_.*")||e.match(".*Matrix")||t({table:s,header:o,uniforms:a,uniformName:e,undefinedOnly:f})&&m++;for(const e of l)e.match(".*Matrix")&&t({table:s,header:o,uniforms:a,uniformName:e,undefinedOnly:f})&&m++;for(const e of l)s[e]||t({table:s,header:o,uniforms:a,uniformName:e,undefinedOnly:f})&&m++;let c=0;const d={};if(!f)for(const e in a){const r=a[e];s[e]||(c++,d[e]={Type:"NOT USED: ".concat(r),[o]:(0,n.formatValue)(r)})}return{table:s,count:m,unusedTable:d,unusedCount:c}}function t(e){let{table:r,header:t,uniforms:u,uniformName:a,undefinedOnly:f}=e;const i=u[a],s=o(i);return(!f||!s)&&(r[a]={[t]:s?(0,n.formatValue)(i):"N/A","Uniform Type":s?i:"NOT PROVIDED"},!0)}function o(e){return null!=e}
},{"../utils/assert":"uPB9","../utils/format-value":"Ijwg"}],"TDxR":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDebugTableForVertexArray=o;var t=r(require("../classes/buffer")),e=require("../webgl-utils/constants-to-keys"),n=require("../webgl-utils/attribute-utils"),c=require("../utils/format-value");function r(t){return t&&t.__esModule?t:{default:t}}function o(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const c={};e.elements&&(c.ELEMENT_ARRAY_BUFFER=a(e,e.elements,null,n));const r=e.values;for(const o in r){const t=e._getAttributeInfo(o);if(t){let i="".concat(o,": ").concat(t.name);const u=e.accessors[t.location];u&&(i="".concat(o,": ").concat(s(t.name,u))),c[i]=a(e,r[o],u,n)}}return c}function a(n,r,o,a){const{gl:s}=n;if(!r)return{[a]:"null","Format ":"N/A"};let i,u,l,f="NOT PROVIDED",g=1,b=0,m=0;if(o&&(f=o.type,g=o.size,i=-1!==(f=String(f).replace("Array","")).indexOf("nt")),r instanceof t.default){const t=r,{data:n,changed:y}=t.getDebugData();let d;if(u=y?"*":"",l=n,b=(m=t.byteLength)/n.BYTES_PER_ELEMENT/g,o){const t=o.divisor>0;d="".concat(t?"I ":"P "," ").concat(b," (x").concat(g,"=").concat(m," bytes ").concat((0,e.getKey)(s,f),")")}else i=!0,d="".concat(m," bytes");return{[a]:"".concat(u).concat((0,c.formatValue)(l,{size:g,isInteger:i})),"Format ":d}}return l=r,g=r.length,i=-1!==(f=String(r.constructor.name).replace("Array","")).indexOf("nt"),{[a]:"".concat((0,c.formatValue)(l,{size:g,isInteger:i})," (constant)"),"Format ":"".concat(g,"x").concat(f," (constant)")}}function s(t,e){const{type:c,size:r}=e,o=(0,n.getCompositeGLType)(c,r);return o?"".concat(t," (").concat(o.name,")"):t}
},{"../classes/buffer":"d4ii","../webgl-utils/constants-to-keys":"UyRF","../webgl-utils/attribute-utils":"r3DH","../utils/format-value":"Ijwg"}],"jWha":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDebugTableForProgramConfiguration=o;var t=require("../webgl-utils/attribute-utils");function o(t){const o={},n="Accessors for ".concat(t.id);for(const c of t.attributeInfos)if(c){const t=e(c);o["in ".concat(t)]={[n]:JSON.stringify(c.accessor)}}for(const c of t.varyingInfos)if(c){const t=e(c);o["out ".concat(t)]={[n]:JSON.stringify(c.accessor)}}return o}function e(o){const{type:e,size:n}=o.accessor,c=(0,t.getCompositeGLType)(e,n);return c?"".concat(c.name," ").concat(o.name):o.name}
},{"../webgl-utils/attribute-utils":"r3DH"}],"KdJH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Accessor",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(exports,"Buffer",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"FEATURES",{enumerable:!0,get:function(){return o.FEATURES}}),Object.defineProperty(exports,"FragmentShader",{enumerable:!0,get:function(){return c.FragmentShader}}),Object.defineProperty(exports,"Framebuffer",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(exports,"Program",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(exports,"Query",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(exports,"Renderbuffer",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(exports,"Shader",{enumerable:!0,get:function(){return c.Shader}}),Object.defineProperty(exports,"Texture2D",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(exports,"Texture3D",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(exports,"TextureCube",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(exports,"TransformFeedback",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(exports,"UniformBufferLayout",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(exports,"VertexArray",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(exports,"VertexArrayObject",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(exports,"VertexShader",{enumerable:!0,get:function(){return c.VertexShader}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return U.assert}}),Object.defineProperty(exports,"blit",{enumerable:!0,get:function(){return x.blit}}),Object.defineProperty(exports,"canCompileGLGSExtension",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"cancelAnimationFrame",{enumerable:!0,get:function(){return r.cancelAnimationFrame}}),Object.defineProperty(exports,"clear",{enumerable:!0,get:function(){return m.clear}}),Object.defineProperty(exports,"clearBuffer",{enumerable:!0,get:function(){return m.clearBuffer}}),Object.defineProperty(exports,"cloneTextureFrom",{enumerable:!0,get:function(){return t.cloneTextureFrom}}),Object.defineProperty(exports,"copyToDataUrl",{enumerable:!0,get:function(){return x.copyToDataUrl}}),Object.defineProperty(exports,"copyToImage",{enumerable:!0,get:function(){return x.copyToImage}}),Object.defineProperty(exports,"copyToTexture",{enumerable:!0,get:function(){return x.copyToTexture}}),Object.defineProperty(exports,"getContextInfo",{enumerable:!0,get:function(){return u.getContextInfo}}),Object.defineProperty(exports,"getContextLimits",{enumerable:!0,get:function(){return u.getContextLimits}}),Object.defineProperty(exports,"getDebugTableForProgramConfiguration",{enumerable:!0,get:function(){return E.getDebugTableForProgramConfiguration}}),Object.defineProperty(exports,"getDebugTableForUniforms",{enumerable:!0,get:function(){return V.getDebugTableForUniforms}}),Object.defineProperty(exports,"getDebugTableForVertexArray",{enumerable:!0,get:function(){return I.getDebugTableForVertexArray}}),Object.defineProperty(exports,"getFeatures",{enumerable:!0,get:function(){return a.getFeatures}}),Object.defineProperty(exports,"getGLContextInfo",{enumerable:!0,get:function(){return u.getGLContextInfo}}),Object.defineProperty(exports,"getKey",{enumerable:!0,get:function(){return n.getKey}}),Object.defineProperty(exports,"getKeyValue",{enumerable:!0,get:function(){return n.getKeyValue}}),Object.defineProperty(exports,"getShaderName",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(exports,"getShaderVersion",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(exports,"getUniformSetter",{enumerable:!0,get:function(){return D.getUniformSetter}}),Object.defineProperty(exports,"hasFeature",{enumerable:!0,get:function(){return a.hasFeature}}),Object.defineProperty(exports,"hasFeatures",{enumerable:!0,get:function(){return a.hasFeatures}}),Object.defineProperty(exports,"isObjectEmpty",{enumerable:!0,get:function(){return C.isObjectEmpty}}),Object.defineProperty(exports,"loadFile",{enumerable:!0,get:function(){return T.loadFile}}),Object.defineProperty(exports,"loadImage",{enumerable:!0,get:function(){return T.loadImage}}),Object.defineProperty(exports,"log",{enumerable:!0,get:function(){return A.log}}),Object.defineProperty(exports,"lumaStats",{enumerable:!0,get:function(){return e.lumaStats}}),Object.defineProperty(exports,"parseUniformName",{enumerable:!0,get:function(){return D.parseUniformName}}),Object.defineProperty(exports,"readPixelsToArray",{enumerable:!0,get:function(){return x.readPixelsToArray}}),Object.defineProperty(exports,"readPixelsToBuffer",{enumerable:!0,get:function(){return x.readPixelsToBuffer}}),Object.defineProperty(exports,"requestAnimationFrame",{enumerable:!0,get:function(){return r.requestAnimationFrame}}),Object.defineProperty(exports,"setPathPrefix",{enumerable:!0,get:function(){return T.setPathPrefix}}),Object.defineProperty(exports,"uid",{enumerable:!0,get:function(){return C.uid}});var e=require("./init"),r=require("./webgl-utils/request-animation-frame"),t=require("./webgl-utils/texture-utils"),n=require("./webgl-utils/constants-to-keys"),u=require("./features/limits"),o=require("./features/webgl-features-table"),a=require("./features/features"),i=v(require("./features/check-glsl-extension")),s=v(require("./classes/accessor")),f=v(require("./classes/buffer")),c=require("./classes/shader"),l=v(require("./classes/program")),b=v(require("./classes/framebuffer")),p=v(require("./classes/renderbuffer")),g=v(require("./classes/texture-2d")),d=v(require("./classes/texture-cube")),m=require("./classes/clear"),x=require("./classes/copy-and-blit"),y=v(require("./classes/query")),P=v(require("./classes/texture-3d")),j=v(require("./classes/transform-feedback")),O=v(require("./classes/vertex-array-object")),q=v(require("./classes/vertex-array")),F=v(require("./classes/uniform-buffer-layout")),T=require("./utils/load-file"),h=v(require("./glsl-utils/get-shader-name")),S=v(require("./glsl-utils/get-shader-version")),A=require("@luma.gl/gltools"),U=require("./utils/assert"),C=require("./utils/utils"),D=require("./classes/uniforms"),V=require("./debug/debug-uniforms"),I=require("./debug/debug-vertex-array"),E=require("./debug/debug-program-configuration");function v(e){return e&&e.__esModule?e:{default:e}}
},{"./init":"HGnm","./webgl-utils/request-animation-frame":"AGkC","./webgl-utils/texture-utils":"oR6C","./webgl-utils/constants-to-keys":"UyRF","./features/limits":"JRcT","./features/webgl-features-table":"UMAV","./features/features":"qa8S","./features/check-glsl-extension":"CuwP","./classes/accessor":"OEzr","./classes/buffer":"d4ii","./classes/shader":"Mfxg","./classes/program":"mrLl","./classes/framebuffer":"QRT8","./classes/renderbuffer":"baET","./classes/texture-2d":"YE27","./classes/texture-cube":"eOjF","./classes/clear":"ztYM","./classes/copy-and-blit":"DmZq","./classes/query":"utYa","./classes/texture-3d":"mmMI","./classes/transform-feedback":"us29","./classes/vertex-array-object":"R2V4","./classes/vertex-array":"uoYk","./classes/uniform-buffer-layout":"ZKrJ","./utils/load-file":"QQ37","./glsl-utils/get-shader-name":"WHl0","./glsl-utils/get-shader-version":"ZDha","@luma.gl/gltools":"lAom","./utils/assert":"uPB9","./utils/utils":"OhKi","./classes/uniforms":"DC0O","./debug/debug-uniforms":"VDWA","./debug/debug-vertex-array":"TDxR","./debug/debug-program-configuration":"jWha"}],"HQLj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/gltools"),i=require("@luma.gl/webgl"),t=require("@probe.gl/env");const s=(0,t.isBrowser)()&&"undefined"!=typeof document;let n=0;class a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:s=(i=>(0,e.createGLContext)(i)),onAddHTML:a=null,onInitialize:r=(()=>{}),onRender:o=(()=>{}),onFinalize:h=(()=>{}),onError:l,gl:m=null,glOptions:u={},debug:d=!1,createFramebuffer:p=!1,autoResizeViewport:c=!0,autoResizeDrawingBuffer:g=!0,stats:_=i.lumaStats.get("animation-loop-".concat(n++))}=t;let{useDevicePixels:f=!0}=t;"useDevicePixelRatio"in t&&(i.log.deprecated("useDevicePixelRatio","useDevicePixels")(),f=t.useDevicePixelRatio),this.props={onCreateContext:s,onAddHTML:a,onInitialize:r,onRender:o,onFinalize:h,onError:l,gl:m,glOptions:u,debug:d,createFramebuffer:p},this.gl=m,this.needsRedraw=null,this.timeline=null,this.stats=_,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:c,autoResizeDrawingBuffer:g,useDevicePixels:f}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return(0,i.assert)("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=i.Query.isSupported(this.gl,["timers"])?new i.Query(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(e=>{this._running&&(this._addCallbackData(e||{}),!1!==e&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const t=document.getElementById(e);return t?Number(t.value):i}setViewParameters(){return i.log.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=s?new Promise((e,i)=>{s&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):(0,i.cancelAnimationFrame)(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):(0,i.requestAnimationFrame)(e)}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:i,aspect:t}=this._getSizeAndAspect();e===this.animationProps.width&&i===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),t!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=i,this.animationProps.aspect=t,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(i){if(this.offScreen=i.canvas&&"undefined"!=typeof OffscreenCanvas&&i.canvas instanceof OffscreenCanvas,i=Object.assign({},i,this.props.glOptions),this.gl=this.props.gl?(0,e.instrumentGLContext)(this.props.gl,i):this.onCreateContext(i),!(0,e.isWebGL)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(0,e.resetParameters)(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const i=document.createElement("div");i.style.position="absolute",i.style.left="10px",i.style.bottom="10px",i.style.width="300px",i.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(i);const t=this.props.onAddHTML(i);t&&(i.innerHTML=t)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,i=this.gl.drawingBufferHeight;let t=1;const{canvas:s}=this.gl;return s&&s.clientHeight?t=s.clientWidth/s.clientHeight:e>0&&i>0&&(t=e/i),{width:e,height:i,aspect:t}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&(0,e.resizeGLContext)(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new i.Framebuffer(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}exports.default=a;
},{"@luma.gl/gltools":"lAom","@luma.gl/webgl":"KdJH","@probe.gl/env":"Ps6r"}],"A8gs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERTEX_SHADER=exports.FRAGMENT_SHADER=void 0;const s="vs";exports.VERTEX_SHADER="vs";const e="fs";exports.FRAGMENT_SHADER="fs";
},{}],"fG4k":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)throw new Error(r||"shadertools: assertion failed.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"JUP5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return e.default}});var e=r(require("./assert"));function r(e){return e&&e.__esModule?e:{default:e}}
},{"./assert":"fG4k"}],"p0tA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parsePropTypes=r;const e={number:{validate:(e,r)=>Number.isFinite(e)&&(!("max"in r)||e<=r.max)&&(!("min"in r)||e>=r.min)},array:{validate:(e,r)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function r(e){const r={};for(const n in e){const a=t(e[n]);r[n]=a}return r}function t(r){let t=n(r);return"object"===t?r?"type"in r?Object.assign({},r,e[r.type]):"value"in r?(t=n(r.value),Object.assign({type:t},r,e[t])):{type:"object",value:r}:{type:"object",value:null}:Object.assign({type:t,value:r},e[t])}function n(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}
},{}],"X8lP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.normalizeShaderModule=r;var e=require("../utils"),t=require("./filters/prop-types");const s="vs",n="fs";class i{constructor(s){let{name:n,vs:i,fs:r,dependencies:a=[],uniforms:c,getUniforms:f,deprecations:d=[],defines:u={},inject:l={},vertexShader:p,fragmentShader:h}=s;(0,e.assert)("string"==typeof n),this.name=n,this.vs=i||p,this.fs=r||h,this.getModuleUniforms=f,this.dependencies=a,this.deprecations=this._parseDeprecationDefinitions(d),this.defines=u,this.injections=o(l),c&&(this.uniforms=(0,t.parsePropTypes)(c))}getModuleSource(t){let i;switch(t){case s:i=this.vs||"";break;case n:i=this.fs||"";break;default:(0,e.assert)(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(i,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(s=>{s.regex.test(e)&&(s.deprecated?t.deprecated(s.old,s.new)():t.removed(s.old,s.new)())})}_parseDeprecationDefinitions(e){return e.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp("\\b".concat(e.old,"\\("));break;default:e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}}),e}_defaultGetUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s={},n=this.uniforms;for(const i in n){const r=n[i];i in t&&!r.private?(r.validate&&(0,e.assert)(r.validate(t[i],r),"".concat(this.name,": invalid ").concat(i)),s[i]=t[i]):s[i]=r.value}return s}}function r(e){if(!e.normalized&&(e.normalized=!0,e.uniforms&&!e.getUniforms)){const t=new i(e);e.getUniforms=t.getUniforms.bind(t)}return e}function o(e){const t={vs:{},fs:{}};for(const s in e){let n=e[s];const i=s.slice(0,2);"string"==typeof n&&(n={order:0,injection:n}),t[i][s]=n}return t}exports.default=i;
},{"../utils":"JUP5","./filters/prop-types":"p0tA"}],"vIC4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TEST_EXPORTS=void 0,exports.resolveModules=d;var e=o(require("./shader-module")),n=require("../utils");function o(e){return e&&e.__esModule?e:{default:e}}function d(e){return t(s(e))}function t(e){const n={},o={};return r({modules:e,level:0,moduleMap:n,moduleDepth:o}),Object.keys(o).sort((e,n)=>o[n]-o[e]).map(e=>n[e])}function r(e){let{modules:n,level:o,moduleMap:d,moduleDepth:t}=e;if(o>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)d[r.name]=r,(void 0===t[r.name]||t[r.name]<o)&&(t[r.name]=o);for(const s of n)s.dependencies&&r({modules:s.dependencies,level:o+1,moduleMap:d,moduleDepth:t})}function s(o,d){return o.map(o=>o instanceof e.default?o:((0,n.assert)("string"!=typeof o,"Shader module use by name is deprecated. Import shader module '".concat(o,"' and use it directly.")),(0,n.assert)(o.name,"shader module has no name"),(o=new e.default(o)).dependencies=s(o.dependencies),o))}const u={getShaderDependencies:t,getDependencyGraph:r};exports.TEST_EXPORTS=u;
},{"./shader-module":"X8lP","../utils":"JUP5"}],"w4sN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FEATURES=void 0,exports.canCompileGLGSExtension=f,exports.getContextInfo=u,exports.hasFeatures=h;var e=r(require("./is-old-ie")),t=r(require("./assert"));function r(e){return e&&e.__esModule?e:{default:e}}const n=7936,o=7937,a=7938,i=35724,s={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},c={};function d(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function u(e){const t=e.getExtension("WEBGL_debug_renderer_info"),r=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||n),s=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||o);return{gpuVendor:E(r,s),vendor:r,renderer:s,version:e.getParameter(a),shadingLanguageVersion:e.getParameter(i)}}function E(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}exports.FEATURES=c,Object.keys(s).forEach(e=>{c[e]=e});const _={};function f(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=s[n];if((0,t.default)(a,n),!(0,e.default)(o))return!0;if(n in _)return _[n];const i=a[0],c=o.behavior||"enable",d="#extension GL_".concat(i," : ").concat(c,"\nvoid main(void) {}"),u=r.createShader(35633);r.shaderSource(u,d),r.compileShader(u);const E=r.getShaderParameter(u,35713);return r.deleteShader(u),_[n]=E,E}function L(e,r){const n=s[r];(0,t.default)(n,r);const o=d(e)&&n[1]||n[0],a="string"==typeof o?Boolean(e.getExtension(o)):o;return(0,t.default)(!1===a||!0===a),a}function h(e,t){return(t=Array.isArray(t)?t:[t]).every(t=>L(e,t))}
},{"./is-old-ie":"tGta","./assert":"fG4k"}],"iiHz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getPlatformShaderDefines=n,exports.getVersionDefines=_;var e=require("../utils/webgl-info");function n(n){switch((0,e.getContextInfo)(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}function _(n,_,i){let a="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return(0,e.hasFeatures)(n,e.FEATURES.GLSL_FRAG_DEPTH)&&(a+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),(0,e.hasFeatures)(n,e.FEATURES.GLSL_DERIVATIVES)&&(0,e.canCompileGLGSExtension)(n,e.FEATURES.GLSL_DERIVATIVES)&&(a+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),(0,e.hasFeatures)(n,e.FEATURES.GLSL_FRAG_DATA)&&(0,e.canCompileGLGSExtension)(n,e.FEATURES.GLSL_FRAG_DATA,{behavior:"require"})&&(a+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),(0,e.hasFeatures)(n,e.FEATURES.GLSL_TEXTURE_LOD)&&(a+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),a}
},{"../utils/webgl-info":"w4sN"}],"qukd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MODULE_INJECTORS_VS=exports.MODULE_INJECTORS_FS=void 0;const o="#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n";exports.MODULE_INJECTORS_VS=o;const r="#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n";exports.MODULE_INJECTORS_FS=r;
},{}],"VTdi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DECLARATION_INJECT_MARKER=void 0,exports.combineInjects=l,exports.default=i;var e=require("../modules/module-injectors"),r=require("./constants"),t=require("../utils");const n={[r.VERTEX_SHADER]:e.MODULE_INJECTORS_VS,[r.FRAGMENT_SHADER]:e.MODULE_INJECTORS_FS},s="__LUMA_INJECT_DECLARATIONS__";exports.DECLARATION_INJECT_MARKER=s;const c=/void\s+main\s*\([^)]*\)\s*\{\n?/,a=/}\n?[^{}]*$/,o=[];function i(e,t,i){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const E=t===r.VERTEX_SHADER;for(const r in i){const t=i[r];t.sort((e,r)=>e.order-r.order),o.length=t.length;for(let e=0,r=t.length;e<r;++e)o[e]=t[e].injection;const n="".concat(o.join("\n"),"\n");switch(r){case"vs:#decl":E&&(e=e.replace(s,n));break;case"vs:#main-start":E&&(e=e.replace(c,e=>e+n));break;case"vs:#main-end":E&&(e=e.replace(a,e=>n+e));break;case"fs:#decl":E||(e=e.replace(s,n));break;case"fs:#main-start":E||(e=e.replace(c,e=>e+n));break;case"fs:#main-end":E||(e=e.replace(a,e=>n+e));break;default:e=e.replace(r,e=>e+n)}}return e=e.replace(s,""),l&&(e=e.replace(/\}\s*$/,e=>e+n[t])),e}function l(e){const r={};return(0,t.assert)(Array.isArray(e)&&e.length>1),e.forEach(e=>{for(const t in e)r[t]=r[t]?"".concat(r[t],"\n").concat(e[t]):e[t]}),r}
},{"../modules/module-injectors":"qukd","./constants":"A8gs","../utils":"JUP5"}],"hdw8":[function(require,module,exports) {
"use strict";function e(e){return new RegExp("\\b".concat(e,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=g;const t=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],n=[...t,[e("attribute"),"in $1"],[e("varying"),"out $1"]],r=[...t,[e("varying"),"in $1"]],o=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],c=[...o,[e("in"),"attribute $1"],[e("out"),"varying $1"]],u=[...o,[e("in"),"varying $1"]],a="gl_FragColor",i=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,s=/void\s+main\s*\([^)]*\)\s*\{\n?/;function g(e,t,r){switch(t){case 300:return r?b(e,n):x(e);case 100:return r?b(e,c):l(e);default:throw new Error("unknown GLSL version ".concat(t))}}function b(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}function x(e){const t=(e=b(e,r)).match(i);if(t){const n=t[1];e=e.replace(new RegExp("\\b".concat(a,"\\b"),"g"),n)}else{const t="fragmentColor";e=e.replace(s,e=>"out vec4 ".concat(t,";\n").concat(e)).replace(new RegExp("\\b".concat(a,"\\b"),"g"),t)}return e}function l(e){const t=(e=b(e,u)).match(i);if(t){const n=t[1];e=e.replace(i,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),a)}return e}
},{}],"aMxS":[function(require,module,exports) {
var define;
var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.assembleShaders=d;var n=require("./constants"),t=require("./resolve-modules"),o=require("./platform-defines"),r=f(require("./inject-shader")),c=i(require("./transpile-shader")),s=require("../utils");function i(e){return e&&e.__esModule?e:{default:e}}function a(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(a=function(e){return e?t:n})(e)}function f(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a(n);if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var s=r?Object.getOwnPropertyDescriptor(e,c):null;s&&(s.get||s.set)?Object.defineProperty(o,c,s):o[c]=e[c]}return o.default=e,t&&t.set(e,o),o}const u="\n\n".concat(r.DECLARATION_INJECT_MARKER,"\n\n"),l={[n.VERTEX_SHADER]:"vertex",[n.FRAGMENT_SHADER]:"fragment"},p="precision highp float;\n\n";function d(e,o){const{vs:r,fs:c}=o,s=(0,t.resolveModules)(o.modules||[]);return{gl:e,vs:g(e,Object.assign({},o,{source:r,type:n.VERTEX_SHADER,modules:s})),fs:g(e,Object.assign({},o,{source:c,type:n.FRAGMENT_SHADER,modules:s})),getUniforms:E(s)}}function g(e,t){let{id:i,source:a,type:f,modules:l,defines:d={},hookFunctions:g=[],inject:E={},transpileToGLSL100:_=!1,prologue:A=!0,log:b}=t;(0,s.assert)("string"==typeof a,"shader source must be a string");const m=f===n.VERTEX_SHADER,D=a.split("\n");let R=100,M="",S=a;0===D[0].indexOf("#version ")?(R=300,M=D[0],S=D.slice(1).join("\n")):M="#version ".concat(R);const P={};l.forEach(e=>{Object.assign(P,e.getDefines())}),Object.assign(P,d);let T=A?"".concat(M,"\n").concat(y({id:i,source:a,type:f}),"\n").concat(h({type:f}),"\n").concat((0,o.getPlatformShaderDefines)(e),"\n").concat((0,o.getVersionDefines)(e,R,!m),"\n").concat(v(P),"\n").concat(m?"":p,"\n"):"".concat(M,"\n");const N=O(g),H={},w={},k={};for(const n in E){const e="string"==typeof E[n]?{injection:E[n],order:0}:E[n],t=n.match(/^(v|f)s:(#)?([\w-]+)$/);if(t){const o=t[2],r=t[3];o?"decl"===r?w[n]=[e]:k[n]=[e]:H[n]=[e]}else k[n]=[e]}for(const n of l){b&&n.checkDeprecations(S,b),T+=n.getModuleSource(f,R);const e=n.injections[f];for(const n in e){const t=n.match(/^(v|f)s:#([\w-]+)$/);if(t){const o="decl"===t[2]?w:k;o[n]=o[n]||[],o[n].push(e[n])}else H[n]=H[n]||[],H[n].push(e[n])}}return T+=u,T=(0,r.default)(T,f,w),T+=j(N[f],H),T+=S,T=(0,r.default)(T,f,k),T=(0,c.default)(T,_?100:R,m)}function E(e){return function(n){const t={};for(const o of e){const e=o.getUniforms(n,t);Object.assign(t,e)}return t}}function h(e){let{type:n}=e;return"\n#define SHADER_TYPE_".concat(l[n].toUpperCase(),"\n")}function y(e){let{id:n,source:t,type:o}=e;return n&&"string"==typeof n&&-1===t.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(n,"_").concat(l[o],"\n\n"):""}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=0,t="";for(const o in e){0===n&&(t+="\n// APPLICATION DEFINES\n"),n++;const r=e[o];(r||Number.isFinite(r))&&(t+="#define ".concat(o.toUpperCase()," ").concat(e[o],"\n"))}return 0===n&&(t+="\n"),t}function j(e,n){let t="";for(const o in e){const r=e[o];if(t+="void ".concat(r.signature," {\n"),r.header&&(t+="  ".concat(r.header)),n[o]){const e=n[o];e.sort((e,n)=>e.order-n.order);for(const n of e)t+="  ".concat(n.injection,"\n")}r.footer&&(t+="  ".concat(r.footer)),t+="}\n"}return t}function O(e){const n={vs:{},fs:{}};return e.forEach(e=>{let t;"string"!=typeof e?e=(t=e).hook:t={},e=e.trim();const[o,r]=e.split(":"),c=e.replace(/\(.+/,"");n[o][c]=Object.assign(t,{signature:r})}),n}
},{"./constants":"A8gs","./resolve-modules":"vIC4","./platform-defines":"iiHz","./inject-shader":"VTdi","./transpile-shader":"hdw8","../utils":"JUP5"}],"uzoD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertToVec4=u,exports.getPassthroughFS=o,exports.getQualifierDetails=r,exports.typeToChannelCount=s,exports.typeToChannelSuffix=a;var e=require("../utils");const t="void main() {gl_FragColor = vec4(0);}",n="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",c="#version 300 es\n".concat(n);function r(e,t){t=Array.isArray(t)?t:[t];const n=e.replace(/^\s+/,"").split(/\s+/),[c,r,o]=n;return t.includes(c)&&r&&o?{qualifier:c,type:r,name:o.split(";")[0]}:null}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:r=100,input:o,inputType:a,output:s}=e;if(!o)return 300===r?c:r>300?"#version ".concat(r,"\n").concat(n):t;const i=u(o,a);return r>=300?"#version ".concat(r," ").concat(300===r?"es":"","\nin ").concat(a," ").concat(o,";\nout vec4 ").concat(s,";\nvoid main() {\n  ").concat(s," = ").concat(i,";\n}"):"varying ".concat(a," ").concat(o,";\nvoid main() {\n  gl_FragColor = ").concat(i,";\n}")}function a(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return(0,e.assert)(!1),null}}function s(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return(0,e.assert)(!1),null}}function u(t,n){switch(n){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return(0,e.assert)(!1),null}}
},{"../utils":"JUP5"}],"LZIL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.random=void 0;const e="float random(vec3 scale, float seed) {\n  return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n",o={name:"random",fs:e};exports.random=o;
},{}],"rSwV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fp32=void 0;const n="#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",t={name:"fp32",vs:n,fs:null};exports.fp32=t;
},{}],"MlO6":[function(require,module,exports) {
"use strict";function t(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=Math.fround(t),n=t-o;return e[r]=o,e[r+1]=n,e}function e(t){return t-Math.fround(t)}function r(e){const r=new Float32Array(32);for(let o=0;o<4;++o)for(let n=0;n<4;++n){const f=4*o+n;t(e[4*n+o],r,2*f)}return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fp64LowPart=e,exports.fp64ify=t,exports.fp64ifyMatrix4=r;
},{}],"ObaP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n";exports.default=n;
},{}],"yYYN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\nvec2 exp_fp64(vec2 a) {\n\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n\n\n\n\n\n  s = sum_fp64(s, t);\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n";exports.default=n;
},{}],"mLAB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fp64=void 0,Object.defineProperty(exports,"fp64LowPart",{enumerable:!0,get:function(){return e.fp64LowPart}}),exports.fp64arithmetic=void 0,Object.defineProperty(exports,"fp64ify",{enumerable:!0,get:function(){return e.fp64ify}}),Object.defineProperty(exports,"fp64ifyMatrix4",{enumerable:!0,get:function(){return e.fp64ifyMatrix4}});var e=require("./fp64-utils"),t=r(require("./fp64-arithmetic.glsl")),f=r(require("./fp64-functions.glsl"));function r(e){return e&&e.__esModule?e:{default:e}}const i={ONE:1};function p(){return i}const n={name:"fp64-arithmetic",vs:t.default,fs:null,getUniforms:p,fp64ify:e.fp64ify,fp64LowPart:e.fp64LowPart,fp64ifyMatrix4:e.fp64ifyMatrix4};exports.fp64arithmetic=n;const o={name:"fp64",vs:f.default,fs:null,dependencies:[n],fp64ify:e.fp64ify,fp64LowPart:e.fp64LowPart,fp64ifyMatrix4:e.fp64ifyMatrix4};exports.fp64=o;
},{"./fp64-utils":"MlO6","./fp64-arithmetic.glsl":"ObaP","./fp64-functions.glsl":"yYYN"}],"YXhZ":[function(require,module,exports) {
"use strict";function e(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"wKVf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.acos=y,exports.asin=g,exports.atan=E,exports.clamp=P,exports.clone=a,exports.config=void 0,exports.configure=u,exports.cos=h,exports.degrees=p,exports.equals=d,exports.exactEquals=O,exports.formatValue=i,exports.isArray=s,exports.lerp=I,exports.radians=l,exports.sin=x,exports.tan=M,exports.toDegrees=f,exports.toRadians=c,exports.withEpsilon=L;var t=r(require("./assert"));function r(t){return t&&t.__esModule?t:{default:t}}const n=1/Math.PI*180,e=1/180*Math.PI,o={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function u(r){for(const n in r)(0,t.default)(n in o),o[n]=r[n];return o}function i(t,{precision:r=o.precision}={}){return t=N(t),"".concat(parseFloat(t.toPrecision(r)))}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function a(t){return"clone"in t?t.clone():t.slice()}function c(t){return l(t)}function f(t){return p(t)}function l(t,r){return b(t,t=>t*e,r)}function p(t,r){return b(t,t=>t*n,r)}function x(t,r){return b(t,t=>Math.sin(t),r)}function h(t,r){return b(t,t=>Math.cos(t),r)}function M(t,r){return b(t,t=>Math.tan(t),r)}function g(t,r){return b(t,t=>Math.asin(t),r)}function y(t,r){return b(t,t=>Math.acos(t),r)}function E(t,r){return b(t,t=>Math.atan(t),r)}function P(t,r,n){return b(t,t=>Math.max(r,Math.min(n,t)))}function I(t,r,n){return s(t)?t.map((t,e)=>I(t,r[e],n)):n*r+(1-n)*t}function d(t,r,n){const e=o.EPSILON;n&&(o.EPSILON=n);try{if(t===r)return!0;if(s(t)&&s(r)){if(t.length!==r.length)return!1;for(let n=0;n<t.length;++n)if(!d(t[n],r[n]))return!1;return!0}return t&&t.equals?t.equals(r):r&&r.equals?r.equals(t):"number"==typeof t&&"number"==typeof r&&Math.abs(t-r)<=o.EPSILON*Math.max(1,Math.abs(t),Math.abs(r))}finally{o.EPSILON=e}}function O(t,r){if(t===r)return!0;if(t&&"object"==typeof t&&r&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;if(t.exactEquals)return t.exactEquals(r)}if(s(t)&&s(r)){if(t.length!==r.length)return!1;for(let n=0;n<t.length;++n)if(!O(t[n],r[n]))return!1;return!0}return!1}function L(t,r){const n=o.EPSILON;let e;o.EPSILON=t;try{e=r()}finally{o.EPSILON=n}return e}function N(t){return Math.round(t/o.EPSILON)*o.EPSILON}function S(t){return t.clone?t.clone():new Array(t.length)}function b(t,r,n){if(s(t)){const e=t;n=n||S(e);for(let o=0;o<n.length&&o<e.length;++o)n[o]=r(t[o],o,n);return n}return r(t)}exports.config=o;
},{"./assert":"YXhZ"}],"cPa0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("../../lib/common");function r(t){function r(){var r=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(r,Object.getPrototypeOf(this)),r}return r.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t,r}class e extends(r(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,r=0){for(let e=0;e<this.ELEMENTS;++e)this[e]=t[e+r];return this.check()}toArray(t=[],r=0){for(let e=0;e<this.ELEMENTS;++e)t[r+e]=this[e];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(r){return r===this?this:(0,t.isArray)(r)?this.toArray(r):this.toObject(r)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(t.config)}formatString(r){let e="";for(let i=0;i<this.ELEMENTS;++i)e+=(i>0?", ":"")+(0,t.formatValue)(this[i],r);return"".concat(r.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(r){if(!r||this.length!==r.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!(0,t.equals)(this[e],r[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,e){if(void 0===e)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){const s=t[i];this[i]=s+e*(r[i]-s)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(Math.max(this[e],t[e]),r[e]);return this.check()}add(...t){for(const r of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=r[t];return this.check()}subtract(...t){for(const r of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=r[t];return this.check()}scale(t){if("number"==typeof t)for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(t.config.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(Math.max(this[e],t),r);return this.check()}get elements(){return this}}exports.default=e;
},{"../../lib/common":"wKVf"}],"imS9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkNumber=n,exports.checkVector=t,exports.deprecated=i,exports.validateVector=r;var e=require("./common");function r(e,r){if(e.length!==r)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}function n(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function t(n,t,o=""){if(e.config.debug&&!r(n,t))throw new Error("math.gl: ".concat(o," some fields set to invalid numbers'"));return n}const o={};function i(e,r){o[e]||(o[e]=!0,console.warn("".concat(e," has been removed in version ").concat(r,", see upgrade guide for more information")))}
},{"./common":"wKVf"}],"BKjK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("./math-array")),e=require("../../lib/validators"),r=s(require("../../lib/assert"));function s(t){return t&&t.__esModule?t:{default:t}}class i extends t.default{get x(){return this[0]}set x(t){this[0]=(0,e.checkNumber)(t)}get y(){return this[1]}set y(t){this[1]=(0,e.checkNumber)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let e=0;e<this.ELEMENTS;++e){const s=this[e]-t[e];r+=s*s}return(0,e.checkNumber)(r)}dot(t){let r=0;for(let e=0;e<this.ELEMENTS;++e)r+=this[e]*t[e];return(0,e.checkNumber)(r)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return(0,r.default)(t>=0&&t<this.ELEMENTS,"index is out of range"),(0,e.checkNumber)(this[t])}setComponent(t,e){return(0,r.default)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}exports.default=i;
},{"./math-array":"cPa0","../../lib/validators":"imS9","../../lib/assert":"YXhZ"}],"XJqx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RANDOM=exports.EPSILON=exports.ARRAY_TYPE=void 0,exports.equals=n,exports.setMatrixArrayType=e,exports.toRadian=s;var t=1e-6;exports.EPSILON=t;var r="undefined"!=typeof Float32Array?Float32Array:Array;exports.ARRAY_TYPE=r;var a=Math.random;function e(t){exports.ARRAY_TYPE=r=t}exports.RANDOM=a;var o=Math.PI/180;function s(t){return t*o}function n(r,a){return Math.abs(r-a)<=t*Math.max(1,Math.abs(r),Math.abs(a))}Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});
},{}],"XSo1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=i,exports.angle=k,exports.ceil=x,exports.clone=o,exports.copy=u,exports.create=n,exports.cross=R,exports.dist=void 0,exports.distance=b,exports.div=void 0,exports.divide=f,exports.dot=E,exports.equals=z,exports.exactEquals=W,exports.floor=v,exports.forEach=void 0,exports.fromValues=a,exports.inverse=O,exports.len=void 0,exports.length=P,exports.lerp=j,exports.max=M,exports.min=h,exports.mul=void 0,exports.multiply=p,exports.negate=A,exports.normalize=g,exports.random=w,exports.rotate=T,exports.round=l,exports.scale=d,exports.scaleAndAdd=m,exports.set=s,exports.sqrLen=exports.sqrDist=void 0,exports.squaredDistance=y,exports.squaredLength=q,exports.str=N,exports.sub=void 0,exports.subtract=c,exports.transformMat2=Y,exports.transformMat2d=_,exports.transformMat3=D,exports.transformMat4=L,exports.zero=I;var t=e(require("./common.js"));function r(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(r=function(t){return t?n:e})(t)}function e(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=r(e);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var s=a?Object.getOwnPropertyDescriptor(t,u):null;s&&(s.get||s.set)?Object.defineProperty(o,u,s):o[u]=t[u]}return o.default=t,n&&n.set(t,o),o}function n(){var r=new t.ARRAY_TYPE(2);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0),r}function o(r){var e=new t.ARRAY_TYPE(2);return e[0]=r[0],e[1]=r[1],e}function a(r,e){var n=new t.ARRAY_TYPE(2);return n[0]=r,n[1]=e,n}function u(t,r){return t[0]=r[0],t[1]=r[1],t}function s(t,r,e){return t[0]=r,t[1]=e,t}function i(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t}function c(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t}function p(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t}function f(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t}function x(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t}function v(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t}function h(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t}function M(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t}function l(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t}function d(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t}function m(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1];return Math.hypot(e,n)}function y(t,r){var e=r[0]-t[0],n=r[1]-t[1];return e*e+n*n}function P(t){var r=t[0],e=t[1];return Math.hypot(r,e)}function q(t){var r=t[0],e=t[1];return r*r+e*e}function A(t,r){return t[0]=-r[0],t[1]=-r[1],t}function O(t,r){return t[0]=1/r[0],t[1]=1/r[1],t}function g(t,r){var e=r[0],n=r[1],o=e*e+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=r[0]*o,t[1]=r[1]*o,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]}function R(t,r,e){var n=r[0]*e[1]-r[1]*e[0];return t[0]=t[1]=0,t[2]=n,t}function j(t,r,e,n){var o=r[0],a=r[1];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t}function w(r,e){e=e||1;var n=2*t.RANDOM()*Math.PI;return r[0]=Math.cos(n)*e,r[1]=Math.sin(n)*e,r}function Y(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o,t[1]=e[1]*n+e[3]*o,t}function _(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o+e[4],t[1]=e[1]*n+e[3]*o+e[5],t}function D(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[3]*o+e[6],t[1]=e[1]*n+e[4]*o+e[7],t}function L(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[4]*o+e[12],t[1]=e[1]*n+e[5]*o+e[13],t}function T(t,r,e,n){var o=r[0]-e[0],a=r[1]-e[1],u=Math.sin(n),s=Math.cos(n);return t[0]=o*s-a*u+e[0],t[1]=o*u+a*s+e[1],t}function k(t,r){var e=t[0],n=t[1],o=r[0],a=r[1],u=Math.sqrt(e*e+n*n)*Math.sqrt(o*o+a*a),s=u&&(e*o+n*a)/u;return Math.acos(Math.min(Math.max(s,-1),1))}function I(t){return t[0]=0,t[1]=0,t}function N(t){return"vec2("+t[0]+", "+t[1]+")"}function W(t,r){return t[0]===r[0]&&t[1]===r[1]}function z(r,e){var n=r[0],o=r[1],a=e[0],u=e[1];return Math.abs(n-a)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-u)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))}var S=P;exports.len=S;var F=c;exports.sub=F;var V=p;exports.mul=V;var B=f;exports.div=B;var C=b;exports.dist=C;var G=y;exports.sqrDist=G;var H=q;exports.sqrLen=H;var J=function(){var t=n();return function(r,e,n,o,a,u){var s,i;for(e||(e=2),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,s=n;s<i;s+=e)t[0]=r[s],t[1]=r[s+1],a(t,t,u),r[s]=t[0],r[s+1]=t[1];return r}}();exports.forEach=J;
},{"./common.js":"XJqx"}],"q1wk":[function(require,module,exports) {
"use strict";function t(t,r,e){const n=r[0],o=r[1],s=e[3]*n+e[7]*o||1;return t[0]=(e[0]*n+e[4]*o)/s,t[1]=(e[1]*n+e[5]*o)/s,t}function r(t,r,e){const n=r[0],o=r[1],s=r[2],c=e[3]*n+e[7]*o+e[11]*s||1;return t[0]=(e[0]*n+e[4]*o+e[8]*s)/c,t[1]=(e[1]*n+e[5]*o+e[9]*s)/c,t[2]=(e[2]*n+e[6]*o+e[10]*s)/c,t}function e(t,r,e){const n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o,t[1]=e[1]*n+e[3]*o,t[2]=r[2],t}function n(t,r,e){const n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o,t[1]=e[1]*n+e[3]*o,t[2]=r[2],t[3]=r[3],t}function o(t,r,e){const n=r[0],o=r[1],s=r[2];return t[0]=e[0]*n+e[3]*o+e[6]*s,t[1]=e[1]*n+e[4]*o+e[7]*s,t[2]=e[2]*n+e[5]*o+e[8]*s,t[3]=r[3],t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec2_transformMat4AsVector=t,exports.vec3_transformMat2=e,exports.vec3_transformMat4AsVector=r,exports.vec4_transformMat2=n,exports.vec4_transformMat3=o;
},{}],"JnVj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("./base/vector")),r=require("../lib/common"),e=require("../lib/validators"),i=a(require("gl-matrix/vec2")),s=require("../lib/gl-matrix-extras");function n(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,e=new WeakMap;return(n=function(t){return t?e:r})(t)}function a(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=n(r);if(e&&e.has(t))return e.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var o=s?Object.getOwnPropertyDescriptor(t,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=t[a]}return i.default=t,e&&e.set(t,i),i}function o(t){return t&&t.__esModule?t:{default:t}}class c extends t.default{constructor(t=0,i=0){super(2),(0,r.isArray)(t)&&1===arguments.length?this.copy(t):(r.config.debug&&((0,e.checkNumber)(t),(0,e.checkNumber)(i)),this[0]=t,this[1]=i)}set(t,r){return this[0]=t,this[1]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return r.config.debug&&((0,e.checkNumber)(t.x),(0,e.checkNumber)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return i.transformMat4(this,this,t),this.check()}transformAsVector(t){return(0,s.vec2_transformMat4AsVector)(this,this,t),this.check()}transformByMatrix3(t){return i.transformMat3(this,this,t),this.check()}transformByMatrix2x3(t){return i.transformMat2d(this,this,t),this.check()}transformByMatrix2(t){return i.transformMat2(this,this,t),this.check()}}exports.default=c;
},{"./base/vector":"BKjK","../lib/common":"wKVf","../lib/validators":"imS9","gl-matrix/vec2":"XSo1","../lib/gl-matrix-extras":"q1wk"}],"AWBd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=c,exports.angle=z,exports.bezier=w,exports.ceil=h,exports.clone=o,exports.copy=u,exports.create=n,exports.cross=R,exports.dist=void 0,exports.distance=y,exports.div=void 0,exports.divide=x,exports.dot=E,exports.equals=Q,exports.exactEquals=F,exports.floor=M,exports.forEach=void 0,exports.fromValues=s,exports.hermite=j,exports.inverse=A,exports.len=void 0,exports.length=a,exports.lerp=Y,exports.max=l,exports.min=v,exports.mul=void 0,exports.multiply=f,exports.negate=q,exports.normalize=g,exports.random=_,exports.rotateX=I,exports.rotateY=T,exports.rotateZ=k,exports.round=d,exports.scale=m,exports.scaleAndAdd=b,exports.set=i,exports.sqrLen=exports.sqrDist=void 0,exports.squaredDistance=O,exports.squaredLength=P,exports.str=W,exports.sub=void 0,exports.subtract=p,exports.transformMat3=L,exports.transformMat4=D,exports.transformQuat=N,exports.zero=S;var t=e(require("./common.js"));function r(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(r=function(t){return t?n:e})(t)}function e(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=r(e);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=a?Object.getOwnPropertyDescriptor(t,s):null;u&&(u.get||u.set)?Object.defineProperty(o,s,u):o[s]=t[s]}return o.default=t,n&&n.set(t,o),o}function n(){var r=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function o(r){var e=new t.ARRAY_TYPE(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function a(t){var r=t[0],e=t[1],n=t[2];return Math.hypot(r,e,n)}function s(r,e,n){var o=new t.ARRAY_TYPE(3);return o[0]=r,o[1]=e,o[2]=n,o}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function i(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}function c(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function p(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function f(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t}function x(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t}function h(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t}function M(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t}function v(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t}function l(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t}function d(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t}function m(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function b(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t}function y(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return Math.hypot(e,n,o)}function O(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return e*e+n*n+o*o}function P(t){var r=t[0],e=t[1],n=t[2];return r*r+e*e+n*n}function q(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t}function A(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t}function g(t,r){var e=r[0],n=r[1],o=r[2],a=e*e+n*n+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function R(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return t[0]=o*i-a*u,t[1]=a*s-n*i,t[2]=n*u-o*s,t}function Y(t,r,e,n){var o=r[0],a=r[1],s=r[2];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=s+n*(e[2]-s),t}function j(t,r,e,n,o,a){var s=a*a,u=s*(2*a-3)+1,i=s*(a-2)+a,c=s*(a-1),p=s*(3-2*a);return t[0]=r[0]*u+e[0]*i+n[0]*c+o[0]*p,t[1]=r[1]*u+e[1]*i+n[1]*c+o[1]*p,t[2]=r[2]*u+e[2]*i+n[2]*c+o[2]*p,t}function w(t,r,e,n,o,a){var s=1-a,u=s*s,i=a*a,c=u*s,p=3*a*u,f=3*i*s,x=i*a;return t[0]=r[0]*c+e[0]*p+n[0]*f+o[0]*x,t[1]=r[1]*c+e[1]*p+n[1]*f+o[1]*x,t[2]=r[2]*c+e[2]*p+n[2]*f+o[2]*x,t}function _(r,e){e=e||1;var n=2*t.RANDOM()*Math.PI,o=2*t.RANDOM()-1,a=Math.sqrt(1-o*o)*e;return r[0]=Math.cos(n)*a,r[1]=Math.sin(n)*a,r[2]=o*e,r}function D(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[3]*n+e[7]*o+e[11]*a+e[15];return s=s||1,t[0]=(e[0]*n+e[4]*o+e[8]*a+e[12])/s,t[1]=(e[1]*n+e[5]*o+e[9]*a+e[13])/s,t[2]=(e[2]*n+e[6]*o+e[10]*a+e[14])/s,t}function L(t,r,e){var n=r[0],o=r[1],a=r[2];return t[0]=n*e[0]+o*e[3]+a*e[6],t[1]=n*e[1]+o*e[4]+a*e[7],t[2]=n*e[2]+o*e[5]+a*e[8],t}function N(t,r,e){var n=e[0],o=e[1],a=e[2],s=e[3],u=r[0],i=r[1],c=r[2],p=o*c-a*i,f=a*u-n*c,x=n*i-o*u,h=o*x-a*f,M=a*p-n*x,v=n*f-o*p,l=2*s;return p*=l,f*=l,x*=l,h*=2,M*=2,v*=2,t[0]=u+p+h,t[1]=i+f+M,t[2]=c+x+v,t}function I(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0],a[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),a[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function T(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),a[1]=o[1],a[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function k(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),a[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),a[2]=o[2],t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function z(t,r){var e=t[0],n=t[1],o=t[2],a=r[0],s=r[1],u=r[2],i=Math.sqrt(e*e+n*n+o*o)*Math.sqrt(a*a+s*s+u*u),c=i&&E(t,r)/i;return Math.acos(Math.min(Math.max(c,-1),1))}function S(t){return t[0]=0,t[1]=0,t[2]=0,t}function W(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function F(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function Q(r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-u)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-i)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))}var V=p;exports.sub=V;var X=f;exports.mul=X;var Z=x;exports.div=Z;var B=y;exports.dist=B;var C=O;exports.sqrDist=C;var G=a;exports.len=G;var H=P;exports.sqrLen=H;var J=function(){var t=n();return function(r,e,n,o,a,s){var u,i;for(e||(e=3),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,u=n;u<i;u+=e)t[0]=r[u],t[1]=r[u+1],t[2]=r[u+2],a(t,t,s),r[u]=t[0],r[u+1]=t[1],r[u+2]=t[2];return r}}();exports.forEach=J;
},{"./common.js":"XJqx"}],"WGSx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=h(require("./base/vector")),e=require("../lib/common"),r=require("../lib/validators"),s=c(require("gl-matrix/vec3")),i=require("../lib/gl-matrix-extras");function n(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(n=function(t){return t?r:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=n(e);if(r&&r.has(t))return r.get(t);var s={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var h=i?Object.getOwnPropertyDescriptor(t,c):null;h&&(h.get||h.set)?Object.defineProperty(s,c,h):s[c]=t[c]}return s.default=t,r&&r.set(t,s),s}function h(t){return t&&t.__esModule?t:{default:t}}const o=[0,0,0];let a;class u extends t.default{static get ZERO(){return a||(a=new u(0,0,0),Object.freeze(a)),a}constructor(t=0,s=0,i=0){super(-0,-0,-0),1===arguments.length&&(0,e.isArray)(t)?this.copy(t):(e.config.debug&&((0,r.checkNumber)(t),(0,r.checkNumber)(s),(0,r.checkNumber)(i)),this[0]=t,this[1]=s,this[2]=i)}set(t,e,r){return this[0]=t,this[1]=e,this[2]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return e.config.debug&&((0,r.checkNumber)(t.x),(0,r.checkNumber)(t.y),(0,r.checkNumber)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=(0,r.checkNumber)(t)}angle(t){return s.angle(this,t)}cross(t){return s.cross(this,this,t),this.check()}rotateX({radians:t,origin:e=o}){return s.rotateX(this,this,e,t),this.check()}rotateY({radians:t,origin:e=o}){return s.rotateY(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=o}){return s.rotateZ(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return s.transformMat4(this,this,t),this.check()}transformAsVector(t){return(0,i.vec3_transformMat4AsVector)(this,this,t),this.check()}transformByMatrix3(t){return s.transformMat3(this,this,t),this.check()}transformByMatrix2(t){return(0,i.vec3_transformMat2)(this,this,t),this.check()}transformByQuaternion(t){return s.transformQuat(this,this,t),this.check()}}exports.default=u;
},{"./base/vector":"BKjK","../lib/common":"wKVf","../lib/validators":"imS9","gl-matrix/vec3":"AWBd","../lib/gl-matrix-extras":"q1wk"}],"T9bv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=u(require("./base/vector")),e=require("../lib/common"),r=require("../lib/validators"),i=n(require("gl-matrix/vec3")),s=require("../lib/gl-matrix-extras");function c(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(c=function(t){return t?r:e})(t)}function n(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=c(e);if(r&&r.has(t))return r.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if("default"!==n&&Object.prototype.hasOwnProperty.call(t,n)){var u=s?Object.getOwnPropertyDescriptor(t,n):null;u&&(u.get||u.set)?Object.defineProperty(i,n,u):i[n]=t[n]}return i.default=t,r&&r.set(t,i),i}function u(t){return t&&t.__esModule?t:{default:t}}let h;class a extends t.default{static get ZERO(){return h||(h=new a(0,0,0,0),Object.freeze(h)),h}constructor(t=0,i=0,s=0,c=0){super(-0,-0,-0,-0),(0,e.isArray)(t)&&1===arguments.length?this.copy(t):(e.config.debug&&((0,r.checkNumber)(t),(0,r.checkNumber)(i),(0,r.checkNumber)(s),(0,r.checkNumber)(c)),this[0]=t,this[1]=i,this[2]=s,this[3]=c)}set(t,e,r,i){return this[0]=t,this[1]=e,this[2]=r,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return e.config.debug&&((0,r.checkNumber)(t.x),(0,r.checkNumber)(t.y),(0,r.checkNumber)(t.z),(0,r.checkNumber)(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=(0,r.checkNumber)(t)}get w(){return this[3]}set w(t){this[3]=(0,r.checkNumber)(t)}transform(t){return i.transformMat4(this,this,t),this.check()}transformByMatrix3(t){return(0,s.vec4_transformMat3)(this,this,t),this.check()}transformByMatrix2(t){return(0,s.vec4_transformMat2)(this,this,t),this.check()}transformByQuaternion(t){return i.transformQuat(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}exports.default=a;
},{"./base/vector":"BKjK","../lib/common":"wKVf","../lib/validators":"imS9","gl-matrix/vec3":"AWBd","../lib/gl-matrix-extras":"q1wk"}],"rnPl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("./math-array")),e=require("../../lib/validators"),r=require("../../lib/common");function s(t){return t&&t.__esModule?t:{default:t}}class i extends t.default{toString(){let t="[";if(r.config.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let r=0;r<this.RANK;++r)t+=" ".concat(this[r*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]"}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,r,s){return this[r*this.RANK+t]=(0,e.checkNumber)(s),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const r=t*this.RANK;for(let s=0;s<this.RANK;++s)e[s]=this[r+s];return e}setColumn(t,e){const r=t*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=e[s];return this}}exports.default=i;
},{"./math-array":"cPa0","../../lib/validators":"imS9","../../lib/common":"wKVf"}],"vtQf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=I,exports.adjoint=M,exports.clone=o,exports.copy=u,exports.create=n,exports.determinant=x,exports.equals=Y,exports.exactEquals=w,exports.frob=j,exports.fromMat2d=O,exports.fromMat4=e,exports.fromQuat=y,exports.fromRotation=d,exports.fromScaling=P,exports.fromTranslation=v,exports.fromValues=s,exports.identity=c,exports.invert=p,exports.mul=void 0,exports.multiply=h,exports.multiplyScalar=N,exports.multiplyScalarAndAdd=R,exports.normalFromMat4=E,exports.projection=S,exports.rotate=b,exports.scale=m,exports.set=i,exports.str=A,exports.sub=void 0,exports.subtract=L,exports.translate=l,exports.transpose=f;var t=a(require("./common.js"));function r(t){if("function"!=typeof WeakMap)return null;var a=new WeakMap,n=new WeakMap;return(r=function(t){return t?n:a})(t)}function a(t,a){if(!a&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=r(a);if(n&&n.has(t))return n.get(t);var e={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var s=o?Object.getOwnPropertyDescriptor(t,u):null;s&&(s.get||s.set)?Object.defineProperty(e,u,s):e[u]=t[u]}return e.default=t,n&&n.set(t,e),e}function n(){var r=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function e(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t}function o(r){var a=new t.ARRAY_TYPE(9);return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function s(r,a,n,e,o,u,s,i,c){var f=new t.ARRAY_TYPE(9);return f[0]=r,f[1]=a,f[2]=n,f[3]=e,f[4]=o,f[5]=u,f[6]=s,f[7]=i,f[8]=c,f}function i(t,r,a,n,e,o,u,s,i,c){return t[0]=r,t[1]=a,t[2]=n,t[3]=e,t[4]=o,t[5]=u,t[6]=s,t[7]=i,t[8]=c,t}function c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function f(t,r){if(t===r){var a=r[1],n=r[2],e=r[5];t[1]=r[3],t[2]=r[6],t[3]=a,t[5]=r[7],t[6]=n,t[7]=e}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t}function p(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8],p=f*u-s*c,M=-f*o+s*i,x=c*o-u*i,h=a*p+n*M+e*x;return h?(h=1/h,t[0]=p*h,t[1]=(-f*n+e*c)*h,t[2]=(s*n-e*u)*h,t[3]=M*h,t[4]=(f*a-e*i)*h,t[5]=(-s*a+e*o)*h,t[6]=x*h,t[7]=(-c*a+n*i)*h,t[8]=(u*a-n*o)*h,t):null}function M(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8];return t[0]=u*f-s*c,t[1]=e*c-n*f,t[2]=n*s-e*u,t[3]=s*i-o*f,t[4]=a*f-e*i,t[5]=e*o-a*s,t[6]=o*c-u*i,t[7]=n*i-a*c,t[8]=a*u-n*o,t}function x(t){var r=t[0],a=t[1],n=t[2],e=t[3],o=t[4],u=t[5],s=t[6],i=t[7],c=t[8];return r*(c*o-u*i)+a*(-c*e+u*s)+n*(i*e-o*s)}function h(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=a[0],x=a[1],h=a[2],l=a[3],b=a[4],m=a[5],v=a[6],d=a[7],P=a[8];return t[0]=M*n+x*u+h*c,t[1]=M*e+x*s+h*f,t[2]=M*o+x*i+h*p,t[3]=l*n+b*u+m*c,t[4]=l*e+b*s+m*f,t[5]=l*o+b*i+m*p,t[6]=v*n+d*u+P*c,t[7]=v*e+d*s+P*f,t[8]=v*o+d*i+P*p,t}function l(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=a[0],x=a[1];return t[0]=n,t[1]=e,t[2]=o,t[3]=u,t[4]=s,t[5]=i,t[6]=M*n+x*u+c,t[7]=M*e+x*s+f,t[8]=M*o+x*i+p,t}function b(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=Math.sin(a),x=Math.cos(a);return t[0]=x*n+M*u,t[1]=x*e+M*s,t[2]=x*o+M*i,t[3]=x*u-M*n,t[4]=x*s-M*e,t[5]=x*i-M*o,t[6]=c,t[7]=f,t[8]=p,t}function m(t,r,a){var n=a[0],e=a[1];return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=e*r[3],t[4]=e*r[4],t[5]=e*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function v(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=r[0],t[7]=r[1],t[8]=1,t}function d(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=a,t[2]=0,t[3]=-a,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function P(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=r[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function O(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t}function y(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=a+a,s=n+n,i=e+e,c=a*u,f=n*u,p=n*s,M=e*u,x=e*s,h=e*i,l=o*u,b=o*s,m=o*i;return t[0]=1-p-h,t[3]=f-m,t[6]=M+b,t[1]=f+m,t[4]=1-c-h,t[7]=x-l,t[2]=M-b,t[5]=x+l,t[8]=1-c-p,t}function E(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8],p=r[9],M=r[10],x=r[11],h=r[12],l=r[13],b=r[14],m=r[15],v=a*s-n*u,d=a*i-e*u,P=a*c-o*u,O=n*i-e*s,y=n*c-o*s,E=e*c-o*i,S=f*l-p*h,A=f*b-M*h,j=f*m-x*h,I=p*b-M*l,L=p*m-x*l,N=M*m-x*b,R=v*N-d*L+P*I+O*j-y*A+E*S;return R?(R=1/R,t[0]=(s*N-i*L+c*I)*R,t[1]=(i*j-u*N-c*A)*R,t[2]=(u*L-s*j+c*S)*R,t[3]=(e*L-n*N-o*I)*R,t[4]=(a*N-e*j+o*A)*R,t[5]=(n*j-a*L-o*S)*R,t[6]=(l*E-b*y+m*O)*R,t[7]=(b*P-h*E-m*d)*R,t[8]=(h*y-l*P+m*v)*R,t):null}function S(t,r,a){return t[0]=2/r,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/a,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function A(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function j(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function I(t,r,a){return t[0]=r[0]+a[0],t[1]=r[1]+a[1],t[2]=r[2]+a[2],t[3]=r[3]+a[3],t[4]=r[4]+a[4],t[5]=r[5]+a[5],t[6]=r[6]+a[6],t[7]=r[7]+a[7],t[8]=r[8]+a[8],t}function L(t,r,a){return t[0]=r[0]-a[0],t[1]=r[1]-a[1],t[2]=r[2]-a[2],t[3]=r[3]-a[3],t[4]=r[4]-a[4],t[5]=r[5]-a[5],t[6]=r[6]-a[6],t[7]=r[7]-a[7],t[8]=r[8]-a[8],t}function N(t,r,a){return t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t[3]=r[3]*a,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*a,t}function R(t,r,a,n){return t[0]=r[0]+a[0]*n,t[1]=r[1]+a[1]*n,t[2]=r[2]+a[2]*n,t[3]=r[3]+a[3]*n,t[4]=r[4]+a[4]*n,t[5]=r[5]+a[5]*n,t[6]=r[6]+a[6]*n,t[7]=r[7]+a[7]*n,t[8]=r[8]+a[8]*n,t}function w(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]}function Y(r,a){var n=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=a[0],x=a[1],h=a[2],l=a[3],b=a[4],m=a[5],v=a[6],d=a[7],P=a[8];return Math.abs(n-M)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(e-x)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-l)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(l))&&Math.abs(s-b)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(i-m)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(c-v)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(f-d)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(d))&&Math.abs(p-P)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))}var _=h;exports.mul=_;var g=L;exports.sub=g;
},{"./common.js":"XJqx"}],"YefV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t,e=u(require("./base/matrix")),r=require("../lib/validators"),i=require("../lib/gl-matrix-extras"),s=c(require("gl-matrix/mat3")),n=c(require("gl-matrix/vec2")),h=c(require("gl-matrix/vec3"));function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(a=function(t){return t?r:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=a(e);if(r&&r.has(t))return r.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if("default"!==n&&Object.prototype.hasOwnProperty.call(t,n)){var h=s?Object.getOwnPropertyDescriptor(t,n):null;h&&(h.get||h.set)?Object.defineProperty(i,n,h):i[n]=t[n]}return i.default=t,r&&r.set(t,i),i}function u(t){return t&&t.__esModule?t:{default:t}}!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"}(t||(t={}));const o=Object.freeze([1,0,0,0,1,0,0,0,1]);class l extends e.default{static get IDENTITY(){return m()}static get ZERO(){return p()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return t}constructor(t,...e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):e.length>0?this.copy([t,...e]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(o)}fromObject(t){return this.check()}fromQuaternion(t){return s.fromQuat(this,t),this.check()}set(t,e,r,i,s,n,h,a,c){return this[0]=t,this[1]=e,this[2]=r,this[3]=i,this[4]=s,this[5]=n,this[6]=h,this[7]=a,this[8]=c,this.check()}setRowMajor(t,e,r,i,s,n,h,a,c){return this[0]=t,this[1]=i,this[2]=h,this[3]=e,this[4]=s,this[5]=a,this[6]=r,this[7]=n,this[8]=c,this.check()}determinant(){return s.determinant(this)}transpose(){return s.transpose(this,this),this.check()}invert(){return s.invert(this,this),this.check()}multiplyLeft(t){return s.multiply(this,t,this),this.check()}multiplyRight(t){return s.multiply(this,this,t),this.check()}rotate(t){return s.rotate(this,this,t),this.check()}scale(t){return Array.isArray(t)?s.scale(this,this,t):s.scale(this,this,[t,t]),this.check()}translate(t){return s.translate(this,this,t),this.check()}transform(t,e){let s;switch(t.length){case 2:s=n.transformMat3(e||[-0,-0],t,this);break;case 3:s=h.transformMat3(e||[-0,-0,-0],t,this);break;case 4:s=(0,i.vec4_transformMat3)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.checkVector)(s,t.length),s}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let O,f;function p(){return O||(O=new l([0,0,0,0,0,0,0,0,0]),Object.freeze(O)),O}function m(){return f||(f=new l,Object.freeze(f)),f}exports.default=l;
},{"./base/matrix":"rnPl","../lib/validators":"imS9","../lib/gl-matrix-extras":"q1wk","gl-matrix/mat3":"vtQf","gl-matrix/vec2":"XSo1","gl-matrix/vec3":"AWBd"}],"w3aR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=B,exports.adjoint=p,exports.clone=e,exports.copy=o,exports.create=n,exports.determinant=c,exports.equals=K,exports.exactEquals=J,exports.frob=z,exports.fromQuat=T,exports.fromQuat2=L,exports.fromRotation=S,exports.fromRotationTranslation=d,exports.fromRotationTranslationScale=Y,exports.fromRotationTranslationScaleOrigin=w,exports.fromScaling=E,exports.fromTranslation=O,exports.fromValues=s,exports.fromXRotation=y,exports.fromYRotation=I,exports.fromZRotation=N,exports.frustum=_,exports.getRotation=A,exports.getScaling=g,exports.getTranslation=R,exports.identity=h,exports.invert=i,exports.lookAt=Q,exports.mul=void 0,exports.multiply=f,exports.multiplyScalar=G,exports.multiplyScalarAndAdd=H,exports.ortho=void 0,exports.orthoNO=Z,exports.orthoZO=W,exports.perspective=void 0,exports.perspectiveFromFieldOfView=k,exports.perspectiveNO=j,exports.perspectiveZO=D,exports.rotate=v,exports.rotateX=l,exports.rotateY=m,exports.rotateZ=P,exports.scale=b,exports.set=u,exports.str=X,exports.sub=void 0,exports.subtract=C,exports.targetTo=V,exports.translate=x,exports.transpose=M;var t=r(require("./common.js"));function a(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(a=function(t){return t?n:r})(t)}function r(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=a(r);if(n&&n.has(t))return n.get(t);var e={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=o?Object.getOwnPropertyDescriptor(t,s):null;u&&(u.get||u.set)?Object.defineProperty(e,s,u):e[s]=t[s]}return e.default=t,n&&n.set(t,e),e}function n(){var a=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function e(a){var r=new t.ARRAY_TYPE(16);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r}function o(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function s(a,r,n,e,o,s,u,h,M,i,p,c,f,x,b,v){var l=new t.ARRAY_TYPE(16);return l[0]=a,l[1]=r,l[2]=n,l[3]=e,l[4]=o,l[5]=s,l[6]=u,l[7]=h,l[8]=M,l[9]=i,l[10]=p,l[11]=c,l[12]=f,l[13]=x,l[14]=b,l[15]=v,l}function u(t,a,r,n,e,o,s,u,h,M,i,p,c,f,x,b,v){return t[0]=a,t[1]=r,t[2]=n,t[3]=e,t[4]=o,t[5]=s,t[6]=u,t[7]=h,t[8]=M,t[9]=i,t[10]=p,t[11]=c,t[12]=f,t[13]=x,t[14]=b,t[15]=v,t}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function M(t,a){if(t===a){var r=a[1],n=a[2],e=a[3],o=a[6],s=a[7],u=a[11];t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=r,t[6]=a[9],t[7]=a[13],t[8]=n,t[9]=o,t[11]=a[14],t[12]=e,t[13]=s,t[14]=u}else t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15];return t}function i(t,a){var r=a[0],n=a[1],e=a[2],o=a[3],s=a[4],u=a[5],h=a[6],M=a[7],i=a[8],p=a[9],c=a[10],f=a[11],x=a[12],b=a[13],v=a[14],l=a[15],m=r*u-n*s,P=r*h-e*s,O=r*M-o*s,E=n*h-e*u,S=n*M-o*u,y=e*M-o*h,I=i*b-p*x,N=i*v-c*x,d=i*l-f*x,L=p*v-c*b,R=p*l-f*b,g=c*l-f*v,A=m*g-P*R+O*L+E*d-S*N+y*I;return A?(A=1/A,t[0]=(u*g-h*R+M*L)*A,t[1]=(e*R-n*g-o*L)*A,t[2]=(b*y-v*S+l*E)*A,t[3]=(c*S-p*y-f*E)*A,t[4]=(h*d-s*g-M*N)*A,t[5]=(r*g-e*d+o*N)*A,t[6]=(v*O-x*y-l*P)*A,t[7]=(i*y-c*O+f*P)*A,t[8]=(s*R-u*d+M*I)*A,t[9]=(n*d-r*R-o*I)*A,t[10]=(x*S-b*O+l*m)*A,t[11]=(p*O-i*S-f*m)*A,t[12]=(u*N-s*L-h*I)*A,t[13]=(r*L-n*N+e*I)*A,t[14]=(b*P-x*E-v*m)*A,t[15]=(i*E-p*P+c*m)*A,t):null}function p(t,a){var r=a[0],n=a[1],e=a[2],o=a[3],s=a[4],u=a[5],h=a[6],M=a[7],i=a[8],p=a[9],c=a[10],f=a[11],x=a[12],b=a[13],v=a[14],l=a[15];return t[0]=u*(c*l-f*v)-p*(h*l-M*v)+b*(h*f-M*c),t[1]=-(n*(c*l-f*v)-p*(e*l-o*v)+b*(e*f-o*c)),t[2]=n*(h*l-M*v)-u*(e*l-o*v)+b*(e*M-o*h),t[3]=-(n*(h*f-M*c)-u*(e*f-o*c)+p*(e*M-o*h)),t[4]=-(s*(c*l-f*v)-i*(h*l-M*v)+x*(h*f-M*c)),t[5]=r*(c*l-f*v)-i*(e*l-o*v)+x*(e*f-o*c),t[6]=-(r*(h*l-M*v)-s*(e*l-o*v)+x*(e*M-o*h)),t[7]=r*(h*f-M*c)-s*(e*f-o*c)+i*(e*M-o*h),t[8]=s*(p*l-f*b)-i*(u*l-M*b)+x*(u*f-M*p),t[9]=-(r*(p*l-f*b)-i*(n*l-o*b)+x*(n*f-o*p)),t[10]=r*(u*l-M*b)-s*(n*l-o*b)+x*(n*M-o*u),t[11]=-(r*(u*f-M*p)-s*(n*f-o*p)+i*(n*M-o*u)),t[12]=-(s*(p*v-c*b)-i*(u*v-h*b)+x*(u*c-h*p)),t[13]=r*(p*v-c*b)-i*(n*v-e*b)+x*(n*c-e*p),t[14]=-(r*(u*v-h*b)-s*(n*v-e*b)+x*(n*h-e*u)),t[15]=r*(u*c-h*p)-s*(n*c-e*p)+i*(n*h-e*u),t}function c(t){var a=t[0],r=t[1],n=t[2],e=t[3],o=t[4],s=t[5],u=t[6],h=t[7],M=t[8],i=t[9],p=t[10],c=t[11],f=t[12],x=t[13],b=t[14],v=t[15];return(a*s-r*o)*(p*v-c*b)-(a*u-n*o)*(i*v-c*x)+(a*h-e*o)*(i*b-p*x)+(r*u-n*s)*(M*v-c*f)-(r*h-e*s)*(M*b-p*f)+(n*h-e*u)*(M*x-i*f)}function f(t,a,r){var n=a[0],e=a[1],o=a[2],s=a[3],u=a[4],h=a[5],M=a[6],i=a[7],p=a[8],c=a[9],f=a[10],x=a[11],b=a[12],v=a[13],l=a[14],m=a[15],P=r[0],O=r[1],E=r[2],S=r[3];return t[0]=P*n+O*u+E*p+S*b,t[1]=P*e+O*h+E*c+S*v,t[2]=P*o+O*M+E*f+S*l,t[3]=P*s+O*i+E*x+S*m,P=r[4],O=r[5],E=r[6],S=r[7],t[4]=P*n+O*u+E*p+S*b,t[5]=P*e+O*h+E*c+S*v,t[6]=P*o+O*M+E*f+S*l,t[7]=P*s+O*i+E*x+S*m,P=r[8],O=r[9],E=r[10],S=r[11],t[8]=P*n+O*u+E*p+S*b,t[9]=P*e+O*h+E*c+S*v,t[10]=P*o+O*M+E*f+S*l,t[11]=P*s+O*i+E*x+S*m,P=r[12],O=r[13],E=r[14],S=r[15],t[12]=P*n+O*u+E*p+S*b,t[13]=P*e+O*h+E*c+S*v,t[14]=P*o+O*M+E*f+S*l,t[15]=P*s+O*i+E*x+S*m,t}function x(t,a,r){var n,e,o,s,u,h,M,i,p,c,f,x,b=r[0],v=r[1],l=r[2];return a===t?(t[12]=a[0]*b+a[4]*v+a[8]*l+a[12],t[13]=a[1]*b+a[5]*v+a[9]*l+a[13],t[14]=a[2]*b+a[6]*v+a[10]*l+a[14],t[15]=a[3]*b+a[7]*v+a[11]*l+a[15]):(n=a[0],e=a[1],o=a[2],s=a[3],u=a[4],h=a[5],M=a[6],i=a[7],p=a[8],c=a[9],f=a[10],x=a[11],t[0]=n,t[1]=e,t[2]=o,t[3]=s,t[4]=u,t[5]=h,t[6]=M,t[7]=i,t[8]=p,t[9]=c,t[10]=f,t[11]=x,t[12]=n*b+u*v+p*l+a[12],t[13]=e*b+h*v+c*l+a[13],t[14]=o*b+M*v+f*l+a[14],t[15]=s*b+i*v+x*l+a[15]),t}function b(t,a,r){var n=r[0],e=r[1],o=r[2];return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*e,t[5]=a[5]*e,t[6]=a[6]*e,t[7]=a[7]*e,t[8]=a[8]*o,t[9]=a[9]*o,t[10]=a[10]*o,t[11]=a[11]*o,t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function v(a,r,n,e){var o,s,u,h,M,i,p,c,f,x,b,v,l,m,P,O,E,S,y,I,N,d,L,R,g=e[0],A=e[1],Y=e[2],w=Math.hypot(g,A,Y);return w<t.EPSILON?null:(g*=w=1/w,A*=w,Y*=w,o=Math.sin(n),u=1-(s=Math.cos(n)),h=r[0],M=r[1],i=r[2],p=r[3],c=r[4],f=r[5],x=r[6],b=r[7],v=r[8],l=r[9],m=r[10],P=r[11],O=g*g*u+s,E=A*g*u+Y*o,S=Y*g*u-A*o,y=g*A*u-Y*o,I=A*A*u+s,N=Y*A*u+g*o,d=g*Y*u+A*o,L=A*Y*u-g*o,R=Y*Y*u+s,a[0]=h*O+c*E+v*S,a[1]=M*O+f*E+l*S,a[2]=i*O+x*E+m*S,a[3]=p*O+b*E+P*S,a[4]=h*y+c*I+v*N,a[5]=M*y+f*I+l*N,a[6]=i*y+x*I+m*N,a[7]=p*y+b*I+P*N,a[8]=h*d+c*L+v*R,a[9]=M*d+f*L+l*R,a[10]=i*d+x*L+m*R,a[11]=p*d+b*L+P*R,r!==a&&(a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a)}function l(t,a,r){var n=Math.sin(r),e=Math.cos(r),o=a[4],s=a[5],u=a[6],h=a[7],M=a[8],i=a[9],p=a[10],c=a[11];return a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[4]=o*e+M*n,t[5]=s*e+i*n,t[6]=u*e+p*n,t[7]=h*e+c*n,t[8]=M*e-o*n,t[9]=i*e-s*n,t[10]=p*e-u*n,t[11]=c*e-h*n,t}function m(t,a,r){var n=Math.sin(r),e=Math.cos(r),o=a[0],s=a[1],u=a[2],h=a[3],M=a[8],i=a[9],p=a[10],c=a[11];return a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*e-M*n,t[1]=s*e-i*n,t[2]=u*e-p*n,t[3]=h*e-c*n,t[8]=o*n+M*e,t[9]=s*n+i*e,t[10]=u*n+p*e,t[11]=h*n+c*e,t}function P(t,a,r){var n=Math.sin(r),e=Math.cos(r),o=a[0],s=a[1],u=a[2],h=a[3],M=a[4],i=a[5],p=a[6],c=a[7];return a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*e+M*n,t[1]=s*e+i*n,t[2]=u*e+p*n,t[3]=h*e+c*n,t[4]=M*e-o*n,t[5]=i*e-s*n,t[6]=p*e-u*n,t[7]=c*e-h*n,t}function O(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function E(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(a,r,n){var e,o,s,u=n[0],h=n[1],M=n[2],i=Math.hypot(u,h,M);return i<t.EPSILON?null:(u*=i=1/i,h*=i,M*=i,e=Math.sin(r),s=1-(o=Math.cos(r)),a[0]=u*u*s+o,a[1]=h*u*s+M*e,a[2]=M*u*s-h*e,a[3]=0,a[4]=u*h*s-M*e,a[5]=h*h*s+o,a[6]=M*h*s+u*e,a[7]=0,a[8]=u*M*s+h*e,a[9]=h*M*s-u*e,a[10]=M*M*s+o,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}function y(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function d(t,a,r){var n=a[0],e=a[1],o=a[2],s=a[3],u=n+n,h=e+e,M=o+o,i=n*u,p=n*h,c=n*M,f=e*h,x=e*M,b=o*M,v=s*u,l=s*h,m=s*M;return t[0]=1-(f+b),t[1]=p+m,t[2]=c-l,t[3]=0,t[4]=p-m,t[5]=1-(i+b),t[6]=x+v,t[7]=0,t[8]=c+l,t[9]=x-v,t[10]=1-(i+f),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function L(a,r){var n=new t.ARRAY_TYPE(3),e=-r[0],o=-r[1],s=-r[2],u=r[3],h=r[4],M=r[5],i=r[6],p=r[7],c=e*e+o*o+s*s+u*u;return c>0?(n[0]=2*(h*u+p*e+M*s-i*o)/c,n[1]=2*(M*u+p*o+i*e-h*s)/c,n[2]=2*(i*u+p*s+h*o-M*e)/c):(n[0]=2*(h*u+p*e+M*s-i*o),n[1]=2*(M*u+p*o+i*e-h*s),n[2]=2*(i*u+p*s+h*o-M*e)),d(a,r,n),a}function R(t,a){return t[0]=a[12],t[1]=a[13],t[2]=a[14],t}function g(t,a){var r=a[0],n=a[1],e=a[2],o=a[4],s=a[5],u=a[6],h=a[8],M=a[9],i=a[10];return t[0]=Math.hypot(r,n,e),t[1]=Math.hypot(o,s,u),t[2]=Math.hypot(h,M,i),t}function A(a,r){var n=new t.ARRAY_TYPE(3);g(n,r);var e=1/n[0],o=1/n[1],s=1/n[2],u=r[0]*e,h=r[1]*o,M=r[2]*s,i=r[4]*e,p=r[5]*o,c=r[6]*s,f=r[8]*e,x=r[9]*o,b=r[10]*s,v=u+p+b,l=0;return v>0?(l=2*Math.sqrt(v+1),a[3]=.25*l,a[0]=(c-x)/l,a[1]=(f-M)/l,a[2]=(h-i)/l):u>p&&u>b?(l=2*Math.sqrt(1+u-p-b),a[3]=(c-x)/l,a[0]=.25*l,a[1]=(h+i)/l,a[2]=(f+M)/l):p>b?(l=2*Math.sqrt(1+p-u-b),a[3]=(f-M)/l,a[0]=(h+i)/l,a[1]=.25*l,a[2]=(c+x)/l):(l=2*Math.sqrt(1+b-u-p),a[3]=(h-i)/l,a[0]=(f+M)/l,a[1]=(c+x)/l,a[2]=.25*l),a}function Y(t,a,r,n){var e=a[0],o=a[1],s=a[2],u=a[3],h=e+e,M=o+o,i=s+s,p=e*h,c=e*M,f=e*i,x=o*M,b=o*i,v=s*i,l=u*h,m=u*M,P=u*i,O=n[0],E=n[1],S=n[2];return t[0]=(1-(x+v))*O,t[1]=(c+P)*O,t[2]=(f-m)*O,t[3]=0,t[4]=(c-P)*E,t[5]=(1-(p+v))*E,t[6]=(b+l)*E,t[7]=0,t[8]=(f+m)*S,t[9]=(b-l)*S,t[10]=(1-(p+x))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function w(t,a,r,n,e){var o=a[0],s=a[1],u=a[2],h=a[3],M=o+o,i=s+s,p=u+u,c=o*M,f=o*i,x=o*p,b=s*i,v=s*p,l=u*p,m=h*M,P=h*i,O=h*p,E=n[0],S=n[1],y=n[2],I=e[0],N=e[1],d=e[2],L=(1-(b+l))*E,R=(f+O)*E,g=(x-P)*E,A=(f-O)*S,Y=(1-(c+l))*S,w=(v+m)*S,T=(x+P)*y,_=(v-m)*y,j=(1-(c+b))*y;return t[0]=L,t[1]=R,t[2]=g,t[3]=0,t[4]=A,t[5]=Y,t[6]=w,t[7]=0,t[8]=T,t[9]=_,t[10]=j,t[11]=0,t[12]=r[0]+I-(L*I+A*N+T*d),t[13]=r[1]+N-(R*I+Y*N+_*d),t[14]=r[2]+d-(g*I+w*N+j*d),t[15]=1,t}function T(t,a){var r=a[0],n=a[1],e=a[2],o=a[3],s=r+r,u=n+n,h=e+e,M=r*s,i=n*s,p=n*u,c=e*s,f=e*u,x=e*h,b=o*s,v=o*u,l=o*h;return t[0]=1-p-x,t[1]=i+l,t[2]=c-v,t[3]=0,t[4]=i-l,t[5]=1-M-x,t[6]=f+b,t[7]=0,t[8]=c+v,t[9]=f-b,t[10]=1-M-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,a,r,n,e,o,s){var u=1/(r-a),h=1/(e-n),M=1/(o-s);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*h,t[6]=0,t[7]=0,t[8]=(r+a)*u,t[9]=(e+n)*h,t[10]=(s+o)*M,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*M,t[15]=0,t}function j(t,a,r,n,e){var o,s=1/Math.tan(a/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0?(o=1/(n-e),t[10]=(e+n)*o,t[14]=2*e*n*o):(t[10]=-1,t[14]=-2*n),t}var q=j;function D(t,a,r,n,e){var o,s=1/Math.tan(a/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0?(o=1/(n-e),t[10]=e*o,t[14]=e*n*o):(t[10]=-1,t[14]=-n),t}function k(t,a,r,n){var e=Math.tan(a.upDegrees*Math.PI/180),o=Math.tan(a.downDegrees*Math.PI/180),s=Math.tan(a.leftDegrees*Math.PI/180),u=Math.tan(a.rightDegrees*Math.PI/180),h=2/(s+u),M=2/(e+o);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=M,t[6]=0,t[7]=0,t[8]=-(s-u)*h*.5,t[9]=(e-o)*M*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Z(t,a,r,n,e,o,s){var u=1/(a-r),h=1/(n-e),M=1/(o-s);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*M,t[11]=0,t[12]=(a+r)*u,t[13]=(e+n)*h,t[14]=(s+o)*M,t[15]=1,t}exports.perspective=q;var F=Z;function W(t,a,r,n,e,o,s){var u=1/(a-r),h=1/(n-e),M=1/(o-s);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=M,t[11]=0,t[12]=(a+r)*u,t[13]=(e+n)*h,t[14]=o*M,t[15]=1,t}function Q(a,r,n,e){var o,s,u,M,i,p,c,f,x,b,v=r[0],l=r[1],m=r[2],P=e[0],O=e[1],E=e[2],S=n[0],y=n[1],I=n[2];return Math.abs(v-S)<t.EPSILON&&Math.abs(l-y)<t.EPSILON&&Math.abs(m-I)<t.EPSILON?h(a):(c=v-S,f=l-y,x=m-I,o=O*(x*=b=1/Math.hypot(c,f,x))-E*(f*=b),s=E*(c*=b)-P*x,u=P*f-O*c,(b=Math.hypot(o,s,u))?(o*=b=1/b,s*=b,u*=b):(o=0,s=0,u=0),M=f*u-x*s,i=x*o-c*u,p=c*s-f*o,(b=Math.hypot(M,i,p))?(M*=b=1/b,i*=b,p*=b):(M=0,i=0,p=0),a[0]=o,a[1]=M,a[2]=c,a[3]=0,a[4]=s,a[5]=i,a[6]=f,a[7]=0,a[8]=u,a[9]=p,a[10]=x,a[11]=0,a[12]=-(o*v+s*l+u*m),a[13]=-(M*v+i*l+p*m),a[14]=-(c*v+f*l+x*m),a[15]=1,a)}function V(t,a,r,n){var e=a[0],o=a[1],s=a[2],u=n[0],h=n[1],M=n[2],i=e-r[0],p=o-r[1],c=s-r[2],f=i*i+p*p+c*c;f>0&&(i*=f=1/Math.sqrt(f),p*=f,c*=f);var x=h*c-M*p,b=M*i-u*c,v=u*p-h*i;return(f=x*x+b*b+v*v)>0&&(x*=f=1/Math.sqrt(f),b*=f,v*=f),t[0]=x,t[1]=b,t[2]=v,t[3]=0,t[4]=p*v-c*b,t[5]=c*x-i*v,t[6]=i*b-p*x,t[7]=0,t[8]=i,t[9]=p,t[10]=c,t[11]=0,t[12]=e,t[13]=o,t[14]=s,t[15]=1,t}function X(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function z(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function B(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t[4]=a[4]+r[4],t[5]=a[5]+r[5],t[6]=a[6]+r[6],t[7]=a[7]+r[7],t[8]=a[8]+r[8],t[9]=a[9]+r[9],t[10]=a[10]+r[10],t[11]=a[11]+r[11],t[12]=a[12]+r[12],t[13]=a[13]+r[13],t[14]=a[14]+r[14],t[15]=a[15]+r[15],t}function C(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t[4]=a[4]-r[4],t[5]=a[5]-r[5],t[6]=a[6]-r[6],t[7]=a[7]-r[7],t[8]=a[8]-r[8],t[9]=a[9]-r[9],t[10]=a[10]-r[10],t[11]=a[11]-r[11],t[12]=a[12]-r[12],t[13]=a[13]-r[13],t[14]=a[14]-r[14],t[15]=a[15]-r[15],t}function G(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t[4]=a[4]*r,t[5]=a[5]*r,t[6]=a[6]*r,t[7]=a[7]*r,t[8]=a[8]*r,t[9]=a[9]*r,t[10]=a[10]*r,t[11]=a[11]*r,t[12]=a[12]*r,t[13]=a[13]*r,t[14]=a[14]*r,t[15]=a[15]*r,t}function H(t,a,r,n){return t[0]=a[0]+r[0]*n,t[1]=a[1]+r[1]*n,t[2]=a[2]+r[2]*n,t[3]=a[3]+r[3]*n,t[4]=a[4]+r[4]*n,t[5]=a[5]+r[5]*n,t[6]=a[6]+r[6]*n,t[7]=a[7]+r[7]*n,t[8]=a[8]+r[8]*n,t[9]=a[9]+r[9]*n,t[10]=a[10]+r[10]*n,t[11]=a[11]+r[11]*n,t[12]=a[12]+r[12]*n,t[13]=a[13]+r[13]*n,t[14]=a[14]+r[14]*n,t[15]=a[15]+r[15]*n,t}function J(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]}function K(a,r){var n=a[0],e=a[1],o=a[2],s=a[3],u=a[4],h=a[5],M=a[6],i=a[7],p=a[8],c=a[9],f=a[10],x=a[11],b=a[12],v=a[13],l=a[14],m=a[15],P=r[0],O=r[1],E=r[2],S=r[3],y=r[4],I=r[5],N=r[6],d=r[7],L=r[8],R=r[9],g=r[10],A=r[11],Y=r[12],w=r[13],T=r[14],_=r[15];return Math.abs(n-P)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(P))&&Math.abs(e-O)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(O))&&Math.abs(o-E)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(s-S)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-y)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-I)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(M-N)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(N))&&Math.abs(i-d)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(p-L)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(c-R)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(f-g)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(g))&&Math.abs(x-A)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(A))&&Math.abs(b-Y)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(Y))&&Math.abs(v-w)<=t.EPSILON*Math.max(1,Math.abs(v),Math.abs(w))&&Math.abs(l-T)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(m-_)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(_))}exports.ortho=F;var U=f;exports.mul=U;var $=C;exports.sub=$;
},{"./common.js":"XJqx"}],"zWbG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=i,exports.ceil=x,exports.clone=o,exports.copy=u,exports.create=n,exports.cross=w,exports.dist=void 0,exports.distance=b,exports.div=void 0,exports.divide=f,exports.dot=E,exports.equals=I,exports.exactEquals=L,exports.floor=h,exports.forEach=void 0,exports.fromValues=a,exports.inverse=R,exports.len=void 0,exports.length=y,exports.lerp=g,exports.max=l,exports.min=M,exports.mul=void 0,exports.multiply=c,exports.negate=P,exports.normalize=q,exports.random=D,exports.round=v,exports.scale=d,exports.scaleAndAdd=m,exports.set=s,exports.sqrLen=exports.sqrDist=void 0,exports.squaredDistance=O,exports.squaredLength=A,exports.str=_,exports.sub=void 0,exports.subtract=p,exports.transformMat4=j,exports.transformQuat=N,exports.zero=Y;var t=e(require("./common.js"));function r(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(r=function(t){return t?n:e})(t)}function e(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=r(e);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var s=a?Object.getOwnPropertyDescriptor(t,u):null;s&&(s.get||s.set)?Object.defineProperty(o,u,s):o[u]=t[u]}return o.default=t,n&&n.set(t,o),o}function n(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function o(r){var e=new t.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function a(r,e,n,o){var a=new t.ARRAY_TYPE(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=o,a}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function s(t,r,e,n,o){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t}function i(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function p(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t}function c(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t[3]=r[3]*e[3],t}function f(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t[3]=r[3]/e[3],t}function x(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t[3]=Math.ceil(r[3]),t}function h(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t[3]=Math.floor(r[3]),t}function M(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t[3]=Math.min(r[3],e[3]),t}function l(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t[3]=Math.max(r[3],e[3]),t}function v(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t[3]=Math.round(r[3]),t}function d(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function m(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return Math.hypot(e,n,o,a)}function O(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return e*e+n*n+o*o+a*a}function y(t){var r=t[0],e=t[1],n=t[2],o=t[3];return Math.hypot(r,e,n,o)}function A(t){var r=t[0],e=t[1],n=t[2],o=t[3];return r*r+e*e+n*n+o*o}function P(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function R(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t[3]=1/r[3],t}function q(t,r){var e=r[0],n=r[1],o=r[2],a=r[3],u=e*e+n*n+o*o+a*a;return u>0&&(u=1/Math.sqrt(u)),t[0]=e*u,t[1]=n*u,t[2]=o*u,t[3]=a*u,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]}function w(t,r,e,n){var o=e[0]*n[1]-e[1]*n[0],a=e[0]*n[2]-e[2]*n[0],u=e[0]*n[3]-e[3]*n[0],s=e[1]*n[2]-e[2]*n[1],i=e[1]*n[3]-e[3]*n[1],p=e[2]*n[3]-e[3]*n[2],c=r[0],f=r[1],x=r[2],h=r[3];return t[0]=f*p-x*i+h*s,t[1]=-c*p+x*u-h*a,t[2]=c*i-f*u+h*o,t[3]=-c*s+f*a-x*o,t}function g(t,r,e,n){var o=r[0],a=r[1],u=r[2],s=r[3];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=u+n*(e[2]-u),t[3]=s+n*(e[3]-s),t}function D(r,e){var n,o,a,u,s,i;e=e||1;do{s=(n=2*t.RANDOM()-1)*n+(o=2*t.RANDOM()-1)*o}while(s>=1);do{i=(a=2*t.RANDOM()-1)*a+(u=2*t.RANDOM()-1)*u}while(i>=1);var p=Math.sqrt((1-s)/i);return r[0]=e*n,r[1]=e*o,r[2]=e*a*p,r[3]=e*u*p,r}function j(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3];return t[0]=e[0]*n+e[4]*o+e[8]*a+e[12]*u,t[1]=e[1]*n+e[5]*o+e[9]*a+e[13]*u,t[2]=e[2]*n+e[6]*o+e[10]*a+e[14]*u,t[3]=e[3]*n+e[7]*o+e[11]*a+e[15]*u,t}function N(t,r,e){var n=r[0],o=r[1],a=r[2],u=e[0],s=e[1],i=e[2],p=e[3],c=p*n+s*a-i*o,f=p*o+i*n-u*a,x=p*a+u*o-s*n,h=-u*n-s*o-i*a;return t[0]=c*p+h*-u+f*-i-x*-s,t[1]=f*p+h*-s+x*-u-c*-i,t[2]=x*p+h*-i+c*-s-f*-u,t[3]=r[3],t}function Y(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function _(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function L(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function I(r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],p=e[2],c=e[3];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-i)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-p)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(u-c)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(c))}var S=p;exports.sub=S;var T=c;exports.mul=T;var k=f;exports.div=k;var W=b;exports.dist=W;var z=O;exports.sqrDist=z;var F=y;exports.len=F;var Q=A;exports.sqrLen=Q;var V=function(){var t=n();return function(r,e,n,o,a,u){var s,i;for(e||(e=4),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,s=n;s<i;s+=e)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],t[3]=r[s+3],a(t,t,u),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2],r[s+3]=t[3];return r}}();exports.forEach=V;
},{"./common.js":"XJqx"}],"of13":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t,r=u(require("./base/matrix")),e=require("../lib/validators"),s=require("../lib/gl-matrix-extras"),i=c(require("gl-matrix/mat4")),h=c(require("gl-matrix/vec2")),n=c(require("gl-matrix/vec3")),o=c(require("gl-matrix/vec4"));function a(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,e=new WeakMap;return(a=function(t){return t?e:r})(t)}function c(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a(r);if(e&&e.has(t))return e.get(t);var s={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in t)if("default"!==h&&Object.prototype.hasOwnProperty.call(t,h)){var n=i?Object.getOwnPropertyDescriptor(t,h):null;n&&(n.get||n.set)?Object.defineProperty(s,h,n):s[h]=t[h]}return s.default=t,e&&e.set(t,s),s}function u(t){return t&&t.__esModule?t:{default:t}}!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(t||(t={}));const O=45*Math.PI/180,l=1,f=.1,p=500,R=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class m extends r.default{static get IDENTITY(){return k()}static get ZERO(){return g()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return t}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,e,s,i,h,n,o,a,c,u,O,l,f,p,R){return this[0]=t,this[1]=r,this[2]=e,this[3]=s,this[4]=i,this[5]=h,this[6]=n,this[7]=o,this[8]=a,this[9]=c,this[10]=u,this[11]=O,this[12]=l,this[13]=f,this[14]=p,this[15]=R,this.check()}setRowMajor(t,r,e,s,i,h,n,o,a,c,u,O,l,f,p,R){return this[0]=t,this[1]=i,this[2]=a,this[3]=l,this[4]=r,this[5]=h,this[6]=c,this[7]=f,this[8]=e,this[9]=n,this[10]=u,this[11]=p,this[12]=s,this[13]=o,this[14]=O,this[15]=R,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(R)}fromObject(t){return this.check()}fromQuaternion(t){return i.fromQuat(this,t),this.check()}frustum(t){const{left:r,right:e,bottom:s,top:h,near:n=f,far:o=p}=t;return o===1/0?y(this,r,e,s,h,n):i.frustum(this,r,e,s,h,n,o),this.check()}lookAt(t){const{eye:r,center:e=[0,0,0],up:s=[0,1,0]}=t;return i.lookAt(this,r,e,s),this.check()}ortho(t){const{left:r,right:e,bottom:s,top:h,near:n=f,far:o=p}=t;return i.ortho(this,r,e,s,h,n,o),this.check()}orthographic(t){const{fovy:r=O,aspect:e=l,focalDistance:s=1,near:i=f,far:h=p}=t;C(r);const n=r/2,o=s*Math.tan(n),a=o*e;return this.ortho({left:-a,right:a,bottom:-o,top:o,near:i,far:h})}perspective(t){const{fovy:r=45*Math.PI/180,aspect:e=1,near:s=.1,far:h=500}=t;return C(r),i.perspective(this,r,e,s,h),this.check()}determinant(){return i.determinant(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const e=this.getScale(r),s=1/e[0],i=1/e[1],h=1/e[2];return t[0]=this[0]*s,t[1]=this[1]*i,t[2]=this[2]*h,t[3]=0,t[4]=this[4]*s,t[5]=this[5]*i,t[6]=this[6]*h,t[7]=0,t[8]=this[8]*s,t[9]=this[9]*i,t[10]=this[10]*h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const e=this.getScale(r),s=1/e[0],i=1/e[1],h=1/e[2];return t[0]=this[0]*s,t[1]=this[1]*i,t[2]=this[2]*h,t[3]=this[4]*s,t[4]=this[5]*i,t[5]=this[6]*h,t[6]=this[8]*s,t[7]=this[9]*i,t[8]=this[10]*h,t}transpose(){return i.transpose(this,this),this.check()}invert(){return i.invert(this,this),this.check()}multiplyLeft(t){return i.multiply(this,t,this),this.check()}multiplyRight(t){return i.multiply(this,this,t),this.check()}rotateX(t){return i.rotateX(this,this,t),this.check()}rotateY(t){return i.rotateY(this,this,t),this.check()}rotateZ(t){return i.rotateZ(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return i.rotate(this,this,t,r),this.check()}scale(t){return i.scale(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return i.translate(this,this,t),this.check()}transform(t,r){return 4===t.length?(r=o.transformMat4(r||[-0,-0,-0,-0],t,this),(0,e.checkVector)(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){const{length:s}=t;let i;switch(s){case 2:i=h.transformMat4(r||[-0,-0],t,this);break;case 3:i=n.transformMat4(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,e.checkVector)(i,t.length),i}transformAsVector(t,r){let i;switch(t.length){case 2:i=(0,s.vec2_transformMat4AsVector)(r||[-0,-0],t,this);break;case 3:i=(0,s.vec3_transformMat4AsVector)(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,e.checkVector)(i,t.length),i}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,e){return this.identity().translate([t,r,e])}}let W,L;function g(){return W||(W=new m([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(W)),W}function k(){return L||(L=new m,Object.freeze(L)),L}function C(t){if(t>2*Math.PI)throw Error("expected radians")}function y(t,r,e,s,i,h){const n=2*h/(e-r),o=2*h/(i-s),a=(e+r)/(e-r),c=(i+s)/(i-s),u=-2*h;return t[0]=n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=a,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0,t}exports.default=m;
},{"./base/matrix":"rnPl","../lib/validators":"imS9","../lib/gl-matrix-extras":"q1wk","gl-matrix/mat4":"w3aR","gl-matrix/vec2":"XSo1","gl-matrix/vec3":"AWBd","gl-matrix/vec4":"zWbG"}],"KdRW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=void 0,exports.calculateW=M,exports.clone=void 0,exports.conjugate=P,exports.copy=void 0,exports.create=s,exports.exactEquals=exports.equals=exports.dot=void 0,exports.exp=h,exports.fromEuler=O,exports.fromMat3=A,exports.fromValues=void 0,exports.getAngle=c,exports.getAxisAngle=i,exports.identity=u,exports.invert=y,exports.lerp=exports.length=exports.len=void 0,exports.ln=d,exports.mul=void 0,exports.multiply=x,exports.normalize=void 0,exports.pow=q,exports.random=g,exports.rotateX=v,exports.rotateY=l,exports.rotateZ=f,exports.setAxes=exports.set=exports.scale=exports.rotationTo=void 0,exports.setAxisAngle=p,exports.slerp=m,exports.squaredLength=exports.sqrLen=exports.sqlerp=void 0,exports.str=j;var t=n(require("./common.js")),r=n(require("./mat3.js")),e=n(require("./vec3.js")),o=n(require("./vec4.js"));function a(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,e=new WeakMap;return(a=function(t){return t?e:r})(t)}function n(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a(r);if(e&&e.has(t))return e.get(t);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=n?Object.getOwnPropertyDescriptor(t,s):null;u&&(u.get||u.set)?Object.defineProperty(o,s,u):o[s]=t[s]}return o.default=t,e&&e.set(t,o),o}function s(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function u(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function p(t,r,e){e*=.5;var o=Math.sin(e);return t[0]=o*r[0],t[1]=o*r[1],t[2]=o*r[2],t[3]=Math.cos(e),t}function i(r,e){var o=2*Math.acos(e[3]),a=Math.sin(o/2);return a>t.EPSILON?(r[0]=e[0]/a,r[1]=e[1]/a,r[2]=e[2]/a):(r[0]=1,r[1]=0,r[2]=0),o}function c(t,r){var e=D(t,r);return Math.acos(2*e*e-1)}function x(t,r,e){var o=r[0],a=r[1],n=r[2],s=r[3],u=e[0],p=e[1],i=e[2],c=e[3];return t[0]=o*c+s*u+a*i-n*p,t[1]=a*c+s*p+n*u-o*i,t[2]=n*c+s*i+o*p-a*u,t[3]=s*c-o*u-a*p-n*i,t}function v(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p+s*u,t[1]=a*p+n*u,t[2]=n*p-a*u,t[3]=s*p-o*u,t}function l(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p-n*u,t[1]=a*p+s*u,t[2]=n*p+o*u,t[3]=s*p-a*u,t}function f(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p+a*u,t[1]=a*p-o*u,t[2]=n*p+s*u,t[3]=s*p-n*u,t}function M(t,r){var e=r[0],o=r[1],a=r[2];return t[0]=e,t[1]=o,t[2]=a,t[3]=Math.sqrt(Math.abs(1-e*e-o*o-a*a)),t}function h(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=Math.sqrt(e*e+o*o+a*a),u=Math.exp(n),p=s>0?u*Math.sin(s)/s:0;return t[0]=e*p,t[1]=o*p,t[2]=a*p,t[3]=u*Math.cos(s),t}function d(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=Math.sqrt(e*e+o*o+a*a),u=s>0?Math.atan2(s,n)/s:0;return t[0]=e*u,t[1]=o*u,t[2]=a*u,t[3]=.5*Math.log(e*e+o*o+a*a+n*n),t}function q(t,r,e){return d(t,r),_(t,t,e),h(t,t),t}function m(r,e,o,a){var n,s,u,p,i,c=e[0],x=e[1],v=e[2],l=e[3],f=o[0],M=o[1],h=o[2],d=o[3];return(s=c*f+x*M+v*h+l*d)<0&&(s=-s,f=-f,M=-M,h=-h,d=-d),1-s>t.EPSILON?(n=Math.acos(s),u=Math.sin(n),p=Math.sin((1-a)*n)/u,i=Math.sin(a*n)/u):(p=1-a,i=a),r[0]=p*c+i*f,r[1]=p*x+i*M,r[2]=p*v+i*h,r[3]=p*l+i*d,r}function g(r){var e=t.RANDOM(),o=t.RANDOM(),a=t.RANDOM(),n=Math.sqrt(1-e),s=Math.sqrt(e);return r[0]=n*Math.sin(2*Math.PI*o),r[1]=n*Math.cos(2*Math.PI*o),r[2]=s*Math.sin(2*Math.PI*a),r[3]=s*Math.cos(2*Math.PI*a),r}function y(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=e*e+o*o+a*a+n*n,u=s?1/s:0;return t[0]=-e*u,t[1]=-o*u,t[2]=-a*u,t[3]=n*u,t}function P(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t}function A(t,r){var e,o=r[0]+r[4]+r[8];if(o>0)e=Math.sqrt(o+1),t[3]=.5*e,e=.5/e,t[0]=(r[5]-r[7])*e,t[1]=(r[6]-r[2])*e,t[2]=(r[1]-r[3])*e;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[3*a+a]&&(a=2);var n=(a+1)%3,s=(a+2)%3;e=Math.sqrt(r[3*a+a]-r[3*n+n]-r[3*s+s]+1),t[a]=.5*e,e=.5/e,t[3]=(r[3*n+s]-r[3*s+n])*e,t[n]=(r[3*n+a]+r[3*a+n])*e,t[s]=(r[3*s+a]+r[3*a+s])*e}return t}function O(t,r,e,o){var a=.5*Math.PI/180;r*=a,e*=a,o*=a;var n=Math.sin(r),s=Math.cos(r),u=Math.sin(e),p=Math.cos(e),i=Math.sin(o),c=Math.cos(o);return t[0]=n*p*c-s*u*i,t[1]=s*u*c+n*p*i,t[2]=s*p*i-n*u*c,t[3]=s*p*c+n*u*i,t}function j(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var b=o.clone;exports.clone=b;var E=o.fromValues;exports.fromValues=E;var I=o.copy;exports.copy=I;var w=o.set;exports.set=w;var L=o.add;exports.add=L;var R=x;exports.mul=R;var _=o.scale;exports.scale=_;var D=o.dot;exports.dot=D;var N=o.lerp;exports.lerp=N;var V=o.length;exports.length=V;var Y=V;exports.len=Y;var z=o.squaredLength;exports.squaredLength=z;var T=z;exports.sqrLen=T;var W=o.normalize;exports.normalize=W;var k=o.exactEquals;exports.exactEquals=k;var S=o.equals;exports.equals=S;var F=function(){var t=e.create(),r=e.fromValues(1,0,0),o=e.fromValues(0,1,0);return function(a,n,s){var u=e.dot(n,s);return u<-.999999?(e.cross(t,r,n),e.len(t)<1e-6&&e.cross(t,o,n),e.normalize(t,t),p(a,t,Math.PI),a):u>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(e.cross(t,n,s),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+u,W(a,a))}}();exports.rotationTo=F;var X=function(){var t=s(),r=s();return function(e,o,a,n,s,u){return m(t,o,s,u),m(r,a,n,u),m(e,t,r,2*u*(1-u)),e}}();exports.sqlerp=X;var Z=function(){var t=r.create();return function(r,e,o,a){return t[0]=o[0],t[3]=o[1],t[6]=o[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],W(r,A(r,t))}}();exports.setAxes=Z;
},{"./common.js":"XJqx","./mat3.js":"vtQf","./vec3.js":"AWBd","./vec4.js":"zWbG"}],"T1TH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=u(require("./base/math-array")),e=require("../lib/validators"),r=u(require("./vector4")),i=n(require("gl-matrix/quat")),s=n(require("gl-matrix/vec4"));function h(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(h=function(t){return t?r:e})(t)}function n(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=h(e);if(r&&r.has(t))return r.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if("default"!==n&&Object.prototype.hasOwnProperty.call(t,n)){var u=s?Object.getOwnPropertyDescriptor(t,n):null;u&&(u.get||u.set)?Object.defineProperty(i,n,u):i[n]=t[n]}return i.default=t,r&&r.set(t,i),i}function u(t){return t&&t.__esModule?t:{default:t}}const c=[0,0,0,1];class a extends t.default{constructor(t=0,e=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,r,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,r,i){return this[0]=t,this[1]=e,this[2]=r,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return i.fromMat3(this,t),this.check()}fromAxisRotation(t,e){return i.setAxisAngle(this,t,e),this.check()}identity(){return i.identity(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=(0,e.checkNumber)(t)}get y(){return this[1]}set y(t){this[1]=(0,e.checkNumber)(t)}get z(){return this[2]}set z(t){this[2]=(0,e.checkNumber)(t)}get w(){return this[3]}set w(t){this[3]=(0,e.checkNumber)(t)}len(){return i.length(this)}lengthSquared(){return i.squaredLength(this)}dot(t){return i.dot(this,t)}rotationTo(t,e){return i.rotationTo(this,t,e),this.check()}add(t){return i.add(this,this,t),this.check()}calculateW(){return i.calculateW(this,this),this.check()}conjugate(){return i.conjugate(this,this),this.check()}invert(){return i.invert(this,this),this.check()}lerp(t,e,r){return void 0===r?this.lerp(this,t,e):(i.lerp(this,t,e,r),this.check())}multiplyRight(t){return i.multiply(this,this,t),this.check()}multiplyLeft(t){return i.multiply(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return i.rotateX(this,this,t),this.check()}rotateY(t){return i.rotateY(this,this,t),this.check()}rotateZ(t){return i.rotateZ(this,this,t),this.check()}scale(t){return i.scale(this,this,t),this.check()}slerp(t,e,r){let s,h,n;switch(arguments.length){case 1:({start:s=c,target:h,ratio:n}=t);break;case 2:s=this,h=t,n=e;break;default:s=t,h=e,n=r}return i.slerp(this,s,h,n),this.check()}transformVector4(t,i=new r.default){return s.transformQuat(i,t,this),(0,e.checkVector)(i,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}exports.default=a;
},{"./base/math-array":"cPa0","../lib/validators":"imS9","./vector4":"T9bv","gl-matrix/quat":"KdRW","gl-matrix/vec4":"zWbG"}],"xqJO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=h(require("@babel/runtime/helpers/esm/defineProperty")),e=h(require("./vector3")),i=require("../lib/common"),r=a(require("gl-matrix/vec3"));function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(s=function(t){return t?i:e})(t)}function a(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var i=s(e);if(i&&i.has(t))return i.get(t);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in t)if("default"!==h&&Object.prototype.hasOwnProperty.call(t,h)){var u=a?Object.getOwnPropertyDescriptor(t,h):null;u&&(u.get||u.set)?Object.defineProperty(r,h,u):r[h]=t[h]}return r.default=t,i&&i.set(t,r),r}function h(t){return t&&t.__esModule?t:{default:t}}const u=1e-6,n=6371e3;class o{constructor({phi:e=0,theta:i=0,radius:r=1,bearing:s,pitch:a,altitude:h,radiusScale:u=n}={}){(0,t.default)(this,"phi",void 0),(0,t.default)(this,"theta",void 0),(0,t.default)(this,"radius",void 0),(0,t.default)(this,"radiusScale",void 0),this.phi=e,this.theta=i,this.radius=r||h||1,this.radiusScale=u||1,void 0!==s&&(this.bearing=s),void 0!==a&&(this.pitch=a),this.check()}toString(){return this.formatString(i.config)}formatString({printTypes:t=!1}){const e=i.formatValue;return"".concat(t?"Spherical":"","[rho:").concat(e(this.radius),",theta:").concat(e(this.theta),",phi:").concat(e(this.phi),"]")}equals(t){return(0,i.equals)(this.radius,t.radius)&&(0,i.equals)(this.theta,t.theta)&&(0,i.equals)(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-(0,i.degrees)(this.phi)}set bearing(t){this.phi=Math.PI-(0,i.radians)(t)}get pitch(){return(0,i.degrees)(this.theta)}set pitch(t){this.theta=(0,i.radians)(t)}get longitude(){return(0,i.degrees)(this.phi)}get latitude(){return(0,i.degrees)(this.theta)}get lng(){return(0,i.degrees)(this.phi)}get lat(){return(0,i.degrees)(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this.check()}clone(){return(new o).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,r]){return this.radius=1+r/this.radiusScale,this.phi=(0,i.radians)(e),this.theta=(0,i.radians)(t),this.check()}fromVector3(t){return this.radius=r.length(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos((0,i.clamp)(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new e.default(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(u,Math.min(Math.PI-u,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}exports.default=o;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./vector3":"WGSx","../lib/common":"wKVf","gl-matrix/vec3":"AWBd"}],"t6Su":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=a(require("./base/math-array")),e=a(require("./quaternion")),r=require("../lib/common"),s=require("../lib/validators");function a(t){return t&&t.__esModule?t:{default:t}}const i="Unknown Euler angle order",h=.99999;var n;!function(t){t[t.ZYX=0]="ZYX",t[t.YXZ=1]="YXZ",t[t.XZY=2]="XZY",t[t.ZXY=3]="ZXY",t[t.YZX=4]="YZX",t[t.XYZ=5]="XYZ"}(n||(n={}));class o extends t.default{static get ZYX(){return n.ZYX}static get YXZ(){return n.YXZ}static get XZY(){return n.XZY}static get ZXY(){return n.ZXY}static get YZX(){return n.YZX}static get XYZ(){return n.XYZ}static get RollPitchYaw(){return n.ZYX}static get DefaultOrder(){return n.ZYX}static get RotationOrders(){return n}static rotationOrder(t){return n[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,r=0,s=o.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,r,s)}fromQuaternion(t){const[e,r,s,a]=t,i=r*r,h=-2*(i+s*s)+1,n=2*(e*r+a*s);let c=-2*(e*s-a*r);const u=2*(r*s+a*e),M=-2*(e*e+i)+1;c=(c=c>1?1:c)<-1?-1:c;const Y=Math.atan2(u,M),X=Math.asin(c),Z=Math.atan2(n,h);return this.set(Y,X,Z,o.RollPitchYaw)}fromObject(t){throw new Error("not implemented")}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,r=0,s){return this[0]=t,this[1]=e,this[2]=r,this[3]=Number.isFinite(s)?s:this[3],this.check()}validate(){return c(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=(0,s.checkNumber)(t)}get y(){return this[1]}set y(t){this[1]=(0,s.checkNumber)(t)}get z(){return this[2]}set z(t){this[2]=(0,s.checkNumber)(t)}get alpha(){return this[0]}set alpha(t){this[0]=(0,s.checkNumber)(t)}get beta(){return this[1]}set beta(t){this[1]=(0,s.checkNumber)(t)}get gamma(){return this[2]}set gamma(t){this[2]=(0,s.checkNumber)(t)}get phi(){return this[0]}set phi(t){this[0]=(0,s.checkNumber)(t)}get theta(){return this[1]}set theta(t){this[1]=(0,s.checkNumber)(t)}get psi(){return this[2]}set psi(t){this[2]=(0,s.checkNumber)(t)}get roll(){return this[0]}set roll(t){this[0]=(0,s.checkNumber)(t)}get pitch(){return this[1]}set pitch(t){this[1]=(0,s.checkNumber)(t)}get yaw(){return this[2]}set yaw(t){this[2]=(0,s.checkNumber)(t)}get order(){return this[3]}set order(t){this[3]=u(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,r){return this.set(t,e,r,n.ZYX)}fromRotationMatrix(t,e=o.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new e.default;switch(this[4]){case n.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case n.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case n.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case n.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case n.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case n.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(i)}}_fromRotationMatrix(t,e=o.DefaultOrder){const s=t[0],a=t[4],n=t[8],c=t[1],u=t[5],M=t[9],Y=t[2],X=t[6],Z=t[10];switch(e=e||this[3]){case o.XYZ:this[1]=Math.asin((0,r.clamp)(n,-1,1)),Math.abs(n)<h?(this[0]=Math.atan2(-M,Z),this[2]=Math.atan2(-a,s)):(this[0]=Math.atan2(X,u),this[2]=0);break;case o.YXZ:this[0]=Math.asin(-(0,r.clamp)(M,-1,1)),Math.abs(M)<h?(this[1]=Math.atan2(n,Z),this[2]=Math.atan2(c,u)):(this[1]=Math.atan2(-Y,s),this[2]=0);break;case o.ZXY:this[0]=Math.asin((0,r.clamp)(X,-1,1)),Math.abs(X)<h?(this[1]=Math.atan2(-Y,Z),this[2]=Math.atan2(-a,u)):(this[1]=0,this[2]=Math.atan2(c,s));break;case o.ZYX:this[1]=Math.asin(-(0,r.clamp)(Y,-1,1)),Math.abs(Y)<h?(this[0]=Math.atan2(X,Z),this[2]=Math.atan2(c,s)):(this[0]=0,this[2]=Math.atan2(-a,u));break;case o.YZX:this[2]=Math.asin((0,r.clamp)(c,-1,1)),Math.abs(c)<h?(this[0]=Math.atan2(-M,u),this[1]=Math.atan2(-Y,s)):(this[0]=0,this[1]=Math.atan2(n,Z));break;case o.XZY:this[2]=Math.asin(-(0,r.clamp)(a,-1,1)),Math.abs(a)<h?(this[0]=Math.atan2(X,u),this[1]=Math.atan2(n,s)):(this[0]=Math.atan2(-M,Z),this[1]=0);break;default:throw new Error(i)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=this.x,s=this.y,a=this.z,h=Math.cos(r),n=Math.cos(s),c=Math.cos(a),u=Math.sin(r),M=Math.sin(s),Y=Math.sin(a);switch(this[3]){case o.XYZ:{const t=h*c,r=h*Y,s=u*c,a=u*Y;e[0]=n*c,e[4]=-n*Y,e[8]=M,e[1]=r+s*M,e[5]=t-a*M,e[9]=-u*n,e[2]=a-t*M,e[6]=s+r*M,e[10]=h*n;break}case o.YXZ:{const t=n*c,r=n*Y,s=M*c,a=M*Y;e[0]=t+a*u,e[4]=s*u-r,e[8]=h*M,e[1]=h*Y,e[5]=h*c,e[9]=-u,e[2]=r*u-s,e[6]=a+t*u,e[10]=h*n;break}case o.ZXY:{const t=n*c,r=n*Y,s=M*c,a=M*Y;e[0]=t-a*u,e[4]=-h*Y,e[8]=s+r*u,e[1]=r+s*u,e[5]=h*c,e[9]=a-t*u,e[2]=-h*M,e[6]=u,e[10]=h*n;break}case o.ZYX:{const t=h*c,r=h*Y,s=u*c,a=u*Y;e[0]=n*c,e[4]=s*M-r,e[8]=t*M+a,e[1]=n*Y,e[5]=a*M+t,e[9]=r*M-s,e[2]=-M,e[6]=u*n,e[10]=h*n;break}case o.YZX:{const t=h*n,r=h*M,s=u*n,a=u*M;e[0]=n*c,e[4]=a-t*Y,e[8]=s*Y+r,e[1]=Y,e[5]=h*c,e[9]=-u*c,e[2]=-M*c,e[6]=r*Y+s,e[10]=t-a*Y;break}case o.XZY:{const t=h*n,r=h*M,s=u*n,a=u*M;e[0]=n*c,e[4]=-Y,e[8]=M*c,e[1]=t*Y+a,e[5]=h*c,e[9]=r*Y-s,e[2]=s*Y-r,e[6]=u*c,e[10]=a*Y+t;break}default:throw new Error(i)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),r=Math.sin(.5*this.yaw),s=Math.cos(.5*this.roll),a=Math.sin(.5*this.roll),i=Math.cos(.5*this.pitch),h=Math.sin(.5*this.pitch),n=t*s*i+r*a*h,o=t*a*i-r*s*h,c=t*s*h+r*a*i,u=r*s*i-t*a*h;return new e.default(o,c,u,n)}}function c(t){return t>=0&&t<6}function u(t){if(t<0&&t>=6)throw new Error(i);return t}exports.default=o;
},{"./base/math-array":"cPa0","./quaternion":"T1TH","../lib/common":"wKVf","../lib/validators":"imS9"}],"m8sA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("@babel/runtime/helpers/esm/defineProperty")),i=r(require("./matrix4")),e=r(require("./vector3")),o=r(require("./euler"));function r(t){return t&&t.__esModule?t:{default:t}}class n{constructor({x:i=0,y:r=0,z:n=0,roll:s=0,pitch:a=0,yaw:h=0,position:l,orientation:u}={}){(0,t.default)(this,"position",void 0),(0,t.default)(this,"orientation",void 0),Array.isArray(l)&&3===l.length?this.position=new e.default(l):this.position=new e.default(i,r,n),Array.isArray(u)&&4===u.length?this.orientation=new o.default(u,u[3]):this.orientation=new o.default(s,a,h,o.default.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&(this.position.equals(t.position)&&this.orientation.equals(t.orientation))}exactEquals(t){return!!t&&(this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation))}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),o=Math.sin(this.yaw),r=Math.cos(this.roll),n=Math.cos(this.pitch),s=Math.cos(this.yaw);return(new i.default).setRowMajor(s*n,-o*r+s*e*t,o*t+s*e*r,this.x,o*n,s*r+o*e*t,-s*t+o*e*r,this.y,-e,n*t,n*r,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new i.default).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new i.default).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}exports.default=n;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./matrix4":"of13","./vector3":"WGSx","./euler":"t6Su"}],"XSGy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI};exports.default=e;
},{}],"dwLx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Euler",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(exports,"Matrix3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"Matrix4",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"Pose",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(exports,"Quaternion",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"SphericalCoordinates",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"Vector2",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"Vector3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"Vector4",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"_Euler",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(exports,"_MathUtils",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(exports,"_Pose",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(exports,"_SphericalCoordinates",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"acos",{enumerable:!0,get:function(){return l.acos}}),Object.defineProperty(exports,"asin",{enumerable:!0,get:function(){return l.asin}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"atan",{enumerable:!0,get:function(){return l.atan}}),Object.defineProperty(exports,"clamp",{enumerable:!0,get:function(){return l.clamp}}),Object.defineProperty(exports,"clone",{enumerable:!0,get:function(){return l.clone}}),Object.defineProperty(exports,"config",{enumerable:!0,get:function(){return l.config}}),Object.defineProperty(exports,"configure",{enumerable:!0,get:function(){return l.configure}}),Object.defineProperty(exports,"cos",{enumerable:!0,get:function(){return l.cos}}),Object.defineProperty(exports,"degrees",{enumerable:!0,get:function(){return l.degrees}}),Object.defineProperty(exports,"equals",{enumerable:!0,get:function(){return l.equals}}),Object.defineProperty(exports,"exactEquals",{enumerable:!0,get:function(){return l.exactEquals}}),Object.defineProperty(exports,"formatValue",{enumerable:!0,get:function(){return l.formatValue}}),Object.defineProperty(exports,"isArray",{enumerable:!0,get:function(){return l.isArray}}),Object.defineProperty(exports,"lerp",{enumerable:!0,get:function(){return l.lerp}}),Object.defineProperty(exports,"radians",{enumerable:!0,get:function(){return l.radians}}),Object.defineProperty(exports,"sin",{enumerable:!0,get:function(){return l.sin}}),Object.defineProperty(exports,"tan",{enumerable:!0,get:function(){return l.tan}}),Object.defineProperty(exports,"toDegrees",{enumerable:!0,get:function(){return l.toDegrees}}),Object.defineProperty(exports,"toRadians",{enumerable:!0,get:function(){return l.toRadians}}),Object.defineProperty(exports,"withEpsilon",{enumerable:!0,get:function(){return l.withEpsilon}});var e=p(require("./classes/vector2")),r=p(require("./classes/vector3")),t=p(require("./classes/vector4")),n=p(require("./classes/matrix3")),u=p(require("./classes/matrix4")),o=p(require("./classes/quaternion")),i=p(require("./classes/spherical-coordinates")),a=p(require("./classes/pose")),c=p(require("./classes/euler")),s=p(require("./lib/math-utils")),f=p(require("./lib/assert")),l=require("./lib/common");function p(e){return e&&e.__esModule?e:{default:e}}
},{"./classes/vector2":"JnVj","./classes/vector3":"WGSx","./classes/vector4":"T9bv","./classes/matrix3":"YefV","./classes/matrix4":"of13","./classes/quaternion":"T1TH","./classes/spherical-coordinates":"xqJO","./classes/pose":"m8sA","./classes/euler":"t6Su","./lib/math-utils":"XSGy","./lib/assert":"YXhZ","./lib/common":"wKVf"}],"zjhX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.project=void 0;var o=require("@math.gl/core");const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n={modelMatrix:i,viewMatrix:i,projectionMatrix:i,cameraPositionWorld:[0,0,0]};function r(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r={};return void 0!==i.modelMatrix&&(r.modelMatrix=i.modelMatrix),void 0!==i.viewMatrix&&(r.viewMatrix=i.viewMatrix),void 0!==i.projectionMatrix&&(r.projectionMatrix=i.projectionMatrix),void 0!==i.cameraPositionWorld&&(r.cameraPositionWorld=i.cameraPositionWorld),void 0===i.projectionMatrix&&void 0===i.viewMatrix||(r.viewProjectionMatrix=new o.Matrix4(i.projectionMatrix).multiplyRight(i.viewMatrix)),r}const t="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n",e="".concat(t,"\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n"),c="\n".concat(t),a={name:"project",getUniforms:r,vs:e,fs:c};exports.project=a;
},{"@math.gl/core":"dwLx"}],"HCaU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";exports.default=n;
},{}],"ob8R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lights=void 0;var t=i(require("./lights.glsl"));function i(t){return t&&t.__esModule?t:{default:t}}const n={lightSources:{}};function e(){let{color:t=[0,0,0],intensity:i=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map(t=>t*i/255)}function o(t){let{ambientLight:i,pointLights:n=[],directionalLights:o=[]}=t;const g={};return g["lighting_uAmbientLight.color"]=i?e(i):[0,0,0],n.forEach((t,i)=>{g["lighting_uPointLight[".concat(i,"].color")]=e(t),g["lighting_uPointLight[".concat(i,"].position")]=t.position,g["lighting_uPointLight[".concat(i,"].attenuation")]=t.attenuation||[1,0,0]}),g.lighting_uPointLightCount=n.length,o.forEach((t,i)=>{g["lighting_uDirectionalLight[".concat(i,"].color")]=e(t),g["lighting_uDirectionalLight[".concat(i,"].direction")]=t.direction}),g.lighting_uDirectionalLightCount=o.length,g}function g(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;if("lightSources"in t){const{ambientLight:i,pointLights:n,directionalLights:e}=t.lightSources||{};return i||n&&n.length>0||e&&e.length>0?Object.assign({},o({ambientLight:i,pointLights:n,directionalLights:e}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const i={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":i.ambientLight=n;break;case"directional":i.directionalLights.push(n);break;case"point":i.pointLights.push(n)}return g({lightSources:i})}return{}}const h={name:"lights",vs:t.default,fs:t.default,getUniforms:g,defines:{MAX_LIGHTS:3}};exports.lights=h;
},{"./lights.glsl":"HCaU"}],"VcTg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.dirlight=void 0;var r=require("../project/project");const i=new Float32Array([1,1,2]),t={lightDirection:i};function e(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;const i={};return r.lightDirection&&(i.dirlight_uLightDirection=r.lightDirection),i}const o=null,n="uniform vec3 dirlight_uLightDirection;\nvec4 dirlight_filterColor(vec4 color) {\n  vec3 normal = project_getNormal_World();\n  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));\n  return vec4(color.rgb * d, color.a);\n}\n",l={name:"dirlight",vs:o,fs:n,getUniforms:e,dependencies:[r.project]};exports.dirlight=l;
},{"../project/project":"zjhX"}],"flfn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.picking=void 0;const i=new Uint8Array([0,255,255,255]),n={pickingSelectedColor:null,pickingHighlightColor:i,pickingActive:!1,pickingAttribute:!1};function o(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;const o={};if(void 0!==i.pickingSelectedColor)if(i.pickingSelectedColor){const n=i.pickingSelectedColor.slice(0,3);o.picking_uSelectedColorValid=1,o.picking_uSelectedColor=n}else o.picking_uSelectedColorValid=0;if(i.pickingHighlightColor){const n=Array.from(i.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),o.picking_uHighlightColor=n}return void 0!==i.pickingActive&&(o.picking_uActive=Boolean(i.pickingActive),o.picking_uAttribute=Boolean(i.pickingAttribute)),o}const e="uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",c="uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",l={name:"picking",vs:e,fs:c,getUniforms:o};exports.picking=l;
},{}],"bRsz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n";exports.default=i;
},{}],"VXHj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.phongLighting=exports.gouraudLighting=void 0;var e=require("../lights/lights"),i=n(require("./phong-lighting.glsl"));function n(e){return e&&e.__esModule?e:{default:e}}const t={};function g(e){const{ambient:i=.35,diffuse:n=.6,shininess:t=32,specularColor:g=[30,30,30]}=e;return{lighting_uAmbient:i,lighting_uDiffuse:n,lighting_uShininess:t,lighting_uSpecularColor:g.map(e=>e/255)}}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;if(!("material"in e))return{};const{material:i}=e;return i?g(i):{lighting_uEnabled:!1}}const r={name:"gouraud-lighting",dependencies:[e.lights],vs:i.default,defines:{LIGHTING_VERTEX:1},getUniforms:s};exports.gouraudLighting=r;const o={name:"phong-lighting",dependencies:[e.lights],fs:i.default,defines:{LIGHTING_FRAGMENT:1},getUniforms:s};exports.phongLighting=o;
},{"../lights/lights":"ob8R","./phong-lighting.glsl":"bRsz"}],"tuDT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n";exports.default=n;
},{}],"VAQj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n";exports.default=n;
},{}],"rSII":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pbr=void 0;var e=require("../lights/lights"),r=s(require("./pbr-vertex.glsl")),t=s(require("./pbr-fragment.glsl"));function s(e){return e&&e.__esModule?e:{default:e}}const l={name:"pbr",vs:r.default,fs:t.default,defines:{LIGHTING_FRAGMENT:1},dependencies:[e.lights]};exports.pbr=l;
},{"../lights/lights":"ob8R","./pbr-vertex.glsl":"tuDT","./pbr-fragment.glsl":"VAQj"}],"LILJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tiltShift=void 0;var e=require("../utils/random");const t="uniform float blurRadius;\nuniform float gradientRadius;\nuniform vec2 start;\nuniform vec2 end;\nuniform bool invert;\n\nvec2 tiltShift_getDelta(vec2 texSize) {\n  vec2 vector = normalize((end - start) * texSize);\n  return invert ? vec2(-vector.y, vector.x) : vector;\n}\n\nvec4 tiltShift_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  vec2 normal = normalize(vec2((start.y - end.y) * texSize.y, (end.x - start.x) * texSize.x));\n  float radius = smoothstep(0.0, 1.0,\n    abs(dot(texCoord * texSize - start * texSize, normal)) / gradientRadius) * blurRadius;\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec4 sample = texture2D(texture, texCoord + tiltShift_getDelta(texSize) / texSize * percent * radius);\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",n={blurRadius:{value:15,min:0,max:50},gradientRadius:{value:200,min:0,max:400},start:[0,0],end:[1,1],invert:{value:!1,private:!0}},r={name:"tiltShift",uniforms:n,fs:t,dependencies:[e.random],passes:[{sampler:!0,uniforms:{invert:!1}},{sampler:!0,uniforms:{invert:!0}}]};exports.tiltShift=r;
},{"../utils/random":"LZIL"}],"trGj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.triangleBlur=void 0;var e=require("../utils/random");const t="uniform float radius;\nuniform vec2 delta;\n\nvec4 triangleBlur_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 adjustedDelta = delta * radius / texSize;\n\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec4 sample = texture2D(texture, texCoord + adjustedDelta * percent);\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",r={radius:{value:20,min:0,softMax:100},delta:{value:[1,0],private:!0}},o={name:"triangleBlur",uniforms:r,fs:t,dependencies:[e.random],passes:[{sampler:!0,uniforms:{delta:[1,0]}},{sampler:!0,uniforms:{delta:[0,1]}}]};exports.triangleBlur=o;
},{"../utils/random":"LZIL"}],"bSXt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zoomBlur=void 0;var e=require("../utils/random");const t="\nuniform vec2 center;\nuniform float strength;\n\nvec4 zoomBlur_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  vec2 toCenter = center * texSize - texCoord * texSize;\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = 0.0; t <= 40.0; t++) {\n    float percent = (t + offset) / 40.0;\n    float weight = 4.0 * (percent - percent * percent);\n    vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",o={center:[.5,.5],strength:{value:.3,min:0,softMax:1}},r={name:"zoomBlur",uniforms:o,fs:t,dependencies:[e.random],passes:[{sampler:!0}]};exports.zoomBlur=r;
},{"../utils/random":"LZIL"}],"wbqy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.brightnessContrast=void 0;const r="uniform float brightness;\nuniform float contrast;\n\nvec4 brightnessContrast_filterColor(vec4 color) {\n  color.rgb += brightness;\n  if (contrast > 0.0) {\n    color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\n  } else {\n    color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\n  }\n  return color;\n}\n\nvec4 brightnessContrast_filterColor(vec4 color, vec2 texSize, vec2 texCoords) {\n  return brightnessContrast_filterColor(color);\n}\n",o={brightness:{value:0,min:-1,max:1},contrast:{value:0,min:-1,max:1}},t={name:"brightnessContrast",uniforms:o,fs:r,passes:[{filter:!0}]};exports.brightnessContrast=t;
},{}],"oonH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.denoise=void 0;const e="uniform float strength;\n\nvec4 denoise_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  float adjustedExponent = 3. + 200. * pow(1. - strength, 4.);\n\n  vec4 center = texture2D(texture, texCoord);\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  for (float x = -4.0; x <= 4.0; x += 1.0) {\n    for (float y = -4.0; y <= 4.0; y += 1.0) {\n      vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);\n      float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));\n      weight = pow(weight, adjustedExponent);\n      color += sample * weight;\n      total += weight;\n    }\n  }\n\n  return color / total;\n}\n",t={strength:{value:.5,min:0,max:.1,adjust:e=>.53+200*Math.pow(1-e,4)}},o={name:"denoise",uniforms:t,fs:e,passes:[{sampler:!0},{sampler:!0}]};exports.denoise=o;
},{}],"UEue":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hueSaturation=void 0;const o="uniform float hue;\nuniform float saturation;\n\nvec4 hueSaturation_filterColor(vec4 color) {\n  float angle = hue * 3.14159265;\n  float s = sin(angle), c = cos(angle);\n  vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\n  float len = length(color.rgb);\n  color.rgb = vec3(\n    dot(color.rgb, weights.xyz),\n    dot(color.rgb, weights.zxy),\n    dot(color.rgb, weights.yzx)\n  );\n  float average = (color.r + color.g + color.b) / 3.0;\n  if (saturation > 0.0) {\n    color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\n  } else {\n    color.rgb += (average - color.rgb) * (-saturation);\n  }\n\n  return color;\n}\n\nvec4 hueSaturation_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return hueSaturation_filterColor(color);\n}\n",r={hue:{value:0,min:-1,max:1},saturation:{value:0,min:-1,max:1}},e={name:"hueSaturation",uniforms:r,fs:o,passes:[{filter:!0}]};exports.hueSaturation=e;
},{}],"xSdj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.noise=void 0;const o="uniform float amount;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvec4 noise_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return noise_filterColor(color, texCoord);\n}\n",e={amount:{value:.5,min:0,max:1}},n={name:"noise",uniforms:e,fs:o,passes:[{filter:!0}]};exports.noise=n;
},{}],"VOww":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sepia=void 0;const o="uniform float amount;\n\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));\n  color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));\n  color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));\n\n  return color;\n}\n\nvec4 sepia_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return sepia_filterColor(color);\n}\n",n={amount:{value:.5,min:0,max:1}},r={name:"sepia",uniforms:n,fs:o,passes:[{filter:!0}]};exports.sepia=r;
},{}],"FovK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vibrance=void 0;const o="uniform float amount;\n\nvec4 vibrance_filterColor(vec4 color) {\n  float average = (color.r + color.g + color.b) / 3.0;\n  float mx = max(color.r, max(color.g, color.b));\n  float amt = (mx - average) * (-amount * 3.0);\n  color.rgb = mix(color.rgb, vec3(mx), amt);\n  return color;\n}\n\nvec4 vibrance_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vibrance_filterColor(color);\n}\n",r={amount:{value:0,min:-1,max:1}},e={name:"vibrance",uniforms:r,fs:o,passes:[{filter:!0}]};exports.vibrance=e;
},{}],"vTmx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vignette=void 0;const e="uniform float radius;\nuniform float amount;\n\nvec4 vignette_filterColor(vec4 color, vec2 texCoord) {\n  float dist = distance(texCoord, vec2(0.5, 0.5));\n  float ratio = smoothstep(0.8, radius * 0.799, dist * (amount + radius));\n  return color.rgba * ratio + (1.0 - ratio)*vec4(0.0, 0.0, 0.0, 1.0);\n}\n\nvec4 vignette_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vignette_filterColor(color, texCoord);\n}\n",t={radius:{value:.5,min:0,max:1},amount:{value:.5,min:0,max:1}},o={name:"vignette",fs:e,uniforms:t,passes:[{filter:!0}]};exports.vignette=o;
},{}],"CVBQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.colorHalftone=void 0;const e="uniform vec2 center;\nuniform float angle;\nuniform float size;\n\nfloat scale = 3.1514 / size;\n\nfloat pattern(float angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * texSize - center * texSize;\n  vec2 point = vec2(\n\tc * tex.x - s * tex.y,\n\ts * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n\tcmy * 10.0 - 3.0 + vec3(\n    pattern(angle + 0.26179, texSize, texCoord),\n\t  pattern(angle + 1.30899, texSize, texCoord),\n    pattern(angle, texSize, texCoord)\n  ),\n\t0.0,\n\t1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n",n={center:[.5,.5],angle:{value:1.1,softMin:0,softMax:Math.PI/2},size:{value:4,min:1,softMin:3,softMax:20}},t={name:"colorHalftone",uniforms:n,fs:e,passes:[{filter:!0}]};exports.colorHalftone=t;
},{}],"jZuR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.dotScreen=void 0;const e="uniform vec2 center;\nuniform float angle;\nuniform float size;\n\nfloat pattern(vec2 texSize, vec2 texCoord) {\n  float scale = 3.1415 / size;\n\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * texSize - center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvec4 dotScreen_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  float average = (color.r + color.g + color.b) / 3.0;\n  return vec4(vec3(average * 10.0 - 5.0 + pattern(texSize, texCoord)), color.a);\n}\n",n={center:[.5,.5],angle:{value:1.1,softMin:0,softMax:Math.PI/2},size:{value:3,min:1,softMin:3,softMax:20}},t={name:"dotScreen",uniforms:n,fs:e,passes:[{filter:!0}]};exports.dotScreen=t;
},{}],"RiAQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.edgeWork=void 0;var e=require("../utils/random");const o="uniform float radius;\nuniform vec2 delta;\n\nvec4 edgeWork_sampleColor1(sampler2D source, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec3 sampleColor = texture2D(source, texCoord + relativeDelta * percent).rgb;\n    float average = (sampleColor.r + sampleColor.g + sampleColor.b) / 3.0;\n    color.x += average * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += average * weight;\n      total.y += weight;\n    }\n  }\n  return vec4(color / total, 0.0, 1.0);\n}\n\nvec4 edgeWork_sampleColor2(sampler2D source, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec2 sampleColor = texture2D(source, texCoord + relativeDelta * percent).xy;\n    color.x += sampleColor.x * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += sampleColor.y * weight;\n      total.y += weight;\n    }\n  }\n  float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\n  return vec4(c, c, c, 1.0);\n}\n",t={radius:{value:2,min:1,softMax:50},delta:{value:[1,0],private:!0}},r={name:"edgeWork",uniforms:t,fs:o,dependencies:[e.random],passes:[{sampler:"edgeWork_sampleColor1",uniforms:{delta:[1,0]}},{sampler:"edgeWork_sampleColor2",uniforms:{delta:[0,1]}}]};exports.edgeWork=r;
},{"../utils/random":"LZIL"}],"izXl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hexagonalPixelate=void 0;const e="uniform vec2 center;\nuniform float scale;\n\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - center * texSize) / scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= scale / texSize;\n\n  return texture2D(texture, choice + center);\n}\n",n={center:{value:[.5,.5],hint:"screenspace"},scale:{value:10,min:1,softMin:5,softMax:50}},c={name:"hexagonalPixelate",uniforms:n,fs:e,passes:[{sampler:!0}]};exports.hexagonalPixelate=c;
},{}],"z868":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ink=void 0;const e="uniform float strength;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = strength * strength * strength * strength * strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n",t={strength:{value:.25,min:0,softMax:1}},n={name:"ink",uniforms:t,fs:e,passes:[{sampler:!0}]};exports.ink=n;
},{}],"G9Jg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.magnify=void 0;const e="uniform vec2 screenXY;\nuniform float radiusPixels;\nuniform float zoom;\nuniform float borderWidthPixels;\nuniform vec4 borderColor;\n\nvec4 magnify_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 pos = vec2(screenXY.x, 1.0 - screenXY.y);\n  float dist = distance(texCoord * texSize, pos * texSize);\n  if (dist < radiusPixels) {\n    return texture2D(texture, (texCoord - pos) / zoom + pos);\n  }\n\n  if (dist <= radiusPixels + borderWidthPixels) {\n    return borderColor;\n  }\n  return texture2D(texture, texCoord);\n}\n",r={screenXY:[0,0],radiusPixels:200,zoom:2,borderWidthPixels:0,borderColor:[255,255,255,255]},o={name:"magnify",uniforms:r,fs:e,passes:[{sampler:!0}]};exports.magnify=o;
},{}],"JIP9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.warp=void 0;const e="vec4 warp_sampleColor(sampler2D texture, vec2 texSize, vec2 coord) {\n  vec4 color = texture2D(texture, coord / texSize);\n  vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);\n  if (coord != clampedCoord) {\n    color.a *= max(0.0, 1.0 - length(coord - clampedCoord));\n  }\n\n  return color;\n}\n",o={name:"warp",fs:e};exports.warp=o;
},{}],"M0NH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bulgePinch=void 0;var e=require("./warp");const n="uniform float radius;\nuniform float strength;\nuniform vec2 center;\n\nvec2 bulgePinch_warp(vec2 coord, vec2 texCenter) {\n  coord -= texCenter;\n  float distance = length(coord);\n  if (distance < radius) {\n    float percent = distance / radius;\n    if (strength > 0.0) {\n      coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n    } else {\n      coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n    }\n  }\n  coord += texCenter;\n  return coord;\n}\n\nvec4 bulgePinch_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 coord = texCoord * texSize;\n  coord = bulgePinch_warp(coord, center * texSize);\n\n  return warp_sampleColor(texture, texSize, coord);\n}\n",r={center:[.5,.5],radius:{value:200,min:1,softMax:600},strength:{value:.5,min:-1,max:1}},t={name:"bulgePinch",fs:n,uniforms:r,dependencies:[e.warp],passes:[{sampler:!0}]};exports.bulgePinch=t;
},{"./warp":"JIP9"}],"L0x2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.swirl=void 0;var e=require("./warp");const r="uniform float radius;\nuniform float angle;\nuniform vec2 center;\n\nvec2 swirl_warp(vec2 coord, vec2 texCenter) {\n  coord -= texCenter;\n  float distance = length(coord);\n  if (distance < radius) {\n    float percent = (radius - distance) / radius;\n    float theta = percent * percent * angle;\n    float s = sin(theta);\n    float c = cos(theta);\n    coord = vec2(\n      coord.x * c - coord.y * s,\n      coord.x * s + coord.y * c\n    );\n  }\n  coord += texCenter;\n  return coord;\n}\n\nvec4 swirl_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 coord = texCoord * texSize;\n  coord = swirl_warp(coord, center * texSize);\n\n  return warp_sampleColor(texture, texSize, coord);\n}\n",o={center:[.5,.5],radius:{value:200,min:1,softMax:600},angle:{value:3,softMin:-25,softMax:25}},n={name:"swirl",fs:r,uniforms:o,dependencies:[e.warp],passes:[{sampler:!0}]};exports.swirl=n;
},{"./warp":"JIP9"}],"RDdh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fxaa=void 0;const n="\n#define FXAA_QUALITY_PRESET 29\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n\nFxaaFloat FxaaLuma_(FxaaFloat4 rgba) { return dot(rgba.rgb, vec3(0.2126, 0.7152, 0.0722)); }\n\nFxaaFloat4 FxaaPixelShader_(\n\n\n    FxaaFloat2 pos,\n\n\n\n\n    FxaaTex tex,\n\n\n\n\n    FxaaFloat2 fxaaQualityRcpFrame,\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualitySubpix,\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThreshold,\n\n\n\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n    if(earlyExit)\n        return rgbyM;\n    FxaaFloat lumaNW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP));\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    #endif\n                        }\n                        #endif\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaTexTop(tex, posM);\n}\n\nvec4 fxaa_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n    const float fxaa_QualitySubpix = 0.5;\n    const float fxaa_QualityEdgeThreshold = 0.125;\n    const float fxaa_QualityEdgeThresholdMin = 0.0833;\n\n    return FxaaPixelShader_(\n        texCoord,\n        texture,\n        vec2(1.0) / texSize,\n        fxaa_QualitySubpix,\n        fxaa_QualityEdgeThreshold,\n        fxaa_QualityEdgeThresholdMin\n    );\n}\n",a={name:"fxaa",uniforms:{},fs:n,passes:[{sampler:!0}]};exports.fxaa=a;
},{}],"hgD9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transform=void 0;const e="attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",r={name:"transform",vs:e,fs:null};exports.transform=r;
},{}],"wMsA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"_transform",{enumerable:!0,get:function(){return L.transform}}),Object.defineProperty(exports,"_warp",{enumerable:!0,get:function(){return S.warp}}),Object.defineProperty(exports,"brightnessContrast",{enumerable:!0,get:function(){return s.brightnessContrast}}),Object.defineProperty(exports,"bulgePinch",{enumerable:!0,get:function(){return w.bulgePinch}}),Object.defineProperty(exports,"colorHalftone",{enumerable:!0,get:function(){return P.colorHalftone}}),Object.defineProperty(exports,"denoise",{enumerable:!0,get:function(){return c.denoise}}),Object.defineProperty(exports,"dirlight",{enumerable:!0,get:function(){return u.dirlight}}),Object.defineProperty(exports,"dotScreen",{enumerable:!0,get:function(){return h.dotScreen}}),Object.defineProperty(exports,"edgeWork",{enumerable:!0,get:function(){return y.edgeWork}}),Object.defineProperty(exports,"fp32",{enumerable:!0,get:function(){return r.fp32}}),Object.defineProperty(exports,"fp64",{enumerable:!0,get:function(){return t.fp64}}),Object.defineProperty(exports,"fp64arithmetic",{enumerable:!0,get:function(){return t.fp64arithmetic}}),Object.defineProperty(exports,"fxaa",{enumerable:!0,get:function(){return B.fxaa}}),Object.defineProperty(exports,"gouraudLighting",{enumerable:!0,get:function(){return a.gouraudLighting}}),Object.defineProperty(exports,"hexagonalPixelate",{enumerable:!0,get:function(){return O.hexagonalPixelate}}),Object.defineProperty(exports,"hueSaturation",{enumerable:!0,get:function(){return b.hueSaturation}}),Object.defineProperty(exports,"ink",{enumerable:!0,get:function(){return q.ink}}),Object.defineProperty(exports,"lights",{enumerable:!0,get:function(){return i.lights}}),Object.defineProperty(exports,"magnify",{enumerable:!0,get:function(){return k.magnify}}),Object.defineProperty(exports,"noise",{enumerable:!0,get:function(){return m.noise}}),Object.defineProperty(exports,"pbr",{enumerable:!0,get:function(){return f.pbr}}),Object.defineProperty(exports,"phongLighting",{enumerable:!0,get:function(){return a.phongLighting}}),Object.defineProperty(exports,"picking",{enumerable:!0,get:function(){return o.picking}}),Object.defineProperty(exports,"project",{enumerable:!0,get:function(){return n.project}}),Object.defineProperty(exports,"random",{enumerable:!0,get:function(){return e.random}}),Object.defineProperty(exports,"sepia",{enumerable:!0,get:function(){return d.sepia}}),Object.defineProperty(exports,"swirl",{enumerable:!0,get:function(){return v.swirl}}),Object.defineProperty(exports,"tiltShift",{enumerable:!0,get:function(){return p.tiltShift}}),Object.defineProperty(exports,"triangleBlur",{enumerable:!0,get:function(){return g.triangleBlur}}),Object.defineProperty(exports,"vibrance",{enumerable:!0,get:function(){return j.vibrance}}),Object.defineProperty(exports,"vignette",{enumerable:!0,get:function(){return x.vignette}}),Object.defineProperty(exports,"zoomBlur",{enumerable:!0,get:function(){return l.zoomBlur}});var e=require("./utils/random"),r=require("./fp32/fp32"),t=require("./fp64/fp64"),n=require("./project/project"),i=require("./lights/lights"),u=require("./dirlight/dirlight"),o=require("./picking/picking"),a=require("./phong-lighting/phong-lighting"),f=require("./pbr/pbr"),p=require("./image-blur-filters/tiltshift"),g=require("./image-blur-filters/triangleblur"),l=require("./image-blur-filters/zoomblur"),s=require("./image-adjust-filters/brightnesscontrast"),c=require("./image-adjust-filters/denoise"),b=require("./image-adjust-filters/huesaturation"),m=require("./image-adjust-filters/noise"),d=require("./image-adjust-filters/sepia"),j=require("./image-adjust-filters/vibrance"),x=require("./image-adjust-filters/vignette"),P=require("./image-fun-filters/colorhalftone"),h=require("./image-fun-filters/dotscreen"),y=require("./image-fun-filters/edgework"),O=require("./image-fun-filters/hexagonalpixelate"),q=require("./image-fun-filters/ink"),k=require("./image-fun-filters/magnify"),w=require("./image-warp-filters/bulgepinch"),v=require("./image-warp-filters/swirl"),S=require("./image-warp-filters/warp"),B=require("./fxaa/fxaa"),L=require("./transform/transform");
},{"./utils/random":"LZIL","./fp32/fp32":"rSwV","./fp64/fp64":"mLAB","./project/project":"zjhX","./lights/lights":"ob8R","./dirlight/dirlight":"VcTg","./picking/picking":"flfn","./phong-lighting/phong-lighting":"VXHj","./pbr/pbr":"rSII","./image-blur-filters/tiltshift":"LILJ","./image-blur-filters/triangleblur":"trGj","./image-blur-filters/zoomblur":"bSXt","./image-adjust-filters/brightnesscontrast":"wbqy","./image-adjust-filters/denoise":"oonH","./image-adjust-filters/huesaturation":"UEue","./image-adjust-filters/noise":"xSdj","./image-adjust-filters/sepia":"VOww","./image-adjust-filters/vibrance":"FovK","./image-adjust-filters/vignette":"vTmx","./image-fun-filters/colorhalftone":"CVBQ","./image-fun-filters/dotscreen":"jZuR","./image-fun-filters/edgework":"RiAQ","./image-fun-filters/hexagonalpixelate":"izXl","./image-fun-filters/ink":"z868","./image-fun-filters/magnify":"G9Jg","./image-warp-filters/bulgepinch":"M0NH","./image-warp-filters/swirl":"L0x2","./image-warp-filters/warp":"JIP9","./fxaa/fxaa":"RDdh","./transform/transform":"hgD9"}],"Pzgo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={assembleShaders:!0,combineInjects:!0,normalizeShaderModule:!0,getQualifierDetails:!0,getPassthroughFS:!0,typeToChannelSuffix:!0,typeToChannelCount:!0,convertToVec4:!0};Object.defineProperty(exports,"assembleShaders",{enumerable:!0,get:function(){return r.assembleShaders}}),Object.defineProperty(exports,"combineInjects",{enumerable:!0,get:function(){return t.combineInjects}}),Object.defineProperty(exports,"convertToVec4",{enumerable:!0,get:function(){return o.convertToVec4}}),Object.defineProperty(exports,"getPassthroughFS",{enumerable:!0,get:function(){return o.getPassthroughFS}}),Object.defineProperty(exports,"getQualifierDetails",{enumerable:!0,get:function(){return o.getQualifierDetails}}),Object.defineProperty(exports,"normalizeShaderModule",{enumerable:!0,get:function(){return n.normalizeShaderModule}}),Object.defineProperty(exports,"typeToChannelCount",{enumerable:!0,get:function(){return o.typeToChannelCount}}),Object.defineProperty(exports,"typeToChannelSuffix",{enumerable:!0,get:function(){return o.typeToChannelSuffix}});var r=require("./lib/assemble-shaders"),t=require("./lib/inject-shader"),n=require("./lib/shader-module"),o=require("./utils/shader-utils"),u=require("./modules");Object.keys(u).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===u[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return u[r]}}))});
},{"./lib/assemble-shaders":"aMxS","./lib/inject-shader":"VTdi","./lib/shader-module":"X8lP","./utils/shader-utils":"uzoD","./modules":"wMsA"}],"BP7a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@luma.gl/shadertools"),s=require("@luma.gl/webgl");class e{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new e(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find(s=>s.name===t.name)||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const s="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter(t=>t.name!==s),this.stateHash++}addShaderHook(t,s){s&&(t=Object.assign(s,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:a="",fs:h="",defines:o={},inject:i={},varyings:n=[],bufferMode:r=35981,transpileToGLSL100:u=!1}=e,l=this._getModuleList(e.modules),g=this._getHash(a),d=this._getHash(h),c=l.map(t=>this._getHash(t.name)).sort(),_=n.map(t=>this._getHash(t)),f=Object.keys(o).sort(),m=Object.keys(i).sort(),p=[],M=[];for(const t of f)p.push(this._getHash(t)),p.push(this._getHash(o[t]));for(const t of m)M.push(this._getHash(t)),M.push(this._getHash(i[t]));const H="".concat(g,"/").concat(d,"D").concat(p.join("/"),"M").concat(c.join("/"),"I").concat(M.join("/"),"V").concat(_.join("/"),"H").concat(this.stateHash,"B").concat(r).concat(u?"T":"");if(!this._programCache[H]){const e=(0,t.assembleShaders)(this.gl,{vs:a,fs:h,modules:l,inject:i,defines:o,hookFunctions:this._hookFunctions,transpileToGLSL100:u});this._programCache[H]=new s.Program(this.gl,{hash:H,vs:e.vs,fs:e.fs,varyings:n,bufferMode:r}),this._getUniforms[H]=e.getUniforms||(t=>{}),this._useCounts[H]=0}return this._useCounts[H]++,this._programCache[H]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const s=t.hash;this._useCounts[s]--,0===this._useCounts[s]&&(this._programCache[s].delete(),delete this._programCache[s],delete this._getUniforms[s],delete this._useCounts[s])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const s=new Array(this._defaultModules.length+t.length),e={};let a=0;for(let h=0,o=this._defaultModules.length;h<o;++h){const t=this._defaultModules[h],o=t.name;s[a++]=t,e[o]=!0}for(let h=0,o=t.length;h<o;++h){const o=t[h],i=o.name;e[i]||(s[a++]=o,e[i]=!0)}return s.length=a,s}}exports.default=e;
},{"@luma.gl/shadertools":"Pzgo","@luma.gl/webgl":"KdJH"}],"sgeN":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBuffersFromGeometry=t,exports.inferAttributeAccessor=i;var e=require("@luma.gl/webgl");const s={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function t(s,t,o){const n={};let c=t.indices;for(const a in t.attributes){const u=t.attributes[a],d=r(a,o);if("indices"===a)c=u;else if(u.constant)n[d]=u.value;else{const t=u.value,r={...u};delete r.value,n[d]=[new e.Buffer(s,t),r],i(a,r)}}if(c){const t=c.value||c;(0,e.assert)(t instanceof Uint16Array||t instanceof Uint32Array,'attribute array for "indices" must be of integer type');const r={size:1,isIndexed:void 0===c.isIndexed||c.isIndexed};n.indices=[new e.Buffer(s,{data:t,target:34963}),r]}return n}function r(e,t){const{attributeMap:r=s}=t||{};return r&&r[e]||e}function i(s,t){let r;switch(s){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":r="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":r="vectors"}switch(r){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2}(0,e.assert)(Number.isFinite(t.size),"attribute ".concat(s," needs size"))}
},{"@luma.gl/webgl":"KdJH"}],"EKUN":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/gltools"),t=i(require("./program-manager")),r=require("@luma.gl/webgl"),s=require("./model-utils");function i(e){return e&&e.__esModule?e:{default:e}}const a=2,o=1e4,n="Model needs drawMode and vertexCount",g=()=>{},d={};class u{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:i=(0,r.uid)("model")}=s;(0,r.assert)((0,e.isWebGL)(t)),this.id=i,this.gl=t,this.id=s.id||(0,r.uid)("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(s)}initialize(e){this.props={},this.programManager=e.programManager||t.default.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:s=null,vs:i,fs:a,modules:o,defines:g,inject:d,varyings:u,bufferMode:h,transpileToGLSL100:m}=e;this.programProps={program:s,vs:i,fs:a,modules:o,defines:g,inject:d,varyings:u,bufferMode:h,transpileToGLSL100:m},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},(0,r.assert)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),n)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:r,fs:s,modules:i,defines:a,inject:o,varyings:n,bufferMode:g,transpileToGLSL100:d}=e;this.programProps={program:t,vs:r,fs:s,modules:i,defines:a,inject:o,varyings:n,bufferMode:g,transpileToGLSL100:d},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return(0,r.assert)(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return(0,r.assert)(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=(0,s.getBuffersFromGeometry)(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,r.isObjectEmpty)(e))return this;const t={};for(const r in e){const s=e[r];t[r]=s.getValue?s.getValue():s}return this.vertexArray.setAttributes(t),this}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return(0,r.clear)(this.program.gl,e),this}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:t=null,framebuffer:s,uniforms:i={},attributes:o={},transformFeedback:n=this.transformFeedback,parameters:u={},vertexArray:h=this.vertexArray}=e;let m;this.setAttributes(o),this.updateModuleSettings(t),this.setUniforms(i),r.log.priority>=a&&(m=this._logDrawCallStart(a));const l=this.vertexArray.getDrawParams(),{isIndexed:f=l.isIndexed,indexType:c=l.indexType,indexOffset:p=l.indexOffset,vertexArrayInstanced:b=l.isInstanced}=this.props;b&&!this.isInstanced&&r.log.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:y,instanceCount:M}=this,{onBeforeRender:v=g,onAfterRender:x=g}=this.props;v(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(d,e,{logPriority:m,uniforms:null,framebuffer:s,parameters:u,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:h,transformFeedback:n,isIndexed:f,indexType:c,isInstanced:y,instanceCount:M,offset:f?p:0}));return x(),r.log.priority>=a&&this._logDrawCallEnd(m,h,s),_}transform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:t=!0,feedbackBuffers:r,unbindModels:s=[]}=e;let{parameters:i}=e;r&&this._setFeedbackBuffers(r),t&&(i=Object.assign({},i,{35977:t})),s.forEach(e=>e.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:i}))}finally{s.forEach(e=>e.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.log.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:t,fs:r,modules:s,inject:i,defines:a,varyings:o,bufferMode:n,transpileToGLSL100:g}=this.programProps;e=this.programManager.get({vs:t,fs:r,modules:s,inject:i,defines:a,varyings:o,bufferMode:n,transpileToGLSL100:g}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}(0,r.assert)(e instanceof r.Program,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new r.VertexArray(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof r.Buffer&&t.delete()}}_setAnimationProps(e){this.animated&&(0,r.assert)(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,r.isObjectEmpty)(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new r.TransformFeedback(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:o;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),r.log.group(a,">>> DRAWING MODEL ".concat(this.id),{collapsed:r.log.level<=2})(),e}_logDrawCallEnd(e,t,s,i){if(void 0===e)return;const o=(0,r.getDebugTableForVertexArray)({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:n,unusedTable:g,unusedCount:d}=(0,r.getDebugTableForUniforms)({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,s)}),{table:u,count:h}=(0,r.getDebugTableForUniforms)({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,s),undefinedOnly:!0});h>0&&r.log.log("MISSING UNIFORMS",Object.keys(u))(),d>0&&r.log.log("UNUSED UNIFORMS",Object.keys(g))();const m=(0,r.getDebugTableForProgramConfiguration)(this.vertexArray.configuration);r.log.table(e,o)(),r.log.table(e,n)(),r.log.table(e+1,m)(),i&&i.log({logLevel:a,message:"Rendered to ".concat(i.id)}),r.log.groupEnd(a)()}}exports.default=u;
},{"@luma.gl/gltools":"lAom","./program-manager":"BP7a","@luma.gl/webgl":"KdJH","./model-utils":"sgeN"}],"VzDO":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/gltools"),s=require("@luma.gl/webgl");class t{constructor(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(s),Object.seal(this)}setupResources(e){for(const s of this.bindings)this._setupTransformFeedback(s,e)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:s}=this;return s.length>0&&(e=Object.assign({},e,{varyings:s})),e}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=this.bindings[this.currentIndex],{sourceBuffers:t,transformFeedback:r}=s;return{attributes:Object.assign({},t,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],r=e?t[e]:null;return r?r instanceof s.Buffer?r:r.buffer:null}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:s}=e,t=this.getBuffer(s);return t?t.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&(0,s.assert)((0,e.isWebGL2)(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:s={}}=e,t={};if(this.bindings[this.currentIndex]&&Object.assign(t,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const e=this.feedbackMap[r];r in s&&(t[e]=r)}Object.assign(t,e.feedbackBuffers);for(const r in t){const e=t[r];if("string"==typeof e){const n=s[e],{byteLength:i,usage:f,accessor:u}=n;t[r]=this._createNewBuffer(r,{byteLength:i,usage:f,accessor:u})}}return t}_setupBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:s=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const t=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:s,feedbackBuffers:t})}_setupTransformFeedback(e,t){let{model:r}=t;const{program:n}=r;e.transformFeedback=new s.TransformFeedback(this.gl,{program:n,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:s}=this._swapBuffers(this.bindings[this.currentIndex]),t=this._getNextIndex();this.bindings[t]=this._updateBinding(this.bindings[t],{sourceBuffers:e,feedbackBuffers:s})}}_updateBinding(e,s){return e?(Object.assign(e.sourceBuffers,s.sourceBuffers),Object.assign(e.feedbackBuffers,s.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},s.sourceBuffers),feedbackBuffers:Object.assign({},s.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const n in this.feedbackMap){const i=this.feedbackMap[n];t[n]=e.feedbackBuffers[i],r[i]=e.sourceBuffers[n],(0,s.assert)(r[i]instanceof s.Buffer)}return{sourceBuffers:t,feedbackBuffers:r}}_createNewBuffer(e,t){const r=new s.Buffer(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}exports.default=t;
},{"@luma.gl/gltools":"lAom","@luma.gl/webgl":"KdJH"}],"eVnT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSizeUniforms=o,exports.getVaryingType=u,exports.processAttributeDefinition=l,exports.updateForTextures=a;var t=require("@luma.gl/webgl"),e=require("@luma.gl/shadertools");const n="transform_uSampler_",r="transform_uSize_",c="transform_position";function a(n){let{vs:a,sourceTextureMap:o,targetTextureVarying:i,targetTexture:s}=n;let f=Object.keys(o).length,m=null;const p={};let g=a,x={};if(f>0||i){const n=g.split("\n"),a=n.slice();if(n.forEach((t,n,r)=>{if(f>0){const r=l(t,o);if(r){const{updatedLine:t,inject:c}=r;a[n]=t,x=(0,e.combineInjects)([x,c]),Object.assign(p,r.samplerTextureMap),f--}}i&&!m&&(m=u(t,i))}),i){(0,t.assert)(s);const n="".concat(r).concat(i),a={"vs:#decl":"uniform vec2 ".concat(n,";\n"),"vs:#main-start":"     vec2 ".concat(c," = transform_getPos(").concat(n,");\n     gl_Position = vec4(").concat(c,", 0, 1.);\n")};x=(0,e.combineInjects)([x,a])}g=a.join("\n")}return{vs:g,targetTextureType:m,inject:x,samplerTextureMap:p}}function o(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:c}=t;const a={};let o,i;n&&(({width:o,height:i}=c),a["".concat(r).concat(n)]=[o,i]);for(const s in e)({width:o,height:i}=e[s]),a["".concat(r).concat(s)]=[o,i];return a}function i(t){return(0,e.getQualifierDetails)(t,["attribute","in"])}function s(t){const e="".concat(n).concat(t),c="".concat(r).concat(t);return{samplerName:e,sizeName:c,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(c,";")}}function u(t,n){const r=(0,e.getQualifierDetails)(t,["varying","out"]);return r&&r.name===n?r.type:null}function l(t,n){const r={},c=i(t);if(!c)return null;const{type:a,name:o}=c;if(o&&n[o]){const n="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:c,sizeName:i,uniformDeclerations:u}=s(o),l=(0,e.typeToChannelSuffix)(a),f="  ".concat(a," ").concat(o," = transform_getInput(").concat(c,", ").concat(i,").").concat(l,";\n");return r[c]=o,{updatedLine:n,inject:{"vs:#decl":u,"vs:#main-start":f},samplerTextureMap:r}}return null}
},{"@luma.gl/webgl":"KdJH","@luma.gl/shadertools":"Pzgo"}],"bMvh":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/webgl"),t=require("@luma.gl/shadertools"),r=require("./transform-shader-utils");const s={10241:9728,10240:9728,10242:33071,10243:33071},u="transform_output";class i{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,sourceTextures:s,framebuffer:u,targetTexture:i}=this.bindings[this.currentIndex],n=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),h=Object.assign({},e.parameters);let o=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){n.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];a[t]=s[e]}this._setSourceTextureParameters();const e=(0,r.getSizeUniforms)({sourceTextureMap:s,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(a,e)}return this.hasTargetTexture&&(o=!1,h.viewport=[0,0,u.width,u.height]),{attributes:n,framebuffer:u,uniforms:a,discard:o,parameters:h}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:s}=this.bindings[this.currentIndex],u=(0,e.readPixelsToArray)(s);if(!r)return u;const i=u.constructor,n=(0,t.typeToChannelCount)(this.targetTextureType),a=new i(u.length*n/4);let h=0;for(let e=0;e<u.length;e+=4)for(let t=0;t<n;t++)a[h++]=u[e+t];return a}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:t,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(t){const{sourceTextures:r,textureOrReference:s}=t;if(s instanceof e.Texture2D)return s;const u=r[s];return u?(this._targetRefTexName=s,this._createNewTexture(u)):null}_setupTextures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,_sourceTextures:r={},_targetTexture:s}=e,u=this._createTargetTexture({sourceTextures:r,textureOrReference:s});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:r,targetTexture:u}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const r=new Float32Array(t);r.forEach((e,t,r)=>{r[t]=t}),this.elementIDBuffer?this.elementIDBuffer.setData({data:r}):this.elementIDBuffer=new e.Buffer(this.gl,{data:r,accessor:{size:1}}),this.elementCount=t}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:e,targetTexture:t}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:e,targetTexture:t})}}_updateBinding(t,r){const{sourceBuffers:s,sourceTextures:u,targetTexture:i}=r;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,u),Object.assign(t.sourceBuffers,s),i){t.targetTexture=i;const{width:r,height:s}=i,{framebuffer:u}=t;u?(u.update({attachments:{36064:i},resizeAttachments:!1}),u.resize({width:r,height:s})):t.framebuffer=new e.Framebuffer(this.gl,{id:"transform-framebuffer",width:r,height:s,attachments:{36064:i}})}return t}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const r in t)t[r].setParameters(s)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(t){const r=(0,e.cloneTextureFrom)(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=r,r}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:i,targetTexture:n}=this.bindings[this.currentIndex],{vs:a,uniforms:h,targetTextureType:o,inject:x,samplerTextureMap:c}=(0,r.updateForTextures)({vs:s.vs,sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),g=(0,t.combineInjects)([s.inject||{},x]);return this.targetTextureType=o,this.samplerTextureMap=c,{vs:a,fs:s._fs||(0,t.getPassthroughFS)({version:(0,e.getShaderVersion)(a),input:this.targetTextureVarying,inputType:o,output:u}),modules:this.hasSourceTextures||this.targetTextureVarying?[t._transform].concat(s.modules||[]):s.modules,uniforms:h,inject:g}}}exports.default=i;
},{"@luma.gl/webgl":"KdJH","@luma.gl/shadertools":"Pzgo","./transform-shader-utils":"eVnT"}],"XhAc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/shadertools"),t=f(require("./buffer-transform")),r=f(require("./texture-transform")),s=require("@luma.gl/gltools"),o=require("@luma.gl/webgl"),n=f(require("../lib/model"));function f(e){return e&&e.__esModule?e:{default:e}}class u{static isSupported(e){return(0,s.isWebGL2)(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:r}=this;e&&e.delete(),t&&t.delete(),r&&r.delete()}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:t=!0}=e,r=this._updateDrawOptions(e);t&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of t)e=e||r.swap();(0,o.assert)(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of t){const t=r.getData(e);if(t)return t}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of t)r.update(e)}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:r}=this;this._buildResourceTransforms(r,t),t=this._updateModelProps(t),this.model=new n.default(r,Object.assign({},t,{fs:t.fs||(0,e.getPassthroughFS)({version:(0,o.getShaderVersion)(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const s of r)t=s.updateModelProps(t);return t}_buildResourceTransforms(e,s){a(s)&&(this.bufferTransform=new t.default(e,s)),i(s)&&(this.textureTransform=new r.default(e,s)),(0,o.assert)(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const s of r)t=Object.assign(t,s.getDrawOptions(t));return t}}function a(e){return!((0,o.isObjectEmpty)(e.feedbackBuffers)&&(0,o.isObjectEmpty)(e.feedbackMap)&&!(e.varyings&&e.varyings.length>0))}function i(e){return!((0,o.isObjectEmpty)(e._sourceTextures)&&!e._targetTexture&&!e._targetTextureVarying)}exports.default=u;
},{"@luma.gl/shadertools":"Pzgo","./buffer-transform":"VzDO","./texture-transform":"bMvh","@luma.gl/gltools":"lAom","@luma.gl/webgl":"KdJH","../lib/model":"EKUN"}],"zvF0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DRAW_MODE=void 0;var t=require("@luma.gl/webgl");const e={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};exports.DRAW_MODE=e;class i{static get DRAW_MODE(){return e}constructor(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:s=(0,t.uid)("geometry"),drawMode:r=e.TRIANGLES,attributes:n={},indices:u=null,vertexCount:a=null}=i;this.id=s,this.drawMode=0|r,this.attributes={},this.userData={},this._setAttributes(n,u),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(e,i){i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i);for(const s in e){let i=e[s];i=ArrayBuffer.isView(i)?{value:i}:i,(0,t.assert)(ArrayBuffer.isView(i.value),"".concat(this._print(s),": must be typed array or object with value as typed array")),"POSITION"!==s&&"positions"!==s||i.size||(i.size=3),"indices"===s?((0,t.assert)(!this.indices),this.indices=i):this.attributes[s]=i}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,i){if(i)return i.value.length;let s=1/0;for(const t in e){const i=e[t],{value:r,size:n,constant:u}=i;!u&&r&&n>=1&&(s=Math.min(s,r.length/n))}return(0,t.assert)(Number.isFinite(s)),s}}exports.default=i;
},{"@luma.gl/webgl":"KdJH"}],"BsEj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("../geometry/geometry")),e=require("@luma.gl/webgl");function r(t){return t&&t.__esModule?t:{default:t}}const a={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class o extends t.default{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:r=(0,e.uid)("truncated-code-geometry")}=t,{indices:a,attributes:o}=i(t);super({...t,id:r,indices:a,attributes:{...o,...t.attributes}})}}function i(t){const{bottomRadius:e=0,topRadius:r=0,height:o=1,nradial:i=10,nvertical:s=10,verticalAxis:l="y",topCap:n=!1,bottomCap:u=!1}=t,d=(n?2:0)+(u?2:0),c=(i+1)*(s+1+d),f=Math.atan2(e-r,o),y=Math.sin,p=Math.cos,v=Math.PI,b=p(f),g=y(f),h=n?-2:0,M=s+(u?2:0),m=i+1,x=new Uint16Array(i*(s+d)*6),A=a[l],O=new Float32Array(3*c),w=new Float32Array(3*c),_=new Float32Array(2*c);let z=0,R=0;for(let a=h;a<=M;a++){let t,l=a/s,n=o*l;a<0?(n=0,l=1,t=e):a>s?(n=o,l=1,t=r):t=e+a/s*(r-e),-2!==a&&a!==s+2||(t=0,l=0),n-=o/2;for(let e=0;e<m;e++){const r=y(e*v*2/i),o=p(e*v*2/i);O[z+A[0]]=r*t,O[z+A[1]]=n,O[z+A[2]]=o*t,w[z+A[0]]=a<0||a>s?0:r*b,w[z+A[1]]=a<0?-1:a>s?1:g,w[z+A[2]]=a<0||a>s?0:o*b,_[R+0]=e/i,_[R+1]=l,R+=2,z+=3}}for(let a=0;a<s+d;a++)for(let t=0;t<i;t++){const e=6*(a*i+t);x[e+0]=m*(a+0)+0+t,x[e+1]=m*(a+0)+1+t,x[e+2]=m*(a+1)+1+t,x[e+3]=m*(a+0)+0+t,x[e+4]=m*(a+1)+1+t,x[e+5]=m*(a+1)+0+t}return{indices:x,attributes:{POSITION:{size:3,value:O},NORMAL:{size:3,value:w},TEXCOORD_0:{size:2,value:_}}}}exports.default=o;
},{"../geometry/geometry":"zvF0","@luma.gl/webgl":"KdJH"}],"wztz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./truncated-cone-geometry")),t=require("@luma.gl/webgl");function o(e){return e&&e.__esModule?e:{default:e}}class r extends e.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:o=(0,t.uid)("cone-geometry"),radius:r=1,cap:u=!0}=e;super({...e,id:o,topRadius:0,topCap:Boolean(u),bottomCap:Boolean(u),bottomRadius:r})}}exports.default=r;
},{"./truncated-cone-geometry":"BsEj","@luma.gl/webgl":"KdJH"}],"bmDE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("../geometry/geometry")),r=require("@luma.gl/webgl");function t(e){return e&&e.__esModule?e:{default:e}}const a=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),l=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),u=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),o=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),s={POSITION:{size:3,value:new Float32Array(l)},NORMAL:{size:3,value:new Float32Array(u)},TEXCOORD_0:{size:2,value:new Float32Array(o)}};class i extends e.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=(0,r.uid)("cube-geometry")}=e;super({...e,id:t,indices:{size:1,value:new Uint16Array(a)},attributes:{...s,...e.attributes}})}}exports.default=i;
},{"../geometry/geometry":"zvF0","@luma.gl/webgl":"KdJH"}],"fC4C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./truncated-cone-geometry")),t=require("@luma.gl/webgl");function r(e){return e&&e.__esModule?e:{default:e}}class u extends e.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:r=(0,t.uid)("cylinder-geometry"),radius:u=1}=e;super({...e,id:r,bottomRadius:u,topRadius:u})}}exports.default=u;
},{"./truncated-cone-geometry":"BsEj","@luma.gl/webgl":"KdJH"}],"IaOA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@math.gl/core"),e=s(require("../geometry/geometry")),r=require("@luma.gl/webgl");function s(t){return t&&t.__esModule?t:{default:t}}const n=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],a=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1];class o extends e.default{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=(0,r.uid)("ico-sphere-geometry")}=t,{indices:s,attributes:n}=u(t);super({...t,id:e,indices:s,attributes:{...n,...t.attributes}})}}function u(e){const{iterations:r=0}=e,s=Math.PI,o=2*s,u=[...n];let l=[...a];u.push(),l.push();const c=(()=>{const t={};return(e,r)=>{const s=(e*=3)>(r*=3)?e:r,n="".concat(e<r?e:r,"|").concat(s);if(n in t)return t[n];const a=u[e],o=u[e+1],l=u[e+2];let c=(a+u[r])/2,i=(o+u[r+1])/2,h=(l+u[r+2])/2;const d=Math.sqrt(c*c+i*i+h*h);return c/=d,i/=d,h/=d,u.push(c,i,h),t[n]=u.length/3-1}})();for(let t=0;t<r;t++){const t=[];for(let e=0;e<l.length;e+=3){const r=c(l[e+0],l[e+1]),s=c(l[e+1],l[e+2]),n=c(l[e+2],l[e+0]);t.push(n,l[e+0],r,r,l[e+1],s,s,l[e+2],n,r,s,n)}l=t}const i=new Array(u.length),h=new Array(u.length/3*2);for(let n=l.length-3;n>=0;n-=3){const e=l[n+0],r=l[n+1],a=l[n+2],c=3*e,d=3*r,p=3*a,g=2*e,y=2*r,M=2*a,f=u[c+0],z=u[c+1],v=u[c+2],w=Math.acos(v/Math.sqrt(f*f+z*z+v*v))/s,x=1-(Math.atan2(z,f)+s)/o,q=u[d+0],A=u[d+1],b=u[d+2],m=Math.acos(b/Math.sqrt(q*q+A*A+b*b))/s,O=1-(Math.atan2(A,q)+s)/o,_=u[p+0],F=u[p+1],I=u[p+2],P=Math.acos(I/Math.sqrt(_*_+F*F+I*I))/s,N=1-(Math.atan2(F,_)+s)/o,R=[_-q,F-A,I-b],T=[f-q,z-A,v-b],j=new t.Vector3(R).cross(T).normalize();let C;(0===x||0===O||0===N)&&(0===x||x>.5)&&(0===O||O>.5)&&(0===N||N>.5)&&(u.push(u[c+0],u[c+1],u[c+2]),C=u.length/3-1,l.push(C),h[2*C+0]=1,h[2*C+1]=w,i[3*C+0]=j.x,i[3*C+1]=j.y,i[3*C+2]=j.z,u.push(u[d+0],u[d+1],u[d+2]),C=u.length/3-1,l.push(C),h[2*C+0]=1,h[2*C+1]=m,i[3*C+0]=j.x,i[3*C+1]=j.y,i[3*C+2]=j.z,u.push(u[p+0],u[p+1],u[p+2]),C=u.length/3-1,l.push(C),h[2*C+0]=1,h[2*C+1]=P,i[3*C+0]=j.x,i[3*C+1]=j.y,i[3*C+2]=j.z),i[c+0]=i[d+0]=i[p+0]=j.x,i[c+1]=i[d+1]=i[p+1]=j.y,i[c+2]=i[d+2]=i[p+2]=j.z,h[g+0]=x,h[g+1]=w,h[y+0]=O,h[y+1]=m,h[M+0]=N,h[M+1]=P}return{indices:{size:1,value:new Uint16Array(l)},attributes:{POSITION:{size:3,value:new Float32Array(u)},NORMAL:{size:3,value:new Float32Array(i)},TEXCOORD_0:{size:2,value:new Float32Array(h)}}}}exports.default=o;
},{"@math.gl/core":"dwLx","../geometry/geometry":"zvF0","@luma.gl/webgl":"KdJH"}],"CGNT":[function(require,module,exports) {
"use strict";function e(e){const{indices:t,attributes:n}=e;if(!t)return e;const s=t.value.length,o={};for(const r in n){const e=n[r],{constant:c,value:u,size:i}=e;if(c||!i)continue;const a=new u.constructor(s*i);for(let n=0;n<s;++n){const e=t.value[n];for(let t=0;t<i;t++)a[n*i+t]=u[e*i+t]}o[r]={size:i,value:a}}return{attributes:Object.assign({},n,o)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.unpackIndexedGeometry=e;
},{}],"oQ0j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("../geometry/geometry")),t=require("../geometry/geometry-utils"),r=require("@luma.gl/webgl");function n(e){return e&&e.__esModule?e:{default:e}}class o extends e.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=(0,r.uid)("plane-geometry")}=e,{indices:n,attributes:o}=a(e);super({...e,id:t,indices:n,attributes:{...o,...e.attributes}})}}function a(e){const{type:r="x,y",offset:n=0,flipCull:o=!1,unpack:a=!1}=e,s=r.split(",");let l=e["".concat(s[0],"len")]||1;const u=e["".concat(s[1],"len")]||1,c=e["n".concat(s[0])]||1,i=e["n".concat(s[1])]||1,d=(c+1)*(i+1),y=new Float32Array(3*d),f=new Float32Array(3*d),p=new Float32Array(2*d);o&&(l=-l);let b=0,w=0;for(let t=0;t<=i;t++)for(let e=0;e<=c;e++){const a=e/c,s=t/i;switch(p[b+0]=o?1-a:a,p[b+1]=s,r){case"x,y":y[w+0]=l*a-.5*l,y[w+1]=u*s-.5*u,y[w+2]=n,f[w+0]=0,f[w+1]=0,f[w+2]=o?1:-1;break;case"x,z":y[w+0]=l*a-.5*l,y[w+1]=n,y[w+2]=u*s-.5*u,f[w+0]=0,f[w+1]=o?1:-1,f[w+2]=0;break;case"y,z":y[w+0]=n,y[w+1]=l*a-.5*l,y[w+2]=u*s-.5*u,f[w+0]=o?1:-1,f[w+1]=0,f[w+2]=0;break;default:throw new Error("PlaneGeometry: unknown type")}b+=2,w+=3}const g=c+1,m=new Uint16Array(c*i*6);for(let t=0;t<i;t++)for(let e=0;e<c;e++){const r=6*(t*c+e);m[r+0]=(t+0)*g+e,m[r+1]=(t+1)*g+e,m[r+2]=(t+0)*g+e+1,m[r+3]=(t+1)*g+e,m[r+4]=(t+1)*g+e+1,m[r+5]=(t+0)*g+e+1}const v={indices:{size:1,value:m},attributes:{POSITION:{size:3,value:y},NORMAL:{size:3,value:f},TEXCOORD_0:{size:2,value:p}}};return a?(0,t.unpackIndexedGeometry)(v):v}exports.default=o;
},{"../geometry/geometry":"zvF0","../geometry/geometry-utils":"CGNT","@luma.gl/webgl":"KdJH"}],"clhU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("../geometry/geometry")),t=require("@luma.gl/webgl");function r(e){return e&&e.__esModule?e:{default:e}}class s extends e.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:r=(0,t.uid)("sphere-geometry")}=e,{indices:s,attributes:n}=o(e);super({...e,id:r,indices:s,attributes:{...n,...e.attributes}})}}function o(e){const{nlat:t=10,nlong:r=10}=e;let{radius:s=1}=e;const o=Math.PI-0,n=2*Math.PI-0,a=(t+1)*(r+1);if("number"==typeof s){const e=s;s=((t,r,s,o,n)=>e)}const i=new Float32Array(3*a),u=new Float32Array(3*a),l=new Float32Array(2*a),c=new(a>65535?Uint32Array:Uint16Array)(t*r*6);for(let f=0;f<=t;f++)for(let e=0;e<=r;e++){const a=e/r,c=f/t,d=e+f*(r+1),y=2*d,M=3*d,h=n*a,v=o*c,b=Math.sin(h),g=Math.cos(h),p=Math.sin(v),A=g*p,O=Math.cos(v),m=b*p,w=s(A,O,m,a,c);i[M+0]=w*A,i[M+1]=w*O,i[M+2]=w*m,u[M+0]=A,u[M+1]=O,u[M+2]=m,l[y+0]=a,l[y+1]=1-c}const d=r+1;for(let f=0;f<r;f++)for(let e=0;e<t;e++){const r=6*(f*t+e);c[r+0]=e*d+f,c[r+1]=e*d+f+1,c[r+2]=(e+1)*d+f,c[r+3]=(e+1)*d+f,c[r+4]=e*d+f+1,c[r+5]=(e+1)*d+f+1}return{indices:{size:1,value:c},attributes:{POSITION:{size:3,value:i},NORMAL:{size:3,value:u},TEXCOORD_0:{size:2,value:l}}}}exports.default=s;
},{"../geometry/geometry":"zvF0","@luma.gl/webgl":"KdJH"}],"r0ew":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Timeline=void 0;let t=1,e=1;class i{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:i=0,duration:n=Number.POSITIVE_INFINITY,rate:s=1,repeat:a=1}=e,h=t++,m={time:0,delay:i,duration:n,rate:s,repeat:a};return this._setChannelTime(m,this.time),this.channels.set(h,m),h}removeChannel(t){this.channels.delete(t);for(const[e,i]of this.animations)i.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const n of e)this._setChannelTime(n,this.time);const i=this.animations.values();for(const n of i){const{animation:t,channel:e}=n;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,i){const n=e++;return this.animations.set(n,{animation:t,channel:i}),t.setTime(this.getTime(i)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const i=e-t.delay;i>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,i)%t.duration,t.time*=t.rate)}}exports.Timeline=i;
},{}],"dLHe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyFrames=void 0;class t{constructor(t){this._lastTime=-1,this.startIndex=-1,this.endIndex=-1,this.factor=0,this.times=[],this.values=[],this.setKeyFrames(t),this.setTime(0)}setKeyFrames(t){const e=t.length;this.times.length=e,this.values.length=e;for(let s=0;s<e;++s)this.times[s]=t[s][0],this.values[s]=t[s][1];this._calculateKeys(this._lastTime)}setTime(t){(t=Math.max(0,t))!==this._lastTime&&(this._calculateKeys(t),this._lastTime=t)}getStartTime(){return this.times[this.startIndex]}getEndTime(){return this.times[this.endIndex]}getStartData(){return this.values[this.startIndex]}getEndData(){return this.values[this.endIndex]}_calculateKeys(t){let e=0;const s=this.times.length;for(e=0;e<s-2&&!(this.times[e+1]>t);++e);this.startIndex=e,this.endIndex=e+1;const i=this.times[this.startIndex],h=this.times[this.endIndex];this.factor=Math.min(Math.max(0,(t-i)/(h-i)),1)}}exports.KeyFrames=t;
},{}],"KnxK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("../lib/model")),t=o(require("../geometry/geometry"));function o(e){return e&&e.__esModule?e:{default:e}}const a="attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",i=[-1,-1,1,-1,-1,1,1,1];class n extends e.default{constructor(e,o){const n=i.map(e=>-1===e?0:e);super(e,Object.assign({},o,{vs:a,geometry:new t.default({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(i)},aTexCoord:{size:2,value:new Float32Array(n)},aCoordinate:{size:2,value:new Float32Array(n)}}})})),this.setVertexCount(4)}}exports.default=n;
},{"../lib/model":"EKUN","../geometry/geometry":"zvF0"}],"YENE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AnimationLoop",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"ClipSpace",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(exports,"ConeGeometry",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"CubeGeometry",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"CylinderGeometry",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(exports,"Geometry",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"IcoSphereGeometry",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(exports,"KeyFrames",{enumerable:!0,get:function(){return d.KeyFrames}}),Object.defineProperty(exports,"Model",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"PlaneGeometry",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"ProgramManager",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"SphereGeometry",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(exports,"Timeline",{enumerable:!0,get:function(){return p.Timeline}}),Object.defineProperty(exports,"Transform",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"TruncatedConeGeometry",{enumerable:!0,get:function(){return c.default}});var e=s(require("./lib/animation-loop")),r=s(require("./lib/model")),t=s(require("./lib/program-manager")),n=s(require("./transform/transform")),o=s(require("./geometry/geometry")),u=s(require("./geometries/cone-geometry")),i=s(require("./geometries/cube-geometry")),a=s(require("./geometries/cylinder-geometry")),m=s(require("./geometries/ico-sphere-geometry")),f=s(require("./geometries/plane-geometry")),l=s(require("./geometries/sphere-geometry")),c=s(require("./geometries/truncated-cone-geometry")),p=require("./animation/timeline"),d=require("./animation/key-frames"),y=s(require("./utils/clip-space"));function s(e){return e&&e.__esModule?e:{default:e}}
},{"./lib/animation-loop":"HQLj","./lib/model":"EKUN","./lib/program-manager":"BP7a","./transform/transform":"XhAc","./geometry/geometry":"zvF0","./geometries/cone-geometry":"wztz","./geometries/cube-geometry":"bmDE","./geometries/cylinder-geometry":"fC4C","./geometries/ico-sphere-geometry":"IaOA","./geometries/plane-geometry":"oQ0j","./geometries/sphere-geometry":"clhU","./geometries/truncated-cone-geometry":"BsEj","./animation/timeline":"r0ew","./animation/key-frames":"dLHe","./utils/clip-space":"KnxK"}],"iuAK":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AnimationLoop",{enumerable:!0,get:function(){return n.AnimationLoop}}),Object.defineProperty(exports,"Buffer",{enumerable:!0,get:function(){return t.Buffer}}),Object.defineProperty(exports,"ClipSpace",{enumerable:!0,get:function(){return n.ClipSpace}}),Object.defineProperty(exports,"ConeGeometry",{enumerable:!0,get:function(){return n.ConeGeometry}}),Object.defineProperty(exports,"CubeGeometry",{enumerable:!0,get:function(){return n.CubeGeometry}}),Object.defineProperty(exports,"CylinderGeometry",{enumerable:!0,get:function(){return n.CylinderGeometry}}),Object.defineProperty(exports,"FEATURES",{enumerable:!0,get:function(){return t.FEATURES}}),Object.defineProperty(exports,"FragmentShader",{enumerable:!0,get:function(){return t.FragmentShader}}),Object.defineProperty(exports,"Framebuffer",{enumerable:!0,get:function(){return t.Framebuffer}}),Object.defineProperty(exports,"Geometry",{enumerable:!0,get:function(){return n.Geometry}}),Object.defineProperty(exports,"IcoSphereGeometry",{enumerable:!0,get:function(){return n.IcoSphereGeometry}}),Object.defineProperty(exports,"Model",{enumerable:!0,get:function(){return n.Model}}),Object.defineProperty(exports,"PlaneGeometry",{enumerable:!0,get:function(){return n.PlaneGeometry}}),Object.defineProperty(exports,"Program",{enumerable:!0,get:function(){return t.Program}}),Object.defineProperty(exports,"ProgramManager",{enumerable:!0,get:function(){return n.ProgramManager}}),Object.defineProperty(exports,"Renderbuffer",{enumerable:!0,get:function(){return t.Renderbuffer}}),Object.defineProperty(exports,"SphereGeometry",{enumerable:!0,get:function(){return n.SphereGeometry}}),Object.defineProperty(exports,"Texture2D",{enumerable:!0,get:function(){return t.Texture2D}}),Object.defineProperty(exports,"Texture3D",{enumerable:!0,get:function(){return t.Texture3D}}),Object.defineProperty(exports,"TextureCube",{enumerable:!0,get:function(){return t.TextureCube}}),Object.defineProperty(exports,"Timeline",{enumerable:!0,get:function(){return n.Timeline}}),Object.defineProperty(exports,"Transform",{enumerable:!0,get:function(){return n.Transform}}),Object.defineProperty(exports,"TransformFeedback",{enumerable:!0,get:function(){return t.TransformFeedback}}),Object.defineProperty(exports,"TruncatedConeGeometry",{enumerable:!0,get:function(){return n.TruncatedConeGeometry}}),Object.defineProperty(exports,"VertexShader",{enumerable:!0,get:function(){return t.VertexShader}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return t.assert}}),Object.defineProperty(exports,"clear",{enumerable:!0,get:function(){return t.clear}}),Object.defineProperty(exports,"cloneTextureFrom",{enumerable:!0,get:function(){return t.cloneTextureFrom}}),Object.defineProperty(exports,"copyToTexture",{enumerable:!0,get:function(){return t.copyToTexture}}),Object.defineProperty(exports,"createGLContext",{enumerable:!0,get:function(){return r.createGLContext}}),Object.defineProperty(exports,"cssToDevicePixels",{enumerable:!0,get:function(){return r.cssToDevicePixels}}),Object.defineProperty(exports,"cssToDeviceRatio",{enumerable:!0,get:function(){return r.cssToDeviceRatio}}),Object.defineProperty(exports,"dirlight",{enumerable:!0,get:function(){return o.dirlight}}),Object.defineProperty(exports,"fp32",{enumerable:!0,get:function(){return o.fp32}}),Object.defineProperty(exports,"fp64",{enumerable:!0,get:function(){return o.fp64}}),Object.defineProperty(exports,"getParameters",{enumerable:!0,get:function(){return r.getParameters}}),Object.defineProperty(exports,"gouraudLighting",{enumerable:!0,get:function(){return o.gouraudLighting}}),Object.defineProperty(exports,"hasFeature",{enumerable:!0,get:function(){return t.hasFeature}}),Object.defineProperty(exports,"hasFeatures",{enumerable:!0,get:function(){return t.hasFeatures}}),Object.defineProperty(exports,"instrumentGLContext",{enumerable:!0,get:function(){return r.instrumentGLContext}}),Object.defineProperty(exports,"isWebGL",{enumerable:!0,get:function(){return r.isWebGL}}),Object.defineProperty(exports,"isWebGL2",{enumerable:!0,get:function(){return r.isWebGL2}}),Object.defineProperty(exports,"log",{enumerable:!0,get:function(){return t.log}}),Object.defineProperty(exports,"lumaStats",{enumerable:!0,get:function(){return t.lumaStats}}),Object.defineProperty(exports,"normalizeShaderModule",{enumerable:!0,get:function(){return o.normalizeShaderModule}}),Object.defineProperty(exports,"pbr",{enumerable:!0,get:function(){return o.pbr}}),Object.defineProperty(exports,"phongLighting",{enumerable:!0,get:function(){return o.phongLighting}}),Object.defineProperty(exports,"picking",{enumerable:!0,get:function(){return o.picking}}),Object.defineProperty(exports,"project",{enumerable:!0,get:function(){return o.project}}),Object.defineProperty(exports,"readPixelsToArray",{enumerable:!0,get:function(){return t.readPixelsToArray}}),Object.defineProperty(exports,"readPixelsToBuffer",{enumerable:!0,get:function(){return t.readPixelsToBuffer}}),Object.defineProperty(exports,"resetParameters",{enumerable:!0,get:function(){return r.resetParameters}}),Object.defineProperty(exports,"setParameters",{enumerable:!0,get:function(){return r.setParameters}}),Object.defineProperty(exports,"uid",{enumerable:!0,get:function(){return t.uid}}),Object.defineProperty(exports,"withParameters",{enumerable:!0,get:function(){return r.withParameters}});var r=require("@luma.gl/gltools"),t=require("@luma.gl/webgl"),n=require("@luma.gl/engine"),o=require("@luma.gl/shadertools");
},{"@luma.gl/gltools":"lAom","@luma.gl/webgl":"KdJH","@luma.gl/engine":"YENE","@luma.gl/shadertools":"Pzgo","buffer":"aMB2"}],"kPtk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AmbientLight=void 0;var t=e(require("@babel/runtime/helpers/esm/defineProperty"));function e(t){return t&&t.__esModule?t:{default:t}}const i=[255,255,255],s=1;let o=0;class n{constructor(e={}){(0,t.default)(this,"id",void 0),(0,t.default)(this,"color",void 0),(0,t.default)(this,"intensity",void 0),(0,t.default)(this,"type","ambient");const{color:n=i}=e,{intensity:r=s}=e;this.id=e.id||"ambient-".concat(o++),this.color=n,this.intensity=r}}exports.AmbientLight=n;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"n3wt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DirectionalLight=void 0;var t=i(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@math.gl/core");function i(t){return t&&t.__esModule?t:{default:t}}const o=[255,255,255],r=1,s=[0,0,-1];let d=0;class n{constructor(i={}){(0,t.default)(this,"id",void 0),(0,t.default)(this,"color",void 0),(0,t.default)(this,"intensity",void 0),(0,t.default)(this,"type","directional"),(0,t.default)(this,"direction",void 0),(0,t.default)(this,"shadow",void 0);const{color:n=o}=i,{intensity:c=r}=i,{direction:l=s}=i,{_shadow:a=!1}=i;this.id=i.id||"directional-".concat(d++),this.color=n,this.intensity=c,this.type="directional",this.direction=new e.Vector3(l).normalize().toArray(),this.shadow=a}getProjectedLight(t){return this}}exports.DirectionalLight=n;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx"}],"ay01":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty"));function s(e){return e&&e.__esModule?e:{default:e}}class t{constructor(s,t={id:"pass"}){(0,e.default)(this,"id",void 0),(0,e.default)(this,"gl",void 0),(0,e.default)(this,"props",void 0);const{id:r}=t;this.id=r,this.gl=s,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}exports.default=t;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"oM9Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.layerIndexResolver=o;var e=a(require("@babel/runtime/helpers/esm/defineProperty")),r=a(require("./pass")),t=require("@luma.gl/core");function a(e){return e&&e.__esModule?e:{default:e}}class s extends r.default{constructor(...r){super(...r),(0,e.default)(this,"_lastRenderIndex",-1)}render(e){const r=this.gl;return(0,t.setParameters)(r,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:r,moduleParameters:t,viewports:a,views:s,onViewportActive:o,clearStack:i=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const u=this.gl;l&&n(u,r),i&&(this._lastRenderIndex=-1);const c=[];for(const n of a){const a=s&&s[n.id];null==o||o(n);const i=this._getDrawLayerParams(n,e),l=n.subViewports||[n];for(const s of l){const o=this._drawLayersInViewport(u,{target:r,moduleParameters:t,viewport:s,view:a,pass:e.pass,layers:e.layers},i);c.push(o)}}return c}_getDrawLayerParams(e,{layers:r,pass:t,isPicking:a=!1,layerFilter:s,cullRect:i,effects:n,moduleParameters:l},u=!1){const c=[],d=o(this._lastRenderIndex+1),p={layer:r[0],viewport:e,isPicking:a,renderPass:t,cullRect:i},f={};for(let o=0;o<r.length;o++){const a=r[o],i=this._shouldDrawLayer(a,p,s,f),m={shouldDrawLayer:i};i&&!u&&(m.layerRenderIndex=d(a,i),m.moduleParameters=this._getModuleParameters(a,n,t,l),m.layerParameters=this.getLayerParameters(a,o,e)),c[o]=m}return c}_drawLayersInViewport(e,{layers:r,moduleParameters:a,pass:s,target:o,viewport:n,view:l},u){const c=i(e,{moduleParameters:a,target:o,viewport:n});if(l&&l.props.clear){const r=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;(0,t.withParameters)(e,{scissorTest:!0,scissor:c},()=>(0,t.clear)(e,r))}const d={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};(0,t.setParameters)(e,{viewport:c});for(let t=0;t<r.length;t++){const e=r[t],{shouldDrawLayer:a,layerRenderIndex:o,moduleParameters:i,layerParameters:l}=u[t];if(a&&e.props.pickable&&d.pickableCount++,e.isComposite)d.compositeCount++;else if(a){d.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,o),i.viewport=n;try{e._drawLayer({moduleParameters:i,uniforms:{layerIndex:o},parameters:l})}catch(p){e.raiseError(p,"drawing ".concat(e," to ").concat(s))}}}return d}shouldDrawLayer(e){return!0}getModuleParameters(e,r){return null}getLayerParameters(e,r,t){return e.props.parameters}_shouldDrawLayer(e,r,t,a){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;r.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(t){const e=r.layer.id;if(e in a||(a[e]=t(r)),!a[e])return!1}return e.activateViewport(r.viewport),!0}_getModuleParameters(e,r,a,s){var o;const i=Object.assign(Object.create((null===(o=e.internalState)||void 0===o?void 0:o.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:(0,t.cssToDeviceRatio)(this.gl)});if(r)for(const t of r){var n;Object.assign(i,null===(n=t.getModuleParameters)||void 0===n?void 0:n.call(t,e))}return Object.assign(i,this.getModuleParameters(e,r),s)}}function o(e=0,r={}){const t={},a=(s,i)=>{const n=s.props._offset,l=s.id,u=s.parent&&s.parent.id;let c;if(!u||u in r||a(s.parent,!1),u in t){const e=t[u]=t[u]||o(r[u],r);c=e(s,i),t[l]=e}else Number.isFinite(n)?(c=n+(r[u]||0),t[l]=null):c=e;return i&&c>=e&&(e=c+1),r[l]=c,c};return a}function i(e,{moduleParameters:r,target:a,viewport:s}){const o=a&&"default-framebuffer"!==a.id,i=r&&r.devicePixelRatio||(0,t.cssToDeviceRatio)(e),n=o?a.height:e.drawingBufferHeight,l=s;return[l.x*i,n-(l.y+l.height)*i,l.width*i,l.height*i]}function n(e,r){const a=r?r.width:e.drawingBufferWidth,s=r?r.height:e.drawingBufferHeight;(0,t.setParameters)(e,{viewport:[0,0,a,s]}),e.clear(16640)}exports.default=s;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./pass":"ay01","@luma.gl/core":"iuAK"}],"STtv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=h(require("@babel/runtime/helpers/esm/defineProperty")),t=h(require("./layers-pass")),s=require("@luma.gl/core");function h(e){return e&&e.__esModule?e:{default:e}}class r extends t.default{constructor(t,h){super(t,h),(0,e.default)(this,"shadowMap",void 0),(0,e.default)(this,"depthBuffer",void 0),(0,e.default)(this,"fbo",void 0),this.shadowMap=new s.Texture2D(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new s.Renderbuffer(t,{format:33189,width:1,height:1}),this.fbo=new s.Framebuffer(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;(0,s.withParameters)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const h=e.viewports[0],r=(0,s.cssToDeviceRatio)(this.gl),d=h.width*r,a=h.height*r;d===t.width&&a===t.height||t.resize({width:d,height:a}),super.render({...e,target:t,pass:"shadow"})})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./layers-pass":"oM9Q","@luma.gl/core":"iuAK"}],"uFGI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const e="#define SMOOTH_EDGE_RADIUS 0.5",n="\n".concat(e,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),t="\n".concat(e,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n");var o={name:"geometry",vs:n,fs:t};exports.default=o;
},{}],"HHu4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o=require("../../lib/constants");const e=Object.keys(o.COORDINATE_SYSTEM).map(e=>"const int COORDINATE_SYSTEM_".concat(e," = ").concat(o.COORDINATE_SYSTEM[e],";")).join(""),n=Object.keys(o.PROJECTION_MODE).map(e=>"const int PROJECTION_MODE_".concat(e," = ").concat(o.PROJECTION_MODE[e],";")).join(""),t=Object.keys(o.UNIT).map(e=>"const int UNIT_".concat(e.toUpperCase()," = ").concat(o.UNIT[e],";")).join("");var r="".concat(e,"\n").concat(n,"\n").concat(t,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n");exports.default=r;
},{"../../lib/constants":"ysbg"}],"uXG5":[function(require,module,exports) {
"use strict";function r(r,e){if(r===e)return!0;if(Array.isArray(r)){const t=r.length;if(!e||e.length!==t)return!1;for(let n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}return!1}function e(e){let t,n={};return u=>{for(const f in u)if(!r(u[f],n[f])){t=e(u),n=u;break}return t}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"iWu9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOffsetOrigin=M,exports.getUniformsFromViewport=_;var e=a(require("gl-matrix/mat4")),t=a(require("gl-matrix/vec4")),r=require("../../lib/constants"),o=i(require("../../utils/memoize"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function a(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(o,a,c):o[a]=e[a]}return o.default=e,r&&r.set(e,o),o}const c=[0,0,0,0],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p=[0,0,0],O=[0,0,0],l=(0,o.default)(E);function M(e,t,o=O){o.length<3&&(o=[o[0],o[1],0]);let i,n=o,a=!0;switch(i=t===r.COORDINATE_SYSTEM.LNGLAT_OFFSETS||t===r.COORDINATE_SYSTEM.METER_OFFSETS?o:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case r.PROJECTION_MODE.WEB_MERCATOR:t!==r.COORDINATE_SYSTEM.LNGLAT&&t!==r.COORDINATE_SYSTEM.CARTESIAN||(i=[0,0,0],a=!1);break;case r.PROJECTION_MODE.WEB_MERCATOR_AUTO_OFFSET:t===r.COORDINATE_SYSTEM.LNGLAT?n=i:t===r.COORDINATE_SYSTEM.CARTESIAN&&(n=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],i=e.unprojectPosition(n),n[0]-=o[0],n[1]-=o[1],n[2]-=o[2]);break;case r.PROJECTION_MODE.IDENTITY:(n=e.position.map(Math.fround))[2]=n[2]||0;break;case r.PROJECTION_MODE.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:a}}function d(r,o,i){const{viewMatrixUncentered:n,projectionMatrix:a}=r;let{viewMatrix:s,viewProjectionMatrix:p}=r,O=c,l=c,d=r.cameraPosition;const{geospatialOrigin:_,shaderCoordinateOrigin:E,offsetMode:T}=M(r,o,i);return T&&(l=r.projectPosition(_||E),d=[d[0]-l[0],d[1]-l[1],d[2]-l[2]],l[3]=1,O=t.transformMat4([],l,p),s=n||s,p=e.multiply([],a,s),p=e.multiply([],p,u)),{viewMatrix:s,viewProjectionMatrix:p,projectionCenter:O,originCommon:l,cameraPosCommon:d,shaderCoordinateOrigin:E,geospatialOrigin:_}}function _({viewport:e,devicePixelRatio:t=1,modelMatrix:o=null,coordinateSystem:i=r.COORDINATE_SYSTEM.DEFAULT,coordinateOrigin:n=O,autoWrapLongitude:a=!1}){i===r.COORDINATE_SYSTEM.DEFAULT&&(i=e.isGeospatial?r.COORDINATE_SYSTEM.LNGLAT:r.COORDINATE_SYSTEM.CARTESIAN);const c=l({viewport:e,devicePixelRatio:t,coordinateSystem:i,coordinateOrigin:n});return c.project_uWrapLongitude=a,c.project_uModelMatrix=o||s,c}function E({viewport:e,devicePixelRatio:o,coordinateSystem:i,coordinateOrigin:n}){const{projectionCenter:a,viewProjectionMatrix:c,originCommon:u,cameraPosCommon:O,shaderCoordinateOrigin:l,geospatialOrigin:M}=d(e,i,n),_=e.getDistanceScales(),E=[e.width*o,e.height*o],T=t.transformMat4([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,m={project_uCoordinateSystem:i,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:u.slice(0,3),project_uCenter:a,project_uPseudoMeters:Boolean(e._pseudoMeters),project_uViewportSize:E,project_uDevicePixelRatio:o,project_uFocalDistance:T,project_uCommonUnitsPerMeter:_.unitsPerMeter,project_uCommonUnitsPerWorldUnit:_.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:p,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:c,project_uModelMatrix:s,project_uCameraPosition:O};if(M){const t=e.getDistanceScales(M);switch(i){case r.COORDINATE_SYSTEM.METER_OFFSETS:m.project_uCommonUnitsPerWorldUnit=t.unitsPerMeter,m.project_uCommonUnitsPerWorldUnit2=t.unitsPerMeter2;break;case r.COORDINATE_SYSTEM.LNGLAT:case r.COORDINATE_SYSTEM.LNGLAT_OFFSETS:e._pseudoMeters||(m.project_uCommonUnitsPerMeter=t.unitsPerMeter),m.project_uCommonUnitsPerWorldUnit=t.unitsPerDegree,m.project_uCommonUnitsPerWorldUnit2=t.unitsPerDegree2;break;case r.COORDINATE_SYSTEM.CARTESIAN:m.project_uCommonUnitsPerWorldUnit=[1,1,t.unitsPerMeter[2]],m.project_uCommonUnitsPerWorldUnit2=[0,0,t.unitsPerMeter2[2]]}}return m}
},{"gl-matrix/mat4":"w3aR","gl-matrix/vec4":"zWbG","../../lib/constants":"ysbg","../../utils/memoize":"uXG5"}],"NVOm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@luma.gl/core"),r=u(require("../misc/geometry")),t=u(require("./project.glsl")),o=require("./viewport-uniforms");function u(e){return e&&e.__esModule?e:{default:e}}const i={};function n(e=i){return"viewport"in e?(0,o.getUniformsFromViewport)(e):{}}var s={name:"project",dependencies:[e.fp32,r.default],vs:t.default,getUniforms:n};exports.default=s;
},{"@luma.gl/core":"iuAK","../misc/geometry":"uFGI","./project.glsl":"HHu4","./viewport-uniforms":"iWu9"}],"AE6F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clamp=s,exports.createMat4=r,exports.lerp=n,exports.log2=void 0,exports.mod=o,exports.transformVector=e;var t=require("gl-matrix/vec4");function r(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function e(r,e){const o=(0,t.transformMat4)([],e,r);return(0,t.scale)(o,o,1/o[3]),o}function o(t,r){const e=t%r;return e<0?r+e:e}function n(t,r,e){return e*r+(1-e)*t}function s(t,r,e){return t<r?r:t>e?e:t}function c(t){return Math.log(t)*Math.LOG2E}const u=Math.log2||c;exports.log2=u;
},{"gl-matrix/vec4":"zWbG"}],"zuem":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)throw new Error(r||"@math.gl/web-mercator: assertion failed.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"eDN9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MAX_LATITUDE=exports.DEFAULT_ALTITUDE=void 0,exports.addMetersToLngLat=F,exports.altitudeToFovy=L,exports.fovyToAltitude=w,exports.getDistanceScales=T,exports.getMeterZoom=b,exports.getProjectionMatrix=D,exports.getProjectionParameters=N,exports.getViewMatrix=y,exports.lngLatToWorld=g,exports.pixelsToWorld=j,exports.scaleToZoom=x,exports.unitsPerMeter=v,exports.worldToLngLat=P,exports.worldToPixels=_,exports.zoomToScale=m;var t=require("./math-utils"),e=s(require("gl-matrix/mat4")),r=s(require("gl-matrix/vec2")),n=s(require("gl-matrix/vec3")),i=o(require("./assert"));function o(t){return t&&t.__esModule?t:{default:t}}function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(a=function(t){return t?r:e})(t)}function s(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=a(e);if(r&&r.has(t))return r.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,r&&r.set(t,n),n}const u=Math.PI,c=u/4,l=u/180,f=180/u,p=512,d=4003e4,M=85.051129;exports.MAX_LATITUDE=85.051129;const h=1.5;function m(t){return Math.pow(2,t)}function x(e){return(0,t.log2)(e)}function g(t){const[e,r]=t;(0,i.default)(Number.isFinite(e)),(0,i.default)(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const n=r*l;return[p*(e*l+u)/(2*u),p*(u+Math.log(Math.tan(c+.5*n)))/(2*u)]}function P(t){const[e,r]=t,n=e/p*(2*u)-u,i=2*(Math.atan(Math.exp(r/p*(2*u)-u))-c);return[n*f,i*f]}function b(t){const{latitude:e}=t;(0,i.default)(Number.isFinite(e));const r=Math.cos(e*l);return x(d*r)-9}function v(t){const e=Math.cos(t*l);return p/d/e}function T(t){const{latitude:e,longitude:r,highPrecision:n=!1}=t;(0,i.default)(Number.isFinite(e)&&Number.isFinite(r));const o=p,a=Math.cos(e*l),s=o/360,u=s/a,c=o/d/a,f={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[s,u,c],degreesPerUnit:[1/s,1/u,1/c]};if(n){const t=l*Math.tan(e*l)/a,r=s*t/2,n=o/d*t,i=n/u*c;f.unitsPerDegree2=[0,r,n],f.unitsPerMeter2=[i,0,i]}return f}function F(t,e){const[r,n,i]=t,[o,a,s]=e,{unitsPerMeter:u,unitsPerMeter2:c}=T({longitude:r,latitude:n,highPrecision:!0}),l=g(t);l[0]+=o*(u[0]+c[0]*a),l[1]+=a*(u[1]+c[1]*a);const f=P(l),p=(i||0)+(s||0);return Number.isFinite(i)||Number.isFinite(s)?[f[0],f[1],p]:f}function y(r){const{height:i,pitch:o,bearing:a,altitude:s,scale:u,center:c}=r,f=(0,t.createMat4)();e.translate(f,f,[0,0,-s]),e.rotateX(f,f,-o*l),e.rotateZ(f,f,a*l);const p=u/i;return e.scale(f,f,[p,p,p]),c&&e.translate(f,f,n.negate([],c)),f}function N(e){const{width:r,height:n,altitude:i,pitch:o=0,offset:a,center:s,scale:u,nearZMultiplier:c=1,farZMultiplier:f=1}=e;let{fovy:p=L(h)}=e;void 0!==i&&(p=L(i));const d=p*l,M=o*l,m=w(p);let x=m;s&&(x+=s[2]*u/Math.cos(M)/n);const g=d*(.5+(a?a[1]:0)/n),P=Math.sin(g)*x/Math.sin((0,t.clamp)(Math.PI/2-M-g,.01,Math.PI-.01)),b=Math.sin(M)*P+x,v=10*x;return{fov:d,aspect:r/n,focalDistance:m,near:c,far:Math.min(b*f,v)}}function D(t){const{fov:r,aspect:n,near:i,far:o}=N(t);return e.perspective([],r,n,i,o)}function L(t){return 2*Math.atan(.5/t)*f}function w(t){return.5/Math.tan(.5*t*l)}function _(e,r){const[n,o,a=0]=e;return(0,i.default)(Number.isFinite(n)&&Number.isFinite(o)&&Number.isFinite(a)),(0,t.transformVector)(r,[n,o,a,1])}function j(e,n,o=0){const[a,s,u]=e;if((0,i.default)(Number.isFinite(a)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(u)){return(0,t.transformVector)(n,[a,s,u,1])}const c=(0,t.transformVector)(n,[a,s,0,1]),l=(0,t.transformVector)(n,[a,s,1,1]),f=c[2],p=l[2],d=f===p?0:((o||0)-f)/(p-f);return r.lerp([],c,l,d)}exports.DEFAULT_ALTITUDE=h;
},{"./math-utils":"AE6F","gl-matrix/mat4":"w3aR","gl-matrix/vec2":"XSo1","gl-matrix/vec3":"AWBd","./assert":"zuem"}],"Lip1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=a;var t=i(require("./assert")),e=require("./math-utils"),o=require("./web-mercator-utils");function i(t){return t&&t.__esModule?t:{default:t}}function a(i){const{width:a,height:u,bounds:n,minExtent:l=0,maxZoom:s=24,offset:m=[0,0]}=i,[[b,d],[h,f]]=n,M=r(i.padding),g=(0,o.lngLatToWorld)([b,(0,e.clamp)(f,-o.MAX_LATITUDE,o.MAX_LATITUDE)]),p=(0,o.lngLatToWorld)([h,(0,e.clamp)(d,-o.MAX_LATITUDE,o.MAX_LATITUDE)]),T=[Math.max(Math.abs(p[0]-g[0]),l),Math.max(Math.abs(p[1]-g[1]),l)],c=[a-M.left-M.right-2*Math.abs(m[0]),u-M.top-M.bottom-2*Math.abs(m[1])];(0,t.default)(c[0]>0&&c[1]>0);const A=c[0]/T[0],L=c[1]/T[1],_=(M.right-M.left)/2/A,x=(M.top-M.bottom)/2/L,E=[(p[0]+g[0])/2+_,(p[1]+g[1])/2+x],F=(0,o.worldToLngLat)(E),N=Math.min(s,(0,e.log2)(Math.abs(Math.min(A,L))));return(0,t.default)(Number.isFinite(N)),{longitude:F[0],latitude:F[1],zoom:N}}function r(e=0){return"number"==typeof e?{top:e,bottom:e,left:e,right:e}:((0,t.default)(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}
},{"./assert":"zuem","./math-utils":"AE6F","./web-mercator-utils":"eDN9"}],"tHha":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=a;var e=require("./web-mercator-utils"),t=o(require("gl-matrix/vec2")),r=require("./math-utils");function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var o={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=u?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(o,a,i):o[a]=e[a]}return o.default=e,r&&r.set(e,o),o}const u=Math.PI/180;function a(e,t=0){const{width:r,height:n,unproject:o}=e,a={targetZ:t},c=o([0,n],a),f=o([r,n],a);let l,p;return(e.fovy?.5*e.fovy*u:Math.atan(.5/e.altitude))>(90-e.pitch)*u-.01?(l=i(e,0,t),p=i(e,r,t)):(l=o([0,0],a),p=o([r,0],a)),[c,f,p,l]}function i(n,o,u){const{pixelUnprojectionMatrix:a}=n,i=(0,r.transformVector)(a,[o,0,1,1]),c=(0,r.transformVector)(a,[o,n.height,1,1]),f=(u*n.distanceScales.unitsPerMeter[2]-i[2])/(c[2]-i[2]),l=t.lerp([],i,c,f),p=(0,e.worldToLngLat)(l);return p.push(u),p}
},{"./web-mercator-utils":"eDN9","gl-matrix/vec2":"XSo1","./math-utils":"AE6F"}],"btK9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=h(require("@babel/runtime/helpers/esm/defineProperty")),e=require("./math-utils"),i=require("./web-mercator-utils"),r=h(require("./fit-bounds")),o=h(require("./get-bounds")),n=u(require("gl-matrix/mat4")),a=u(require("gl-matrix/vec2")),s=u(require("gl-matrix/vec3"));function l(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(l=function(t){return t?i:e})(t)}function u(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var i=l(e);if(i&&i.has(t))return i.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if("default"!==n&&Object.prototype.hasOwnProperty.call(t,n)){var a=o?Object.getOwnPropertyDescriptor(t,n):null;a&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n]}return r.default=t,i&&i.set(t,r),r}function h(t){return t&&t.__esModule?t:{default:t}}class d{constructor(e={width:1,height:1}){(0,t.default)(this,"latitude",void 0),(0,t.default)(this,"longitude",void 0),(0,t.default)(this,"zoom",void 0),(0,t.default)(this,"pitch",void 0),(0,t.default)(this,"bearing",void 0),(0,t.default)(this,"altitude",void 0),(0,t.default)(this,"fovy",void 0),(0,t.default)(this,"meterOffset",void 0),(0,t.default)(this,"center",void 0),(0,t.default)(this,"width",void 0),(0,t.default)(this,"height",void 0),(0,t.default)(this,"scale",void 0),(0,t.default)(this,"distanceScales",void 0),(0,t.default)(this,"viewMatrix",void 0),(0,t.default)(this,"projectionMatrix",void 0),(0,t.default)(this,"viewProjectionMatrix",void 0),(0,t.default)(this,"pixelProjectionMatrix",void 0),(0,t.default)(this,"pixelUnprojectionMatrix",void 0),(0,t.default)(this,"equals",t=>t instanceof d&&(t.width===this.width&&t.height===this.height&&n.equals(t.projectionMatrix,this.projectionMatrix)&&n.equals(t.viewMatrix,this.viewMatrix))),(0,t.default)(this,"project",(t,e={})=>{const{topLeft:r=!0}=e,o=this.projectPosition(t),n=(0,i.worldToPixels)(o,this.pixelProjectionMatrix),[a,s]=n,l=r?s:this.height-s;return 2===t.length?[a,l]:[a,l,n[2]]}),(0,t.default)(this,"unproject",(t,e={})=>{const{topLeft:r=!0,targetZ:o}=e,[n,a,s]=t,l=r?a:this.height-a,u=o&&o*this.distanceScales.unitsPerMeter[2],h=(0,i.pixelsToWorld)([n,l,s],this.pixelUnprojectionMatrix,u),[d,c,p]=this.unprojectPosition(h);return Number.isFinite(s)?[d,c,p]:Number.isFinite(o)?[d,c,o]:[d,c]}),(0,t.default)(this,"projectPosition",t=>{const[e,r]=(0,i.lngLatToWorld)(t);return[e,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}),(0,t.default)(this,"unprojectPosition",t=>{const[e,r]=(0,i.worldToLngLat)(t);return[e,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]});let{width:r,height:o,altitude:a=null,fovy:l=null}=e;const{latitude:u=0,longitude:h=0,zoom:c=0,pitch:p=0,bearing:f=0,position:g=null,nearZMultiplier:M=.02,farZMultiplier:v=1.01}=e;r=r||1,o=o||1,null===l&&null===a?(a=i.DEFAULT_ALTITUDE,l=(0,i.altitudeToFovy)(a)):null===l?l=(0,i.altitudeToFovy)(a):null===a&&(a=(0,i.fovyToAltitude)(l));const x=(0,i.zoomToScale)(c);a=Math.max(.75,a);const j=(0,i.getDistanceScales)({longitude:h,latitude:u}),m=(0,i.lngLatToWorld)([h,u]);m.push(0),g&&s.add(m,m,s.mul([],g,j.unitsPerMeter)),this.projectionMatrix=(0,i.getProjectionMatrix)({width:r,height:o,scale:x,center:m,pitch:p,fovy:l,nearZMultiplier:M,farZMultiplier:v}),this.viewMatrix=(0,i.getViewMatrix)({height:o,scale:x,center:m,pitch:p,bearing:f,altitude:a}),this.width=r,this.height=o,this.scale=x,this.latitude=u,this.longitude=h,this.zoom=c,this.pitch=p,this.bearing=f,this.altitude=a,this.fovy=l,this.center=m,this.meterOffset=g||[0,0,0],this.distanceScales=j,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:t,height:i,projectionMatrix:r,viewMatrix:o}=this,a=(0,e.createMat4)();n.multiply(a,a,r),n.multiply(a,a,o),this.viewProjectionMatrix=a;const s=(0,e.createMat4)();n.scale(s,s,[t/2,-i/2,1]),n.translate(s,s,[1,-1,0]),n.multiply(s,s,a);const l=n.invert((0,e.createMat4)(),s);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=s,this.pixelUnprojectionMatrix=l}projectFlat(t){return(0,i.lngLatToWorld)(t)}unprojectFlat(t){return(0,i.worldToLngLat)(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const r=(0,i.pixelsToWorld)(e,this.pixelUnprojectionMatrix),o=(0,i.lngLatToWorld)(t),n=a.add([],o,a.negate([],r)),s=a.add([],this.center,n);return(0,i.worldToLngLat)(s)}fitBounds(t,e={}){const{width:i,height:o}=this,{longitude:n,latitude:a,zoom:s}=(0,r.default)(Object.assign({width:i,height:o,bounds:t},e));return new d({width:i,height:o,longitude:n,latitude:a,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),i=Math.min(...e.map(t=>t[0])),r=Math.max(...e.map(t=>t[0]));return[[i,Math.min(...e.map(t=>t[1]))],[r,Math.max(...e.map(t=>t[1]))]]}getBoundingRegion(t={}){return(0,o.default)(this,t.z||0)}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}}exports.default=d;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./math-utils":"AE6F","./web-mercator-utils":"eDN9","./fit-bounds":"Lip1","./get-bounds":"tHha","gl-matrix/mat4":"w3aR","gl-matrix/vec2":"XSo1","gl-matrix/vec3":"AWBd"}],"BccJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=i;var t=require("./web-mercator-utils"),e=require("./math-utils");const o=512;function i(i){const{width:r,height:l,pitch:n=0}=i;let{longitude:s,latitude:u,zoom:d,bearing:a=0}=i;(s<-180||s>180)&&(s=(0,e.mod)(s+180,360)-180),(a<-180||a>180)&&(a=(0,e.mod)(a+180,360)-180);const c=(0,e.log2)(l/o);if(d<=c)d=c,u=0;else{const e=l/2/Math.pow(2,d),i=(0,t.worldToLngLat)([0,e])[1];if(u<i)u=i;else{const i=(0,t.worldToLngLat)([0,o-e])[1];u>i&&(u=i)}}return{width:r,height:l,longitude:s,latitude:u,zoom:d,pitch:n,bearing:a}}
},{"./web-mercator-utils":"eDN9","./math-utils":"AE6F"}],"Ytqr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=s,exports.getFlyToDuration=l;var t=require("./math-utils"),e=require("./web-mercator-utils"),r=n(require("gl-matrix/vec2"));function o(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(o=function(t){return t?r:e})(t)}function n(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=o(e);if(r&&r.has(t))return r.get(t);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var i=a?Object.getOwnPropertyDescriptor(t,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=t[u]}return n.default=t,r&&r.set(t,n),n}const a=.01,u=["longitude","latitude","zoom"],i={curve:1.414,speed:1.2};function s(o,n,i,s){const{startZoom:l,startCenterXY:h,uDelta:f,w0:d,u1:p,S:g,rho:m,rho2:M,r0:b}=c(o,n,s);if(p<a){const e={};for(const r of u){const a=o[r],u=n[r];e[r]=(0,t.lerp)(a,u,i)}return e}const y=i*g,v=Math.cosh(b)/Math.cosh(b+m*y),w=d*((Math.cosh(b)*Math.tanh(b+m*y)-Math.sinh(b))/M)/p,O=1/v,j=l+(0,e.scaleToZoom)(O),x=r.scale([],f,w);r.add(x,x,h);const T=(0,e.worldToLngLat)(x);return{longitude:T[0],latitude:T[1],zoom:j}}function l(t,e,r){const o={...i,...r},{screenSpeed:n,speed:a,maxDuration:u}=o,{S:s,rho:l}=c(t,e,o),h=1e3*s;let f;return f=Number.isFinite(n)?h/(n/l):h/a,Number.isFinite(u)&&f>u?0:f}function c(t,o,n){const u=(n=Object.assign({},i,n)).curve,s=t.zoom,l=[t.longitude,t.latitude],c=(0,e.zoomToScale)(s),h=o.zoom,f=[o.longitude,o.latitude],d=(0,e.zoomToScale)(h-s),p=(0,e.lngLatToWorld)(l),g=(0,e.lngLatToWorld)(f),m=r.sub([],g,p),M=Math.max(t.width,t.height),b=M/d,y=r.length(m)*c,v=Math.max(y,a),w=u*u,O=(b*b-M*M+w*w*v*v)/(2*M*w*v),j=(b*b-M*M-w*w*v*v)/(2*b*w*v),x=Math.log(Math.sqrt(O*O+1)-O),T=Math.log(Math.sqrt(j*j+1)-j);return{startZoom:s,startCenterXY:p,uDelta:m,w0:M,u1:y,S:(T-x)/u,rho:u,rho2:w,r0:x,r1:T}}
},{"./math-utils":"AE6F","./web-mercator-utils":"eDN9","gl-matrix/vec2":"XSo1"}],"PqV4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"MAX_LATITUDE",{enumerable:!0,get:function(){return u.MAX_LATITUDE}}),Object.defineProperty(exports,"WebMercatorViewport",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"addMetersToLngLat",{enumerable:!0,get:function(){return u.addMetersToLngLat}}),Object.defineProperty(exports,"altitudeToFovy",{enumerable:!0,get:function(){return u.altitudeToFovy}}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"fitBounds",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"flyToViewport",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"fovyToAltitude",{enumerable:!0,get:function(){return u.fovyToAltitude}}),Object.defineProperty(exports,"getBounds",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"getDistanceScales",{enumerable:!0,get:function(){return u.getDistanceScales}}),Object.defineProperty(exports,"getFlyToDuration",{enumerable:!0,get:function(){return o.getFlyToDuration}}),Object.defineProperty(exports,"getMeterZoom",{enumerable:!0,get:function(){return u.getMeterZoom}}),Object.defineProperty(exports,"getProjectionMatrix",{enumerable:!0,get:function(){return u.getProjectionMatrix}}),Object.defineProperty(exports,"getProjectionParameters",{enumerable:!0,get:function(){return u.getProjectionParameters}}),Object.defineProperty(exports,"getViewMatrix",{enumerable:!0,get:function(){return u.getViewMatrix}}),Object.defineProperty(exports,"lngLatToWorld",{enumerable:!0,get:function(){return u.lngLatToWorld}}),Object.defineProperty(exports,"normalizeViewportProps",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"pixelsToWorld",{enumerable:!0,get:function(){return u.pixelsToWorld}}),Object.defineProperty(exports,"scaleToZoom",{enumerable:!0,get:function(){return u.scaleToZoom}}),Object.defineProperty(exports,"unitsPerMeter",{enumerable:!0,get:function(){return u.unitsPerMeter}}),Object.defineProperty(exports,"worldToLngLat",{enumerable:!0,get:function(){return u.worldToLngLat}}),Object.defineProperty(exports,"worldToPixels",{enumerable:!0,get:function(){return u.worldToPixels}}),Object.defineProperty(exports,"zoomToScale",{enumerable:!0,get:function(){return u.zoomToScale}});var e=f(require("./web-mercator-viewport")),t=f(require("./get-bounds")),r=f(require("./fit-bounds")),n=f(require("./normalize-viewport-props")),o=a(require("./fly-to-viewport")),u=require("./web-mercator-utils");function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function a(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var a=o?Object.getOwnPropertyDescriptor(e,u):null;a&&(a.get||a.set)?Object.defineProperty(n,u,a):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}function f(e){return e&&e.__esModule?e:{default:e}}
},{"./web-mercator-viewport":"btK9","./get-bounds":"tHha","./fit-bounds":"Lip1","./normalize-viewport-props":"BccJ","./fly-to-viewport":"Ytqr","./web-mercator-utils":"eDN9"}],"gw95":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o=require("../../lib/constants"),a=i(require("../project/project")),t=require("@math.gl/core"),n=i(require("../../utils/memoize")),e=require("@math.gl/web-mercator");function i(o){return o&&o.__esModule?o:{default:o}}const s="\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",h="\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",r=(0,n.default)(u),d=(0,n.default)(l),w=[0,0,0,1],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function p(o,a){const[t,n,i]=o,s=(0,e.pixelsToWorld)([t,n,i],a);return Number.isFinite(i)?s:[s[0],s[1],0]}function u({viewport:o,center:a}){return new t.Matrix4(o.viewProjectionMatrix).invert().transform(a)}function l({viewport:o,shadowMatrices:a}){const n=[],e=o.pixelUnprojectionMatrix,i=o.isGeospatial?void 0:1,s=[[0,0,i],[o.width,0,i],[0,o.height,i],[o.width,o.height,i],[0,0,-1],[o.width,0,-1],[0,o.height,-1],[o.width,o.height,-1]].map(o=>p(o,e));for(const h of a){const a=h.clone().translate(new t.Vector3(o.center).negate()),e=s.map(o=>a.transform(o)),i=(new t.Matrix4).ortho({left:Math.min(...e.map(o=>o[0])),right:Math.max(...e.map(o=>o[0])),bottom:Math.min(...e.map(o=>o[1])),top:Math.max(...e.map(o=>o[1])),near:Math.min(...e.map(o=>-o[2])),far:Math.max(...e.map(o=>-o[2]))});n.push(i.multiplyRight(h))}return n}function _(a,n){const{shadowEnabled:e=!0}=a;if(!e||!a.shadowMatrices||!a.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(a.drawToShadowMap),shadow_uUseShadowMap:!!a.shadowMaps&&a.shadowMaps.length>0,shadow_uColor:a.shadowColor||w,shadow_uLightId:a.shadowLightId||0,shadow_uLightCount:a.shadowMatrices.length},s=r({viewport:a.viewport,center:n.project_uCenter}),h=[],p=d({shadowMatrices:a.shadowMatrices,viewport:a.viewport}).slice();for(let r=0;r<a.shadowMatrices.length;r++){const e=p[r],i=e.clone().translate(new t.Vector3(a.viewport.center).negate());n.project_uCoordinateSystem===o.COORDINATE_SYSTEM.LNGLAT&&n.project_uProjectionMode===o.PROJECTION_MODE.WEB_MERCATOR?(p[r]=i,h[r]=s):(p[r]=e.clone().multiplyRight(c),h[r]=i.transform(s))}for(let o=0;o<p.length;o++)i["shadow_uViewProjectionMatrices[".concat(o,"]")]=p[o],i["shadow_uProjectCenters[".concat(o,"]")]=h[o],a.shadowMaps&&a.shadowMaps.length>0?i["shadow_uShadowMap".concat(o)]=a.shadowMaps[o]:i["shadow_uShadowMap".concat(o)]=a.dummyShadowMap;return i}var m={name:"shadow",dependencies:[a.default],vs:s,fs:h,inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(o={},a={})=>"viewport"in o&&(o.drawToShadowMap||o.shadowMaps&&o.shadowMaps.length>0)?_(o,a):{}};exports.default=m;
},{"../../lib/constants":"ysbg","../project/project":"NVOm","@math.gl/core":"dwLx","../../utils/memoize":"uXG5","@math.gl/web-mercator":"PqV4"}],"MByF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@luma.gl/core"),s=require("./ambient-light"),i=require("./directional-light"),a=require("@math.gl/core"),h=r(require("../../passes/shadow-pass")),o=r(require("../../shaderlib/shadow/shadow"));function r(t){return t&&t.__esModule?t:{default:t}}const d={color:[255,255,255],intensity:1},l=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],n=[0,0,0,200/255];class g{constructor(e={}){(0,t.default)(this,"id","lighting-effect"),(0,t.default)(this,"props",void 0),(0,t.default)(this,"shadowColor",n),(0,t.default)(this,"shadow",void 0),(0,t.default)(this,"ambientLight",void 0),(0,t.default)(this,"directionalLights",void 0),(0,t.default)(this,"pointLights",void 0),(0,t.default)(this,"shadowPasses",[]),(0,t.default)(this,"shadowMaps",[]),(0,t.default)(this,"dummyShadowMap",null),(0,t.default)(this,"programManager",void 0),(0,t.default)(this,"shadowMatrices",void 0),this.setProps(e)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const s=t[e];switch(s.type){case"ambient":this.ambientLight=s;break;case"directional":this.directionalLights.push(s);break;case"point":this.pointLights.push(s)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.props=t}preRender(t,{layers:s,layerFilter:i,viewports:a,onViewportActive:h,views:r}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=e.ProgramManager.getDefaultProgramManager(t),o.default&&this.programManager.addDefaultModule(o.default)),this.dummyShadowMap||(this.dummyShadowMap=new e.Texture2D(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++){this.shadowPasses[t].render({layers:s,layerFilter:i,viewports:a,onViewportActive:h,views:r,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(e=>e.getProjectedLight({layer:t})),pointLights:this.pointLights.map(e=>e.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(o.default),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const s=(new a.Matrix4).lookAt({eye:new a.Vector3(e.direction).negate()});t.push(s)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const s=new h.default(t);this.shadowPasses[e]=s,this.shadowMaps[e]=s.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:a}=this;t||0!==e.length||0!==a.length||(this.ambientLight=new s.AmbientLight(d),this.directionalLights.push(new i.DirectionalLight(l[0]),new i.DirectionalLight(l[1])))}}exports.default=g;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","./ambient-light":"kPtk","./directional-light":"n3wt","@math.gl/core":"dwLx","../../passes/shadow-pass":"STtv","../../shaderlib/shadow/shadow":"gw95"}],"yeLJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.TypedArrayManager=void 0;var e=t(require("@babel/runtime/helpers/esm/defineProperty"));function t(e){return e&&e.__esModule?e:{default:e}}class r{constructor(t={}){(0,e.default)(this,"_pool",[]),(0,e.default)(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:r=1,type:s,padding:o=0,copy:i=!1,initialize:l=!1,maxCount:n}){const a=s||e&&e.constructor||Float32Array,p=t*r+o;if(ArrayBuffer.isView(e)){if(p<=e.length)return e;if(p*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new a(e.buffer,0,p)}let f=1/0;n&&(f=n*r+o);const u=this._allocate(a,p,l,f);return e&&i?u.set(e):l||u.fill(0,0,4),this._release(e),u}release(e){this._release(e)}_allocate(e,t,r,s){let o=Math.max(Math.ceil(t*this.opts.overAlloc),1);o>s&&(o=s);const i=this._pool,l=e.BYTES_PER_ELEMENT*o,n=i.findIndex(e=>e.byteLength>=l);if(n>=0){const t=new e(i.splice(n,1)[0],0,o);return r&&t.fill(0),t}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:r}=e,{byteLength:s}=r,o=t.findIndex(e=>e.byteLength>=s);o<0?t.push(r):(o>0||t.length<this.opts.poolSize)&&t.splice(o,0,r),t.length>this.opts.poolSize&&t.shift()}}exports.TypedArrayManager=r;var s=new r;exports.default=s;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"ki6G":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMat4=n,exports.fp64LowPart=i,exports.getCameraPosition=a,exports.getFrustumPlanes=u,exports.mergeBounds=d,exports.mod=o,exports.toDoublePrecisionArray=f;var t=r(require("./typed-array-manager")),e=require("@math.gl/core");function r(t){return t&&t.__esModule?t:{default:t}}function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function o(t,e){const r=t%e;return r<0?e+r:r}function a(t){return[t[12],t[13],t[14]]}function u(t){return{left:c(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:c(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:c(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:c(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:c(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:c(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const s=new e.Vector3;function c(t,r,n,o){s.set(t,r,n);const a=s.len();return{distance:o/a,normal:new e.Vector3(-t/a,-r/a,-n/a)}}function i(t){return t-Math.fround(t)}let l;function f(e,r){const{size:n=1,startIndex:o=0}=r,a=void 0!==r.endIndex?r.endIndex:e.length,u=(a-o)/n;l=t.default.allocate(l,u,{type:Float32Array,size:2*n});let s=o,c=0;for(;s<a;){for(let t=0;t<n;t++){const r=e[s++];l[c+t]=r,l[c+t+n]=i(r)}c+=2*n}return l.subarray(0,u*n*2)}function d(t){let e=null,r=!1;for(const n of t)n&&(e?(r||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}
},{"./typed-array-manager":"yeLJ","@math.gl/core":"dwLx"}],"HjGN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=c(require("@babel/runtime/helpers/esm/defineProperty")),i=c(require("../utils/log")),e=require("../utils/math-utils"),s=require("@math.gl/core"),r=h(require("gl-matrix/mat4")),a=require("@math.gl/web-mercator"),o=require("../lib/constants");function n(t){if("function"!=typeof WeakMap)return null;var i=new WeakMap,e=new WeakMap;return(n=function(t){return t?e:i})(t)}function h(t,i){if(!i&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=n(i);if(e&&e.has(t))return e.get(t);var s={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var o=r?Object.getOwnPropertyDescriptor(t,a):null;o&&(o.get||o.set)?Object.defineProperty(s,a,o):s[a]=t[a]}return s.default=t,e&&e.set(t,s),s}function c(t){return t&&t.__esModule?t:{default:t}}const l=Math.PI/180,u=(0,e.createMat4)(),d=[0,0,0],p={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function f({width:t,height:i,orthographic:e,fovyRadians:r,focalDistance:a,padding:o,near:n,far:h}){const c=t/i,l=e?(new s.Matrix4).orthographic({fovy:r,aspect:c,focalDistance:a,near:n,far:h}):(new s.Matrix4).perspective({fovy:r,aspect:c,near:n,far:h});if(o){const{left:e=0,right:r=0,top:a=0,bottom:n=0}=o,h=(0,s.clamp)((e+t-r)/2,0,t)-t/2,c=(0,s.clamp)((a+i-n)/2,0,i)-i/2;l[8]-=2*h/t,l[9]+=2*c/i}return l}class M{constructor(i={}){(0,t.default)(this,"id",void 0),(0,t.default)(this,"x",void 0),(0,t.default)(this,"y",void 0),(0,t.default)(this,"width",void 0),(0,t.default)(this,"height",void 0),(0,t.default)(this,"padding",void 0),(0,t.default)(this,"isGeospatial",void 0),(0,t.default)(this,"zoom",void 0),(0,t.default)(this,"focalDistance",void 0),(0,t.default)(this,"position",void 0),(0,t.default)(this,"modelMatrix",void 0),(0,t.default)(this,"distanceScales",void 0),(0,t.default)(this,"scale",void 0),(0,t.default)(this,"center",void 0),(0,t.default)(this,"cameraPosition",void 0),(0,t.default)(this,"projectionMatrix",void 0),(0,t.default)(this,"viewMatrix",void 0),(0,t.default)(this,"viewMatrixUncentered",void 0),(0,t.default)(this,"viewMatrixInverse",void 0),(0,t.default)(this,"viewProjectionMatrix",void 0),(0,t.default)(this,"pixelProjectionMatrix",void 0),(0,t.default)(this,"pixelUnprojectionMatrix",void 0),(0,t.default)(this,"resolution",void 0),(0,t.default)(this,"_frustumPlanes",{}),this.id=i.id||this.constructor.displayName||"viewport",this.x=i.x||0,this.y=i.y||0,this.width=i.width||1,this.height=i.height||1,this.zoom=i.zoom||0,this.padding=i.padding,this.distanceScales=i.distanceScales||p,this.focalDistance=i.focalDistance||1,this.position=i.position||d,this.modelMatrix=i.modelMatrix||null;const{longitude:e,latitude:s}=i;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(e),this._initProps(i),this._initMatrices(i),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?o.PROJECTION_MODE.WEB_MERCATOR:o.PROJECTION_MODE.WEB_MERCATOR_AUTO_OFFSET:o.PROJECTION_MODE.IDENTITY}equals(t){return t instanceof M&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,s.equals)(t.projectionMatrix,this.projectionMatrix)&&(0,s.equals)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const e=this.projectPosition(t),s=(0,a.worldToPixels)(e,this.pixelProjectionMatrix),[r,o]=s,n=i?o:this.height-o;return 2===t.length?[r,n]:[r,n,s[2]]}unproject(t,{topLeft:i=!0,targetZ:e}={}){const[s,r,o]=t,n=i?r:this.height-r,h=e&&e*this.distanceScales.unitsPerMeter[2],c=(0,a.pixelsToWorld)([s,n,o],this.pixelUnprojectionMatrix,h),[l,u,d]=this.unprojectPosition(c);return Number.isFinite(o)?[l,u,d]:Number.isFinite(e)?[l,u,e]:[l,u]}projectPosition(t){const[i,e]=this.projectFlat(t);return[i,e,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,e]=this.unprojectFlat(t);return[i,e,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const i=(0,a.lngLatToWorld)(t);return i[1]=(0,s.clamp)(i[1],-318,830),i}return t}unprojectFlat(t){return this.isGeospatial?(0,a.worldToLngLat)(t):t}getBounds(t={}){const i={targetZ:t.z||0},e=this.unproject([0,0],i),s=this.unproject([this.width,0],i),r=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(e[0],s[0],r[0],a[0]),Math.min(e[1],s[1],r[1],a[1]),Math.max(e[0],s[0],r[0],a[0]),Math.max(e[1],s[1],r[1],a[1])]}getDistanceScales(t){return t?(0,a.getDistanceScales)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:e=1,height:s=1}){return t<this.x+this.width&&this.x<t+e&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,(0,e.getFrustumPlanes)(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,i){return null}_initProps(t){const i=t.longitude,e=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=(0,a.getMeterZoom)({latitude:e})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||(0,a.getDistanceScales)({latitude:e,longitude:i}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:o,modelMatrix:n}=t;let h=d;if(o&&(h=n?new s.Matrix4(n).transformAsVector(o,[]):o),this.isGeospatial){const t=this.projectPosition([i,e,0]);this.center=new s.Vector3(h).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(h)}_initMatrices(t){const{viewMatrix:a=u,projectionMatrix:o=null,orthographic:n=!1,fovyRadians:h,fovy:c=75,near:d=.1,far:p=1e3,padding:M=null,focalDistance:x=1}=t;this.viewMatrixUncentered=a,this.viewMatrix=(new s.Matrix4).multiplyRight(a).translate(new s.Vector3(this.center).negate()),this.projectionMatrix=o||f({width:this.width,height:this.height,orthographic:n,fovyRadians:h||c*l,focalDistance:x,padding:M,near:d,far:p});const v=(0,e.createMat4)();r.multiply(v,v,this.projectionMatrix),r.multiply(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=r.invert([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,e.getCameraPosition)(this.viewMatrixInverse);const g=(0,e.createMat4)(),j=(0,e.createMat4)();r.scale(g,g,[this.width/2,-this.height/2,1]),r.translate(g,g,[1,-1,0]),r.multiply(j,g,this.viewProjectionMatrix),this.pixelProjectionMatrix=j,this.pixelUnprojectionMatrix=r.invert((0,e.createMat4)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||i.default.warn("Pixel project matrix not invertible")()}}exports.default=M,(0,t.default)(M,"displayName","Viewport");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../utils/log":"GVus","../utils/math-utils":"ki6G","@math.gl/core":"dwLx","gl-matrix/mat4":"w3aR","@math.gl/web-mercator":"PqV4","../lib/constants":"ysbg"}],"Rf6Y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=n(require("@babel/runtime/helpers/esm/defineProperty")),e=n(require("./viewport")),i=require("@math.gl/web-mercator"),r=u(require("gl-matrix/vec2")),o=require("@math.gl/core");function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(s=function(t){return t?i:e})(t)}function u(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var i=s(e);if(i&&i.has(t))return i.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var n=o?Object.getOwnPropertyDescriptor(t,u):null;n&&(n.get||n.set)?Object.defineProperty(r,u,n):r[u]=t[u]}return r.default=t,i&&i.set(t,r),r}function n(t){return t&&t.__esModule?t:{default:t}}class a extends e.default{constructor(e={}){const{latitude:r=0,longitude:s=0,zoom:u=0,pitch:n=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:d=1.01,orthographic:h=!1,projectionMatrix:p,repeat:f=!1,worldOffset:c=0,position:g,padding:M,legacyMeterSizes:v=!1}=e;let{width:w,height:b,altitude:y=1.5}=e;const m=Math.pow(2,u);let j;w=w||1,b=b||1;let P=null;if(p)y=p[5]/2,j=(0,i.altitudeToFovy)(y);else{let t;if(e.fovy?(j=e.fovy,y=(0,i.fovyToAltitude)(j)):j=(0,i.altitudeToFovy)(y),M){const{top:e=0,bottom:i=0}=M;t=[0,(0,o.clamp)((e+b-i)/2,0,b)-b/2]}P=(0,i.getProjectionParameters)({width:w,height:b,scale:m,center:g&&[0,0,g[2]*(0,i.unitsPerMeter)(r)],offset:t,pitch:n,fovy:j,nearZMultiplier:l,farZMultiplier:d})}let _=(0,i.getViewMatrix)({height:b,pitch:n,bearing:a,scale:m,altitude:y});if(c){_=(new o.Matrix4).translate([512*c,0,0]).multiplyLeft(_)}super({...e,width:w,height:b,viewMatrix:_,longitude:s,latitude:r,zoom:u,...P,fovy:j,focalDistance:y}),(0,t.default)(this,"longitude",void 0),(0,t.default)(this,"latitude",void 0),(0,t.default)(this,"pitch",void 0),(0,t.default)(this,"bearing",void 0),(0,t.default)(this,"altitude",void 0),(0,t.default)(this,"fovy",void 0),(0,t.default)(this,"orthographic",void 0),(0,t.default)(this,"_subViewports",void 0),(0,t.default)(this,"_pseudoMeters",void 0),this.latitude=r,this.longitude=s,this.zoom=u,this.pitch=n,this.bearing=a,this.altitude=y,this.fovy=j,this.orthographic=h,this._subViewports=f?[]:null,this._pseudoMeters=v,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),i=Math.ceil((t[2]-180)/360);for(let r=e;r<=i;r++){const t=r?new a({...this,worldOffset:r}):this;this._subViewports.push(t)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,r]=this.projectFlat(t);return[e,r,(t[2]||0)*(0,i.unitsPerMeter)(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,r]=this.unprojectFlat(t);return[e,r,(t[2]||0)/(0,i.unitsPerMeter)(r)]}addMetersToLngLat(t,e){return(0,i.addMetersToLngLat)(t,e)}panByPosition(t,e){const o=(0,i.pixelsToWorld)(e,this.pixelUnprojectionMatrix),s=this.projectFlat(t),u=r.add([],s,r.negate([],o)),n=r.add([],this.center,u),[a,l]=this.unprojectFlat(n);return{longitude:a,latitude:l}}getBounds(t={}){const e=(0,i.getBounds)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:r,height:o}=this,{longitude:s,latitude:u,zoom:n}=(0,i.fitBounds)({width:r,height:o,bounds:t,...e});return new a({width:r,height:o,longitude:s,latitude:u,zoom:n})}}exports.default=a,(0,t.default)(a,"displayName","WebMercatorViewport");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./viewport":"HjGN","@math.gl/web-mercator":"PqV4","gl-matrix/vec2":"XSo1","@math.gl/core":"dwLx"}],"AJ0f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getWorldPosition=O,exports.projectPosition=l;var e=require("../../lib/constants"),t=require("./viewport-uniforms"),r=c(require("../../viewports/web-mercator-viewport")),o=s(require("gl-matrix/vec4")),i=s(require("gl-matrix/vec3")),n=require("@math.gl/web-mercator");function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var s=i?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(o,n,s):o[n]=e[n]}return o.default=e,r&&r.set(e,o),o}function c(e){return e&&e.__esModule?e:{default:e}}const f=[0,0,0];function u(e,t,o=!1){const i=t.projectPosition(e);if(o&&t instanceof r.default){const[r,o,n=0]=e,a=t.getDistanceScales([r,o]);i[2]=n*a.unitsPerMeter[2]}return i}function d(t){const{viewport:r,modelMatrix:o,coordinateOrigin:i}=t;let{coordinateSystem:n,fromCoordinateSystem:a,fromCoordinateOrigin:s}=t;return n===e.COORDINATE_SYSTEM.DEFAULT&&(n=r.isGeospatial?e.COORDINATE_SYSTEM.LNGLAT:e.COORDINATE_SYSTEM.CARTESIAN),void 0===a&&(a=n),void 0===s&&(s=i),{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:a,fromCoordinateOrigin:s}}function O(t,{viewport:r,modelMatrix:i,coordinateSystem:a,coordinateOrigin:s,offsetMode:c}){let[f,d,O=0]=t;switch(i&&([f,d,O]=o.transformMat4([],[f,d,O,1],i)),a){case e.COORDINATE_SYSTEM.LNGLAT:return u([f,d,O],r,c);case e.COORDINATE_SYSTEM.LNGLAT_OFFSETS:return u([f+s[0],d+s[1],O+(s[2]||0)],r,c);case e.COORDINATE_SYSTEM.METER_OFFSETS:return u((0,n.addMetersToLngLat)(s,[f,d,O]),r,c);case e.COORDINATE_SYSTEM.CARTESIAN:default:return r.isGeospatial?[f+s[0],d+s[1],O+s[2]]:r.projectPosition([f,d,O])}}function l(e,r){const{viewport:o,coordinateSystem:n,coordinateOrigin:a,modelMatrix:s,fromCoordinateSystem:c,fromCoordinateOrigin:u}=d(r),{autoOffset:l=!0}=r,{geospatialOrigin:p=f,shaderCoordinateOrigin:S=f,offsetMode:m=!1}=l?(0,t.getOffsetOrigin)(o,n,a):{},M=O(e,{viewport:o,modelMatrix:s,coordinateSystem:c,coordinateOrigin:u,offsetMode:m});if(m){const e=o.projectPosition(p||S);i.sub(M,M,e)}return M}
},{"../../lib/constants":"ysbg","./viewport-uniforms":"iWu9","../../viewports/web-mercator-viewport":"Rf6Y","gl-matrix/vec4":"zWbG","gl-matrix/vec3":"AWBd","@math.gl/web-mercator":"PqV4"}],"yBNR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PointLight=void 0;var t=e(require("@babel/runtime/helpers/esm/defineProperty")),i=require("../../shaderlib/project/project-functions"),o=require("../../lib/constants");function e(t){return t&&t.__esModule?t:{default:t}}const n=[255,255,255],s=1,r=[0,0,1],d=[0,0,1];let a=0;class c{constructor(i={}){(0,t.default)(this,"id",void 0),(0,t.default)(this,"color",void 0),(0,t.default)(this,"intensity",void 0),(0,t.default)(this,"type","point"),(0,t.default)(this,"position",void 0),(0,t.default)(this,"attenuation",void 0),(0,t.default)(this,"projectedLight",void 0);const{color:o=n}=i,{intensity:e=s}=i,{position:r=d}=i;this.id=i.id||"point-".concat(a++),this.color=o,this.intensity=e,this.type="point",this.position=r,this.attenuation=h(i),this.projectedLight={...this}}getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:s,coordinateOrigin:r}=t.props,d=(0,i.projectPosition)(this.position,{viewport:n,coordinateSystem:s,coordinateOrigin:r,fromCoordinateSystem:n.isGeospatial?o.COORDINATE_SYSTEM.LNGLAT:o.COORDINATE_SYSTEM.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return e.color=this.color,e.intensity=this.intensity,e.position=d,e}}function h(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:r}exports.PointLight=c;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../../shaderlib/project/project-functions":"AJ0f","../../lib/constants":"ysbg"}],"xYso":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("./point-light"),e=require("../../shaderlib/project/viewport-uniforms");class o extends t.PointLight{getProjectedLight({layer:t}){const{projectedLight:o}=this,i=t.context.viewport,{coordinateSystem:r,coordinateOrigin:s,modelMatrix:n}=t.props,{project_uCameraPosition:a}=(0,e.getUniformsFromViewport)({viewport:i,modelMatrix:n,coordinateSystem:r,coordinateOrigin:s});return o.color=this.color,o.intensity=this.intensity,o.position=a,o}}exports.default=o;
},{"./point-light":"yBNR","../../shaderlib/project/viewport-uniforms":"iWu9"}],"Nicg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSunDirection=r,exports.getSunPosition=M;const t=Math.PI/180,n=864e5,a=2440588,i=2451545,s=23.4397*t,o=357.5291,c=.98560028,e=280.147,h=360.9856235;function M(n,a,i){const s=t*-i,o=t*a,c=f(n),e=b(c),h=m(c,s)-e.rightAscension;return{azimuth:g(h,o,e.declination),altitude:p(h,o,e.declination)}}function r(t,n,a){const{azimuth:i,altitude:s}=M(t,n,a);return[Math.sin(i)*Math.cos(s),Math.cos(i)*Math.cos(s),-Math.sin(s)]}function u(t){return("number"==typeof t?t:t.getTime())/n-.5+a}function f(t){return u(t)-i}function d(t,n){const a=t;return Math.atan2(Math.sin(a)*Math.cos(s)-Math.tan(n)*Math.sin(s),Math.cos(a))}function l(t,n){const a=t;return Math.asin(Math.sin(n)*Math.cos(s)+Math.cos(n)*Math.sin(s)*Math.sin(a))}function g(t,n,a){const i=t,s=n,o=a;return Math.atan2(Math.sin(i),Math.cos(i)*Math.sin(s)-Math.tan(o)*Math.cos(s))}function p(t,n,a){const i=t,s=n,o=a;return Math.asin(Math.sin(s)*Math.sin(o)+Math.cos(s)*Math.cos(o)*Math.cos(i))}function m(n,a){return t*(e+h*n)-a}function P(n){return t*(o+c*n)}function x(n){const a=n;return a+t*(1.9148*Math.sin(a)+.02*Math.sin(2*a)+3e-4*Math.sin(3*a))+102.9372*t+Math.PI}function b(t){const n=x(P(t));return{declination:l(n,0),rightAscension:d(n,0)}}
},{}],"Z7z2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"getSunDirection",{enumerable:!0,get:function(){return e.getSunDirection}}),Object.defineProperty(exports,"getSunPosition",{enumerable:!0,get:function(){return e.getSunPosition}});var e=require("./suncalc");
},{"./suncalc":"Nicg"}],"hMy0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@babel/runtime/helpers/esm/defineProperty")),t=require("./directional-light"),i=require("@math.gl/sun");function r(e){return e&&e.__esModule?e:{default:e}}class s extends t.DirectionalLight{constructor(t){super(t),(0,e.default)(this,"timestamp",void 0),this.timestamp=t.timestamp}getProjectedLight({layer:e}){const{viewport:t}=e.context;if(t.resolution&&t.resolution>0){const[e,t,r]=(0,i.getSunDirection)(this.timestamp,0,0);this.direction=[e,-r,t]}else{const{latitude:e,longitude:r}=t;this.direction=(0,i.getSunDirection)(this.timestamp,e,r)}return this}}exports.default=s;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./directional-light":"n3wt","@math.gl/sun":"Z7z2"}],"YqRQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@luma.gl/core"),r=s(require("./pass"));function s(e){return e&&e.__esModule?e:{default:e}}class d extends r.default{constructor(r,s){super(r,s),(0,e.default)(this,"model",void 0);const{module:d,fs:i,id:u}=s;this.model=new t.ClipSpace(r,{id:u,fs:i,modules:[d]})}render(e){const r=this.gl;(0,t.setParameters)(r,{viewport:[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}),(0,t.withParameters)(r,{framebuffer:e.outputBuffer,clearColor:[0,0,0,0]},()=>this._renderPass(r,e))}delete(){this.model.delete(),this.model=null}_renderPass(e,r){const{inputBuffer:s}=r;(0,t.clear)(e,{color:!0}),this.model.draw({moduleSettings:r.moduleSettings,uniforms:{texture:s,texSize:[s.width,s.height]},parameters:{depthWrite:!1,depthTest:!1}})}}exports.default=d;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","./pass":"ay01"}],"QgRQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@babel/runtime/helpers/esm/defineProperty")),t=r(require("../passes/screen-pass")),s=require("@luma.gl/core");function r(e){return e&&e.__esModule?e:{default:e}}class n{constructor(t,r={}){(0,e.default)(this,"id",void 0),(0,e.default)(this,"props",void 0),(0,e.default)(this,"module",void 0),(0,e.default)(this,"passes",void 0),this.id="".concat(t.name,"-pass"),this.props=r,(0,s.normalizeShaderModule)(t),this.module=t}setProps(e){this.props=e}preRender(){}postRender(e,t){const s=this.passes||o(e,this.module,this.id);this.passes=s;const{target:r}=t;let n=t.inputBuffer,i=t.swapBuffer;for(let o=0;o<this.passes.length;o++){r&&o===this.passes.length-1&&(i=r),this.passes[o].render({inputBuffer:n,outputBuffer:i,moduleSettings:this.props});const e=i;i=n,n=e}return n}cleanup(){if(this.passes){for(const e of this.passes)e.delete();this.passes=void 0}}}function o(e,s,r){if(!s.passes){const n=u(s);return[new t.default(e,{id:r,module:s,fs:n})]}return s.passes.map((n,o)=>{const i=u(s,n),a="".concat(r,"-").concat(o);return new t.default(e,{id:a,module:s,fs:i})})}exports.default=n;const i=e=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(e,"(gl_FragColor, texSize, texCoord);\n}\n"),a=e=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(e,"(texture, texSize, texCoord);\n}\n");function u(e,t=e){if(t.filter){const s="string"==typeof t.filter?t.filter:"".concat(e.name,"_filterColor");return i(s)}if(t.sampler){const s="string"==typeof t.sampler?t.sampler:"".concat(e.name,"_sampleColor");return a(s)}return null}
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../passes/screen-pass":"YqRQ","@luma.gl/core":"iuAK"}],"WJJZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty")),r=s(require("./layers-pass")),t=require("@luma.gl/core"),i=s(require("../utils/log"));function s(e){return e&&e.__esModule?e:{default:e}}const o={blendFunc:[1,0,32771,0],blendEquation:32774};class n extends r.default{constructor(...r){super(...r),(0,e.default)(this,"pickZ",void 0),(0,e.default)(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:r,views:i,viewports:s,onViewportActive:n,pickingFBO:l,deviceRect:{x:a,y:d,width:u,height:p},cullRect:h,effects:k,pass:y="picking",pickZ:g,moduleParameters:b}){const f=this.gl;this.pickZ=g;const w=this._resetColorEncoder(g),v=(0,t.withParameters)(f,{scissorTest:!0,scissor:[a,d,u,p],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...o,blend:!g},()=>super.render({target:l,layers:e,layerFilter:r,views:i,viewports:s,onViewportActive:n,cullRect:h,effects:null==k?void 0:k.filter(e=>e.useInPicking),pass:y,isPicking:!0,moduleParameters:b}));return this._colorEncoderState=null,{decodePickingColor:w&&c.bind(null,w),stats:v}}shouldDrawLayer(e){const{pickable:r,operation:t}=e.props;return r&&t.includes("draw")||t.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,r,t){const i={...e.props.parameters},{pickable:s,operation:n}=e.props;return this._colorEncoderState?s&&n.includes("draw")&&(Object.assign(i,o),i.blend=!0,i.blendColor=l(this._colorEncoderState,e,t)):i.blend=!1,n.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function l(e,r,t){const{byLayer:s,byAlpha:o}=e;let n,l=s.get(r);return l?(l.viewports.push(t),n=l.a):(n=s.size+1)<=255?(l={a:n,layer:r,viewports:[t]},s.set(r,l),o[n]=l):(i.default.warn("Too many pickable layers, only picking the first 255")(),n=0),[0,0,0,n/255]}function c(e,r){const t=e.byAlpha[r[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(r)}}exports.default=n;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./layers-pass":"oM9Q","@luma.gl/core":"iuAK","../utils/log":"GVus"}],"dDJN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROP_TYPES_SYMBOL=exports.LIFECYCLE=exports.DEPRECATED_PROPS_SYMBOL=exports.COMPONENT_SYMBOL=exports.ASYNC_RESOLVED_SYMBOL=exports.ASYNC_ORIGINAL_SYMBOL=exports.ASYNC_DEFAULTS_SYMBOL=void 0;const o={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"};exports.LIFECYCLE=o;const e=Symbol.for("component");exports.COMPONENT_SYMBOL=e;const t=Symbol.for("propTypes");exports.PROP_TYPES_SYMBOL=t;const r=Symbol.for("deprecatedProps");exports.DEPRECATED_PROPS_SYMBOL=r;const s=Symbol.for("asyncPropDefaults");exports.ASYNC_DEFAULTS_SYMBOL=s;const S=Symbol.for("asyncPropOriginal");exports.ASYNC_ORIGINAL_SYMBOL=S;const O=Symbol.for("asyncPropResolved");exports.ASYNC_RESOLVED_SYMBOL=O;
},{}],"gSVO":[function(require,module,exports) {
"use strict";function t(t,e=(()=>!0)){return Array.isArray(t)?r(t,e,[]):e(t)?[t]:[]}function r(t,e,n){let o=-1;for(;++o<t.length;){const s=t[o];Array.isArray(s)?r(s,e,n):e(s)&&n.push(s)}return n}function e({target:t,source:r,start:e=0,count:n=1}){const o=r.length,s=n*o;let i=0;for(let u=e;i<o;i++)t[u++]=r[i];for(;i<s;)i<s-i?(t.copyWithin(e+i,e,e+i),i*=2):(t.copyWithin(e+i,e,e+s-i),i=s);return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fillArray=e,exports.flatten=t;
},{}],"h6BZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@loaders.gl/core");function s(t){return t&&t.__esModule?t:{default:t}}class i{constructor(e,s,i){(0,t.default)(this,"id",void 0),(0,t.default)(this,"context",void 0),(0,t.default)(this,"isLoaded",void 0),(0,t.default)(this,"persistent",void 0),(0,t.default)(this,"_loadCount",0),(0,t.default)(this,"_subscribers",new Set),(0,t.default)(this,"_data",void 0),(0,t.default)(this,"_loader",void 0),(0,t.default)(this,"_error",void 0),(0,t.default)(this,"_content",void 0),this.id=e,this.context=i,this.setData(s)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,s){if(t===this._data&&!s)return;this._data=t;const i=++this._loadCount;let r=t;"string"==typeof t&&(r=(0,e.load)(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(t=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=t)}).catch(t=>{this._loadCount===i&&(this.isLoaded=!0,this._error=t||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const e of this._subscribers)e.onChange(this.getData())}}exports.default=i;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@loaders.gl/core":"ikKD"}],"CnML":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("@babel/runtime/helpers/esm/defineProperty")),s=t(require("./resource"));function t(e){return e&&e.__esModule?e:{default:e}}class r{constructor({gl:s,protocol:t}){(0,e.default)(this,"protocol",void 0),(0,e.default)(this,"_context",void 0),(0,e.default)(this,"_resources",void 0),(0,e.default)(this,"_consumers",void 0),(0,e.default)(this,"_pruneRequest",void 0),this.protocol=t||"resource://",this._context={gl:s,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:r=!1,persistent:o=!0}){let u=this._resources[e];u?u.setData(t,r):(u=new s.default(e,t,this._context),this._resources[e]=u),u.persistent=o}remove(e){const s=this._resources[e];s&&(s.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const s=this._consumers[e];if(s){for(const e in s){const t=s[e],r=this._resources[t.resourceId];r&&r.unsubscribe(t)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:s,consumerId:t,requestId:r="default"}){const{_resources:o,protocol:u}=this;e.startsWith(u)&&(o[e=e.replace(u,"")]||this.add({resourceId:e,data:null,persistent:!1}));const i=o[e];if(this._track(t,r,i,s),i)return i.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,s,t,r){const o=this._consumers,u=o[e]=o[e]||{},i=u[s]||{},c=i.resourceId&&this._resources[i.resourceId];c&&(c.unsubscribe(i),this.prune()),t&&(u[s]=i,i.onChange=r,i.resourceId=t.id,t.subscribe(i))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const s=this._resources[e];s.persistent||s.inUse()||(s.delete(),delete this._resources[e])}}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./resource":"h6BZ"}],"qxVk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o=t(require("../project/project"));function t(o){return o&&o.__esModule?o:{default:o}}const e="\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n";var n={name:"project32",dependencies:[o.default],vs:e};exports.default=n;
},{"../project/project":"NVOm"}],"Vaj8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=require("@luma.gl/core"),o={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...i.picking};exports.default=o;
},{"@luma.gl/core":"iuAK"}],"vZnx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createProgramManager=a,Object.defineProperty(exports,"gouraudLighting",{enumerable:!0,get:function(){return e.gouraudLighting}}),Object.defineProperty(exports,"phongLighting",{enumerable:!0,get:function(){return e.phongLighting}}),Object.defineProperty(exports,"picking",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"project",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"project32",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"shadow",{enumerable:!0,get:function(){return o.default}});var e=require("@luma.gl/core"),r=u(require("./project/project")),t=u(require("./project32/project32")),o=u(require("./shadow/shadow")),n=u(require("./picking/picking"));function u(e){return e&&e.__esModule?e:{default:e}}const i=[r.default],c=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function a(r){const t=e.ProgramManager.getDefaultProgramManager(r);for(const e of i)t.addDefaultModule(e);for(const e of c)t.addShaderHook(e);return t}
},{"@luma.gl/core":"iuAK","./project/project":"NVOm","./project32/project32":"qxVk","./shadow/shadow":"gw95","./picking/picking":"Vaj8"}],"m8xf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=c(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@luma.gl/core"),r=require("../lifecycle/constants"),a=c(require("../utils/log")),s=c(require("../debug")),i=require("../utils/flatten"),n=require("@probe.gl/stats"),l=c(require("./resource/resource-manager")),d=c(require("../viewports/viewport")),o=require("../shaderlib");function c(e){return e&&e.__esModule?e:{default:e}}const u="layerManager.setLayers",h="layerManager.activateViewport";class y{constructor(r,{deck:a,stats:i,viewport:c,timeline:u}={}){(0,e.default)(this,"layers",void 0),(0,e.default)(this,"context",void 0),(0,e.default)(this,"resourceManager",void 0),(0,e.default)(this,"_lastRenderedLayers",[]),(0,e.default)(this,"_needsRedraw",!1),(0,e.default)(this,"_needsUpdate",!1),(0,e.default)(this,"_nextLayers",null),(0,e.default)(this,"_debug",!1),(0,e.default)(this,"activateViewport",e=>{(0,s.default)(h,this,e),e&&(this.context.viewport=e)}),this.layers=[],this.resourceManager=new l.default({gl:r,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:r,deck:a,programManager:r&&(0,o.createProgramManager)(r),stats:i||new n.Stats({id:"deck.gl"}),viewport:c||new d.default({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:u||new t.Timeline,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const a=r.getNeedsRedraw(e);t=t||a}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(e=>0===t.id.indexOf(e))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){(0,s.default)(u,this,t,e),this._lastRenderedLayers=e;const r=(0,i.flatten)(e,Boolean);for(const a of r)a.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,t,r){r.raiseError(t,"".concat(e," of ").concat(r))}_updateLayers(e,t){const r={};for(const n of e)r[n.id]?a.default.warn("Multiple old layers with same id ".concat(n.id))():r[n.id]=n;const s=[];this._updateSublayersRecursively(t,r,s),this._finalizeOldLayers(r);let i=!1;for(const a of s)if(a.hasUniformTransition()){i="Uniform transition in ".concat(a);break}this._needsUpdate=i,this.layers=s}_updateSublayersRecursively(e,t,r){for(const i of e){i.context=this.context;const e=t[i.id];null===e&&a.default.warn("Multiple new layers with same id ".concat(i.id))(),t[i.id]=null;let n=null;try{this._debug&&e!==i&&i.validateProps(),e?(this._transferLayerState(e,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),n=i.isComposite?i.getSubLayers():null}catch(s){this._handleError("matching",s,i)}n&&this._updateSublayersRecursively(n,t,r)}}_finalizeOldLayers(e){for(const t in e){const r=e[t];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=r.LIFECYCLE.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=r.LIFECYCLE.MATCHED,t!==e&&(e.lifecycle=r.LIFECYCLE.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=r.LIFECYCLE.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=r.LIFECYCLE.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}exports.default=y;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","../lifecycle/constants":"dDJN","../utils/log":"GVus","../debug":"EEoF","../utils/flatten":"gSVO","@probe.gl/stats":"SZdt","./resource/resource-manager":"CnML","../viewports/viewport":"HjGN","../shaderlib":"vZnx"}],"KSag":[function(require,module,exports) {
"use strict";function r(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let f=0;f<e.length;f++)if(!r(e[f],t[f],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){const f=Object.keys(e),i=Object.keys(t);if(f.length!==i.length)return!1;for(const u of f){if(!t.hasOwnProperty(u))return!1;if(!r(e[u],t[u],n-1))return!1}return!0}return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deepEqual=r;
},{}],"H2B6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=n(require("@babel/runtime/helpers/esm/defineProperty")),e=require("../utils/deep-equal"),i=n(require("../utils/log")),s=require("../utils/flatten");function n(t){return t&&t.__esModule?t:{default:t}}class a{constructor(e){(0,t.default)(this,"width",void 0),(0,t.default)(this,"height",void 0),(0,t.default)(this,"views",void 0),(0,t.default)(this,"viewState",void 0),(0,t.default)(this,"controllers",void 0),(0,t.default)(this,"timeline",void 0),(0,t.default)(this,"_viewports",void 0),(0,t.default)(this,"_viewportMap",void 0),(0,t.default)(this,"_isUpdating",void 0),(0,t.default)(this,"_needsRedraw",void 0),(0,t.default)(this,"_needsUpdate",void 0),(0,t.default)(this,"_eventManager",void 0),(0,t.default)(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return this.views.find(e=>e.id===t)}getViewState(t){const e="string"==typeof t?this.getView(t):t,i=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(i):i}getViewport(t){return this._viewportMap[t]}unproject(t,e){const i=this.getViewports(),s={x:t[0],y:t[1]};for(let n=i.length-1;n>=0;--n){const a=i[n];if(a.containsPixel(s)){const i=t.slice();return i[0]-=a.x,i[1]-=a.y,a.unproject(i,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=(0,s.flatten)(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){!(0,e.deepEqual)(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else i.default.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>{var i;return null===(i=this.getView(t.id))||void 0===i?void 0:i.makeViewport({viewState:e,width:this.width,height:this.height})}})}_updateController(t,e,i,s){const n=t.controller;if(n){const a={...e,...n,id:t.id,x:i.x,y:i.y,width:i.width,height:i.height};return s||(s=this._createController(t,a)),s&&s.setProps(a),s}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let s=t.length;s--;){const n=t[s],a=this.getViewState(n),h=n.makeViewport({viewState:a,width:this.width,height:this.height});let r=e[n.id];const o=Boolean(n.controller);o&&!r&&(i=!0),!i&&o||!r||(r.finalize(),r=null),this.controllers[n.id]=this._updateController(n,a,h,r),this._viewports.unshift(h)}for(const s in e){const t=e[s];t&&!this.controllers[s]&&t.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length||t.some((i,s)=>!t[s].equals(e[s]))}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../utils/deep-equal":"KSag","../utils/log":"GVus","../utils/flatten":"gSVO"}],"MOmt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getPosition=o,exports.parsePosition=e;const t=/([0-9]+\.?[0-9]*)(%|px)/;function e(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const o=t.exec(e);if(o&&o.length>=3){const t="%"===o[2],e=parseFloat(o[1]);return{position:t?e/100:e,relative:t}}default:throw new Error("Could not parse position string ".concat(e))}}function o(t,e){return t.relative?Math.round(t.position*e):t.position}
},{}],"Txat":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)throw new Error(r||"deck.gl: assertion failed.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"k6Eh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("@babel/runtime/helpers/esm/defineProperty")),i=r(require("../viewports/viewport")),e=require("../utils/positions"),s=require("../utils/deep-equal"),o=r(require("../utils/assert"));function r(t){return t&&t.__esModule?t:{default:t}}class n{constructor(s){(0,t.default)(this,"id",void 0),(0,t.default)(this,"viewportInstance",void 0),(0,t.default)(this,"_x",void 0),(0,t.default)(this,"_y",void 0),(0,t.default)(this,"_width",void 0),(0,t.default)(this,"_height",void 0),(0,t.default)(this,"_padding",void 0),(0,t.default)(this,"props",void 0);const{id:r,x:n=0,y:p=0,width:h="100%",height:d="100%",padding:a=null,viewportInstance:l}=s||{};(0,o.default)(!l||l instanceof i.default),this.viewportInstance=l,this.id=r||this.constructor.displayName||"view",this.props={...s,id:this.id},this._x=(0,e.parsePosition)(n),this._y=(0,e.parsePosition)(p),this._width=(0,e.parsePosition)(h),this._height=(0,e.parsePosition)(d),this._padding=a&&{left:(0,e.parsePosition)(a.left||0),right:(0,e.parsePosition)(a.right||0),top:(0,e.parsePosition)(a.top||0),bottom:(0,e.parsePosition)(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&(0,s.deepEqual)(this.props,t.props,2))}makeViewport({width:t,height:i,viewState:e}){if(this.viewportInstance)return this.viewportInstance;e=this.filterViewState(e);const s=this.getDimensions({width:t,height:i});return new this.ViewportType({...e,...this.props,...s})}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:(null==t?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const i={...t};for(const t in this.props.viewState)"id"!==t&&(i[t]=this.props.viewState[t]);return i}return t}getDimensions({width:t,height:i}){const s={x:(0,e.getPosition)(this._x,t),y:(0,e.getPosition)(this._y,i),width:(0,e.getPosition)(this._width,t),height:(0,e.getPosition)(this._height,i)};return this._padding&&(s.padding={left:(0,e.getPosition)(this._padding.left,t),top:(0,e.getPosition)(this._padding.top,i),right:(0,e.getPosition)(this._padding.right,t),bottom:(0,e.getPosition)(this._padding.bottom,i)}),s}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}exports.default=n;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../viewports/viewport":"HjGN","../utils/positions":"MOmt","../utils/deep-equal":"KSag","../utils/assert":"Txat"}],"yDoV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=i(require("@babel/runtime/helpers/esm/defineProperty"));function i(t){return t&&t.__esModule?t:{default:t}}class e{constructor(i){(0,t.default)(this,"_inProgress",void 0),(0,t.default)(this,"_handle",void 0),(0,t.default)(this,"_timeline",void 0),(0,t.default)(this,"time",void 0),(0,t.default)(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=i,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var i,e;this.cancel(),this.settings=t,this._inProgress=!0,null===(i=(e=this.settings).onStart)||void 0===i||i.call(e,this)}end(){var t,i;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(i=this.settings).onEnd)||void 0===t||t.call(i,this))}cancel(){var t,i;this._inProgress&&(null===(t=(i=this.settings).onInterrupt)||void 0===t||t.call(i,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,i;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:i}=this;this._handle=t.addChannel({delay:t.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(i=this.settings).onUpdate)||void 0===t||t.call(i,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}exports.default=e;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"awSe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.TRANSITION_EVENTS=void 0;var t=i(require("@babel/runtime/helpers/esm/defineProperty")),n=i(require("../transitions/transition"));function i(t){return t&&t.__esModule?t:{default:t}}const r=()=>{},s={BREAK:1,SNAP_TO_END:2,IGNORE:3};exports.TRANSITION_EVENTS=s;const o=t=>t,e=s.BREAK;class a{constructor(i){(0,t.default)(this,"getControllerState",void 0),(0,t.default)(this,"props",void 0),(0,t.default)(this,"propsInTransition",void 0),(0,t.default)(this,"transition",void 0),(0,t.default)(this,"onViewStateChange",void 0),(0,t.default)(this,"onStateChange",void 0),(0,t.default)(this,"_onTransitionUpdate",t=>{const{time:n,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:e}}=t,a=e(n/o),p=i.interpolateProps(r,s,a);this.propsInTransition=this.getControllerState({...this.props,...p}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=i.getControllerState,this.propsInTransition=null,this.transition=new n.default(i.timeline),this.onViewStateChange=i.onViewStateChange||r,this.onStateChange=i.onStateChange||r}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let n=!1;const i=this.props;if(this.props=t,!i||this._shouldIgnoreViewportChange(i,t))return!1;if(this._isTransitionEnabled(t)){let r=i;if(this.transition.inProgress){const{interruption:t,endProps:n}=this.transition.settings;r={...i,...t===s.SNAP_TO_END?n:this.propsInTransition||i}}this._triggerTransition(r,t),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:n,transitionInterpolator:i}=t;return(n>0||"auto"===n)&&Boolean(i)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,n){return this.transition.inProgress?this.transition.settings.interruption===s.IGNORE||this._isUpdateDueToCurrentTransition(n):!this._isTransitionEnabled(n)||n.transitionInterpolator.arePropsEqual(t,n)}_triggerTransition(t,n){const i=this.getControllerState(t),r=this.getControllerState(n).shortestPathFrom(i),s=n.transitionInterpolator,a=s.getDuration?s.getDuration(t,n):n.transitionDuration;if(0===a)return;const p=s.initializeProps(t,r);this.propsInTransition={};const h={duration:a,easing:n.transitionEasing||o,interpolator:s,interruption:n.transitionInterruption||e,startProps:p.start,endProps:p.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(h),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==t||t(n)}}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../transitions/transition":"yDoV"}],"R8fo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=o(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@math.gl/core"),t=o(require("../utils/assert"));function o(r){return r&&r.__esModule?r:{default:r}}class i{constructor(e){(0,r.default)(this,"_propsToCompare",void 0),(0,r.default)(this,"_propsToExtract",void 0),(0,r.default)(this,"_requiredProps",void 0);const{compare:t,extract:o,required:i}=e;this._propsToCompare=t,this._propsToExtract=o||t,this._requiredProps=i}arePropsEqual(r,t){for(const o of this._propsToCompare)if(!(o in r&&o in t&&(0,e.equals)(r[o],t[o])))return!1;return!0}initializeProps(r,e){const t={},o={};for(const i of this._propsToExtract)(i in r||i in e)&&(t[i]=r[i],o[i]=e[i]);return this._checkRequiredProps(t),this._checkRequiredProps(o),{start:t,end:o}}getDuration(r,e){return e.transitionDuration}_checkRequiredProps(r){this._requiredProps&&this._requiredProps.forEach(e=>{const o=r[e];(0,t.default)(Number.isFinite(o)||Array.isArray(o),"".concat(e," is required for transition"))})}}exports.default=i;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx","../utils/assert":"Txat"}],"bGRb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("@babel/runtime/helpers/esm/defineProperty")),r=o(require("./transition-interpolator")),e=require("@math.gl/core");function o(t){return t&&t.__esModule?t:{default:t}}const i=["longitude","latitude","zoom","bearing","pitch"],s=["longitude","latitude","zoom"];class n extends r.default{constructor(r={}){const e=Array.isArray(r)?r:r.transitionProps,o=Array.isArray(r)?{}:r;o.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:i,required:s},super(o.transitionProps),(0,t.default)(this,"opts",void 0),this.opts=o}initializeProps(t,r){const e=super.initializeProps(t,r),{makeViewport:o,around:i}=this.opts;if(o&&i){const s=o(t),n=o(r),a=s.unproject(i);e.start.around=i,Object.assign(e.end,{around:n.project(a),aroundPosition:a,width:r.width,height:r.height})}return e}interpolateProps(t,r,o){const i={};for(const s of this._propsToExtract)i[s]=(0,e.lerp)(t[s]||0,r[s]||0,o);if(r.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...r,...i});Object.assign(i,s.panByPosition(r.aroundPosition,(0,e.lerp)(t.around,r.around,o)))}return i}}exports.default=n;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./transition-interpolator":"R8fo","@math.gl/core":"dwLx"}],"ugw5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=i(require("@babel/runtime/helpers/esm/defineProperty")),e=i(require("./transition-manager")),n=i(require("../transitions/linear-interpolator"));function i(t){return t&&t.__esModule?t:{default:t}}const o={transitionDuration:0},s=300,a=t=>1-(1-t)*(1-t),r={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},h={};class l{constructor(n){(0,t.default)(this,"props",void 0),(0,t.default)(this,"state",{}),(0,t.default)(this,"transitionManager",void 0),(0,t.default)(this,"eventManager",void 0),(0,t.default)(this,"onViewStateChange",void 0),(0,t.default)(this,"onStateChange",void 0),(0,t.default)(this,"makeViewport",void 0),(0,t.default)(this,"_controllerState",void 0),(0,t.default)(this,"_events",{}),(0,t.default)(this,"_interactionState",{isDragging:!1}),(0,t.default)(this,"_customEvents",[]),(0,t.default)(this,"_eventStartBlocked",null),(0,t.default)(this,"_panMove",!1),(0,t.default)(this,"invertPan",!1),(0,t.default)(this,"dragMode","rotate"),(0,t.default)(this,"inertia",0),(0,t.default)(this,"scrollZoom",!0),(0,t.default)(this,"dragPan",!0),(0,t.default)(this,"dragRotate",!0),(0,t.default)(this,"doubleClickZoom",!0),(0,t.default)(this,"touchZoom",!0),(0,t.default)(this,"touchRotate",!1),(0,t.default)(this,"keyboard",!0),this.transitionManager=new e.default({...n,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=n.eventManager,this.onViewStateChange=n.onViewStateChange||(()=>{}),this.onStateChange=n.onStateChange||(()=>{}),this.makeViewport=n.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events){var t;if(this._events[e])null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent)}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const o=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return o&&e&&e.stopPropagation(),o}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?s:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:o=!0,doubleClickZoom:a=!0,touchZoom:h=!0,touchRotate:l=!1,keyboard:g=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(r.WHEEL,c&&n),this.toggleEvents(r.PAN,c&&(i||o)),this.toggleEvents(r.PINCH,c&&(h||l)),this.toggleEvents(r.TRIPLE_PAN,c&&l),this.toggleEvents(r.DOUBLE_TAP,c&&a),this.toggleEvents(r.KEYBOARD,c&&g),this.scrollZoom=n,this.dragPan=i,this.dragRotate=o,this.doubleClickZoom=a,this.touchZoom=h,this.touchRotate=l,this.keyboard=g}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))})}updateViewport(t,e=null,n={}){const i={...t.getViewportProps(),...e},o=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),o){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,o,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,o,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],o=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,o,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],o=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.srcEvent.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:o}=t;let s=2/(1+Math.exp(-Math.abs(o*n)));o<0&&0!==s&&(s=1/s);const a=this.controllerState.zoom({pos:e,scale:s});return this.updateViewport(a,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,o,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,o,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],o=this.controllerState.rotate({pos:i});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return h._startPinchRotation=t.rotation,h._lastPinchEvent=t,this.updateViewport(n,o,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:h._startPinchRotation-n})}return this.updateViewport(e,o,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),h._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=h;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let o=this.controllerState.rotateEnd();const s=Math.log2(t.scale),r=(s-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),h=Math.pow(2,s+r*e/2);o=o.zoom({pos:i,scale:h}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return h._startPinchRotation=null,h._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:o,rotateSpeedY:s}=!0===this.keyboard?{}:this.keyboard,{controllerState:a}=this;let r;const h={};switch(t.srcEvent.code){case"Minus":r=e?a.zoomOut(n).zoomOut(n):a.zoomOut(n),h.isZooming=!0;break;case"Equal":r=e?a.zoomIn(n).zoomIn(n):a.zoomIn(n),h.isZooming=!0;break;case"ArrowLeft":e?(r=a.rotateLeft(o),h.isRotating=!0):(r=a.moveLeft(i),h.isPanning=!0);break;case"ArrowRight":e?(r=a.rotateRight(o),h.isRotating=!0):(r=a.moveRight(i),h.isPanning=!0);break;case"ArrowUp":e?(r=a.rotateUp(s),h.isRotating=!0):(r=a.moveUp(i),h.isPanning=!0);break;case"ArrowDown":e?(r=a.rotateDown(s),h.isRotating=!0):(r=a.moveDown(i),h.isPanning=!0);break;default:return!1}return this.updateViewport(r,this._getTransitionProps(),h),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new n.default({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:o}}exports.default=l;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./transition-manager":"awSe","../transitions/linear-interpolator":"bGRb"}],"TfDO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("@babel/runtime/helpers/esm/defineProperty"));function e(t){return t&&t.__esModule?t:{default:t}}class r{constructor(e,r){(0,t.default)(this,"_viewportProps",void 0),(0,t.default)(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"N44t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.MapState=void 0;var t=n(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@math.gl/core"),r=n(require("./controller")),o=n(require("./view-state")),i=require("@math.gl/web-mercator"),a=n(require("../utils/assert")),s=n(require("../transitions/linear-interpolator"));function n(t){return t&&t.__esModule?t:{default:t}}const p=5,h=1.2;class u extends o.default{constructor(e){const{width:r,height:o,latitude:i,longitude:s,zoom:n,bearing:p=0,pitch:h=0,altitude:u=1.5,position:m=[0,0,0],maxZoom:g=20,minZoom:d=0,maxPitch:l=60,minPitch:c=0,startPanLngLat:P,startZoomLngLat:w,startRotatePos:_,startBearing:V,startPitch:S,startZoom:b,normalize:z=!0}=e;(0,a.default)(Number.isFinite(s)),(0,a.default)(Number.isFinite(i)),(0,a.default)(Number.isFinite(n)),super({width:r,height:o,latitude:i,longitude:s,zoom:n,bearing:p,pitch:h,altitude:u,maxZoom:g,minZoom:d,maxPitch:l,minPitch:c,normalize:z,position:m},{startPanLngLat:P,startZoomLngLat:w,startRotatePos:_,startBearing:V,startPitch:S,startZoom:b}),(0,t.default)(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const r=this.getState().startPanLngLat||this._unproject(e);if(!r)return this;const o=this.makeViewport(this.getViewportProps()).panByPosition(r,t);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:r=0}){const{startRotatePos:o,startBearing:i,startPitch:a}=this.getState();if(!o||void 0===i||void 0===a)return this;let s;return s=t?this._getNewRotation(t,o,a,i):{bearing:i+e,pitch:a+r},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:r,scale:o}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(r)||this._unproject(t)),!a)return this;const{maxZoom:s,minZoom:n}=this.getViewportProps();let p=i+Math.log2(o);p=(0,e.clamp)(p,n,s);const h=this.makeViewport({...this.getViewportProps(),zoom:p});return this._getUpdatedState({zoom:p,...h.panByPosition(a,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),r={...this.getViewportProps()},{bearing:o,longitude:i}=r;return Math.abs(o-e.bearing)>180&&(r.bearing=o<0?o+360:o-360),Math.abs(i-e.longitude)>180&&(r.longitude=i<0?i+360:i-360),r}applyConstraints(t){const{maxZoom:r,minZoom:o,zoom:a}=t;t.zoom=(0,e.clamp)(a,o,r);const{maxPitch:s,minPitch:n,pitch:p}=t;t.pitch=(0,e.clamp)(p,n,s);const{normalize:h=!0}=t;return h&&Object.assign(t,(0,i.normalizeViewportProps)(t)),t}_zoomFromCenter(t){const{width:e,height:r}=this.getViewportProps();return this.zoom({pos:[e/2,r/2],scale:t})}_panFromCenter(t){const{width:e,height:r}=this.getViewportProps();return this.pan({startPos:[e/2,r/2],pos:[e/2+t[0],r/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,r,o,i){const a=t[0]-r[0],s=t[1]-r[1],n=t[1],u=r[1],{width:m,height:g}=this.getViewportProps(),d=a/m;let l=0;s>0?Math.abs(g-u)>p&&(l=s/(u-g)*h):s<0&&u>p&&(l=1-n/u),l=(0,e.clamp)(l,-1,1);const{minPitch:c,maxPitch:P}=this.getViewportProps();let w=o;return l>0?w=o+l*(P-o):l<0&&(w=o-l*(c-o)),{pitch:w,bearing:i+180*d}}}exports.MapState=u;class m extends r.default{constructor(...e){super(...e),(0,t.default)(this,"ControllerState",u),(0,t.default)(this,"transition",{transitionDuration:300,transitionInterpolator:new s.default({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),(0,t.default)(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}exports.default=m;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx","./controller":"ugw5","./view-state":"TfDO","@math.gl/web-mercator":"PqV4","../utils/assert":"Txat","../transitions/linear-interpolator":"bGRb"}],"wDMu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("@babel/runtime/helpers/esm/defineProperty")),r=u(require("./view")),t=u(require("../viewports/web-mercator-viewport")),l=u(require("../controllers/map-controller"));function u(e){return e&&e.__esModule?e:{default:e}}class o extends r.default{get ViewportType(){return t.default}get ControllerType(){return l.default}}exports.default=o,(0,e.default)(o,"displayName","MapView");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./view":"k6Eh","../viewports/web-mercator-viewport":"Rf6Y","../controllers/map-controller":"N44t"}],"sqcc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=f(require("@babel/runtime/helpers/esm/defineProperty")),t=require("../utils/deep-equal"),s=f(require("../effects/lighting/lighting-effect"));function f(e){return e&&e.__esModule?e:{default:e}}const i=new s.default;function d(e,t){var s,f;return(null!==(s=e.order)&&void 0!==s?s:1/0)-(null!==(f=t.order)&&void 0!==f?f:1/0)}class r{constructor(){(0,e.default)(this,"effects",void 0),(0,e.default)(this,"_resolvedEffects",[]),(0,e.default)(this,"_defaultEffects",[]),(0,e.default)(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(t=>t.id===e.id)){const s=t.findIndex(t=>d(t,e)>0);s<0?t.push(e):t.splice(s,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&((0,t.deepEqual)(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const s of this.effects)t[s.id]=s;const f=[];for(const s of e){const e=t[s.id];e&&e!==s?e.setProps?(e.setProps(s.props),f.push(e)):(e.cleanup(),f.push(s)):f.push(s),delete t[s.id]}for(const s in t)t[s].cleanup();this.effects=f,this._resolvedEffects=f.concat(this._defaultEffects),e.some(e=>e instanceof s.default)||this._resolvedEffects.push(i),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../utils/deep-equal":"KSag","../effects/lighting/lighting-effect":"MByF"}],"snJ8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./layers-pass"));function r(e){return e&&e.__esModule?e:{default:e}}class s extends e.default{shouldDrawLayer(e){const{operation:r}=e.props;return r.includes("draw")||r.includes("terrain")}}exports.default=s;
},{"./layers-pass":"oM9Q"}],"J3c9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@babel/runtime/helpers/esm/defineProperty")),s=a(require("../debug")),r=a(require("../passes/draw-layers-pass")),t=a(require("../passes/pick-layers-pass")),i=require("@luma.gl/core");function a(e){return e&&e.__esModule?e:{default:e}}const d="deckRenderer.renderLayers";class l{constructor(s){(0,e.default)(this,"gl",void 0),(0,e.default)(this,"layerFilter",void 0),(0,e.default)(this,"drawPickingColors",void 0),(0,e.default)(this,"drawLayersPass",void 0),(0,e.default)(this,"pickLayersPass",void 0),(0,e.default)(this,"renderCount",void 0),(0,e.default)(this,"_needsRedraw",void 0),(0,e.default)(this,"renderBuffers",void 0),(0,e.default)(this,"lastPostProcessEffect",void 0),this.gl=s,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new r.default(s),this.pickLayersPass=new t.default(s),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,t={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||i.Framebuffer.getDefaultFramebuffer(this.gl)};t.effects&&this._preRender(t.effects,t);const a=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,l=r.render({...t,target:a});t.effects&&this._postRender(t.effects,t),this.renderCount++,(0,s.default)(d,this,l,e)}needsRedraw(e={clearRedrawFlags:!1}){const s=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),s}finalize(){const{renderBuffers:e}=this;for(const s of e)s.delete();e.length=0}_preRender(e,s){this.lastPostProcessEffect=null,s.preRenderStats=s.preRenderStats||{};for(const r of e)s.preRenderStats[r.id]=r.preRender(this.gl,s),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new i.Framebuffer(this.gl),new i.Framebuffer(this.gl));for(const s of e)s.resize()}_postRender(e,s){const{renderBuffers:r}=this,t={...s,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const i of e)if(i.postRender){if(i.id===this.lastPostProcessEffect){t.target=s.target,i.postRender(this.gl,t);break}const e=i.postRender(this.gl,t);t.inputBuffer=e,t.swapBuffer=e===r[0]?r[1]:r[0]}}}exports.default=l;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../debug":"EEoF","../passes/draw-layers-pass":"snJ8","../passes/pick-layers-pass":"WJJZ","@luma.gl/core":"iuAK"}],"Eruv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getClosestObject=r,exports.getUniqueObjects=i;var e=o(require("../../utils/log"));function o(e){return e&&e.__esModule?e:{default:e}}const t={pickedColor:null,pickedObjectIndex:-1};function r({pickedColors:o,decodePickingColor:r,deviceX:i,deviceY:c,deviceRadius:n,deviceRect:s}){const{x:l,y:d,width:u,height:f}=s;let p=n*n,a=-1,k=0;for(let e=0;e<f;e++){const t=e+d-c,r=t*t;if(r>p)k+=4*u;else for(let e=0;e<u;e++){if(o[k+3]-1>=0){const o=e+l-i,t=o*o+r;t<=p&&(p=t,a=k)}k+=4}}if(a>=0){const t=o.slice(a,a+4),i=r(t);if(i){const e=Math.floor(a/4/u),o=a/4-e*u;return{...i,pickedColor:t,pickedX:l+o,pickedY:d+e}}e.default.error("Picked non-existent layer. Is picking buffer corrupt?")()}return t}function i({pickedColors:o,decodePickingColor:t}){const r=new Map;if(o)for(let i=0;i<o.length;i+=4){if(o[i+3]-1>=0){const c=o.slice(i,i+4),n=c.join(",");if(!r.has(n)){const o=t(c);o?r.set(n,{...o,color:c}):e.default.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}
},{"../../utils/log":"GVus"}],"dX8M":[function(require,module,exports) {
"use strict";function e({pickInfo:e,viewports:o,pixelRatio:i,x:t,y:r,z:c}){let l,d=o[0];if(o.length>1&&(d=n((null==e?void 0:e.pickedViewports)||o,{x:t,y:r})),d){const e=[t-d.x,r-d.y];void 0!==c&&(e[2]=c),l=d.unproject(e)}return{color:null,layer:null,viewport:d,index:-1,picked:!1,x:t,y:r,pixel:[t,r],coordinate:l,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:i}}function o(o){const{pickInfo:n,lastPickedInfo:t,mode:r,layers:c}=o,{pickedColor:l,pickedLayer:d,pickedObjectIndex:p}=n,s=d?[d]:[];if("hover"===r){const e=t.index,o=t.layerId,i=d?d.props.id:null;if(i!==o||p!==e){if(i!==o){const e=c.find(e=>e.props.id===o);e&&s.unshift(e)}t.layerId=i,t.index=p,t.info=null}}const f=e(o),u=new Map;return u.set(null,f),s.forEach(e=>{let o={...f};e===d&&(o.color=l,o.index=p,o.picked=!0);const n=(o=i({layer:e,info:o,mode:r})).layer;e===d&&"hover"===r&&(t.info=o),u.set(n.id,o),"hover"===r&&n.updateAutoHighlight(o)}),u}function i({layer:e,info:o,mode:i}){for(;e&&o;){const n=o.layer||null;o.sourceLayer=n,o.layer=e,o=e.getPickingInfo({info:o,mode:i,sourceLayer:n}),e=e.parent}return o}function n(e,o){for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.containsPixel(o))return n}return e[0]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEmptyPickingInfo=e,exports.getLayerPickingInfo=i,exports.processPickInfo=o;
},{}],"G03o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@babel/runtime/helpers/esm/defineProperty")),i=require("@luma.gl/core"),t=r(require("../passes/pick-layers-pass")),s=require("./picking/query-object"),c=require("./picking/pick-info");function r(e){return e&&e.__esModule?e:{default:e}}class o{constructor(i){(0,e.default)(this,"gl",void 0),(0,e.default)(this,"pickingFBO",void 0),(0,e.default)(this,"depthFBO",void 0),(0,e.default)(this,"pickLayersPass",void 0),(0,e.default)(this,"layerFilter",void 0),(0,e.default)(this,"lastPickedInfo",void 0),(0,e.default)(this,"_pickable",!0),this.gl=i,this.pickLayersPass=new t.default(i),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:i,layers:t,viewports:s},c=this.lastPickedInfo.info){const r=c&&c.layer&&c.layer.id,o=c&&c.viewport&&c.viewport.id,l=r?t.find(e=>e.id===r):null,a=o&&s.find(e=>e.id===o)||s[0],d=a&&a.unproject([e-a.x,i-a.y]),n={x:e,y:i,viewport:a,coordinate:d,layer:l};return{...c,...n}}_resizeBuffer(){var e,t;const{gl:s}=this;if(!this.pickingFBO&&(this.pickingFBO=new i.Framebuffer(s),i.Framebuffer.isSupported(s,{colorBufferFloat:!0}))){const e=new i.Framebuffer(s);e.attach({36064:new i.Texture2D(s,{format:(0,i.isWebGL2)(s)?34836:6408,type:5126})}),this.depthFBO=e}null===(e=this.pickingFBO)||void 0===e||e.resize({width:s.canvas.width,height:s.canvas.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:s.canvas.width,height:s.canvas.height})}_getPickable(e){if(!1===this._pickable)return null;const i=e.filter(e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite);return i.length?i:null}_pickClosestObject({layers:e,views:t,viewports:r,x:o,y:l,radius:a=0,depth:d=1,mode:n="query",unproject3D:h,onViewportActive:p,effects:u}){const f=this._getPickable(e),k=(0,i.cssToDeviceRatio)(this.gl);if(!f)return{result:[],emptyInfo:(0,c.getEmptyPickingInfo)({viewports:r,x:o,y:l,pixelRatio:k})};this._resizeBuffer();const v=(0,i.cssToDevicePixels)(this.gl,[o,l],!0),y=[v.x+Math.floor(v.width/2),v.y+Math.floor(v.height/2)],g=Math.round(a*k),{width:w,height:x}=this.pickingFBO,b=this._getPickingRect({deviceX:y[0],deviceY:y[1],deviceRadius:g,deviceWidth:w,deviceHeight:x}),O={x:o-a,y:l-a,width:2*a+1,height:2*a+1};let P;const F=[],m=new Set;for(let i=0;i<d;i++){let e,a;if(b){const i=this._drawAndSample({layers:f,views:t,viewports:r,onViewportActive:p,deviceRect:b,cullRect:O,effects:u,pass:"picking:".concat(n)});e=(0,s.getClosestObject)({...i,deviceX:y[0],deviceY:y[1],deviceRadius:g,deviceRect:b})}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&h&&this.depthFBO){const{pickedColors:i}=this._drawAndSample({layers:[e.pickedLayer],views:t,viewports:r,onViewportActive:p,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:O,effects:u,pass:"picking:".concat(n,":z")},!0);i[3]&&(a=i[0])}e.pickedLayer&&i+1<d&&(m.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),P=(0,c.processPickInfo)({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:n,layers:f,viewports:r,x:o,y:l,z:a,pixelRatio:k});for(const i of P.values())i.layer&&F.push(i);if(!e.pickedColor)break}for(const i of m)i.restorePickingColors();return{result:F,emptyInfo:P.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:r,x:o,y:l,width:a=1,height:d=1,mode:n="query",maxObjects:h=null,onViewportActive:p,effects:u}){const f=this._getPickable(e);if(!f)return[];this._resizeBuffer();const k=(0,i.cssToDeviceRatio)(this.gl),v=(0,i.cssToDevicePixels)(this.gl,[o,l],!0),y=v.x,g=v.y+v.height,w=(0,i.cssToDevicePixels)(this.gl,[o+a,l+d],!0),x=w.x+w.width,b=w.y,O={x:y,y:b,width:x-y,height:g-b},P=this._drawAndSample({layers:f,views:t,viewports:r,onViewportActive:p,deviceRect:O,cullRect:{x:o,y:l,width:a,height:d},effects:u,pass:"picking:".concat(n)}),F=(0,s.getUniqueObjects)(P),m=new Map,_=Number.isFinite(h);for(let i=0;i<F.length&&!(_&&h&&m.size>=h);i++){const e=F[i];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:o,y:l,pixelRatio:k};t=(0,c.getLayerPickingInfo)({layer:e.pickedLayer,info:t,mode:n}),m.has(t.object)||m.set(t.object,t)}return Array.from(m.values())}_drawAndSample({layers:e,views:t,viewports:s,onViewportActive:c,deviceRect:r,cullRect:o,effects:l,pass:a},d=!1){const n=d?this.depthFBO:this.pickingFBO,h={layers:e,layerFilter:this.layerFilter,views:t,viewports:s,onViewportActive:c,pickingFBO:n,deviceRect:r,cullRect:o,effects:l,pass:a,pickZ:d,preRenderStats:{}};for(const i of l)i.useInPicking&&(h.preRenderStats[i.id]=i.preRender(this.gl,h));const{decodePickingColor:p}=this.pickLayersPass.render(h),{x:u,y:f,width:k,height:v}=r,y=new(d?Float32Array:Uint8Array)(k*v*4);return(0,i.readPixelsToArray)(n,{sourceX:u,sourceY:f,sourceWidth:k,sourceHeight:v,target:y}),{pickedColors:y,decodePickingColor:p}}_getPickingRect({deviceX:e,deviceY:i,deviceRadius:t,deviceWidth:s,deviceHeight:c}){const r=Math.max(0,e-t),o=Math.max(0,i-t),l=Math.min(s,e+t+1)-r,a=Math.min(c,i+t+1)-o;return l<=0||a<=0?null:{x:r,y:o,width:l,height:a}}}exports.default=o;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","../passes/pick-layers-pass":"WJJZ","./picking/query-object":"Eruv","./picking/pick-info":"dX8M"}],"Dm3R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("@babel/runtime/helpers/esm/defineProperty"));function t(e){return e&&e.__esModule?e:{default:e}}const s={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class l{constructor(t){(0,e.default)(this,"el",null),(0,e.default)(this,"isVisible",!1);const l=t.parentElement;l&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,s),l.appendChild(this.el))}setTooltip(e,t,s){const l=this.el;if(l){if("string"==typeof e)l.innerText=e;else{if(!e)return this.isVisible=!1,void(l.style.display="none");e.text&&(l.innerText=e.text),e.html&&(l.innerHTML=e.html),e.className&&(l.className=e.className),Object.assign(l.style,e.style)}this.isVisible=!0,l.style.display="block",l.style.transform="translate(".concat(t,"px, ").concat(s,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}exports.default=l;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"K0KY":[function(require,module,exports) {
var define;
var t;!function(e,i,n,r){"use strict";var s,o=["","webkit","Moz","MS","ms","o"],a=i.createElement("div"),h="function",u=Math.round,c=Math.abs,l=Date.now;function p(t,e,i){return setTimeout(y(t,i),e)}function f(t,e,i){return!!Array.isArray(t)&&(v(t,i[e],i),!0)}function v(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==r)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function d(t,i,n){var r="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=e.console&&(e.console.warn||e.console.log);return s&&s.call(e.console,r,n),t.apply(this,arguments)}}s="function"!=typeof Object.assign?function(t){if(t===r||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==r&&null!==n)for(var s in n)n.hasOwnProperty(s)&&(e[s]=n[s])}return e}:Object.assign;var m=d(function(t,e,i){for(var n=Object.keys(e),s=0;s<n.length;)(!i||i&&t[n[s]]===r)&&(t[n[s]]=e[n[s]]),s++;return t},"extend","Use `assign`."),g=d(function(t,e){return m(t,e,!0)},"merge","Use `assign`.");function T(t,e,i){var n,r=e.prototype;(n=t.prototype=Object.create(r)).constructor=t,n._super=r,i&&s(n,i)}function y(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==h?t.apply(e&&e[0]||r,e):t}function I(t,e){return t===r?e:t}function A(t,e,i){v(b(e),function(e){t.addEventListener(e,i,!1)})}function _(t,e,i){v(b(e),function(e){t.removeEventListener(e,i,!1)})}function C(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function S(t,e){return t.indexOf(e)>-1}function b(t){return t.trim().split(/\s+/g)}function P(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function D(t){return Array.prototype.slice.call(t,0)}function x(t,e,i){for(var n=[],r=[],s=0;s<t.length;){var o=e?t[s][e]:t[s];P(r,o)<0&&n.push(t[s]),r[s]=o,s++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function w(t,e){for(var i,n,s=e[0].toUpperCase()+e.slice(1),a=0;a<o.length;){if((n=(i=o[a])?i+s:e)in t)return n;a++}return r}var O=1;function R(t){var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||e}var M="ontouchstart"in e,z=w(e,"PointerEvent")!==r,N=M&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),X=25,Y=1,F=2,W=4,q=8,k=1,H=2,L=4,U=8,V=16,j=H|L,G=U|V,Z=j|G,B=["x","y"],$=["clientX","clientY"];function J(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&i.handler(e)},this.init()}function K(t,e,i){var n=i.pointers.length,s=i.changedPointers.length,o=e&Y&&n-s==0,a=e&(W|q)&&n-s==0;i.isFirst=!!o,i.isFinal=!!a,o&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,s=n.length;i.firstInput||(i.firstInput=Q(e));s>1&&!i.firstMultiple?i.firstMultiple=Q(e):1===s&&(i.firstMultiple=!1);var o=i.firstInput,a=i.firstMultiple,h=a?a.center:o.center,u=e.center=tt(n);e.timeStamp=l(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=rt(h,u),e.distance=nt(h,u),function(t,e){var i=e.center,n=t.offsetDelta||{},r=t.prevDelta||{},s=t.prevInput||{};e.eventType!==Y&&s.eventType!==W||(r=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y});e.deltaX=r.x+(i.x-n.x),e.deltaY=r.y+(i.y-n.y)}(i,e),e.offsetDirection=it(e.deltaX,e.deltaY);var p=et(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=c(p.x)>c(p.y)?p.x:p.y,e.scale=a?(f=a.pointers,v=n,nt(v[0],v[1],$)/nt(f[0],f[1],$)):1,e.rotation=a?function(t,e){return rt(e[1],e[0],$)+rt(t[1],t[0],$)}(a.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,s,o,a=t.lastInterval||e,h=e.timeStamp-a.timeStamp;if(e.eventType!=q&&(h>X||a.velocity===r)){var u=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,p=et(h,u,l);n=p.x,s=p.y,i=c(p.x)>c(p.y)?p.x:p.y,o=it(u,l),t.lastInterval=e}else i=a.velocity,n=a.velocityX,s=a.velocityY,o=a.direction;e.velocity=i,e.velocityX=n,e.velocityY=s,e.direction=o}(i,e);var f,v;var d=t.element;C(e.srcEvent.target,d)&&(d=e.srcEvent.target);e.target=d}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Q(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:u(t.pointers[i].clientX),clientY:u(t.pointers[i].clientY)},i++;return{timeStamp:l(),pointers:e,center:tt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function tt(t){var e=t.length;if(1===e)return{x:u(t[0].clientX),y:u(t[0].clientY)};for(var i=0,n=0,r=0;r<e;)i+=t[r].clientX,n+=t[r].clientY,r++;return{x:u(i/e),y:u(n/e)}}function et(t,e,i){return{x:e/t||0,y:i/t||0}}function it(t,e){return t===e?k:c(t)>=c(e)?t<0?H:L:e<0?U:V}function nt(t,e,i){i||(i=B);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return Math.sqrt(n*n+r*r)}function rt(t,e,i){i||(i=B);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return 180*Math.atan2(r,n)/Math.PI}J.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(R(this.element),this.evWin,this.domHandler)}};var st={mousedown:Y,mousemove:F,mouseup:W},ot="mousedown",at="mousemove mouseup";function ht(){this.evEl=ot,this.evWin=at,this.pressed=!1,J.apply(this,arguments)}T(ht,J,{handler:function(t){var e=st[t.type];e&Y&&0===t.button&&(this.pressed=!0),e&F&&1!==t.which&&(e=W),this.pressed&&(e&W&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var ut={pointerdown:Y,pointermove:F,pointerup:W,pointercancel:q,pointerout:q},ct={2:"touch",3:"pen",4:"mouse",5:"kinect"},lt="pointerdown",pt="pointermove pointerup pointercancel";function ft(){this.evEl=lt,this.evWin=pt,J.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(lt="MSPointerDown",pt="MSPointerMove MSPointerUp MSPointerCancel"),T(ft,J,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),r=ut[n],s=ct[t.pointerType]||t.pointerType,o="touch"==s,a=P(e,t.pointerId,"pointerId");r&Y&&(0===t.button||o)?a<0&&(e.push(t),a=e.length-1):r&(W|q)&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),i&&e.splice(a,1))}});var vt={touchstart:Y,touchmove:F,touchend:W,touchcancel:q},dt="touchstart",mt="touchstart touchmove touchend touchcancel";function gt(){this.evTarget=dt,this.evWin=mt,this.started=!1,J.apply(this,arguments)}T(gt,J,{handler:function(t){var e=vt[t.type];if(e===Y&&(this.started=!0),this.started){var i=function(t,e){var i=D(t.touches),n=D(t.changedTouches);e&(W|q)&&(i=x(i.concat(n),"identifier",!0));return[i,n]}.call(this,t,e);e&(W|q)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}}});var Tt={touchstart:Y,touchmove:F,touchend:W,touchcancel:q},yt="touchstart touchmove touchend touchcancel";function Et(){this.evTarget=yt,this.targetIds={},J.apply(this,arguments)}T(Et,J,{handler:function(t){var e=Tt[t.type],i=function(t,e){var i=D(t.touches),n=this.targetIds;if(e&(Y|F)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,o=D(t.changedTouches),a=[],h=this.target;if(s=i.filter(function(t){return C(t.target,h)}),e===Y)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;r=0;for(;r<o.length;)n[o[r].identifier]&&a.push(o[r]),e&(W|q)&&delete n[o[r].identifier],r++;if(!a.length)return;return[x(s.concat(a),"identifier",!0),a]}.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}});var It=2500,At=25;function _t(){J.apply(this,arguments);var t=y(this.handler,this);this.touch=new Et(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Ct(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},It)}}T(_t,J,{handler:function(t,e,i){var n="touch"==i.pointerType,r="mouse"==i.pointerType;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)(function(t,e){t&Y?(this.primaryTouch=e.changedPointers[0].identifier,Ct.call(this,e)):t&(W|q)&&Ct.call(this,e)}).call(this,e,i);else if(r&&function(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],s=Math.abs(e-r.x),o=Math.abs(i-r.y);if(s<=At&&o<=At)return!0}return!1}.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var St=w(a.style,"touchAction"),bt=St!==r,Pt="auto",Dt="manipulation",xt="none",wt="pan-x",Ot="pan-y",Rt=function(){if(!bt)return!1;var t={},i=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!i||e.CSS.supports("touch-action",n)}),t}();function Mt(t,e){this.manager=t,this.set(e)}Mt.prototype={set:function(t){"compute"==t&&(t=this.compute()),bt&&this.manager.element.style&&Rt[t]&&(this.manager.element.style[St]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(S(t,xt))return xt;var e=S(t,wt),i=S(t,Ot);if(e&&i)return xt;if(e||i)return e?wt:Ot;if(S(t,Dt))return Dt;return Pt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,r=S(n,xt)&&!Rt[xt],s=S(n,Ot)&&!Rt[Ot],o=S(n,wt)&&!Rt[wt];if(r){var a=1===t.pointers.length,h=t.distance<2,u=t.deltaTime<250;if(a&&h&&u)return}if(!o||!s)return r||s&&i&j||o&&i&G?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var zt=1,Nt=2,Xt=4,Yt=8,Ft=Yt,Wt=16;function qt(t){this.options=s({},this.defaults,t||{}),this.id=O++,this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=zt,this.simultaneous={},this.requireFail=[]}function kt(t){return t&Wt?"cancel":t&Yt?"end":t&Xt?"move":t&Nt?"start":""}function Ht(t){return t==V?"down":t==U?"up":t==H?"left":t==L?"right":""}function Lt(t,e){var i=e.manager;return i?i.get(t):t}function Ut(){qt.apply(this,arguments)}function Vt(){Ut.apply(this,arguments),this.pX=null,this.pY=null}function jt(){Ut.apply(this,arguments)}function Gt(){qt.apply(this,arguments),this._timer=null,this._input=null}function Zt(){Ut.apply(this,arguments)}function Bt(){Ut.apply(this,arguments)}function $t(){qt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Jt(t,e){return(e=e||{}).recognizers=I(e.recognizers,Jt.defaults.preset),new Kt(t,e)}qt.prototype={defaults:{},set:function(t){return s(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(f(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Lt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return f(t,"dropRecognizeWith",this)?this:(t=Lt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(f(t,"requireFailure",this))return this;var e=this.requireFail;return-1===P(e,t=Lt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(f(t,"dropRequireFailure",this))return this;t=Lt(t,this);var e=P(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<Yt&&n(e.options.event+kt(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=Yt&&n(e.options.event+kt(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|zt)))return!1;t++}return!0},recognize:function(t){var e=s({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Ft|Wt|32)&&(this.state=zt),this.state=this.process(e),this.state&(Nt|Xt|Yt|Wt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},T(Ut,qt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(Nt|Xt),r=this.attrTest(t);return n&&(i&q||!r)?e|Wt:n||r?i&W?e|Yt:e&Nt?e|Xt:Nt:32}}),T(Vt,Ut,{defaults:{event:"pan",threshold:10,pointers:1,direction:Z},getTouchAction:function(){var t=this.options.direction,e=[];return t&j&&e.push(Ot),t&G&&e.push(wt),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,r=t.direction,s=t.deltaX,o=t.deltaY;return r&e.direction||(e.direction&j?(r=0===s?k:s<0?H:L,i=s!=this.pX,n=Math.abs(t.deltaX)):(r=0===o?k:o<0?U:V,i=o!=this.pY,n=Math.abs(t.deltaY))),t.direction=r,i&&n>e.threshold&&r&e.direction},attrTest:function(t){return Ut.prototype.attrTest.call(this,t)&&(this.state&Nt||!(this.state&Nt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Ht(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),T(jt,Ut,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[xt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Nt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),T(Gt,qt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Pt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(W|q)&&!r)this.reset();else if(t.eventType&Y)this.reset(),this._timer=p(function(){this.state=Ft,this.tryEmit()},e.time,this);else if(t.eventType&W)return Ft;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Ft&&(t&&t.eventType&W?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input)))}}),T(Zt,Ut,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[xt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Nt)}}),T(Bt,Ut,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:j|G,pointers:1},getTouchAction:function(){return Vt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(j|G)?e=t.overallVelocity:i&j?e=t.overallVelocityX:i&G&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&c(e)>this.options.velocity&&t.eventType&W},emit:function(t){var e=Ht(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),T($t,qt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Dt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&Y&&0===this.count)return this.failTimeout();if(n&&r&&i){if(t.eventType!=W)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<e.interval,o=!this.pCenter||nt(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,o&&s?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=p(function(){this.state=Ft,this.tryEmit()},e.interval,this),Nt):Ft}return 32},failTimeout:function(){return this._timer=p(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ft&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Jt.VERSION="2.0.7",Jt.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Zt,{enable:!1}],[jt,{enable:!1},["rotate"]],[Bt,{direction:j}],[Vt,{direction:j},["swipe"]],[$t],[$t,{event:"doubletap",taps:2},["tap"]],[Gt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Kt(t,e){var i;this.options=s({},Jt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((i=this).options.inputClass||(z?ft:N?Et:M?_t:ht))(i,K),this.touchAction=new Mt(this,this.options.touchAction),Qt(this,!0),v(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function Qt(t,e){var i,n=t.element;n.style&&(v(t.options.cssProps,function(r,s){i=w(n.style,s),e?(t.oldCssProps[i]=n.style[i],n.style[i]=r):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}Kt.prototype={set:function(t){return s(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&Ft)&&(r=e.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],2===e.stopped||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(t),!r&&i.state&(Nt|Xt|Yt)&&(r=e.curRecognizer=i),s++}},get:function(t){if(t instanceof qt)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(f(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(f(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=P(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==r&&e!==r){var i=this.handlers;return v(b(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this}},off:function(t,e){if(t!==r){var i=this.handlers;return v(b(t),function(t){e?i[t]&&i[t].splice(P(i[t],e),1):delete i[t]}),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=i.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Qt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(Jt,{INPUT_START:Y,INPUT_MOVE:F,INPUT_END:W,INPUT_CANCEL:q,STATE_POSSIBLE:zt,STATE_BEGAN:Nt,STATE_CHANGED:Xt,STATE_ENDED:Yt,STATE_RECOGNIZED:Ft,STATE_CANCELLED:Wt,STATE_FAILED:32,DIRECTION_NONE:k,DIRECTION_LEFT:H,DIRECTION_RIGHT:L,DIRECTION_UP:U,DIRECTION_DOWN:V,DIRECTION_HORIZONTAL:j,DIRECTION_VERTICAL:G,DIRECTION_ALL:Z,Manager:Kt,Input:J,TouchAction:Mt,TouchInput:Et,MouseInput:ht,PointerEventInput:ft,TouchMouseInput:_t,SingleTouchInput:gt,Recognizer:qt,AttrRecognizer:Ut,Tap:$t,Pan:Vt,Swipe:Bt,Pinch:jt,Rotate:Zt,Press:Gt,on:A,off:_,each:v,merge:g,extend:m,assign:s,inherit:T,bindFn:y,prefixed:w}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Jt,"function"==typeof t&&t.amd?t(function(){return Jt}):"undefined"!=typeof module&&module.exports?module.exports=Jt:e.Hammer=Jt}(window,document);
},{}],"kXVE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.enhanceMouseInput=p,exports.enhancePointerEventInput=r;const e=1,t=2,n=4,o={mousedown:e,mousemove:t,mouseup:n};function s(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function r(e){const t=e.prototype.handler;e.prototype.handler=function(e){const n=this.store;e.button>0&&"pointerdown"===e.type&&(s(n,t=>t.pointerId===e.pointerId)||n.push(e)),t.call(this,e)}}function p(s){s.prototype.handler=function(s){let r=o[s.type];r&e&&s.button>=0&&(this.pressed=!0),r&t&&0===s.which&&(r=n),this.pressed&&(r&n&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[s],changedPointers:[s],pointerType:"mouse",srcEvent:s}))}}
},{}],"MW4S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Manager=void 0;var e=n(require("hammerjs")),t=require("./hammer-overrides");function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}function n(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var p=a?Object.getOwnPropertyDescriptor(e,u):null;p&&(p.get||p.set)?Object.defineProperty(o,u,p):o[u]=e[u]}return o.default=e,n&&n.set(e,o),o}(0,t.enhancePointerEventInput)(e.PointerEventInput),(0,t.enhanceMouseInput)(e.MouseInput);const o=e.Manager;exports.Manager=o;var a=e;exports.default=a;
},{"hammerjs":"K0KY","./hammer-overrides":"kXVE"}],"ZmL7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class e{constructor(e,t,s){this.element=e,this.callback=t,this.options={enable:!0,...s}}}exports.default=e;
},{}],"jCzK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RECOGNIZER_FALLBACK_MAP=exports.RECOGNIZER_COMPATIBLE_MAP=exports.RECOGNIZERS=exports.INPUT_EVENT_TYPES=exports.GESTURE_EVENT_ALIASES=exports.EVENT_RECOGNIZER_MAP=exports.BASIC_EVENT_ALIASES=void 0;var e=t(require("./utils/hammer"));function t(e){return e&&e.__esModule?e:{default:e}}const p=e.default?[[e.default.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[e.default.Rotate,{enable:!1}],[e.default.Pinch,{enable:!1}],[e.default.Swipe,{enable:!1}],[e.default.Pan,{threshold:0,enable:!1}],[e.default.Press,{enable:!1}],[e.default.Tap,{event:"doubletap",taps:2,enable:!1}],[e.default.Tap,{event:"anytap",enable:!1}],[e.default.Tap,{enable:!1}]]:null;exports.RECOGNIZERS=p;const n={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]};exports.RECOGNIZER_COMPATIBLE_MAP=n;const a={doubletap:["tap"]};exports.RECOGNIZER_FALLBACK_MAP=a;const o={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"};exports.BASIC_EVENT_ALIASES=o;const r={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]};exports.INPUT_EVENT_TYPES=r;const i={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"};exports.EVENT_RECOGNIZER_MAP=i;const s={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"};exports.GESTURE_EVENT_ALIASES=s;
},{"./utils/hammer":"MW4S"}],"b2B5":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.window=exports.userAgent=exports.passiveSupported=exports.global=exports.document=void 0;const t="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"";exports.userAgent=t;const o="undefined"!=typeof window?window:e;exports.window=o;const s=void 0!==e?e:window;exports.global=s;const n="undefined"!=typeof document?document:{};exports.document=n;let r=!1;exports.passiveSupported=r;try{const e={get passive(){return exports.passiveSupported=r=!0,!0}};o.addEventListener("test",null,e),o.removeEventListener("test",null)}catch(p){exports.passiveSupported=r=!1}
},{}],"k4W9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("./input")),t=require("../constants"),n=require("../utils/globals");function s(e){return e&&e.__esModule?e:{default:e}}const i=-1!==n.userAgent.indexOf("firefox"),{WHEEL_EVENTS:o}=t.INPUT_EVENT_TYPES,r="wheel",l=4.000244140625,a=40,d=.25;class E extends e.default{constructor(e,t,s){super(e,t,s),this.handleEvent=(e=>{if(!this.options.enable)return;let t=e.deltaY;n.window.WheelEvent&&(i&&e.deltaMode===n.window.WheelEvent.DOM_DELTA_PIXEL&&(t/=n.window.devicePixelRatio),e.deltaMode===n.window.WheelEvent.DOM_DELTA_LINE&&(t*=a)),0!==t&&t%l==0&&(t=Math.floor(t/l)),e.shiftKey&&t&&(t*=d),this.callback({type:r,center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})}),this.events=(this.options.events||[]).concat(o),this.events.forEach(t=>e.addEventListener(t,this.handleEvent,!!n.passiveSupported&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===r&&(this.options.enable=t)}}exports.default=E;
},{"./input":"ZmL7","../constants":"jCzK","../utils/globals":"b2B5"}],"N73Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("./input")),t=require("../constants");function n(e){return e&&e.__esModule?e:{default:e}}const{MOUSE_EVENTS:s}=t.INPUT_EVENT_TYPES,i="pointermove",v="pointerover",a="pointerout",h="pointerenter",r="pointerleave";class o extends e.default{constructor(e,t,n){super(e,t,n),this.handleEvent=(e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}),this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(s),this.events.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===i&&(this.enableMoveEvent=t),e===v&&(this.enableOverEvent=t),e===a&&(this.enableOutEvent=t),e===h&&(this.enableEnterEvent=t),e===r&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(v,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(a,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(h,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(r,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this._emit(i,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}exports.default=o;
},{"./input":"ZmL7","../constants":"jCzK"}],"PrTM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("./input")),t=require("../constants");function n(e){return e&&e.__esModule?e:{default:e}}const{KEY_EVENTS:s}=t.INPUT_EVENT_TYPES,a="keydown",i="keyup";class o extends e.default{constructor(e,t,n){super(e,t,n),this.handleEvent=(e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:a,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:i,srcEvent:e,key:e.key,target:e.target}))}),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(s),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===a&&(this.enableDownEvent=t),e===i&&(this.enableUpEvent=t)}}exports.default=o;
},{"./input":"ZmL7","../constants":"jCzK"}],"I4Fd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./input"));function t(e){return e&&e.__esModule?e:{default:e}}const n="contextmenu";class s extends e.default{constructor(e,t,s){super(e,t,s),this.handleEvent=(e=>{this.options.enable&&this.callback({type:n,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===n&&(this.options.enable=t)}}exports.default=s;
},{"./input":"ZmL7"}],"sn9i":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOffsetPosition=B,exports.whichButtons=d;const t=1,e=2,n=4,o={pointerdown:t,pointermove:e,pointerup:n,mousedown:t,mousemove:e,mouseup:n},i=1,r=2,s=3,u=0,c=1,f=2,l=1,p=2,h=4;function d(d){const B=o[d.srcEvent.type];if(!B)return null;const{buttons:m,button:g,which:v}=d.srcEvent;let w=!1,x=!1,a=!1;return B===n||B===e&&!Number.isFinite(m)?(w=v===i,x=v===r,a=v===s):B===e?(w=Boolean(m&l),x=Boolean(m&h),a=Boolean(m&p)):B===t&&(w=g===u,x=g===c,a=g===f),{leftButton:w,middleButton:x,rightButton:a}}function B(t,e){const n=t.center;if(!n)return null;const o=e.getBoundingClientRect(),i=o.width/e.offsetWidth||1,r=o.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-o.left-e.clientLeft)/i,y:(n.y-o.top-e.clientTop)/r}}}
},{}],"e1JC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./event-utils");const t={srcElement:"root",priority:0};class n{constructor(e){this.handleEvent=(e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")}),this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,s,r=!1,i=!1){const{handlers:l,handlersByElement:o}=this;let a=t;"string"==typeof s||s&&s.addEventListener?a={...t,srcElement:s}:s&&(a={...t,...s});let h=o.get(a.srcElement);h||(h=[],o.set(a.srcElement,h));const c={type:e,handler:n,srcElement:a.srcElement,priority:a.priority};r&&(c.once=!0),i&&(c.passive=!0),l.push(c),this._active=this._active||!c.passive;let p=h.length-1;for(;p>=0&&!(h[p].priority>=c.priority);)p--;h.splice(p+1,0,c)}remove(e,t){const{handlers:n,handlersByElement:s}=this;for(let r=n.length-1;r>=0;r--){const i=n[r];if(i.type===e&&i.handler===t){n.splice(r,1);const e=s.get(i.srcElement);e.splice(e.indexOf(i),1),0===e.length&&s.delete(i.srcElement)}}this._active=n.some(e=>!e.passive)}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const s=()=>{e.handled=!0},r=()=>{e.handled=!0,t=!0},i=[];for(let l=0;l<n.length;l++){const{type:o,handler:a,once:h}=n[l];if(a({...e,type:o,stopPropagation:s,stopImmediatePropagation:r}),h&&i.push(n[l]),t)break}for(let e=0;e<i.length;e++){const{type:t,handler:n}=i[e];this.remove(t,n)}}}_normalizeEvent(t){const n=this.eventManager.getElement();return{...t,...(0,e.whichButtons)(t),...(0,e.getOffsetPosition)(t,n),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}exports.default=n;
},{"./event-utils":"sn9i"}],"GjpX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./utils/hammer"),t=a(require("./inputs/wheel-input")),n=a(require("./inputs/move-input")),i=a(require("./inputs/key-input")),s=a(require("./inputs/contextmenu-input")),r=a(require("./utils/event-registrar")),o=require("./constants");function a(e){return e&&e.__esModule?e:{default:e}}const h={events:null,recognizers:null,recognizerOptions:{},Manager:e.Manager,touchAction:"none",tabIndex:0};class u{constructor(e=null,t){this._onBasicInput=(e=>{const{srcEvent:t}=e,n=o.BASIC_EVENT_ALIASES[t.type];n&&this.manager.emit(n,e)}),this._onOtherEvent=(e=>{this.manager.emit(e.type,e)}),this.options={...h,...t},this.events=new Map,this.setElement(e);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:r}=this,a=r.Manager;this.manager=new a(e,{touchAction:r.touchAction,recognizers:r.recognizers||o.RECOGNIZERS}).on("hammer.input",this._onBasicInput),r.recognizers||Object.keys(o.RECOGNIZER_COMPATIBLE_MAP).forEach(e=>{const t=this.manager.get(e);t&&o.RECOGNIZER_COMPATIBLE_MAP[e].forEach(e=>{t.recognizeWith(e)})});for(const t in r.recognizerOptions){const e=this.manager.get(t);if(e){const n=r.recognizerOptions[t];delete n.enable,e.set(n)}}this.wheelInput=new t.default(e,this._onOtherEvent,{enable:!1}),this.moveInput=new n.default(e,this._onOtherEvent,{enable:!1}),this.keyInput=new i.default(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new s.default(e,this._onOtherEvent,{enable:!1});for(const[t,n]of this.events)n.isEmpty()||(this._toggleRecognizer(n.recognizerName,!0),this.manager.on(t,n.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const i=n.get(e);if(i&&i.options.enable!==t){i.set({enable:t});const s=o.RECOGNIZER_FALLBACK_MAP[e];s&&!this.options.recognizers&&s.forEach(s=>{const r=n.get(s);t?(r.requireFailure(e),i.dropRequireFailure(s)):r.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,i,s){if("string"!=typeof e){n=t;for(const t in e)this._addEventHandler(t,e[t],n,i,s);return}const{manager:a,events:h}=this,u=o.GESTURE_EVENT_ALIASES[e]||e;let l=h.get(u);l||(l=new r.default(this),h.set(u,l),l.recognizerName=o.EVENT_RECOGNIZER_MAP[u]||u,a&&a.on(u,l.handleEvent)),l.add(e,t,n,i,s),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:n}=this,i=o.GESTURE_EVENT_ALIASES[e]||e,s=n.get(i);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:e}=s;let t=!1;for(const i of n.values())if(i.recognizerName===e&&!i.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}}exports.default=u;
},{"./utils/hammer":"MW4S","./inputs/wheel-input":"k4W9","./inputs/move-input":"N73Z","./inputs/key-input":"PrTM","./inputs/contextmenu-input":"I4Fd","./utils/event-registrar":"e1JC","./constants":"jCzK"}],"sV3P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"EventManager",{enumerable:!0,get:function(){return e.default}});var e=r(require("./event-manager"));function r(e){return e&&e.__esModule?e:{default:e}}
},{"./event-manager":"GjpX"}],"ruUO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=m(require("@babel/runtime/helpers/esm/defineProperty")),t=m(require("./layer-manager")),i=m(require("./view-manager")),s=m(require("../views/map-view")),r=m(require("./effect-manager")),a=m(require("./deck-renderer")),n=m(require("./deck-picker")),o=m(require("./tooltip")),l=m(require("../utils/log")),h=require("../utils/deep-equal"),c=m(require("../utils/typed-array-manager")),u=require("./init"),p=require("@probe.gl/env"),d=require("@luma.gl/core"),g=require("@probe.gl/stats"),f=require("mjolnir.js"),v=m(require("../utils/assert")),w=require("./constants");function m(e){return e&&e.__esModule?e:{default:e}}function y(){}const M=({isDragging:e})=>e?"grabbing":"grab",_={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:y,onResize:y,onViewStateChange:y,onInteractionStateChange:y,onBeforeRender:y,onAfterRender:y,onLoad:y,onError:e=>l.default.error(e.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:M,getTooltip:null,debug:!1,drawPickingColors:!1};class k{constructor(t){(0,e.default)(this,"props",void 0),(0,e.default)(this,"width",0),(0,e.default)(this,"height",0),(0,e.default)(this,"userData",{}),(0,e.default)(this,"canvas",null),(0,e.default)(this,"viewManager",null),(0,e.default)(this,"layerManager",null),(0,e.default)(this,"effectManager",null),(0,e.default)(this,"deckRenderer",null),(0,e.default)(this,"deckPicker",null),(0,e.default)(this,"eventManager",null),(0,e.default)(this,"tooltip",null),(0,e.default)(this,"metrics",void 0),(0,e.default)(this,"animationLoop",void 0),(0,e.default)(this,"stats",void 0),(0,e.default)(this,"viewState",void 0),(0,e.default)(this,"cursorState",void 0),(0,e.default)(this,"_needsRedraw",void 0),(0,e.default)(this,"_pickRequest",void 0),(0,e.default)(this,"_lastPointerDownInfo",null),(0,e.default)(this,"_metricsCounter",void 0),(0,e.default)(this,"_onPointerMove",e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e}),(0,e.default)(this,"_onEvent",e=>{const t=w.EVENTS[e.type],i=e.offsetCenter;if(!t||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=r,n=a&&(a[t.handler]||a.props[t.handler]),o=this.props[t.handler];let l=!1;n&&(l=n.call(a,r,e)),!l&&o&&o(r,e)}),(0,e.default)(this,"_onPointerDown",e=>{const t=e.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={..._,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&l.default.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,p.getBrowser)()&&l.default.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new g.Stats({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&c.default.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,i,s,r,a,n,o;(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(t=this.viewManager)||void 0===t||t.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(s=this.deckRenderer)||void 0===s||s.finalize(),this.deckRenderer=null,null===(r=this.deckPicker)||void 0===r||r.finalize(),this.deckPicker=null,null===(a=this.eventManager)||void 0===a||a.destroy(),this.eventManager=null,null===(n=this.tooltip)||void 0===n||n.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas)||(null===(o=this.canvas.parentElement)||void 0===o||o.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&l.default.removed("onLayerHover","onHover")(),"onLayerClick"in e&&l.default.removed("onLayerClick","onClick")(),e.initialViewState&&!(0,h.deepEqual)(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),s=this.layerManager.needsRedraw(e),r=this.effectManager.needsRedraw(e),a=this.deckRenderer.needsRedraw(e);return t=t||i||s||r||a}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});(t=e||t)&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return(0,v.default)(this.viewManager),this.viewManager.views}getViewports(e){return(0,v.default)(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,t,i){(0,v.default)(this.deckPicker);const{stats:s}=this;s.get("Pick Count").incrementCount(),s.get(t).timeStart();const r=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return s.get(t).timeEnd(),r}_createCanvas(e){let t=e.canvas;if("string"==typeof t&&(t=document.getElementById(t),(0,v.default)(t)),!t){(t=document.createElement("canvas")).id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:i}=e;if(t||0===t){const e=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=e}if(i||0===i){var s;const t=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=(null===(s=e.style)||void 0===s?void 0:s.position)||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;var s;t===this.width&&i===this.height||(this.width=t,this.height=i,null===(s=this.viewManager)||void 0===s||s.setProps({width:t,height:i}),this.props.onResize({width:t,height:i}))}_createAnimationLoop(e){const{width:t,height:i,gl:s,glOptions:r,debug:a,onError:n,onBeforeRender:o,onAfterRender:l,useDevicePixels:h}=e;return new d.AnimationLoop({width:t,height:i,useDevicePixels:h,autoResizeViewport:!1,gl:s,onCreateContext:e=>(0,d.createGLContext)({...r,...e,canvas:this.canvas,debug:a,onContextLost:()=>this._onContextLost()}),onInitialize:e=>this._setGLContext(e.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:o,onAfterRender:l,onError:n})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new s.default({id:"default-view"})];return(e=Array.isArray(e)?e:[e]).length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:s}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let r=s,a=!1;for(const n of i){var t;r=n,a=(null===(t=n.layer)||void 0===t?void 0:t.onHover(n,e.event))||a}if(!a&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip&&this.tooltip){const e=this.props.getTooltip(r);this.tooltip.setTooltip(e,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,(0,d.instrumentGLContext)(e,{enable:!0,copyState:!0})),this.tooltip=new o.default(this.canvas),(0,d.setParameters)(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const s=new d.Timeline;s.play(),this.animationLoop.attachTimeline(s),this.eventManager=new f.EventManager(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in w.EVENTS)this.eventManager.on(t,this._onEvent);this.viewManager=new i.default({timeline:s,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const l=this.viewManager.getViewports()[0];this.layerManager=new t.default(e,{deck:this,stats:this.stats,viewport:l,timeline:s}),this.effectManager=new r.default,this.deckRenderer=new a.default(e),this.deckPicker=new n.default(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;(0,d.setParameters)(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),l.default.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=d.lumaStats.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}exports.default=k,(0,e.default)(k,"defaultProps",_),(0,e.default)(k,"VERSION",u.VERSION);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./layer-manager":"m8xf","./view-manager":"H2B6","../views/map-view":"wDMu","./effect-manager":"sqcc","./deck-renderer":"J3c9","./deck-picker":"G03o","./tooltip":"Dm3R","../utils/log":"GVus","../utils/deep-equal":"KSag","../utils/typed-array-manager":"yeLJ","./init":"N6pv","@probe.gl/env":"Ps6r","@luma.gl/core":"iuAK","@probe.gl/stats":"SZdt","mjolnir.js":"sV3P","../utils/assert":"Txat","./constants":"ysbg"}],"CFZ8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("@babel/runtime/helpers/esm/defineProperty"));function t(e){return e&&e.__esModule?e:{default:e}}class s{constructor(t,s){(0,e.default)(this,"opts",void 0),(0,e.default)(this,"source",void 0),this.opts=s,this.source=t}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:s}=this.source,{size:r}=t;let o=s;if(s&&s.length!==r){o=new Float32Array(r);const e=t.elementOffset||0;for(let t=0;t<r;++t)o[t]=s[e+t]}return o}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}exports.default=s;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"SsHL":[function(require,module,exports) {
"use strict";function r(r){switch(r){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.glArrayFromType=r;
},{}],"WlAL":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@luma.gl/core"),s=u(require("./shader-attribute")),r=require("./gl-utils"),i=u(require("../../utils/typed-array-manager")),n=require("../../utils/math-utils"),a=u(require("../../utils/log"));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){return e.stride||e.size*e.bytesPerElement}function f(e,t){t.offset&&a.default.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const s=l(e),r=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*s+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return{...t,offset:r,stride:s}}function o(e,t){const s=f(e,t);return{high:s,low:{...s,offset:s.offset+4*e.size}}}class c{constructor(s,i,n){(0,e.default)(this,"gl",void 0),(0,e.default)(this,"id",void 0),(0,e.default)(this,"size",void 0),(0,e.default)(this,"settings",void 0),(0,e.default)(this,"value",void 0),(0,e.default)(this,"doublePrecision",void 0),(0,e.default)(this,"_buffer",void 0),(0,e.default)(this,"state",void 0),this.gl=s,this.id=i.id||"",this.size=i.size||1;const a=i.logicalType||i.type,u=5130===a;let l,{defaultValue:f}=i;f=Number.isFinite(f)?[f]:f||new Array(this.size).fill(0),l=u?5126:!a&&i.isIndexed?s&&(0,t.hasFeature)(s,t.FEATURES.ELEMENT_INDEX_UINT32)?5125:5123:a||5126;let o=(0,r.glArrayFromType)(a||l||5126);this.doublePrecision=u,u&&!1===i.fp64&&(o=Float32Array),this.value=null,this.settings={...i,defaultType:o,defaultValue:f,logicalType:a,type:l,size:this.size,bytesPerElement:o.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:s}=this.settings;this._buffer=new t.Buffer(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:s}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*l(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),i.default.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,n=o(this.getAccessor(),t||{});return r[e]=new s.default(this,n.high),r["".concat(e,"64Low")]=i?new s.default(this,n.low):new Float32Array(this.size),r}if(t){const r=f(this.getAccessor(),t);return{[e]:new s.default(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:s,size:r}=this,i=s*r;if(t&&i&&t.length>=i){const s=new Array(r).fill(1/0),n=new Array(r).fill(-1/0);for(let e=0;e<i;)for(let i=0;i<r;i++){const r=t[e++];r<s[i]&&(s[i]=r),r>n[i]&&(n[i]=r)}e=[s,n]}}return this.state.bounds=e,e}setData(e){const{state:s}=this;let r;r=ArrayBuffer.isView(e)?{value:e}:e instanceof t.Buffer?{buffer:e}:e;const i={...this.settings,...r};if(s.bufferAccessor=i,s.bounds=null,r.constant){let e=r.value;if(e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e)),!(!s.constant||!this._areValuesEqual(e,this.value)))return!1;s.externalBuffer=null,s.constant=!0,this.value=e}else if(r.buffer){const e=r.buffer;s.externalBuffer=e,s.constant=!1,this.value=r.value||null;const t=r.value instanceof Float64Array;i.type=r.type||e.accessor.type,i.bytesPerElement=e.accessor.BYTES_PER_ELEMENT*(t?2:1),i.stride=l(i)}else if(r.value){this._checkExternalBuffer(r);let e=r.value;s.externalBuffer=null,s.constant=!1,this.value=e,i.bytesPerElement=e.BYTES_PER_ELEMENT,i.stride=l(i);const{buffer:t,byteOffset:a}=this;this.doublePrecision&&e instanceof Float64Array&&(e=(0,n.toDoublePrecisionArray)(e,i));const u=e.byteLength+a+2*i.stride;t.byteLength<u&&t.reallocate(u),t.setAccessor(null),t.subData({data:e,offset:a}),i.type=r.type||t.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:s=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?(0,n.toDoublePrecisionArray)(t,{size:this.size,startIndex:s,endIndex:r}):t.subarray(s,r),offset:s*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,t=!1){const{state:s}=this,r=s.allocatedValue,a=i.default.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=a;const{buffer:u,byteOffset:l}=this;return u.byteLength<a.byteLength+l&&(u.reallocate(a.byteLength+l),t&&r&&u.subData({data:r instanceof Float64Array?(0,n.toDoublePrecisionArray)(r,this):r,offset:l})),s.allocatedValue=a,s.constant=!1,s.externalBuffer=null,s.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const s=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof s||!this.settings.normalized||"normalized"in e||a.default.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(e=>(e+128)/255*2-1);case 5122:return new Float32Array(e).map(e=>(e+32768)/65535*2-1);case 5121:return new Float32Array(e).map(e=>e/255);case 5123:return new Float32Array(e).map(e=>e/65535);default:return e}}_normalizeValue(e,t,s){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(e))return t[s]=e,t;if(!e){let e=i;for(;--e>=0;)t[s+e]=r[e];return t}switch(i){case 4:t[s+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[s+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[s+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[s+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let n=i;for(;--n>=0;)t[s+n]=Number.isFinite(e[n])?e[n]:r[n]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:s}=this;for(let r=0;r<s;r++)if(e[r]!==t[r])return!1;return!0}}exports.default=c;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","./shader-attribute":"CFZ8","./gl-utils":"SsHL","../../utils/typed-array-manager":"yeLJ","../../utils/math-utils":"ki6G","../../utils/log":"GVus"}],"kai7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createIterable=r,exports.getAccessorFromBuffer=o,exports.isAsyncIterable=n;const e=[],t=[];function r(r,n=0,o=1/0){let s=e;const c={index:-1,data:r,target:[]};return r?"function"==typeof r[Symbol.iterator]?s=r:r.length>0&&(t.length=r.length,s=t):s=e,(n>0||Number.isFinite(o))&&(s=(Array.isArray(s)?s:Array.from(s)).slice(n,o),c.index=n-1),{iterable:s,objectInfo:c}}function n(e){return e&&e[Symbol.asyncIterator]}function o(e,t){const{size:r,stride:n,offset:o,startIndices:s,nested:c}=t,i=e.BYTES_PER_ELEMENT,l=n?n/i:r,a=o?o/i:0,f=Math.floor((e.length-a)/l);return(t,{index:n,target:o})=>{if(!s){const t=n*l+a;for(let n=0;n<r;n++)o[n]=e[t+n];return o}const i=s[n],u=s[n+1]||f;let y;if(c){y=new Array(u-i);for(let t=i;t<u;t++){const n=t*l+a;o=new Array(r);for(let t=0;t<r;t++)o[t]=e[n+t];y[t-i]=o}}else if(l===r)y=e.subarray(i*r+a,u*r+a);else{y=new e.constructor((u-i)*r);let t=0;for(let n=i;n<u;n++){const o=n*l+a;for(let n=0;n<r;n++)y[t++]=e[o+n]}}return y}}
},{}],"UFya":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FULL=exports.EMPTY=void 0,exports.add=r;const t=[];exports.EMPTY=t;const e=[[0,1/0]];function r(t,r){if(t===e)return t;if(r[0]<0&&(r[0]=0),r[0]>=r[1])return t;const s=[],o=t.length;let n=0;for(let e=0;e<o;e++){const o=t[e];o[1]<r[0]?(s.push(o),n=e+1):o[0]>r[1]?s.push(o):r=[Math.min(o[0],r[0]),Math.max(o[1],r[1])]}return s.splice(n,0,r),s}exports.FULL=e;
},{}],"LUSB":[function(require,module,exports) {
"use strict";function t(t){const{source:e,target:r,start:a=0,size:s,getData:n}=t,o=t.end||r.length,i=e.length,u=o-a;if(i>u)return void r.set(e.subarray(0,u),a);if(r.set(e,a),!n)return;let c=i;for(;c<u;){const t=n(c,e);for(let e=0;e<s;e++)r[a+c]=t[e]||0,c++}}function e({source:e,target:r,size:a,getData:s,sourceStartIndices:n,targetStartIndices:o}){if(!Array.isArray(o))return t({source:e,target:r,size:a,getData:s}),r;let i=0,u=0;const c=s&&((t,e)=>s(t+u,e)),g=Math.min(n.length,o.length);for(let l=1;l<g;l++){const s=n[l]*a,g=o[l]*a;t({source:e.subarray(i,s),target:r,start:u,end:g,size:a,getData:c}),i=s,u=g}return u<r.length&&t({source:[],target:r,start:u,size:a,getData:c}),r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.padArray=e;
},{}],"pb8L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cycleBuffers=i,exports.getAttributeBufferLength=a,exports.getAttributeTypeFromSize=s,exports.getSourceBufferAttribute=n,exports.normalizeTransitionSettings=r,exports.padBuffer=o;var t=require("../../utils/array-utils");const e={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function r(t,r){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...e[n],...r,...t,type:n}}function n(t,e){const r=e.getBuffer();return r?[r,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function s(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function i(t){t.push(t.shift())}function a(t,e){const{doublePrecision:r,settings:n,value:s,size:i}=t,a=r&&s instanceof Float64Array?2:1;return(n.noAlloc?s.length:e*i)*a}function o({buffer:e,numInstances:r,attribute:n,fromLength:s,fromStartIndices:i,getData:o=(t=>t)}){const u=n.doublePrecision&&n.value instanceof Float64Array?2:1,c=n.size*u,f=n.byteOffset,l=n.startIndices,g=i&&l,d=a(n,r),p=n.isConstant;if(!g&&s>=d)return;const y=p?n.value:n.getBuffer().getData({srcByteOffset:f});if(n.settings.normalized&&!p){const t=o;o=((e,r)=>n.normalizeConstant(t(e,r)))}const b=p?(t,e)=>o(y,e):(t,e)=>o(y.subarray(t,t+c),e),z=e.getData({length:s}),h=new Float32Array(d);(0,t.padArray)({source:z,target:h,sourceStartIndices:i,targetStartIndices:l,size:c,getData:b}),e.byteLength<h.byteLength+f&&e.reallocate(h.byteLength+f),e.subData({data:h,offset:f})}
},{"../../utils/array-utils":"LUSB"}],"btRH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=l(require("@babel/runtime/helpers/esm/defineProperty")),e=l(require("./data-column")),s=l(require("../../utils/assert")),r=require("../../utils/iterable-utils"),a=require("../../utils/flatten"),i=o(require("../../utils/range")),n=require("./attribute-transition-utils");function u(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,s=new WeakMap;return(u=function(t){return t?s:e})(t)}function o(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=u(e);if(s&&s.has(t))return s.get(t);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var n=a?Object.getOwnPropertyDescriptor(t,i):null;n&&(n.get||n.set)?Object.defineProperty(r,i,n):r[i]=t[i]}return r.default=t,s&&s.set(t,r),r}function l(t){return t&&t.__esModule?t:{default:t}}class c extends e.default{constructor(e,s){super(e,s,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:i.FULL}),(0,t.default)(this,"constant",!1),this.settings.update=s.update||(s.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,s=this.settings.transition,r=Array.isArray(e)?t[e.find(e=>t[e])]:t[e];return(0,n.normalizeTransitionSettings)(r,s)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:s=1/0}=e;this.state.updateRanges=i.add(this.state.updateRanges,[t,s])}else this.state.updateRanges=i.FULL}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=i.EMPTY}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:s}=this;return!s.noAlloc&&(!!s.update&&(super.allocate(t,e.updateRanges!==i.FULL),!0))}updateBuffer({numInstances:t,data:e,props:s,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:i,noAlloc:n}}=this;let u=!0;if(i){for(const[n,u]of a)i.call(r,this,{data:e,startRow:n,endRow:u,props:s,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,s]of a){const r=Number.isFinite(e)?this.getVertexOffset(e):0,a=Number.isFinite(s)?this.getVertexOffset(s):n||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:a})}else;this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(t){if(void 0===t||"function"==typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t),!0)):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:a,settings:i}=this;if(!t)return a.binaryValue=null,a.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(a.binaryValue===t)return this.clearNeedsUpdate(),!0;if(a.binaryValue=t,this.setNeedsRedraw(),i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const n=t;(0,s.default)(ArrayBuffer.isView(n.value),"invalid ".concat(i.accessor));const u=Boolean(n.size)&&n.size!==this.size;return a.binaryAccessor=(0,r.getAccessorFromBuffer)(n.value,{size:n.size||this.size,stride:n.stride,offset:n.offset,startIndices:e,nested:u}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const s in t)Object.assign(e,super.getShaderAttributes(s,t[s]));return e}_autoUpdater(t,{data:e,startRow:i,endRow:n,props:u,numInstances:o}){if(t.constant)return;const{settings:l,state:c,value:d,size:f,startIndices:h}=t,{accessor:p,transform:g}=l,b=c.binaryAccessor||("function"==typeof p?p:u[p]);(0,s.default)("function"==typeof b,'accessor "'.concat(p,'" is not a function'));let y=t.getVertexOffset(i);const{iterable:w,objectInfo:A}=(0,r.createIterable)(e,i,n);for(const s of w){A.index++;let e=b(s,A);if(g&&(e=g.call(this,e)),h){const s=(A.index<h.length-1?h[A.index+1]:o)-h[A.index];if(e&&Array.isArray(e[0])){let s=y;for(const r of e)t._normalizeValue(r,d,s),s+=f}else e&&e.length>f?d.set(e,y):(t._normalizeValue(e,A.target,0),(0,a.fillArray)({target:d,source:A.target,start:y,count:s}));y+=s*f}else t._normalizeValue(e,d,y),y+=f}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"==typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let s=!0;switch(e){case 4:s=s&&Number.isFinite(t[3]);case 3:s=s&&Number.isFinite(t[2]);case 2:s=s&&Number.isFinite(t[1]);case 1:s=s&&Number.isFinite(t[0]);break;default:s=!1}if(!s)throw new Error("Illegal attribute generated for ".concat(this.id))}}}exports.default=c;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./data-column":"WlAL","../../utils/assert":"Txat","../../utils/iterable-utils":"kai7","../../utils/flatten":"gSVO","../../utils/range":"UFya","./attribute-transition-utils":"pb8L"}],"cHcD":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@luma.gl/core"),r=s(require("../lib/attribute/attribute")),i=require("../lib/attribute/attribute-transition-utils"),n=s(require("./transition"));function s(t){return t&&t.__esModule?t:{default:t}}class a{constructor({gl:i,attribute:s,timeline:a}){(0,t.default)(this,"gl",void 0),(0,t.default)(this,"type","interpolation"),(0,t.default)(this,"attributeInTransition",void 0),(0,t.default)(this,"settings",void 0),(0,t.default)(this,"attribute",void 0),(0,t.default)(this,"transition",void 0),(0,t.default)(this,"currentStartIndices",void 0),(0,t.default)(this,"currentLength",void 0),(0,t.default)(this,"transform",void 0),(0,t.default)(this,"buffers",void 0),this.gl=i,this.transition=new n.default(a),this.attribute=s,this.attributeInTransition=new r.default(i,s.settings),this.currentStartIndices=s.startIndices,this.currentLength=0,this.transform=o(i,s);const u={byteLength:0,usage:35050};this.buffers=[new e.Buffer(i,u),new e.Buffer(i,u)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:r,buffers:n,attribute:s}=this;(0,i.cycleBuffers)(n);const a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const u of n)(0,i.padBuffer)({buffer:u,...a});this.currentStartIndices=s.startIndices,this.currentLength=(0,i.getAttributeBufferLength)(s,e),this.attributeInTransition.setData({buffer:n[1],value:s.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:n[0],aTo:(0,i.getSourceBufferAttribute)(r,s)},feedbackBuffers:{vCurrent:n[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:r}=this.transition;let i=r/t;e&&(i=e(i)),this.transform.run({uniforms:{time:i}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}}exports.default=a;const u="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";function o(t,r){const n=(0,i.getAttributeTypeFromSize)(r.size);return new e.Transform(t,{vs:u,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","../lib/attribute/attribute":"btRH","../lib/attribute/attribute-transition-utils":"pb8L","./transition":"yDoV"}],"YGNu":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@luma.gl/core"),r=require("../lib/attribute/attribute-transition-utils"),i=s(require("../lib/attribute/attribute")),n=s(require("./transition"));function s(t){return t&&t.__esModule?t:{default:t}}class a{constructor({gl:r,attribute:s,timeline:a}){(0,t.default)(this,"gl",void 0),(0,t.default)(this,"type","spring"),(0,t.default)(this,"attributeInTransition",void 0),(0,t.default)(this,"settings",void 0),(0,t.default)(this,"attribute",void 0),(0,t.default)(this,"transition",void 0),(0,t.default)(this,"currentStartIndices",void 0),(0,t.default)(this,"currentLength",void 0),(0,t.default)(this,"texture",void 0),(0,t.default)(this,"framebuffer",void 0),(0,t.default)(this,"transform",void 0),(0,t.default)(this,"buffers",void 0),this.gl=r,this.type="spring",this.transition=new n.default(a),this.attribute=s,this.attributeInTransition=new i.default(r,{...s.settings,normalized:!1}),this.currentStartIndices=s.startIndices,this.currentLength=0,this.texture=f(r),this.framebuffer=o(r,this.texture),this.transform=u(r,s,this.framebuffer);const d={byteLength:0,usage:35050};this.buffers=[new e.Buffer(r,d),new e.Buffer(r,d),new e.Buffer(r,d)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:i,buffers:n,attribute:s}=this,a={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const u of n)(0,r.padBuffer)({buffer:u,...a});this.settings=t,this.currentStartIndices=s.startIndices,this.currentLength=(0,r.getAttributeBufferLength)(s,e),this.attributeInTransition.setData({buffer:n[1],value:s.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:(0,r.getSourceBufferAttribute)(i,s)}})}update(){const{buffers:t,transform:i,framebuffer:n,transition:s}=this;if(!s.update())return!1;const a=this.settings;return i.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),i.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:a.stiffness,damping:a.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),(0,r.cycleBuffers)(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),(0,e.readPixelsToArray)(n)[0]>0||s.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function u(t,i,n){const s=(0,r.getAttributeTypeFromSize)(i.size);return new e.Transform(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:s},varyings:["vNext"]})}function f(t){return new e.Texture2D(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function o(t,r){return new e.Framebuffer(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:r}})}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","../lib/attribute/attribute-transition-utils":"pb8L","../lib/attribute/attribute":"btRH","./transition":"yDoV"}],"Llox":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("@babel/runtime/helpers/esm/defineProperty")),i=require("@luma.gl/core"),s=r(require("../../transitions/gpu-interpolation-transition")),e=r(require("../../transitions/gpu-spring-transition")),n=r(require("../../utils/log"));function r(t){return t&&t.__esModule?t:{default:t}}const o={interpolation:s.default,spring:e.default};class a{constructor(s,{id:e,timeline:n}){(0,t.default)(this,"id",void 0),(0,t.default)(this,"isSupported",void 0),(0,t.default)(this,"gl",void 0),(0,t.default)(this,"timeline",void 0),(0,t.default)(this,"transitions",void 0),(0,t.default)(this,"needsRedraw",void 0),(0,t.default)(this,"numInstances",void 0),this.id=e,this.gl=s,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=i.Transform.isSupported(s)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:i,numInstances:s}){this.numInstances=s||1;for(const e in t){const s=t[e],n=s.getTransitionSetting(i);n&&this._updateAttribute(e,s,n)}for(const e in this.transitions){const s=t[e];s&&s.getTransitionSetting(i)||this._removeTransition(e)}}hasAttribute(t){const i=this.transitions[t];return i&&i.inProgress}getAttributes(){const t={};for(const i in this.transitions){const s=this.transitions[i];s.inProgress&&(t[i]=s.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const i in this.transitions){this.transitions[i].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,i,s){const e=this.transitions[t];let r=!e||e.type!==s.type;if(r){if(!this.isSupported)return void n.default.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();e&&this._removeTransition(t);const a=o[s.type];a?this.transitions[t]=new a({attribute:i,timeline:this.timeline,gl:this.gl}):(n.default.error("unsupported transition type '".concat(s.type,"'"))(),r=!1)}(r||i.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(s,this.numInstances))}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","../../transitions/gpu-interpolation-transition":"cHcD","../../transitions/gpu-spring-transition":"YGNu","../../utils/log":"GVus"}],"wT56":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=d(require("@babel/runtime/helpers/esm/defineProperty")),e=d(require("./attribute")),s=d(require("../../utils/log")),i=d(require("../../utils/memoize")),a=require("../../utils/math-utils"),r=d(require("../../debug")),n=d(require("./attribute-transition-manager"));function d(t){return t&&t.__esModule?t:{default:t}}const u="attributeManager.invalidate",o="attributeManager.updateStart",h="attributeManager.updateEnd",l="attribute.updateStart",c="attribute.allocate",b="attribute.updateEnd";class g{constructor(e,{id:s="attribute-manager",stats:r,timeline:d}={}){(0,t.default)(this,"id",void 0),(0,t.default)(this,"gl",void 0),(0,t.default)(this,"attributes",void 0),(0,t.default)(this,"updateTriggers",void 0),(0,t.default)(this,"needsRedraw",void 0),(0,t.default)(this,"userData",void 0),(0,t.default)(this,"stats",void 0),(0,t.default)(this,"attributeTransitionManager",void 0),(0,t.default)(this,"mergeBoundsMemoized",(0,i.default)(a.mergeBounds)),this.id=s,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new n.default(e,{id:"".concat(s,"-transitions"),timeline:d}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const s=this._invalidateTrigger(t,e);(0,r.default)(u,this,t,s)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,r.default)(u,this,"all")}update({data:t,numInstances:e,startIndices:i=null,transitions:a,props:n={},buffers:d={},context:u={}}){let l=!1;(0,r.default)(o,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const r in this.attributes){const a=this.attributes[r],o=a.settings.accessor;a.startIndices=i,a.numInstances=e,n[r]&&s.default.removed("props.".concat(r),"data.attributes.".concat(r))(),a.setExternalBuffer(d[r])||a.setBinaryValue("string"==typeof o?d[o]:void 0,t.startIndices)||"string"==typeof o&&!d[o]&&a.setConstantValue(n[o])||a.needsUpdate()&&(l=!0,this._updateAttribute({attribute:a,numInstances:e,data:t,props:n,context:u})),this.needsRedraw=this.needsRedraw||a.needsRedraw()}l&&(0,r.default)(h,this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:a})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map(t=>{var e;return null===(e=this.attributes[t])||void 0===e?void 0:e.getBounds()});return this.mergeBoundsMemoized(e)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:s}=this,i={...s.getAttributes()};for(const a in e){const r=e[a];r.needsRedraw(t)&&!s.hasAttribute(a)&&(i[a]=r)}return i}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const s={};for(const i in t)e[i]||Object.assign(s,t[i].getShaderAttributes());return s}_add(t,e={}){for(const s in t){const i=t[s];this.attributes[s]=this._createAttribute(s,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,s,i){const a={...s,id:t,size:(s.isIndexed?1:s.size)||1,divisor:i.instanced?1:s.divisor||0};return new e.default(this.gl,a)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach(s=>{t[s]||(t[s]=[]),t[s].push(e)})}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:s,updateTriggers:i}=this,a=i[t];return a&&a.forEach(t=>{const i=s[t];i&&i.setNeedsUpdate(i.id,e)}),a}_updateAttribute(t){const{attribute:e,numInstances:s}=t;(0,r.default)(l,e),e.constant?e.setConstantValue(e.value):(e.allocate(s)&&(0,r.default)(c,e,s),e.updateBuffer(t)&&(this.needsRedraw=!0,(0,r.default)(b,e,s)))}}exports.default=g;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./attribute":"btRH","../../utils/log":"GVus","../../utils/memoize":"uXG5","../../utils/math-utils":"ki6G","../../debug":"EEoF","./attribute-transition-manager":"Llox"}],"YhSP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@math.gl/core"),t=r(require("./transition"));function r(e){return e&&e.__esModule?e:{default:e}}class u extends t.default{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:r,toValue:u,duration:s,easing:a}}=this,i=a(t/s);this._value=(0,e.lerp)(r,u,i)}}exports.default=u;
},{"@math.gl/core":"dwLx","./transition":"yDoV"}],"juRJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./transition"));function e(t){return t&&t.__esModule?t:{default:t}}const r=1e-5;function n(t,e,r,n,s){const u=e-t;return(r-e)*s+-u*n+u+e}function s(t,e,r,s,u){if(Array.isArray(r)){const a=[];for(let i=0;i<r.length;i++)a[i]=n(t[i],e[i],r[i],s,u);return a}return n(t,e,r,s,u)}function u(t,e){if(Array.isArray(t)){let r=0;for(let n=0;n<t.length;n++){const s=t[n]-e[n];r+=s*s}return Math.sqrt(r)}return Math.abs(t-e)}class a extends t.default{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:a}=this.settings,{_prevValue:i=t,_currValue:o=t}=this;let l=s(i,o,e,n,a);const c=u(l,e),f=u(l,o);c<r&&f<r&&(l=e,this.end()),this._prevValue=o,this._currValue=l}}exports.default=a;
},{"./transition":"yDoV"}],"f2Ln":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("./attribute/attribute-transition-utils"),e=r(require("../transitions/cpu-interpolation-transition")),i=r(require("../transitions/cpu-spring-transition")),s=r(require("../utils/log"));function r(t){return t&&t.__esModule?t:{default:t}}const n={interpolation:e.default,spring:i.default};class o{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(e,i,r,o){const{transitions:a}=this;if(a.has(e)){const t=a.get(e),{value:s=t.settings.fromValue}=t;i=s,this.remove(e)}if(!(o=(0,t.normalizeTransitionSettings)(o)))return;const u=n[o.type];if(!u)return void s.default.error("unsupported transition type '".concat(o.type,"'"))();const l=new u(this.timeline);l.start({...o,fromValue:i,toValue:r}),a.set(e,l)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,i]of this.transitions)i.update(),t[e]=i.value,i.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}exports.default=o;
},{"./attribute/attribute-transition-utils":"pb8L","../transitions/cpu-interpolation-transition":"YhSP","../transitions/cpu-spring-transition":"juRJ","../utils/log":"GVus"}],"UiIs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.compareProps=o,exports.diffProps=e,exports.validateProps=t;var n=require("./constants");function t(t){const e=t[n.PROP_TYPES_SYMBOL];for(const n in e){const r=e[n],{validate:o}=r;if(o&&!o(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function e(t,e){const a=o({newProps:t,oldProps:e,propTypes:t[n.PROP_TYPES_SYMBOL],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),s=l(t,e);let u=!1;return s||(u=i(t,e)),{dataChanged:s,propsChanged:a,updateTriggersChanged:u,extensionsChanged:c(t,e),transitionsChanged:r(t,e)}}function r(t,e){if(!t.transitions)return!1;const r={},o=t[n.PROP_TYPES_SYMBOL];let l=!1;for(const n in t.transitions){const i=o[n],c=i&&i.type;("number"===c||"color"===c||"array"===c)&&a(t[n],e[n],i)&&(r[n]=!0,l=!0)}return!!l&&r}function o({newProps:n,oldProps:t,ignoreProps:e={},propTypes:r={},triggerName:o="props"}){if(t===n)return!1;if("object"!=typeof n||null===n)return"".concat(o," changed shallowly");if("object"!=typeof t||null===t)return"".concat(o," changed shallowly");for(const l of Object.keys(n))if(!(l in e)){if(!(l in t))return"".concat(o,".").concat(l," added");const e=a(n[l],t[l],r[l]);if(e)return"".concat(o,".").concat(l," ").concat(e)}for(const l of Object.keys(t))if(!(l in e)){if(!(l in n))return"".concat(o,".").concat(l," dropped");if(!Object.hasOwnProperty.call(n,l)){const e=a(n[l],t[l],r[l]);if(e)return"".concat(o,".").concat(l," ").concat(e)}}return!1}function a(n,t,e){let r=e&&e.equal;return r&&!r(n,t,e)?"changed deeply":r||!(r=n&&t&&n.equals)||r.call(n,t)?r||t===n?null:"changed shallowly":"changed deeply"}function l(n,t){if(null===t)return"oldProps is null, initial diff";let e=!1;const{dataComparator:r,_dataDiff:o}=n;return r?r(n.data,t.data)||(e="Data comparator detected a change"):n.data!==t.data&&(e="A new data container was supplied"),e&&o&&(e=o(n.data,t.data)||e),e}function i(n,t){if(null===t)return{all:!0};if("all"in n.updateTriggers){if(s(n,t,"all"))return{all:!0}}const e={};let r=!1;for(const o in n.updateTriggers)if("all"!==o){s(n,t,o)&&(e[o]=!0,r=!0)}return!!r&&e}function c(n,t){if(null===t)return!0;const e=t.extensions,{extensions:r}=n;if(r===e)return!1;if(!e||!r)return!0;if(r.length!==e.length)return!0;for(let o=0;o<r.length;o++)if(!r[o].equals(e[o]))return!0;return!1}function s(n,t,e){let r=n.updateTriggers[e];r=null==r?{}:r;let a=t.updateTriggers[e];return o({oldProps:a=null==a?{}:a,newProps:r,triggerName:e})}
},{"./constants":"dDJN"}],"nzk4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.count=n;const t="count(): argument not an object",e="count(): argument not a container";function n(n){if(!o(n))throw new Error(t);if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(r(n))return Object.keys(n).length;throw new Error(e)}function r(t){return null!==t&&"object"==typeof t&&t.constructor===Object}function o(t){return null!==t&&"object"==typeof t}
},{}],"NycH":[function(require,module,exports) {
"use strict";function e(e,n){if(!n)return e;const i={...e,...n};if("defines"in n&&(i.defines={...e.defines,...n.defines}),"modules"in n&&(i.modules=(e.modules||[]).concat(n.modules),n.modules.some(e=>"project64"===e.name))){const e=i.modules.findIndex(e=>"project32"===e.name);e>=0&&i.modules.splice(e,1)}if("inject"in n)if(e.inject){const s={...e.inject};for(const e in n.inject)s[e]=(s[e]||"")+n.inject[e];i.inject=s}else i.inject=n.inject;return i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeShaders=e;
},{}],"RaIZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createTexture=n,exports.destroyTexture=o;var e=require("@luma.gl/core");const t={10241:9987,10240:9729,10242:33071,10243:33071},r={};function n(n,o,u){if(o instanceof e.Texture2D)return o;o.constructor&&"Object"!==o.constructor.name&&(o={data:o});let c=null;o.compressed&&(c={10241:o.data.length>1?9985:9729});const s=new e.Texture2D(n,{...o,parameters:{...t,...c,...u}});return r[s.id]=!0,s}function o(t){t&&t instanceof e.Texture2D&&r[t.id]&&(t.delete(),delete r[t.id])}
},{"@luma.gl/core":"iuAK"}],"qD4Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parsePropTypes=a;var e=require("../utils/texture"),r=require("../utils/deep-equal");const t={boolean:{validate:(e,r)=>!0,equal:(e,r,t)=>Boolean(e)===Boolean(r)},number:{validate:(e,r)=>Number.isFinite(e)&&(!("max"in r)||e<=r.max)&&(!("min"in r)||e>=r.min)},color:{validate:(e,r)=>r.optional&&!e||u(e)&&(3===e.length||4===e.length),equal:(e,t,a)=>(0,r.deepEqual)(e,t,1)},accessor:{validate(e,r){const t=l(e);return"function"===t||t===l(r.value)},equal:(e,t,a)=>"function"==typeof t||(0,r.deepEqual)(e,t,1)},array:{validate:(e,r)=>r.optional&&!e||u(e),equal(e,t,a){const{compare:n}=a,o=Number.isInteger(n)?n:n?1:0;return n?(0,r.deepEqual)(e,t,o):e===t}},object:{equal(e,t,a){if(a.ignore)return!0;const{compare:n}=a,o=Number.isInteger(n)?n:n?1:0;return n?(0,r.deepEqual)(e,t,o):e===t}},function:{validate:(e,r)=>r.optional&&!e||"function"==typeof e,equal:(e,r,t)=>!t.compare&&!1!==t.ignore||e===r},data:{transform:(e,r,t)=>{const{dataTransform:a}=t.props;return a&&e?a(e):e}},image:{transform:(r,t,a)=>{const n=a.context;return n&&n.gl?(0,e.createTexture)(n.gl,r,{...t.parameters,...a.props.textureParameters}):null},release:r=>{(0,e.destroyTexture)(r)}}};function a(e){const r={},t={},a={};for(const[o,u]of Object.entries(e)){const e=null==u?void 0:u.deprecatedFor;if(e)a[o]=Array.isArray(e)?e:[e];else{const e=n(o,u);r[o]=e,t[o]=e.value}}return{propTypes:r,defaultProps:t,deprecatedProps:a}}function n(e,r){switch(l(r)){case"object":return o(e,r);case"array":return o(e,{type:"array",value:r,compare:!1});case"boolean":return o(e,{type:"boolean",value:r});case"number":return o(e,{type:"number",value:r});case"function":return o(e,{type:"function",value:r,compare:!0});default:return{name:e,type:"unknown",value:r}}}function o(e,r){return"type"in r?{name:e,...t[r.type],...r}:"value"in r?{name:e,type:l(r.value),...r}:{name:e,type:"object",value:r}}function u(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function l(e){return u(e)?"array":null===e?"null":typeof e}
},{"../utils/texture":"RaIZ","../utils/deep-equal":"KSag"}],"jz7I":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createProps=s;var e=r(require("../utils/log")),t=require("../utils/iterable-utils"),n=require("./prop-types"),o=require("./constants");function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){let n;for(let o=t.length-1;o>=0;o--){const e=t[o];"extensions"in e&&(n=e.extensions)}const r=i(e.constructor,n),s=Object.create(r);s[o.COMPONENT_SYMBOL]=e,s[o.ASYNC_ORIGINAL_SYMBOL]={},s[o.ASYNC_RESOLVED_SYMBOL]={};for(let o=0;o<t.length;++o){const e=t[o];for(const t in e)s[t]=e[t]}return Object.freeze(s),s}const c="_mergedDefaultProps";function i(e,t){let n=c;if(t)for(const r of t){const e=r.constructor;e&&(n+=":".concat(e.extensionName||e.name))}const o=l(e,n);return o||(e[n]=O(e,t||[]))}function O(e,t){if(!e.prototype)return null;const r=i(Object.getPrototypeOf(e)),s=l(e,"defaultProps")||{},c=(0,n.parsePropTypes)(s),O=Object.assign(Object.create(null),r,c.defaultProps),_=Object.assign(Object.create(null),null==r?void 0:r[o.PROP_TYPES_SYMBOL],c.propTypes),p=Object.assign(Object.create(null),null==r?void 0:r[o.DEPRECATED_PROPS_SYMBOL],c.deprecatedProps);for(const n of t){const e=i(n.constructor);e&&(Object.assign(O,e),Object.assign(_,e[o.PROP_TYPES_SYMBOL]),Object.assign(p,e[o.DEPRECATED_PROPS_SYMBOL]))}return u(O,e),a(O,_),S(O,p),O[o.PROP_TYPES_SYMBOL]=_,O[o.DEPRECATED_PROPS_SYMBOL]=p,0!==t.length||f(e,"_propTypes")||(e._propTypes=_),O}function u(e,t){const n=p(t);Object.defineProperties(e,{id:{writable:!0,value:n}})}function S(t,n){for(const o in n)Object.defineProperty(t,o,{enumerable:!1,set(t){const r="".concat(this.id,": ").concat(o);for(const e of n[o])f(this,e)||(this[e]=t);e.default.deprecated(r,n[o].join("/"))()}})}function a(e,t){const n={},r={};for(const o in t){const e=t[o],{name:s,value:c}=e;e.async&&(n[s]=c,r[s]=_(s))}e[o.ASYNC_DEFAULTS_SYMBOL]=n,e[o.ASYNC_ORIGINAL_SYMBOL]={},Object.defineProperties(e,r)}function _(e){return{enumerable:!0,set(n){"string"==typeof n||n instanceof Promise||(0,t.isAsyncIterable)(n)?this[o.ASYNC_ORIGINAL_SYMBOL][e]=n:this[o.ASYNC_RESOLVED_SYMBOL][e]=n},get(){if(this[o.ASYNC_RESOLVED_SYMBOL]){if(e in this[o.ASYNC_RESOLVED_SYMBOL]){return this[o.ASYNC_RESOLVED_SYMBOL][e]||this[o.ASYNC_DEFAULTS_SYMBOL][e]}if(e in this[o.ASYNC_ORIGINAL_SYMBOL]){const t=this[o.COMPONENT_SYMBOL]&&this[o.COMPONENT_SYMBOL].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[o.ASYNC_DEFAULTS_SYMBOL][e]}}return this[o.ASYNC_DEFAULTS_SYMBOL][e]}}}function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e,t){return f(e,t)&&e[t]}function p(t){const n=l(t,"layerName")||l(t,"componentName");return n||e.default.once(0,"".concat(t.name,".componentName not specified"))(),n||t.name}
},{"../utils/log":"GVus","../utils/iterable-utils":"kai7","./prop-types":"qD4Q","./constants":"dDJN"}],"ElXl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@babel/runtime/helpers/esm/defineProperty")),t=require("./constants"),r=require("./create-props");function o(e){return e&&e.__esModule?e:{default:e}}let s=0;class i{constructor(...t){(0,e.default)(this,"id",void 0),(0,e.default)(this,"props",void 0),(0,e.default)(this,"count",void 0),this.props=(0,r.createProps)(this,t),this.id=this.props.id,this.count=s++}clone(e){const{props:r}=this,o={};for(const s in r[t.ASYNC_DEFAULTS_SYMBOL])s in r[t.ASYNC_RESOLVED_SYMBOL]?o[s]=r[t.ASYNC_RESOLVED_SYMBOL][s]:s in r[t.ASYNC_ORIGINAL_SYMBOL]&&(o[s]=r[t.ASYNC_ORIGINAL_SYMBOL][s]);return new this.constructor({...r,...o,...e})}}exports.default=i,(0,e.default)(i,"componentName","Component"),(0,e.default)(i,"defaultProps",{});
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./constants":"dDJN","./create-props":"jz7I"}],"c85S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var s=t(require("@babel/runtime/helpers/esm/defineProperty")),o=require("../utils/iterable-utils"),e=require("./constants");function t(s){return s&&s.__esModule?s:{default:s}}const n=Object.freeze({});class r{constructor(o){(0,s.default)(this,"component",void 0),(0,s.default)(this,"onAsyncPropUpdated",void 0),(0,s.default)(this,"asyncProps",void 0),(0,s.default)(this,"oldProps",void 0),(0,s.default)(this,"oldAsyncProps",void 0),this.component=o,this.asyncProps={},this.onAsyncPropUpdated=(()=>{}),this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const s in this.asyncProps){const o=this.asyncProps[s];o&&o.type&&o.type.release&&o.type.release(o.resolvedValue,o.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||n}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(s){return s in this.asyncProps}getAsyncProp(s){const o=this.asyncProps[s];return o&&o.resolvedValue}isAsyncPropLoading(s){if(s){const o=this.asyncProps[s];return Boolean(o&&o.pendingLoadCount>0&&o.pendingLoadCount!==o.resolvedLoadCount)}for(const o in this.asyncProps)if(this.isAsyncPropLoading(o))return!0;return!1}reloadAsyncProp(s,o){this._watchPromise(s,Promise.resolve(o))}setAsyncProps(s){this.component=s[e.COMPONENT_SYMBOL]||this.component;const o=s[e.ASYNC_RESOLVED_SYMBOL]||{},t=s[e.ASYNC_ORIGINAL_SYMBOL]||s,n=s[e.ASYNC_DEFAULTS_SYMBOL]||{};for(const e in o){const s=o[e];this._createAsyncPropData(e,n[e]),this._updateAsyncProp(e,s),o[e]=this.getAsyncProp(e)}for(const e in t){const s=t[e];this._createAsyncPropData(e,n[e]),this._updateAsyncProp(e,s)}}_fetch(s,o){return null}_onResolve(s,o){}_onError(s,o){}_updateAsyncProp(s,e){this._didAsyncInputValueChange(s,e)&&("string"==typeof e&&(e=this._fetch(s,e)),e instanceof Promise?this._watchPromise(s,e):(0,o.isAsyncIterable)(e)?this._resolveAsyncIterable(s,e):this._setPropValue(s,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const s in this.asyncProps)Object.defineProperty(this.oldAsyncProps,s,{enumerable:!0,value:this.oldProps[s]})}}_didAsyncInputValueChange(s,o){const e=this.asyncProps[s];return o!==e.resolvedValue&&o!==e.lastValue&&(e.lastValue=o,!0)}_setPropValue(s,o){this._freezeAsyncOldProps();const e=this.asyncProps[s];e&&(o=this._postProcessValue(e,o),e.resolvedValue=o,e.pendingLoadCount++,e.resolvedLoadCount=e.pendingLoadCount)}_setAsyncPropValue(s,o,e){const t=this.asyncProps[s];t&&e>=t.resolvedLoadCount&&void 0!==o&&(this._freezeAsyncOldProps(),t.resolvedValue=o,t.resolvedLoadCount=e,this.onAsyncPropUpdated(s,o))}_watchPromise(s,o){const e=this.asyncProps[s];if(e){e.pendingLoadCount++;const t=e.pendingLoadCount;o.then(o=>{this.component&&(o=this._postProcessValue(e,o),this._setAsyncPropValue(s,o,t),this._onResolve(s,o))}).catch(o=>{this._onError(s,o)})}}async _resolveAsyncIterable(s,o){if("data"!==s)return void this._setPropValue(s,o);const e=this.asyncProps[s];if(!e)return;e.pendingLoadCount++;const t=e.pendingLoadCount;let n=[],r=0;for await(const i of o){if(!this.component)return;const{dataTransform:o}=this.component.props;n=o?o(i,n):n.concat(i),Object.defineProperty(n,"__diff",{enumerable:!1,value:[{startRow:r,endRow:n.length}]}),r=n.length,this._setAsyncPropValue(s,n,t)}this._onResolve(s,n)}_postProcessValue(s,o){const e=s.type;return e&&this.component&&(e.release&&e.release(s.resolvedValue,e,this.component),e.transform)?e.transform(o,e,this.component):o}_createAsyncPropData(s,o){if(!this.asyncProps[s]){const t=this.component&&this.component.props[e.PROP_TYPES_SYMBOL];this.asyncProps[s]={type:t&&t[s],lastValue:null,resolvedValue:o,pendingLoadCount:0,resolvedLoadCount:0}}}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../utils/iterable-utils":"kai7","./constants":"dDJN"}],"CAGE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@babel/runtime/helpers/esm/defineProperty")),t=r(require("../lifecycle/component-state"));function r(e){return e&&e.__esModule?e:{default:e}}class s extends t.default{constructor({attributeManager:t,layer:r}){super(r),(0,e.default)(this,"attributeManager",void 0),(0,e.default)(this,"needsRedraw",void 0),(0,e.default)(this,"needsUpdate",void 0),(0,e.default)(this,"subLayers",void 0),(0,e.default)(this,"usesPickingColorCache",void 0),(0,e.default)(this,"hasPickingBuffer",void 0),(0,e.default)(this,"changeFlags",void 0),(0,e.default)(this,"viewport",void 0),(0,e.default)(this,"uniformTransitions",void 0),(0,e.default)(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const r=this.layer,s=null==r?void 0:r.props.fetch;return s?s(t,{propName:e,layer:r}):super._fetch(e,t)}_onResolve(e,t){const r=this.layer;if(r){const s=r.props.onDataLoad;"data"===e&&s&&s(t,{propName:e,layer:r})}}_onError(e,t){const r=this.layer;r&&r.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}exports.default=s;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../lifecycle/component-state":"c85S"}],"xVVm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=v(require("@babel/runtime/helpers/esm/defineProperty")),e=require("./constants"),i=v(require("./attribute/attribute-manager")),a=v(require("./uniform-transition-manager")),s=require("../lifecycle/props"),n=require("../lifecycle/constants"),r=require("../utils/count"),o=v(require("../utils/log")),l=v(require("../debug")),d=require("@luma.gl/core"),h=v(require("../utils/assert")),u=v(require("../utils/memoize")),p=require("../utils/shader"),c=require("../shaderlib/project/project-functions"),g=v(require("../utils/typed-array-manager")),f=v(require("../lifecycle/component")),m=v(require("./layer-state")),S=require("@math.gl/web-mercator"),y=require("@loaders.gl/core");function v(t){return t&&t.__esModule?t:{default:t}}const b="layer.changeFlag",C="layer.initialize",P="layer.update",A="layer.finalize",x="layer.matched",w=2**24-1,M=Object.freeze([]),_=(0,u.default)(({oldViewport:t,viewport:e})=>t.equals(e));let I=new Uint8ClampedArray(0);const O={data:{type:"data",value:M,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:i,loaders:a,loadOptions:s,signal:n})=>{const{resourceManager:r}=i.context;var o;(s=s||i.getLoadOptions(),a=a||i.props.loaders,n)&&(s={...s,fetch:{...null===(o=s)||void 0===o?void 0:o.fetch,signal:n}});let l=r.contains(t);return l||s||(r.add({resourceId:t,data:(0,y.load)(t,a),persistent:!1}),l=!0),l?r.subscribe({resourceId:t,onChange:t=>{var a;return null===(a=i.internalState)||void 0===a?void 0:a.reloadAsyncProp(e,t)},consumerId:i.id,requestId:e}):(0,y.load)(t,a,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:e.COORDINATE_SYSTEM.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class k extends f.default{constructor(...e){super(...e),(0,t.default)(this,"internalState",null),(0,t.default)(this,"lifecycle",n.LIFECYCLE.NO_STATE),(0,t.default)(this,"context",void 0),(0,t.default)(this,"state",void 0),(0,t.default)(this,"parent",null)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){(0,h.default)(this.internalState);const e=this.internalState.viewport||this.context.viewport,i=(0,c.getWorldPosition)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[a,s,n]=(0,S.worldToPixels)(i,e.pixelProjectionMatrix);return 2===t.length?[a,s]:[a,s,n]}unproject(t){return(0,h.default)(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){(0,h.default)(this.internalState);const i=this.internalState.viewport||this.context.viewport;return(0,c.projectPosition)(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===e.COORDINATE_SYSTEM.DEFAULT||t===e.COORDINATE_SYSTEM.LNGLAT||t===e.COORDINATE_SYSTEM.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,h.default)(t instanceof Uint8Array);const[e,i,a]=t;return e+256*i+65536*a-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:(0,r.count)(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=(0,p.mergeShaders)(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:i}=t.changeFlags;if(i&&e)if(Array.isArray(i))for(const a of i)e.invalidateAll(a);else e.invalidateAll();if(e){const{props:i}=t,a=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(t=>t.getNeedsPickingBuffer.call(this,t));if(a!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:t,instancePickingColors:i}=e.attributes,a=t||i;a&&(s&&a.constant&&(a.constant=!1,e.invalidate(a.id)),a.value||s||(a.constant=!0,a.value=[0,0,0]))}}}finalizeState(t){for(const i of this.getModels())i.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e,sourceLayer:i}){const{index:a}=t;return a>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[a]),t}raiseError(t,e){var i,a,s,n;(e&&(t.message="".concat(e,": ").concat(t.message)),null!==(i=(a=this.props).onError)&&void 0!==i&&i.call(a,t))||(null===(s=this.context)||void 0===s||null===(n=s.onError)||void 0===n||n.call(s,t,this))}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&_({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,i=this.getNumInstances(),a=this.getStartIndices();t.update({data:e.data,numInstances:i,startIndices:a,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const s=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),i=Object.create(this.props);for(const t in e)Object.defineProperty(i,t,{value:e[t]});return i}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const i=Math.floor(I.length/3);if(this.internalState.usesPickingColorCache=!0,i<e){e>w&&o.default.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),I=g.default.allocate(I,e,{size:3,copy:!0,maxCount:Math.max(e,w)});const t=Math.floor(I.length/3),a=[];for(let e=i;e<t;e++)this.encodePickingColor(e,a),I[3*e+0]=a[0],I[3*e+1]=a[1],I[3*e+2]=a[2]}t.value=I.subarray(0,3*e)}_setModelAttributes(t,e){const i=this.getAttributeManager(),a=t.userData.excludeAttributes||{},s=i.getShaderAttributes(e,a);t.setAttributes(s)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:i}=this.getAttributeManager().attributes,a=e||i;if(!a)return;const s=a.getVertexOffset(t),n=a.getVertexOffset(t+1);a.buffer.subData({data:new Uint8Array(n-s),offset:s})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,i=t||e;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==I.buffer&&(i.value=I.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){(0,h.default)(!this.internalState),(0,h.default)(Number.isFinite(this.props.coordinateSystem)),(0,l.default)(C,this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new m.default({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(o.default.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new a.default(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){(0,l.default)(x,this,this===t);const{state:e,internalState:i}=t;this!==t&&(this.internalState=i,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if((0,l.default)(P,this,t),!t)return;const e=this.props,i=this.context,a=this.internalState,s=i.viewport,n=this._updateUniformTransition();a.propsInTransition=n,i.viewport=a.viewport||s,this.props=n;try{const t=this._getUpdateParams(),n=this.getModels();if(i.gl)this.updateState(t);else try{this.updateState(t)}catch(r){}for(const e of this.props.extensions)e.updateState.call(this,t,e);const o=this.getModels()[0]!==n[0];this._postUpdate(t,o)}finally{i.viewport=s,this.props=e,this._clearChangeFlags(),a.needsUpdate=!1,a.resetOldProps()}}_finalize(){(0,l.default)(A,this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({moduleParameters:t=null,uniforms:e={},parameters:i={}}){this._updateAttributeTransition();const a=this.props,s=this.context;this.props=this.internalState.propsInTransition||a;const n=this.props.opacity;e.opacity=Math.pow(n,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:n}=this.props,r=n&&n(e)||[0,0];(0,d.setParameters)(s.gl,{polygonOffset:r}),(0,d.withParameters)(s.gl,i,()=>{const a={moduleParameters:t,uniforms:e,parameters:i,context:s};for(const t of this.props.extensions)t.draw.call(this,a,t);this.draw(a)})}finally{this.props=a}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const a in t)if(t[a]){let i=!1;switch(a){case"dataChanged":const s=t[a],n=e[a];s&&Array.isArray(n)&&(e.dataChanged=Array.isArray(s)?n.concat(s):s,i=!0);default:e[a]||(e[a]=t[a],i=!0)}i&&(0,l.default)(b,this,a,t)}const i=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=i,e.somethingChanged=i||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const i=(0,s.diffProps)(t,e);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var a;this.internalState.uniformTransitions.add(s,e[s],t[s],null===(a=t.transitions)||void 0===a?void 0:a[s])}return this.setChangeFlags(i)}validateProps(){(0,s.validateProps)(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:i}=this.props;t.picked&&"function"==typeof i&&(e.pickingHighlightColor=i(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new i.default(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:i,oldProps:a}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;null==s||s.setInstanceCount(this.getNumInstances());const{autoHighlight:n,highlightedObjectIndex:r,highlightColor:o}=i;if(e||a.autoHighlight!==n||a.highlightedObjectIndex!==r||a.highlightColor!==o){const t={};n||(t.pickingSelectedColor=null),Array.isArray(o)&&(t.pickingHighlightColor=o),(e||r!==a.highlightedObjectIndex)&&(t.pickingSelectedColor=Number.isFinite(r)&&r>=0?this.encodePickingColor(r):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),a=!!i&&i.getNeedsRedraw(t);if(e=e||a)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}exports.default=k,(0,t.default)(k,"defaultProps",O),(0,t.default)(k,"layerName","Layer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./constants":"ysbg","./attribute/attribute-manager":"wT56","./uniform-transition-manager":"f2Ln","../lifecycle/props":"UiIs","../lifecycle/constants":"dDJN","../utils/count":"nzk4","../utils/log":"GVus","../debug":"EEoF","@luma.gl/core":"iuAK","../utils/assert":"Txat","../utils/memoize":"uXG5","../utils/shader":"NycH","../shaderlib/project/project-functions":"AJ0f","../utils/typed-array-manager":"yeLJ","../lifecycle/component":"ElXl","./layer-state":"CAGE","@math.gl/web-mercator":"PqV4","@loaders.gl/core":"ikKD"}],"dK5R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@babel/runtime/helpers/esm/defineProperty")),t=o(require("./layer")),r=o(require("../debug")),s=require("../utils/flatten"),i=require("../lifecycle/constants");function o(e){return e&&e.__esModule?e:{default:e}}const a="compositeLayer.renderLayers";class n extends t.default{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id?(e.object=t.__source.object,e.index=t.__source.index,e):e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||t}getSubLayerRow(e,t,r){return e.__source={parent:this,object:t,index:r},e}getSubLayerAccessor(e){if("function"==typeof e){const t={index:-1,data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(t.index=r.__source.index,e(r.__source.object,t)):e(r,s)}return e}getSubLayerProps(e={}){var t;const{opacity:r,pickable:s,visible:o,parameters:a,getPolygonOffset:n,highlightedObjectIndex:u,autoHighlight:d,highlightColor:p,coordinateSystem:c,coordinateOrigin:g,wrapLongitude:l,positionFormat:h,modelMatrix:y,extensions:b,fetch:f,operation:_,_subLayerProps:L}=this.props,S={id:"",updateTriggers:{},opacity:r,pickable:s,visible:o,parameters:a,getPolygonOffset:n,highlightedObjectIndex:u,autoHighlight:d,highlightColor:p,coordinateSystem:c,coordinateOrigin:g,wrapLongitude:l,positionFormat:h,modelMatrix:y,extensions:b,fetch:f,operation:_},x=L&&e.id&&L[e.id],m=x&&x.updateTriggers,O=e.id||"sublayer";if(x){const t=this.props[i.PROP_TYPES_SYMBOL],r=e.type?e.type._propTypes:{};for(const e in x){const s=r[e]||t[e];s&&"accessor"===s.type&&(x[e]=this.getSubLayerAccessor(x[e]))}}Object.assign(S,e,x),S.id="".concat(this.props.id,"-").concat(O),S.updateTriggers={all:null===(t=this.props.updateTriggers)||void 0===t?void 0:t.all,...e.updateTriggers,...m};for(const i of b){const e=i.getSubLayerProps.call(this,i);e&&Object.assign(S,e,{updateTriggers:Object.assign(S.updateTriggers,e.updateTriggers)})}return S}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let i=this.internalState.subLayers;const o=!i||this.needsUpdate();if(o){const e=this.renderLayers();i=(0,s.flatten)(e,Boolean),this.internalState.subLayers=i}(0,r.default)(a,this,o,i);for(const r of i)r.parent=this}}exports.default=n,(0,e.default)(n,"layerName","CompositeLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./layer":"xVVm","../debug":"EEoF","../utils/flatten":"gSVO","../lifecycle/constants":"dDJN"}],"DUOV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=u(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@math.gl/core"),r=u(require("./viewport")),i=require("../lib/constants"),n=a(require("gl-matrix/vec3")),o=a(require("gl-matrix/vec4"));function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(s=function(t){return t?r:e})(t)}function a(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=s(e);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var a=n?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}function u(t){return t&&t.__esModule?t:{default:t}}const l=Math.PI/180,h=180/Math.PI,c=6370972,d=256;function p(){const t=d/c,e=Math.PI/180*d;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class f extends r.default{constructor(r={}){const{latitude:i=0,longitude:n=0,zoom:o=0,nearZMultiplier:s=.1,farZMultiplier:a=2,resolution:u=10}=r;let{height:h,altitude:c=1.5}=r;h=h||1,c=Math.max(.75,c);const f=(new e.Matrix4).lookAt({eye:[0,-c,0],up:[0,0,1]}),M=Math.pow(2,o);f.rotateX(i*l),f.rotateZ(-n*l),f.scale(M/h);const g=Math.atan(.5/c),P=2*d*M/h;super({...r,height:h,viewMatrix:f,longitude:n,latitude:i,zoom:o,distanceScales:p(),fovyRadians:2*g,focalDistance:c,near:s,far:Math.min(2,1/P+1)*c*a}),(0,t.default)(this,"longitude",void 0),(0,t.default)(this,"latitude",void 0),(0,t.default)(this,"resolution",void 0),this.latitude=i,this.longitude=n,this.resolution=u}get projectionMode(){return i.PROJECTION_MODE.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},r=this.unproject([0,this.height/2],e),i=this.unproject([this.width/2,0],e),n=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return n[0]<this.longitude&&(n[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],n[0],i[0],o[0]),Math.min(r[1],n[1],i[1],o[1]),Math.max(r[0],n[0],i[0],o[0]),Math.max(r[1],n[1],i[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:r}={}){const[i,o,s]=t,a=e?o:this.height-o,{pixelUnprojectionMatrix:u}=this;let l;if(Number.isFinite(s))l=M(u,[i,a,s,1]);else{const t=M(u,[i,a,-1,1]),e=M(u,[i,a,1,1]),o=((r||0)/c+1)*d,s=n.sqrLen(n.sub([],t,e)),h=n.sqrLen(t),p=n.sqrLen(e),f=4*((4*h*p-(s-h-p)**2)/16)/s,g=(Math.sqrt(h-f)-Math.sqrt(Math.max(0,o*o-f)))/Math.sqrt(s);l=n.lerp([],t,e,g)}const[h,p,f]=this.unprojectPosition(l);return Number.isFinite(s)?[h,p,f]:Number.isFinite(r)?[h,p,r]:[h,p]}projectPosition(t){const[e,r,i=0]=t,n=e*l,o=r*l,s=Math.cos(o),a=(i/c+1)*d;return[Math.sin(n)*s*a,-Math.cos(n)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,r,i]=t,o=n.len(t),s=Math.asin(i/o);return[Math.atan2(e,-r)*h,s*h,(o/d-1)*c]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const r=this.unproject(e);return{longitude:t[0]-r[0]+this.longitude,latitude:t[1]-r[1]+this.latitude}}}function M(t,e){const r=o.transformMat4([],e,t);return o.scale(r,r,1/r[3]),r}exports.default=f;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx","./viewport":"HjGN","../lib/constants":"ysbg","gl-matrix/vec3":"AWBd","gl-matrix/vec4":"zWbG"}],"twQX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=i(require("@babel/runtime/helpers/esm/defineProperty")),e=i(require("../viewports/viewport")),o=require("@math.gl/core"),r=require("@math.gl/web-mercator");function i(t){return t&&t.__esModule?t:{default:t}}const n=Math.PI/180;function s({height:t,focalDistance:e,orbitAxis:r,rotationX:i,rotationOrbit:s,zoom:a}){const c="Z"===r?[0,0,1]:[0,1,0],h="Z"===r?[0,-e,0]:[0,0,e],u=(new o.Matrix4).lookAt({eye:h,up:c});u.rotateX(i*n),"Z"===r?u.rotateZ(s*n):u.rotateY(s*n);const p=Math.pow(2,a)/t;return u.scale(p),u}class a extends e.default{constructor(e){const{height:o,projectionMatrix:i,fovy:n=50,orbitAxis:a="Z",target:c=[0,0,0],rotationX:h=0,rotationOrbit:u=0,zoom:p=0}=e,l=i?i[5]/2:(0,r.fovyToAltitude)(n);super({...e,longitude:void 0,viewMatrix:s({height:o||1,focalDistance:l,orbitAxis:a,rotationX:h,rotationOrbit:u,zoom:p}),fovy:n,focalDistance:l,position:c,zoom:p}),(0,t.default)(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[o,i,n=this.projectedCenter[2]]=t,s=e?i:this.height-i,[a,c,h]=(0,r.pixelsToWorld)([o,s,n],this.pixelUnprojectionMatrix);return[a,c,h]}panByPosition(t,e){const o=this.project(t),r=[this.width/2+o[0]-e[0],this.height/2+o[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../viewports/viewport":"HjGN","@math.gl/core":"dwLx","@math.gl/web-mercator":"PqV4"}],"cs0l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=a(require("../viewports/viewport")),e=require("@math.gl/core"),r=require("@math.gl/web-mercator"),n=i(require("gl-matrix/vec2"));function o(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(o=function(t){return t?r:e})(t)}function i(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=o(e);if(r&&r.has(t))return r.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=i?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=t[a]}return n.default=t,r&&r.set(t,n),n}function a(t){return t&&t.__esModule?t:{default:t}}const s=(new e.Matrix4).lookAt({eye:[0,0,1]});function c({width:t,height:r,near:n,far:o,padding:i}){let a=-t/2,s=t/2,c=-r/2,l=r/2;if(i){const{left:n=0,right:o=0,top:u=0,bottom:p=0}=i,f=(0,e.clamp)((n+t-o)/2,0,t)-t/2,d=(0,e.clamp)((u+r-p)/2,0,r)-r/2;a-=f,s-=f,c+=d,l+=d}return(new e.Matrix4).ortho({left:a,right:s,bottom:c,top:l,near:n,far:o})}class l extends t.default{constructor(t){const{width:e,height:r,near:n=.1,far:o=1e3,zoom:i=0,target:a=[0,0,0],padding:l=null,flipY:u=!0}=t,p=Array.isArray(i)?i[0]:i,f=Array.isArray(i)?i[1]:i,d=Math.min(p,f),h=Math.pow(2,d);let g;if(p!==f){const t=Math.pow(2,p),e=Math.pow(2,f);g={unitsPerMeter:[t/h,e/h,1],metersPerUnit:[h/t,h/e,1]}}super({...t,longitude:void 0,position:a,viewMatrix:s.clone().scale([h,h*(u?-1:1),h]),projectionMatrix:c({width:e||1,height:r||1,padding:l,near:n,far:o}),zoom:d,distanceScales:g})}projectFlat([t,e]){const{unitsPerMeter:r}=this.distanceScales;return[t*r[0],e*r[1]]}unprojectFlat([t,e]){const{metersPerUnit:r}=this.distanceScales;return[t*r[0],e*r[1]]}panByPosition(t,e){const o=(0,r.pixelsToWorld)(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),a=n.add([],i,n.negate([],o)),s=n.add([],this.center,a);return{target:this.unprojectFlat(s)}}}exports.default=l;
},{"../viewports/viewport":"HjGN","@math.gl/core":"dwLx","@math.gl/web-mercator":"PqV4","gl-matrix/vec2":"XSo1"}],"qAaj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@babel/runtime/helpers/esm/defineProperty")),t=o(require("../viewports/viewport")),r=require("@math.gl/web-mercator"),i=require("@math.gl/core");function o(e){return e&&e.__esModule?e:{default:e}}class a extends t.default{constructor(t){const{longitude:o,latitude:a,modelMatrix:u,bearing:l=0,pitch:s=0,up:d=[0,0,1]}=t,n=new i._SphericalCoordinates({bearing:l,pitch:-90===s?1e-4:90+s}).toVector3().normalize(),c=u?new i.Matrix4(u).transformAsVector(n):n,p=Number.isFinite(a)?(0,r.getMeterZoom)({latitude:a}):0,h=Math.pow(2,p),m=(new i.Matrix4).lookAt({eye:[0,0,0],center:c,up:d}).scale(h);super({...t,zoom:p,viewMatrix:m}),(0,e.default)(this,"longitude",void 0),(0,e.default)(this,"latitude",void 0),this.latitude=a,this.longitude=o}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../viewports/viewport":"HjGN","@math.gl/web-mercator":"PqV4","@math.gl/core":"dwLx"}],"Egne":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=a(require("@babel/runtime/helpers/esm/defineProperty")),e=a(require("./controller")),i=a(require("./view-state")),r=require("../utils/math-utils"),o=a(require("../transitions/linear-interpolator")),s=require("@math.gl/core");function a(t){return t&&t.__esModule?t:{default:t}}const n=20;class h extends i.default{constructor(t){const{width:e,height:i,position:r=[0,0,0],bearing:o=0,pitch:s=0,longitude:a=null,latitude:n=null,maxPitch:h=90,minPitch:p=-90,startRotatePos:g,startBearing:u,startPitch:l,startZoomPosition:d}=t;super({width:e,height:i,position:r,bearing:o,pitch:s,longitude:a,latitude:n,maxPitch:h,minPitch:p},{startRotatePos:g,startBearing:u,startPitch:l,startZoomPosition:d})}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:o,startPitch:s}=this.getState(),{width:a,height:n}=this.getViewportProps();if(!r||void 0===o||void 0===s)return this;let h;if(t){h={bearing:o-180*((t[0]-r[0])/a),pitch:s-90*((t[1]-r[1])/n)}}else h={bearing:o-e,pitch:s-i};return this._getUpdatedState(h)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}zoom({scale:t}){let{startZoomPosition:e}=this.getState();e||(e=this.getViewportProps().position);const i=this.getDirection();return this._move(i,Math.log2(t)*n,e)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null})}moveLeft(t=n){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:Math.PI/2}),t)}moveRight(t=n){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:-Math.PI/2}),t)}moveUp(t=n){const e=this.getDirection(!0);return this._move(e,t)}moveDown(t=n){const e=this.getDirection(!0);return this._move(e.negate(),t)}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}zoomIn(t=2){return this.zoom({scale:t})}zoomOut(t=2){return this.zoom({scale:1/t})}shortestPathFrom(t){const e=t.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:o}=i;return Math.abs(r-e.bearing)>180&&(i.bearing=r<0?r+360:r-360),null!==o&&null!==e.longitude&&Math.abs(o-e.longitude)>180&&(i.longitude=o<0?o+360:o-360),i}_move(t,e,i=this.getViewportProps().position){const r=t.scale(e);return this._getUpdatedState({position:new s.Vector3(i).add(r)})}getDirection(t=!1){return new s._SphericalCoordinates({bearing:this.getViewportProps().bearing,pitch:t?90:90+this.getViewportProps().pitch}).toVector3().normalize()}_getUpdatedState(t){return new h({...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{pitch:e,maxPitch:i,minPitch:o,longitude:a,bearing:n}=t;return t.pitch=(0,s.clamp)(e,o,i),null!==a&&(a<-180||a>180)&&(t.longitude=(0,r.mod)(a+180,360)-180),(n<-180||n>180)&&(t.bearing=(0,r.mod)(n+180,360)-180),t}}class p extends e.default{constructor(...e){super(...e),(0,t.default)(this,"ControllerState",h),(0,t.default)(this,"transition",{transitionDuration:300,transitionInterpolator:new o.default(["position","pitch","bearing"])})}}exports.default=p;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./controller":"ugw5","./view-state":"TfDO","../utils/math-utils":"ki6G","../transitions/linear-interpolator":"bGRb","@math.gl/core":"dwLx"}],"EN53":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty")),r=s(require("./view")),t=s(require("../viewports/first-person-viewport")),o=s(require("../controllers/first-person-controller"));function s(e){return e&&e.__esModule?e:{default:e}}class l extends r.default{get ViewportType(){return t.default}get ControllerType(){return o.default}}exports.default=l,(0,e.default)(l,"displayName","FirstPersonView");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./view":"k6Eh","../viewports/first-person-viewport":"qAaj","../controllers/first-person-controller":"Egne"}],"o35a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.OrbitState=void 0;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),o=require("@math.gl/core"),r=s(require("./controller")),e=s(require("./view-state")),i=require("../utils/math-utils"),a=s(require("../transitions/linear-interpolator"));function s(t){return t&&t.__esModule?t:{default:t}}class n extends e.default{constructor(o){const{width:r,height:e,rotationX:i=0,rotationOrbit:a=0,target:s=[0,0,0],zoom:n=0,minRotationX:p=-90,maxRotationX:m=90,minZoom:h=-1/0,maxZoom:u=1/0,startPanPosition:l,startRotatePos:d,startRotationX:g,startRotationOrbit:c,startZoomPosition:P,startZoom:w}=o;super({width:r,height:e,rotationX:i,rotationOrbit:a,target:s,zoom:n,minRotationX:p,maxRotationX:m,minZoom:h,maxZoom:u},{startPanPosition:l,startRotatePos:d,startRotationX:g,startRotationOrbit:c,startZoomPosition:P,startZoom:w}),(0,t.default)(this,"makeViewport",void 0),this.makeViewport=o.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:o}){const r=this.getState().startPanPosition||o;if(!r)return this;const e=this.makeViewport(this.getViewportProps()).panByPosition(r,t);return this._getUpdatedState(e)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:t,deltaAngleX:o=0,deltaAngleY:r=0}){const{startRotatePos:e,startRotationX:i,startRotationOrbit:a}=this.getState(),{width:s,height:n}=this.getViewportProps();if(!e||void 0===i||void 0===a)return this;let p;if(t){let o=(t[0]-e[0])/s;const r=(t[1]-e[1])/n;(i<-90||i>90)&&(o*=-1),p={rotationX:i+180*r,rotationOrbit:a+180*o}}else p={rotationX:i+r,rotationOrbit:a+o};return this._getUpdatedState(p)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const o=t.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:e}=r;return Math.abs(e-o.rotationOrbit)>180&&(r.rotationOrbit=e<0?e+360:e-360),r}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:o,scale:r}){let{startZoom:e,startZoomPosition:i}=this.getState();if(i||(e=this.getViewportProps().zoom,i=this._unproject(o)||this._unproject(t)),!i)return this;const a=this._calculateNewZoom({scale:r,startZoom:e}),s=this.makeViewport({...this.getViewportProps(),zoom:a});return this._getUpdatedState({zoom:a,...s.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+t})}_unproject(t){const o=this.makeViewport(this.getViewportProps());return t&&o.unproject(t)}_calculateNewZoom({scale:t,startZoom:r}){const{maxZoom:e,minZoom:i}=this.getViewportProps();void 0===r&&(r=this.getViewportProps().zoom);const a=r+Math.log2(t);return(0,o.clamp)(a,i,e)}_panFromCenter(t){const{width:o,height:r,target:e}=this.getViewportProps();return this.pan({startPosition:e,pos:[o/2+t[0],r/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{maxZoom:r,minZoom:e,zoom:a,maxRotationX:s,minRotationX:n,rotationOrbit:p}=t;return t.zoom=Array.isArray(a)?[(0,o.clamp)(a[0],e,r),(0,o.clamp)(a[1],e,r)]:(0,o.clamp)(a,e,r),t.rotationX=(0,o.clamp)(t.rotationX,n,s),(p<-180||p>180)&&(t.rotationOrbit=(0,i.mod)(p+180,360)-180),t}}exports.OrbitState=n;class p extends r.default{constructor(...o){super(...o),(0,t.default)(this,"ControllerState",n),(0,t.default)(this,"transition",{transitionDuration:300,transitionInterpolator:new a.default({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}exports.default=p;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx","./controller":"ugw5","./view-state":"TfDO","../utils/math-utils":"ki6G","../transitions/linear-interpolator":"bGRb"}],"gGaz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("@babel/runtime/helpers/esm/defineProperty")),r=i(require("./view")),t=i(require("../viewports/orbit-viewport")),o=i(require("../controllers/orbit-controller"));function i(e){return e&&e.__esModule?e:{default:e}}class u extends r.default{constructor(e={}){super(e),this.props.orbitAxis=e.orbitAxis||"Z"}get ViewportType(){return t.default}get ControllerType(){return o.default}}exports.default=u,(0,e.default)(u,"displayName","OrbitView");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./view":"k6Eh","../viewports/orbit-viewport":"twQX","../controllers/orbit-controller":"o35a"}],"osBw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=i(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@math.gl/core"),r=i(require("./controller")),o=require("./orbit-controller"),a=i(require("../transitions/linear-interpolator"));function i(t){return t&&t.__esModule?t:{default:t}}class s extends o.OrbitState{constructor(e){super(e),(0,t.default)(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:t,startZoom:r}){const{maxZoom:o,minZoom:a}=this.getViewportProps();void 0===r&&(r=this.getViewportProps().zoom);let i=Math.log2(t);if(Array.isArray(r)){let[t,s]=r;switch(this.zoomAxis){case"X":t=(0,e.clamp)(t+i,a,o);break;case"Y":s=(0,e.clamp)(s+i,a,o);break;default:let r=Math.min(t+i,s+i);r<a&&(i+=a-r),(r=Math.max(t+i,s+i))>o&&(i+=o-r),t+=i,s+=i}return[t,s]}return(0,e.clamp)(r+i,a,o)}}class l extends r.default{constructor(...e){super(...e),(0,t.default)(this,"ControllerState",s),(0,t.default)(this,"transition",{transitionDuration:300,transitionInterpolator:new a.default(["target","zoom"])}),(0,t.default)(this,"dragMode","pan")}_onPanRotate(){return!1}}exports.default=l;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx","./controller":"ugw5","./orbit-controller":"o35a","../transitions/linear-interpolator":"bGRb"}],"d3vQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("@babel/runtime/helpers/esm/defineProperty")),r=l(require("./view")),t=l(require("../viewports/orthographic-viewport")),o=l(require("../controllers/orthographic-controller"));function l(e){return e&&e.__esModule?e:{default:e}}class u extends r.default{get ViewportType(){return t.default}get ControllerType(){return o.default}}exports.default=u,(0,e.default)(u,"displayName","OrthographicView");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./view":"k6Eh","../viewports/orthographic-viewport":"cs0l","../controllers/orthographic-controller":"osBw"}],"JDk6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@math.gl/core"),r=s(require("./controller")),o=require("./map-controller"),a=require("../utils/math-utils"),i=s(require("../transitions/linear-interpolator"));function s(t){return t&&t.__esModule?t:{default:t}}class l extends o.MapState{applyConstraints(t){const{maxZoom:r,minZoom:o,zoom:i}=t;t.zoom=(0,e.clamp)(i,o,r);const{longitude:s,latitude:l}=t;return(s<-180||s>180)&&(t.longitude=(0,a.mod)(s+180,360)-180),t.latitude=(0,e.clamp)(l,-89,89),t}}class n extends r.default{constructor(...e){super(...e),(0,t.default)(this,"ControllerState",l),(0,t.default)(this,"transition",{transitionDuration:300,transitionInterpolator:new i.default(["longitude","latitude","zoom"])}),(0,t.default)(this,"dragMode","pan")}setProps(t){super.setProps(t),this.dragRotate=!1,this.touchRotate=!1}}exports.default=n;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx","./controller":"ugw5","./map-controller":"N44t","../utils/math-utils":"ki6G","../transitions/linear-interpolator":"bGRb"}],"WZeT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@babel/runtime/helpers/esm/defineProperty")),r=o(require("./view")),t=o(require("../viewports/globe-viewport")),l=o(require("../controllers/globe-controller"));function o(e){return e&&e.__esModule?e:{default:e}}class u extends r.default{get ViewportType(){return t.default}get ControllerType(){return l.default}}exports.default=u,(0,e.default)(u,"displayName","GlobeView");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./view":"k6Eh","../viewports/globe-viewport":"DUOV","../controllers/globe-controller":"JDk6"}],"TXTo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@babel/runtime/helpers/esm/defineProperty")),t=require("../utils/deep-equal");function r(e){return e&&e.__esModule?e:{default:e}}class s{constructor(t){(0,e.default)(this,"opts",void 0),t&&(this.opts=t)}equals(e){return this===e||this.constructor===e.constructor&&(0,t.deepEqual)(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:t}=e.constructor,r={updateTriggers:{}};for(const s in t)if(s in this.props){const e=t[s],o=this.props[s];r[s]=o,e&&"accessor"===e.type&&(r.updateTriggers[s]=this.props.updateTriggers[s],"function"==typeof o&&(r[s]=this.getSubLayerAccessor(o)))}return r}initializeState(e,t){}updateState(e,t){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,t){}finalizeState(e,t){}}exports.default=s,(0,e.default)(s,"defaultProps",{});
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","../utils/deep-equal":"KSag"}],"PVme":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("@babel/runtime/helpers/esm/defineProperty")),t=i(require("./transition-interpolator")),r=require("@math.gl/core"),o=require("@math.gl/web-mercator");function i(e){return e&&e.__esModule?e:{default:e}}const u=["bearing","pitch"],s={speed:1.2,curve:1.414};class a extends t.default{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),(0,e.default)(this,"opts",void 0),this.opts={...s,...t}}interpolateProps(e,t,i){const s=(0,o.flyToViewport)(e,t,i,this.opts);for(const o of u)s[o]=(0,r.lerp)(e[o]||0,t[o]||0,i);return s}getDuration(e,t){let{transitionDuration:r}=t;return"auto"===r&&(r=(0,o.getFlyToDuration)(e,t,this.opts)),r}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./transition-interpolator":"R8fo","@math.gl/core":"dwLx","@math.gl/web-mercator":"PqV4"}],"yiMu":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("@babel/runtime/helpers/esm/defineProperty")),e=require("./iterable-utils"),i=o(require("./typed-array-manager")),s=o(require("./assert")),r=require("@luma.gl/webgl");function o(t){return t&&t.__esModule?t:{default:t}}class a{constructor(e){(0,t.default)(this,"opts",void 0),(0,t.default)(this,"typedArrayManager",void 0),(0,t.default)(this,"indexStarts",[0]),(0,t.default)(this,"vertexStarts",[0]),(0,t.default)(this,"vertexCount",0),(0,t.default)(this,"instanceCount",0),(0,t.default)(this,"attributes",void 0),(0,t.default)(this,"_attributeDefs",void 0),(0,t.default)(this,"data",void 0),(0,t.default)(this,"getGeometry",void 0),(0,t.default)(this,"geometryBuffer",void 0),(0,t.default)(this,"buffers",void 0),(0,t.default)(this,"positionSize",void 0),(0,t.default)(this,"normalize",void 0);const{attributes:s={}}=e;this.typedArrayManager=i.default,this.attributes={},this._attributeDefs=s,this.opts=e,this.updateGeometry(e)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:i={},getGeometry:r,geometryBuffer:o,positionFormat:a,dataChanged:n,normalize:f=!0}=this.opts;if(this.data=e,this.getGeometry=r,this.positionSize=o&&o.size||("XY"===a?2:3),this.buffers=i,this.normalize=f,o&&((0,s.default)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),f||(i.positions=o)),this.geometryBuffer=i.positions,Array.isArray(n))for(const s of n)this._rebuildGeometry(s);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}getGeometryFromBuffer(t){const i=t.value||t;return ArrayBuffer.isView(i)?(0,e.getAccessorFromBuffer)(i,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:i,buffers:s,_attributeDefs:r,typedArrayManager:o}=this;for(const a in r)if(a in s)o.release(i[a]),i[a]=null;else{const s=r[a];s.copy=e,i[a]=o.allocate(i[a],t,s)}}_forEachGeometry(t,i,s){const{data:r,getGeometry:o}=this,{iterable:a,objectInfo:n}=(0,e.createIterable)(r,i,s);for(const e of a){n.index++,t(o?o(e,n):null,n.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:i,instanceCount:s}=this;const{data:o,geometryBuffer:a}=this,{startRow:n=0,endRow:f=1/0}=t||{},u={};if(t||(e=[0],i=[0]),this.normalize||!a)this._forEachGeometry((t,e)=>{const s=t&&this.normalizeGeometry(t);u[e]=s,i[e+1]=i[e]+(s?this.getGeometrySize(s):0)},n,f),s=i[i.length-1];else if(i=o.startIndices,s=i[o.length]||0,ArrayBuffer.isView(a))s=s||a.length/this.positionSize;else if(a instanceof r.Buffer){const t=a.accessor.stride||4*this.positionSize;s=s||a.byteLength/t}else if(a.buffer){const t=a.stride||4*this.positionSize;s=s||a.buffer.byteLength/t}else if(a.value){const t=a.value,e=a.stride/t.BYTES_PER_ELEMENT||this.positionSize;s=s||t.length/e}this._allocate(s,Boolean(t)),this.indexStarts=e,this.vertexStarts=i,this.instanceCount=s;const d={};this._forEachGeometry((t,r)=>{const o=u[r]||t;d.vertexStart=i[r],d.indexStart=e[r];const a=r<i.length-1?i[r+1]:s;d.geometrySize=a-i[r],d.geometryIndex=r,this.updateGeometryAttributes(o,d)},n,f),this.vertexCount=e[e.length-1]}}exports.default=a;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","./iterable-utils":"kai7","./typed-array-manager":"yeLJ","./assert":"Txat","@luma.gl/webgl":"KdJH"}],"vvxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AmbientLight",{enumerable:!0,get:function(){return n.AmbientLight}}),Object.defineProperty(exports,"AttributeManager",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(exports,"COORDINATE_SYSTEM",{enumerable:!0,get:function(){return r.COORDINATE_SYSTEM}}),Object.defineProperty(exports,"CompositeLayer",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(exports,"Controller",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(exports,"Deck",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(exports,"DeckRenderer",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(exports,"DirectionalLight",{enumerable:!0,get:function(){return i.DirectionalLight}}),Object.defineProperty(exports,"FirstPersonController",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(exports,"FirstPersonView",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(exports,"FirstPersonViewport",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(exports,"FlyToInterpolator",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(exports,"Layer",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(exports,"LayerExtension",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(exports,"LayerManager",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(exports,"LightingEffect",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"LinearInterpolator",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(exports,"MapController",{enumerable:!0,get:function(){return V.default}}),Object.defineProperty(exports,"MapView",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(exports,"OPERATION",{enumerable:!0,get:function(){return r.OPERATION}}),Object.defineProperty(exports,"OrbitController",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(exports,"OrbitView",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(exports,"OrbitViewport",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(exports,"OrthographicController",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(exports,"OrthographicView",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(exports,"OrthographicViewport",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(exports,"PointLight",{enumerable:!0,get:function(){return o.PointLight}}),Object.defineProperty(exports,"PostProcessEffect",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(exports,"TRANSITION_EVENTS",{enumerable:!0,get:function(){return R.TRANSITION_EVENTS}}),Object.defineProperty(exports,"Tesselator",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(exports,"TransitionInterpolator",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(exports,"UNIT",{enumerable:!0,get:function(){return r.UNIT}}),Object.defineProperty(exports,"VERSION",{enumerable:!0,get:function(){return e.VERSION}}),Object.defineProperty(exports,"View",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(exports,"Viewport",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(exports,"WebMercatorViewport",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(exports,"_CameraLight",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"_GlobeController",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(exports,"_GlobeView",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(exports,"_GlobeViewport",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(exports,"_LayersPass",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"_PickLayersPass",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(exports,"_SunLight",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(exports,"_compareProps",{enumerable:!0,get:function(){return X.compareProps}}),Object.defineProperty(exports,"_count",{enumerable:!0,get:function(){return H.count}}),Object.defineProperty(exports,"_deepEqual",{enumerable:!0,get:function(){return J.deepEqual}}),Object.defineProperty(exports,"_fillArray",{enumerable:!0,get:function(){return B.fillArray}}),Object.defineProperty(exports,"_flatten",{enumerable:!0,get:function(){return B.flatten}}),Object.defineProperty(exports,"_memoize",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(exports,"_mergeShaders",{enumerable:!0,get:function(){return Q.mergeShaders}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(exports,"createIterable",{enumerable:!0,get:function(){return U.createIterable}}),Object.defineProperty(exports,"fp64LowPart",{enumerable:!0,get:function(){return Y.fp64LowPart}}),Object.defineProperty(exports,"gouraudLighting",{enumerable:!0,get:function(){return h.gouraudLighting}}),Object.defineProperty(exports,"log",{enumerable:!0,get:function(){return G.default}}),Object.defineProperty(exports,"phongLighting",{enumerable:!0,get:function(){return h.phongLighting}}),Object.defineProperty(exports,"picking",{enumerable:!0,get:function(){return h.picking}}),Object.defineProperty(exports,"project",{enumerable:!0,get:function(){return h.project}}),Object.defineProperty(exports,"project32",{enumerable:!0,get:function(){return h.project32}}),Object.defineProperty(exports,"shadow",{enumerable:!0,get:function(){return h.shadow}});var e=require("./lib/init"),r=require("./lib/constants"),t=Z(require("./effects/lighting/lighting-effect")),n=require("./effects/lighting/ambient-light"),i=require("./effects/lighting/directional-light"),o=require("./effects/lighting/point-light"),u=Z(require("./effects/lighting/camera-light")),l=Z(require("./effects/lighting/sun-light")),a=Z(require("./effects/post-process-effect")),f=Z(require("./passes/layers-pass")),p=Z(require("./passes/pick-layers-pass")),c=Z(require("./lib/deck")),s=Z(require("./lib/layer-manager")),b=Z(require("./lib/attribute/attribute-manager")),g=Z(require("./lib/layer")),d=Z(require("./lib/composite-layer")),m=Z(require("./lib/deck-renderer")),O=Z(require("./viewports/viewport")),y=Z(require("./viewports/web-mercator-viewport")),P=Z(require("./viewports/globe-viewport")),j=Z(require("./viewports/orbit-viewport")),x=Z(require("./viewports/orthographic-viewport")),q=Z(require("./viewports/first-person-viewport")),h=require("./shaderlib"),w=Z(require("./views/view")),v=Z(require("./views/map-view")),L=Z(require("./views/first-person-view")),_=Z(require("./views/orbit-view")),E=Z(require("./views/orthographic-view")),I=Z(require("./views/globe-view")),T=Z(require("./controllers/controller")),V=Z(require("./controllers/map-controller")),N=Z(require("./controllers/globe-controller")),S=Z(require("./controllers/first-person-controller")),A=Z(require("./controllers/orbit-controller")),C=Z(require("./controllers/orthographic-controller")),M=Z(require("./lib/layer-extension")),R=require("./controllers/transition-manager"),k=Z(require("./transitions/transition-interpolator")),D=Z(require("./transitions/linear-interpolator")),F=Z(require("./transitions/fly-to-interpolator")),G=Z(require("./utils/log")),z=Z(require("./utils/assert")),U=require("./utils/iterable-utils"),Y=require("./utils/math-utils"),W=Z(require("./utils/tesselator")),B=require("./utils/flatten"),H=require("./utils/count"),J=require("./utils/deep-equal"),K=Z(require("./utils/memoize")),Q=require("./utils/shader"),X=require("./lifecycle/props");function Z(e){return e&&e.__esModule?e:{default:e}}
},{"./lib/init":"N6pv","./lib/constants":"ysbg","./effects/lighting/lighting-effect":"MByF","./effects/lighting/ambient-light":"kPtk","./effects/lighting/directional-light":"n3wt","./effects/lighting/point-light":"yBNR","./effects/lighting/camera-light":"xYso","./effects/lighting/sun-light":"hMy0","./effects/post-process-effect":"QgRQ","./passes/layers-pass":"oM9Q","./passes/pick-layers-pass":"WJJZ","./lib/deck":"ruUO","./lib/layer-manager":"m8xf","./lib/attribute/attribute-manager":"wT56","./lib/layer":"xVVm","./lib/composite-layer":"dK5R","./lib/deck-renderer":"J3c9","./viewports/viewport":"HjGN","./viewports/web-mercator-viewport":"Rf6Y","./viewports/globe-viewport":"DUOV","./viewports/orbit-viewport":"twQX","./viewports/orthographic-viewport":"cs0l","./viewports/first-person-viewport":"qAaj","./shaderlib":"vZnx","./views/view":"k6Eh","./views/map-view":"wDMu","./views/first-person-view":"EN53","./views/orbit-view":"gGaz","./views/orthographic-view":"d3vQ","./views/globe-view":"WZeT","./controllers/controller":"ugw5","./controllers/map-controller":"N44t","./controllers/globe-controller":"JDk6","./controllers/first-person-controller":"Egne","./controllers/orbit-controller":"o35a","./controllers/orthographic-controller":"osBw","./lib/layer-extension":"TXTo","./controllers/transition-manager":"awSe","./transitions/transition-interpolator":"R8fo","./transitions/linear-interpolator":"bGRb","./transitions/fly-to-interpolator":"PVme","./utils/log":"GVus","./utils/assert":"Txat","./utils/iterable-utils":"kai7","./utils/math-utils":"ki6G","./utils/tesselator":"yiMu","./utils/flatten":"gSVO","./utils/count":"nzk4","./utils/deep-equal":"KSag","./utils/memoize":"uXG5","./utils/shader":"NycH","./lifecycle/props":"UiIs"}],"tyPT":[function(require,module,exports) {
var define;
var t;!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("leaflet"),require("@deck.gl/core")):"function"==typeof t&&t.amd?t(["exports","leaflet","@deck.gl/core"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).DeckGlLeaflet={},e.L,e.deck)}(this,function(t,e,n){"use strict";var o=function(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:function(){return t[n]}})}}),e.default=t,Object.freeze(e)}(e);function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach(function(e){u(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function p(t){return{longitude:t.getCenter().lng,latitude:t.getCenter().lat,zoom:t.getZoom()-1,pitch:0,bearing:0}}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,o=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?r(t):e}(this,n)}}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,o.Layer);var e,c,s=h(l);function l(t){var e;return function(t,e){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),u(r(e=s.call(this)),"_container",void 0),u(r(e),"_deck",void 0),u(r(e),"_animate",void 0),e.props=t,e}return e=l,(c=[{key:"onAdd",value:function(){return this._container=o.DomUtil.create("div"),this._container.className="leaflet-layer",this._zoomAnimated&&o.DomUtil.addClass(this._container,"leaflet-zoom-animated"),this.getPane().appendChild(this._container),this._deck=function(t,e,o,i){if(!o){var r=p(t);o=new n.Deck(f(f({},i),{},{parent:e,controller:!1,style:{zIndex:"auto"},viewState:r}))}return o}(this._map,this._container,this._deck,this.props),this._update(),this}},{key:"onRemove",value:function(t){return o.DomUtil.remove(this._container),this._container=void 0,this._deck.finalize(),this._deck=void 0,this}},{key:"getEvents",value:function(){var t={viewreset:this._reset,movestart:this._onMoveStart,moveend:this._onMoveEnd,zoomstart:this._onZoomStart,zoom:this._onZoom,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t}},{key:"setProps",value:function(t){Object.assign(this.props,t),this._deck&&this._deck.setProps(t)}},{key:"pickObject",value:function(t){return this._deck&&this._deck.pickObject(t)}},{key:"pickMultipleObjects",value:function(t){return this._deck&&this._deck.pickMultipleObjects(t)}},{key:"pickObjects",value:function(t){return this._deck&&this._deck.pickObjects(t)}},{key:"_update",value:function(){if(!this._map._animatingZoom){var t=this._map.getSize();this._container.style.width="".concat(t.x,"px"),this._container.style.height="".concat(t.y,"px");var e,n,i=this._map._getMapPanePos().multiplyBy(-1);o.DomUtil.setPosition(this._container,i),e=this._deck,n=p(this._map),e.setProps({viewState:n}),e.redraw(!1)}}},{key:"_pauseAnimation",value:function(){this._deck.props._animate&&(this._animate=this._deck.props._animate,this._deck.setProps({_animate:!1}))}},{key:"_unpauseAnimation",value:function(){this._animate&&(this._deck.setProps({_animate:this._animate}),this._animate=void 0)}},{key:"_reset",value:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom()),this._update()}},{key:"_onMoveStart",value:function(){this._pauseAnimation()}},{key:"_onMoveEnd",value:function(){this._update(),this._unpauseAnimation()}},{key:"_onZoomStart",value:function(){this._pauseAnimation()}},{key:"_onAnimZoom",value:function(t){this._updateTransform(t.center,t.zoom)}},{key:"_onZoom",value:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())}},{key:"_onZoomEnd",value:function(){this._unpauseAnimation()}},{key:"_updateTransform",value:function(t,e){var n=this._map.getZoomScale(e,this._map.getZoom()),i=o.DomUtil.getPosition(this._container),r=this._map.getSize().multiplyBy(.5),a=this._map.project(this._map.getCenter(),e),c=this._map.project(t,e).subtract(a),s=r.multiplyBy(-n).add(i).add(r).subtract(c);o.Browser.any3d?o.DomUtil.setTransform(this._container,s,n):o.DomUtil.setPosition(this._container,s)}}])&&i(e.prototype,c),l}();t.LeafletLayer=_,Object.defineProperty(t,"__esModule",{value:!0})});
},{"leaflet":"H1SE","@deck.gl/core":"vvxL"}],"ThfJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t="#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(curr, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n";exports.default=t;
},{}],"I6hY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=n;
},{}],"x0jA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("@luma.gl/core"),i=a(require("./arc-layer-vertex.glsl")),r=a(require("./arc-layer-fragment.glsl"));function a(e){return e&&e.__esModule?e:{default:e}}const o=[0,0,0,255],n={getSourcePosition:{type:"accessor",value:e=>e.sourcePosition},getTargetPosition:{type:"accessor",value:e=>e.targetPosition},getSourceColor:{type:"accessor",value:o},getTargetColor:{type:"accessor",value:o},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class l extends t.Layer{constructor(...t){super(...t),(0,e.default)(this,"state",void 0)}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:i.default,fs:r.default,modules:[t.project32,t.picking]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:o},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:o},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var t;const{gl:e}=this.context;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:s,widthScale:i,widthMinPixels:r,widthMaxPixels:a,greatCircle:o,wrapLongitude:n}=this.props;this.state.model.setUniforms(e).setUniforms({greatCircle:o,widthUnits:t.UNIT[s],widthScale:i,widthMinPixels:r,widthMaxPixels:a,useShortestPath:n}).draw()}_getModel(e){let t=[];for(let s=0;s<50;s++)t=t.concat([s,1,0,s,-1,0]);const i=new s.Model(e,{...this.getShaders(),id:this.props.id,geometry:new s.Geometry({drawMode:5,attributes:{positions:new Float32Array(t)}}),isInstanced:!0});return i.setUniforms({numSegments:50}),i}}exports.default=l,(0,e.default)(l,"layerName","ArcLayer"),(0,e.default)(l,"defaultProps",n);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./arc-layer-vertex.glsl":"ThfJ","./arc-layer-fragment.glsl":"I6hY"}],"qfl3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=n;var t=require("@math.gl/core");const e=new Uint16Array([0,2,1,0,3,2]),r=new Float32Array([0,1,0,0,1,0,1,1]);function n(t,e){if(!e)return o(t);const r=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),n=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),s=Math.ceil(r/e)+1,i=Math.ceil(n/e)+1,l=(s-1)*(i-1)*6,c=new Uint32Array(l),u=new Float32Array(s*i*2),h=new Float64Array(s*i*3);let f=0,M=0;for(let o=0;o<s;o++){const e=o/(s-1);for(let r=0;r<i;r++){const n=r/(i-1),s=a(t,e,n);h[3*f+0]=s[0],h[3*f+1]=s[1],h[3*f+2]=s[2]||0,u[2*f+0]=e,u[2*f+1]=1-n,o>0&&r>0&&(c[M++]=f-i,c[M++]=f-i-1,c[M++]=f-1,c[M++]=f-i,c[M++]=f-1,c[M++]=f),f++}}return{vertexCount:l,positions:h,indices:c,texCoords:u}}function o(t){const n=new Float64Array(12);for(let e=0;e<t.length;e++)n[3*e+0]=t[e][0],n[3*e+1]=t[e][1],n[3*e+2]=t[e][2]||0;return{vertexCount:6,positions:n,indices:e,texCoords:r}}function a(e,r,n){return(0,t.lerp)((0,t.lerp)(e[0],e[1],n),(0,t.lerp)(e[3],e[2],n),r)}
},{"@math.gl/core":"dwLx"}],"DCWY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o="\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n";exports.default=o;
},{}],"mZ2d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const n="\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n";var o="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat(n,"\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive && !picking_uAttribute) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n");exports.default=o;
},{}],"hMcC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),o=require("@luma.gl/core"),i=require("@math.gl/web-mercator"),s=a(require("./create-mesh")),r=a(require("./bitmap-layer-vertex")),n=a(require("./bitmap-layer-fragment"));function a(e){return e&&e.__esModule?e:{default:e}}const l={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:t.COORDINATE_SYSTEM.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class d extends t.Layer{constructor(...t){super(...t),(0,e.default)(this,"state",void 0)}getShaders(){return super.getShaders({vs:r.default,fs:n.default,modules:[t.project32,t.picking]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);e.add({indices:{size:1,isIndexed:!0,update:e=>e.value=this.state.mesh.indices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:e=>e.value=this.state.mesh.positions,noAlloc:!0},texCoords:{size:2,update:e=>e.value=this.state.mesh.texCoords,noAlloc:!0}})}updateState({props:e,oldProps:t,changeFlags:o}){const i=this.getAttributeManager();if(o.extensionsChanged){var s;const{gl:e}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(e),i.invalidateAll()}if(e.bounds!==t.bounds){const e=this.state.mesh,t=this._createMesh();this.state.model.setVertexCount(t.vertexCount);for(const o in t)e&&e[o]!==t[o]&&i.invalidate(o);this.setState({mesh:t,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==t._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:t}=this.props,o=e.info;if(!o.color||!t)return o.bitmap=null,o;const{width:i,height:s}=t;o.index=0;const r=u(o.color),n=[Math.floor(r[0]*i),Math.floor(r[1]*s)];return o.bitmap={size:{width:i,height:s},uv:r,pixel:n},o}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let t=e;return c(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),(0,s.default)(t,this.context.viewport.resolution)}_getModel(e){return e?new o.Model(e,{...this.getShaders(),id:this.props.id,geometry:new o.Geometry({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:t,moduleParameters:o}=e,{model:i,coordinateConversion:s,bounds:r,disablePicking:n}=this.state,{image:a,desaturate:l,transparentColor:d,tintColor:u}=this.props;o.pickingActive&&n||a&&i&&i.setUniforms(t).setUniforms({bitmapTexture:a,desaturate:l,transparentColor:d.map(e=>e/255),tintColor:u.slice(0,3).map(e=>e/255),coordinateConversion:s,bounds:r}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:o,DEFAULT:s}=t.COORDINATE_SYSTEM;let{_imageCoordinateSystem:r}=this.props;if(r!==s){const{bounds:t}=this.props;if(!c(t))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const s=this.context.viewport.resolution?e:o;if((r=r===e?e:o)===e&&s===o)return{coordinateConversion:-1,bounds:t};if(r===o&&s===e){const e=(0,i.lngLatToWorld)([t[0],t[1]]),o=(0,i.lngLatToWorld)([t[2],t[3]]);return{coordinateConversion:1,bounds:[e[0],e[1],o[0],o[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function u(e){const[t,o,i]=e;return[(t+(15&i)/16)/256,(o+(240&i)/256)/256]}function c(e){return Number.isFinite(e[0])}exports.default=d,(0,e.default)(d,"layerName","BitmapLayer"),(0,e.default)(d,"defaultProps",l);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","@math.gl/web-mercator":"PqV4","./create-mesh":"qfl3","./bitmap-layer-vertex":"DCWY","./bitmap-layer-fragment":"mZ2d"}],"vmNi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n";exports.default=n;
},{}],"bSNg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o="#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=o;
},{}],"r4Lr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildMapping=g,exports.default=void 0,exports.getDiffIcons=_;var t=n(require("@babel/runtime/helpers/esm/defineProperty")),e=require("@luma.gl/core"),i=require("@loaders.gl/core"),s=require("@deck.gl/core");function n(t){return t&&t.__esModule?t:{default:t}}const a=1024,h=4,r=()=>{},o={10241:9987,10240:9729,10242:33071,10243:33071};function u(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function l(t,e,i,s){const n=Math.min(i/e.width,s/e.height),a=Math.floor(e.width*n),h=Math.floor(e.height*n);return 1===n?{data:e,width:a,height:h}:(t.canvas.height=h,t.canvas.width=a,t.clearRect(0,0,a,h),t.drawImage(e,0,0,e.width,e.height,0,0,a,h),{data:t.canvas,width:a,height:h})}function d(t){return t&&(t.id||t.url)}function c(t,i,s,n){const a=t.width,h=t.height,r=new e.Texture2D(t.gl,{width:i,height:s,parameters:n});return(0,e.copyToTexture)(t,r,{targetY:0,width:a,height:h}),t.delete(),r}function f(t,e,i){for(let s=0;s<e.length;s++){const{icon:n,xOffset:a}=e[s];t[d(n)]={...n,x:a,y:i}}}function g({icons:t,buffer:e,mapping:i={},xOffset:s=0,yOffset:n=0,rowHeight:a=0,canvasWidth:h}){let r=[];for(let o=0;o<t.length;o++){const u=t[o];if(!i[d(u)]){const{height:t,width:o}=u;s+o+e>h&&(f(i,r,n),s=0,n=a+n+e,a=0,r=[]),r.push({icon:u,xOffset:s}),s=s+o+e,a=Math.max(a,t)}}return r.length>0&&f(i,r,n),{mapping:i,rowHeight:a,xOffset:s,yOffset:n,canvasWidth:h,canvasHeight:u(a+n+e)}}function _(t,e,i){if(!t||!e)return null;i=i||{};const n={},{iterable:a,objectInfo:h}=(0,s.createIterable)(t);for(const s of a){h.index++;const t=e(s,h),a=d(t);if(!t)throw new Error("Icon is missing.");if(!t.url)throw new Error("Icon url is missing.");n[a]||i[a]&&t.url===i[a].url||(n[a]={...t,source:s,sourceIndex:h.index})}return n}class p{constructor(e,{onUpdate:i=r,onError:s=r}){(0,t.default)(this,"gl",void 0),(0,t.default)(this,"onUpdate",void 0),(0,t.default)(this,"onError",void 0),(0,t.default)(this,"_loadOptions",null),(0,t.default)(this,"_texture",null),(0,t.default)(this,"_externalTexture",null),(0,t.default)(this,"_mapping",{}),(0,t.default)(this,"_textureParameters",null),(0,t.default)(this,"_pendingCount",0),(0,t.default)(this,"_autoPacking",!1),(0,t.default)(this,"_xOffset",0),(0,t.default)(this,"_yOffset",0),(0,t.default)(this,"_rowHeight",0),(0,t.default)(this,"_buffer",h),(0,t.default)(this,"_canvasWidth",a),(0,t.default)(this,"_canvasHeight",0),(0,t.default)(this,"_canvas",null),this.gl=e,this.onUpdate=i,this.onError=s}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?d(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:i,iconMapping:s,textureParameters:n}){var a;(t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),s&&(this._mapping=s),i)&&(null===(a=this._texture)||void 0===a||a.delete(),this._texture=null,this._externalTexture=i);n&&(this._textureParameters=n)}get isLoaded(){return 0===this._pendingCount}packIcons(t,i){if(!this._autoPacking||"undefined"==typeof document)return;const s=Object.values(_(t,i,this._mapping)||{});if(s.length>0){const{mapping:t,xOffset:i,yOffset:n,rowHeight:a,canvasHeight:h}=g({icons:s,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=t,this._xOffset=i,this._yOffset=n,this._canvasHeight=h,this._texture||(this._texture=new e.Texture2D(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||o})),this._texture.height!==this._canvasHeight&&(this._texture=c(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||o)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(s)}}_loadIcons(t){const e=this._canvas.getContext("2d",{willReadFrequently:!0});for(const s of t)this._pendingCount++,(0,i.load)(s.url,this._loadOptions).then(t=>{const i=d(s),n=this._mapping[i],{x:a,y:h,width:r,height:o}=n,{data:u,width:c,height:f}=l(e,t,r,o);this._texture.setSubImageData({data:u,x:a+(r-c)/2,y:h+(o-f)/2,width:c,height:f}),n.width=c,n.height=f,this._texture.generateMipmap(),this.onUpdate()}).catch(t=>{this.onError({url:s.url,source:s.source,sourceIndex:s.sourceIndex,loadOptions:this._loadOptions,error:t})}).finally(()=>{this._pendingCount--})}}exports.default=p;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","@loaders.gl/core":"ikKD","@deck.gl/core":"vvxL"}],"NHB3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("@luma.gl/core"),a=o(require("./icon-layer-vertex.glsl")),i=o(require("./icon-layer-fragment.glsl")),n=o(require("./icon-manager"));function o(e){return e&&e.__esModule?e:{default:e}}const r=[0,0,0,255],l={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:r},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class c extends t.Layer{constructor(...t){super(...t),(0,e.default)(this,"state",void 0)}getShaders(){return super.getShaders({vs:a.default,fs:i.default,modules:[t.project32,t.picking]})}initializeState(){this.state={iconManager:new n.default(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:r},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:s,changeFlags:a}=e,i=this.getAttributeManager(),{iconAtlas:n,iconMapping:o,data:r,getIcon:l,textureParameters:c}=t,{iconManager:g}=this.state,u=n||this.internalState.isAsyncPropLoading("iconAtlas");if(g.setProps({loadOptions:t.loadOptions,autoPacking:!u,iconAtlas:n,iconMapping:u?o:null,textureParameters:c}),u?s.iconMapping!==t.iconMapping&&i.invalidate("getIcon"):(a.dataChanged||a.updateTriggersChanged&&(a.updateTriggersChanged.all||a.updateTriggersChanged.getIcon))&&g.packIcons(r,l),a.extensionsChanged){var d;const{gl:e}=this.context;null===(d=this.state.model)||void 0===d||d.delete(),this.state.model=this._getModel(e),i.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:s,sizeMinPixels:a,sizeMaxPixels:i,sizeUnits:n,billboard:o,alphaCutoff:r}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:t.UNIT[n],sizeScale:s,sizeMinPixels:a,sizeMaxPixels:i,billboard:o,alphaCutoff:r}).draw()}_getModel(e){return new s.Model(e,{...this.getShaders(),id:this.props.id,geometry:new s.Geometry({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var s;const a=null===(s=this.getCurrentLayer())||void 0===s?void 0:s.props.onIconError;a?a(e):t.log.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:s,anchorX:a=t/2,anchorY:i=s/2}=this.state.iconManager.getIconMapping(e);return[t/2-a,s/2-i]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:s,width:a,height:i}=this.state.iconManager.getIconMapping(e);return[t,s,a,i]}}exports.default=c,(0,e.default)(c,"defaultProps",l),(0,e.default)(c,"layerName","IconLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./icon-layer-vertex.glsl":"vmNi","./icon-layer-fragment.glsl":"bSNg","./icon-manager":"r4Lr"}],"pFFP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e="#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(p, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n";exports.default=e;
},{}],"hY8X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e="#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=e;
},{}],"RubV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),i=require("@luma.gl/core"),s=a(require("./line-layer-vertex.glsl")),r=a(require("./line-layer-fragment.glsl"));function a(e){return e&&e.__esModule?e:{default:e}}const o=[0,0,0,255],n={getSourcePosition:{type:"accessor",value:e=>e.sourcePosition},getTargetPosition:{type:"accessor",value:e=>e.targetPosition},getColor:{type:"accessor",value:o},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class l extends t.Layer{getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:s.default,fs:r.default,modules:[t.project32,t.picking]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var t;const{gl:e}=this.context;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:i,widthScale:s,widthMinPixels:r,widthMaxPixels:a,wrapLongitude:o}=this.props;this.state.model.setUniforms(e).setUniforms({widthUnits:t.UNIT[i],widthScale:s,widthMinPixels:r,widthMaxPixels:a,useShortestPath:o?1:0}).draw(),o&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(e){return new i.Model(e,{...this.getShaders(),id:this.props.id,geometry:new i.Geometry({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0})}}exports.default=l,(0,e.default)(l,"layerName","LineLayer"),(0,e.default)(l,"defaultProps",n);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./line-layer-vertex.glsl":"pFFP","./line-layer-fragment.glsl":"hY8X"}],"PBJe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o="#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n";exports.default=o;
},{}],"v8Zu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=n;
},{}],"cUWd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("@luma.gl/core"),i=o(require("./point-cloud-layer-vertex.glsl")),a=o(require("./point-cloud-layer-fragment.glsl"));function o(e){return e&&e.__esModule?e:{default:e}}const r=[0,0,0,255],n=[0,0,1],l={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:e=>e.position},getNormal:{type:"accessor",value:n},getColor:{type:"accessor",value:r},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function d(e){const{header:t,attributes:s}=e;t&&s&&(e.length=t.vertexCount,s.POSITION&&(s.instancePositions=s.POSITION),s.NORMAL&&(s.instanceNormals=s.NORMAL),s.COLOR_0&&(s.instanceColors=s.COLOR_0))}class u extends t.Layer{getShaders(){return super.getShaders({vs:i.default,fs:a.default,modules:[t.project32,t.gouraudLighting,t.picking]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:n},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:r}})}updateState(e){const{changeFlags:t,props:s}=e;if(super.updateState(e),t.extensionsChanged){var i;const{gl:e}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}t.dataChanged&&d(s.data)}draw({uniforms:e}){const{pointSize:s,sizeUnits:i}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:t.UNIT[i],radiusPixels:s}).draw()}_getModel(e){const t=[];for(let s=0;s<3;s++){const e=s/3*Math.PI*2;t.push(2*Math.cos(e),2*Math.sin(e),0)}return new s.Model(e,{...this.getShaders(),id:this.props.id,geometry:new s.Geometry({drawMode:4,attributes:{positions:new Float32Array(t)}}),isInstanced:!0})}}exports.default=u,(0,e.default)(u,"layerName","PointCloudLayer"),(0,e.default)(u,"defaultProps",l);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./point-cloud-layer-vertex.glsl":"PBJe","./point-cloud-layer-fragment.glsl":"v8Zu"}],"cDzh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i="#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n";exports.default=i;
},{}],"YtWs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=n;
},{}],"s9mM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),i=require("@luma.gl/core"),s=l(require("./scatterplot-layer-vertex.glsl")),a=l(require("./scatterplot-layer-fragment.glsl"));function l(e){return e&&e.__esModule?e:{default:e}}const r=[0,0,0,255],n={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:r},getLineColor:{type:"accessor",value:r},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class o extends t.Layer{getShaders(){return super.getShaders({vs:s.default,fs:a.default,modules:[t.project32,t.picking]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var t;const{gl:e}=this.context;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:i,radiusScale:s,radiusMinPixels:a,radiusMaxPixels:l,stroked:r,filled:n,billboard:o,antialiasing:d,lineWidthUnits:u,lineWidthScale:c,lineWidthMinPixels:p,lineWidthMaxPixels:g}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:r?1:0,filled:n,billboard:o,antialiasing:d,radiusUnits:t.UNIT[i],radiusScale:s,radiusMinPixels:a,radiusMaxPixels:l,lineWidthUnits:t.UNIT[u],lineWidthScale:c,lineWidthMinPixels:p,lineWidthMaxPixels:g}).draw()}_getModel(e){return new i.Model(e,{...this.getShaders(),id:this.props.id,geometry:new i.Geometry({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}exports.default=o,(0,e.default)(o,"defaultProps",n),(0,e.default)(o,"layerName","ScatterplotLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./scatterplot-layer-vertex.glsl":"cDzh","./scatterplot-layer-fragment.glsl":"YtWs"}],"rrZl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WINDING=void 0,exports.forEachSegmentInPolygon=s,exports.forEachSegmentInPolygonPoints=u,exports.getPolygonSignedArea=r,exports.getPolygonSignedAreaPoints=c,exports.getPolygonWindingDirection=o,exports.getPolygonWindingDirectionPoints=g,exports.modifyPolygonWindingDirection=e,exports.modifyPolygonWindingDirectionPoints=l;var t=require("@math.gl/core");const n={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function e(t,n,e={}){return o(t,e)!==n&&(i(t,e),!0)}function o(t,n={}){return Math.sign(r(t,n))}function r(t,n={}){const{start:e=0,end:o=t.length}=n,r=n.size||2;let s=0;for(let i=e,l=o-r;i<o;i+=r)s+=(t[i]-t[l])*(t[i+1]+t[l+1]),l=i;return s/2}function s(n,e,o={}){const{start:r=0,end:s=n.length,size:i=2,isClosed:l}=o,g=(s-r)/i;for(let t=0;t<g-1;++t)e(n[r+t*i],n[r+t*i+1],n[r+(t+1)*i],n[r+(t+1)*i+1],t,t+1);const c=r+(g-1)*i;l||(0,t.equals)(n[r],n[c])&&(0,t.equals)(n[r+1],n[c+1])||e(n[c],n[c+1],n[r],n[r+1],g-1,0)}function i(t,n){const{start:e=0,end:o=t.length,size:r=2}=n,s=(o-e)/r,i=Math.floor(s/2);for(let l=0;l<i;++l){const n=e+l*r,o=e+(s-1-l)*r;for(let e=0;e<r;++e){const r=t[n+e];t[n+e]=t[o+e],t[o+e]=r}}}function l(t,n,e={}){return g(t,e)!==n&&(t.reverse(),!0)}function g(t,n={}){return Math.sign(c(t,n))}function c(t,n={}){const{start:e=0,end:o=t.length}=n;let r=0;for(let s=e,i=o-1;s<o;++s)r+=(t[s][0]-t[i][0])*(t[s][1]+t[i][1]),i=s;return r/2}function u(n,e,o={}){const{start:r=0,end:s=n.length,isClosed:i}=o;for(let t=r;t<s-1;++t)e(n[t],n[t+1],t,t+1);i||(0,t.equals)(n[s-1],n[0])||e(n[s-1],n[0],s-1,0)}exports.WINDING=n;
},{"@math.gl/core":"dwLx"}],"YiDX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),i=require("@math.gl/core"),e=require("./polygon-utils");function s(t){return t&&t.__esModule?t:{default:t}}class o{constructor(e,s={}){(0,t.default)(this,"points",void 0),(0,t.default)(this,"isFlatArray",void 0),(0,t.default)(this,"options",void 0),this.points=e,this.isFlatArray=!(0,i.isArray)(e[0]),this.options={start:s.start||0,end:s.end||e.length,size:s.size||2,isClosed:s.isClosed},Object.freeze(this)}getSignedArea(){return this.isFlatArray?(0,e.getPolygonSignedArea)(this.points,this.options):(0,e.getPolygonSignedAreaPoints)(this.points,this.options)}getArea(){return Math.abs(this.getSignedArea())}getWindingDirection(){return Math.sign(this.getSignedArea())}forEachSegment(t){this.isFlatArray?(0,e.forEachSegmentInPolygon)(this.points,(i,e,s,o,n,r)=>{t([i,e],[s,o],n,r)},this.options):(0,e.forEachSegmentInPolygonPoints)(this.points,t,this.options)}modifyWindingDirection(t){return this.isFlatArray?(0,e.modifyPolygonWindingDirection)(this.points,t,this.options):(0,e.modifyPolygonWindingDirectionPoints)(this.points,t,this.options)}}exports.default=o;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@math.gl/core":"dwLx","./polygon-utils":"rrZl"}],"BeZ9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.earcut=n;var e=require("./polygon-utils");function n(e,n,x=2,i){const u=n&&n.length,y=u?n[0]*x:e.length;let o=t(e,0,y,x,!0,i&&i[0]);const l=[];if(!o||o.next===o.prev)return l;let p,v,c,s,h,Z,a;if(u&&(o=f(e,n,o,x,i)),e.length>80*x){s=v=e[0],h=c=e[1];for(let n=x;n<y;n+=x)(Z=e[n])<s&&(s=Z),(a=e[n+1])<h&&(h=a),Z>v&&(v=Z),a>c&&(c=a);p=0!==(p=Math.max(v-s,c-h))?1/p:0}return r(o,l,x,s,h,p),l}function t(n,t,x,r,i,u){let y,o;if(void 0===u&&(u=(0,e.getPolygonSignedArea)(n,{start:t,end:x,size:r})),i===u<0)for(y=t;y<x;y+=r)o=q(y,n[y],n[y+1],o);else for(y=x-r;y>=t;y-=r)o=q(y,n[y],n[y+1],o);return o&&z(o,o.next)&&(A(o),o=o.next),o}function x(e,n){if(!e)return e;n||(n=e);let t,x=e;do{if(t=!1,x.steiner||!z(x,x.next)&&0!==g(x.prev,x,x.next))x=x.next;else{if(A(x),(x=n=x.prev)===x.next)break;t=!0}}while(t||x!==n);return n}function r(e,n,t,f,l,p,v){if(!e)return;!v&&p&&s(e,f,l,p);let c,h,Z=e;for(;e.prev!==e.next;)if(c=e.prev,h=e.next,p?u(e,f,l,p):i(e))n.push(c.i/t),n.push(e.i/t),n.push(h.i/t),A(e),e=h.next,Z=h.next;else if((e=h)===Z){v?1===v?r(e=y(x(e),n,t),n,t,f,l,p,2):2===v&&o(e,n,t,f,l,p):r(x(e),n,t,f,l,p,1);break}}function i(e){const n=e.prev,t=e,x=e.next;if(g(n,t,x)>=0)return!1;let r=e.next.next;for(;r!==e.prev;){if(d(n.x,n.y,t.x,t.y,x.x,x.y,r.x,r.y)&&g(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(e,n,t,x){const r=e.prev,i=e,u=e.next;if(g(r,i,u)>=0)return!1;const y=r.x<i.x?r.x<u.x?r.x:u.x:i.x<u.x?i.x:u.x,o=r.y<i.y?r.y<u.y?r.y:u.y:i.y<u.y?i.y:u.y,f=r.x>i.x?r.x>u.x?r.x:u.x:i.x>u.x?i.x:u.x,l=r.y>i.y?r.y>u.y?r.y:u.y:i.y>u.y?i.y:u.y,p=Z(y,o,n,t,x),v=Z(f,l,n,t,x);let c=e.prevZ,s=e.nextZ;for(;c&&c.z>=p&&s&&s.z<=v;){if(c!==e.prev&&c!==e.next&&d(r.x,r.y,i.x,i.y,u.x,u.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,s!==e.prev&&s!==e.next&&d(r.x,r.y,i.x,i.y,u.x,u.y,s.x,s.y)&&g(s.prev,s,s.next)>=0)return!1;s=s.nextZ}for(;c&&c.z>=p;){if(c!==e.prev&&c!==e.next&&d(r.x,r.y,i.x,i.y,u.x,u.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;s&&s.z<=v;){if(s!==e.prev&&s!==e.next&&d(r.x,r.y,i.x,i.y,u.x,u.y,s.x,s.y)&&g(s.prev,s,s.next)>=0)return!1;s=s.nextZ}return!0}function y(e,n,t){let r=e;do{const x=r.prev,i=r.next.next;!z(x,i)&&M(x,r,r.next,i)&&P(x,i)&&P(i,x)&&(n.push(x.i/t),n.push(r.i/t),n.push(i.i/t),A(r),A(r.next),r=e=i),r=r.next}while(r!==e);return x(r)}function o(e,n,t,i,u,y){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&w(o,e)){let f=j(o,e);return o=x(o,o.next),f=x(f,f.next),r(o,n,t,i,u,y),void r(f,n,t,i,u,y)}e=e.next}o=o.next}while(o!==e)}function f(e,n,r,i,u){const y=[];let o,f,v,c,s;for(o=0,f=n.length;o<f;o++)(s=t(e,v=n[o]*i,c=o<f-1?n[o+1]*i:e.length,i,!1,u&&u[o+1]))===s.next&&(s.steiner=!0),y.push(a(s));for(y.sort(l),o=0;o<y.length;o++)p(y[o],r),r=x(r,r.next);return r}function l(e,n){return e.x-n.x}function p(e,n){if(n=v(e,n)){const t=j(n,e);x(n,n.next),x(t,t.next)}}function v(e,n){let t=n;const x=e.x,r=e.y;let i,u=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const e=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(e<=x&&e>u){if(u=e,e===x){if(r===t.y)return t;if(r===t.next.y)return t.next}i=t.x<t.next.x?t:t.next}}t=t.next}while(t!==n);if(!i)return null;if(x===u)return i;const y=i,o=i.x,f=i.y;let l,p=1/0;t=i;do{x>=t.x&&t.x>=o&&x!==t.x&&d(r<f?x:u,r,o,f,r<f?u:x,r,t.x,t.y)&&(l=Math.abs(r-t.y)/(x-t.x),P(t,e)&&(l<p||l===p&&(t.x>i.x||t.x===i.x&&c(i,t)))&&(i=t,p=l)),t=t.next}while(t!==y);return i}function c(e,n){return g(e.prev,e,n.prev)<0&&g(n.next,e,e.next)<0}function s(e,n,t,x){let r=e;do{null===r.z&&(r.z=Z(r.x,r.y,n,t,x)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,h(r)}function h(e){let n,t,x,r,i,u,y,o,f=1;do{for(r=e,e=null,o=null,x=0;r;){for(x++,u=r,i=0,t=0;t<f&&(i++,u=u.nextZ);t++);for(y=f;i>0||y>0&&u;)0!==i&&(0===y||!u||r.z<=u.z)?(n=r,r=r.nextZ,i--):(n=u,u=u.nextZ,y--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=u}o.nextZ=null,f*=2}while(x>1);return e}function Z(e,n,t,x,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-t)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-x)*r)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function a(e){let n=e,t=e;do{(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next}while(n!==e);return t}function d(e,n,t,x,r,i,u,y){return(r-u)*(n-y)-(e-u)*(i-y)>=0&&(e-u)*(x-y)-(t-u)*(n-y)>=0&&(t-u)*(i-y)-(r-u)*(x-y)>=0}function w(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!k(e,n)&&(P(e,n)&&P(n,e)&&_(e,n)&&(g(e.prev,e,n.prev)||g(e,n.prev,n))||z(e,n)&&g(e.prev,e,e.next)>0&&g(n.prev,n,n.next)>0)}function g(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function z(e,n){return e.x===n.x&&e.y===n.y}function M(e,n,t,x){const r=b(g(e,n,t)),i=b(g(e,n,x)),u=b(g(t,x,e)),y=b(g(t,x,n));return r!==i&&u!==y||(!(0!==r||!m(e,t,n))||(!(0!==i||!m(e,x,n))||(!(0!==u||!m(t,e,x))||!(0!==y||!m(t,n,x)))))}function m(e,n,t){return n.x<=Math.max(e.x,t.x)&&n.x>=Math.min(e.x,t.x)&&n.y<=Math.max(e.y,t.y)&&n.y>=Math.min(e.y,t.y)}function b(e){return e>0?1:e<0?-1:0}function k(e,n){let t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&M(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function P(e,n){return g(e.prev,e,e.next)<0?g(e,n,e.next)>=0&&g(e,e.prev,n)>=0:g(e,n,e.prev)<0||g(e,e.next,n)<0}function _(e,n){let t=e,x=!1;const r=(e.x+n.x)/2,i=(e.y+n.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&r<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(x=!x),t=t.next}while(t!==e);return x}function j(e,n){const t=new O(e.i,e.x,e.y),x=new O(n.i,n.x,n.y),r=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=r,r.prev=t,x.next=t,t.prev=x,i.next=x,x.prev=i,x}function q(e,n,t,x){const r=new O(e,n,t);return x?(r.next=x.next,r.prev=x,x.next.prev=r,x.next=r):(r.prev=r,r.next=r),r}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function O(e,n,t){this.i=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}
},{"./polygon-utils":"rrZl"}],"P0NL":[function(require,module,exports) {
"use strict";function t(t,e){const n=e.length,o=t.length;if(o>0){let r=!0;for(let f=0;f<n;f++)if(t[o-n+f]!==e[f]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[o+r]=e[r];return!0}function e(t,e){const n=e.length;for(let o=0;o<n;o++)t[o]=e[o]}function n(t,e,n,o,r=[]){const f=o+e*n;for(let s=0;s<n;s++)r[s]=t[f+s];return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.copy=e,exports.getPointAtIndex=n,exports.push=t;
},{}],"AO07":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bitCode=o,exports.clipPolygon=n,exports.clipPolyline=t,exports.intersect=r;var e=require("./utils");function t(t,n,i){const{size:l=2,startIndex:s=0,endIndex:u=t.length}=i||{},f=(u-s)/l,p=[];let d,x,c,h,g=[],I=-1;for(let a=1;a<f;a++){for(d=(0,e.getPointAtIndex)(t,a-1,l,s,d),x=(0,e.getPointAtIndex)(t,a,l,s,x),I<0&&(I=o(d,n)),c=h=o(x,n);;){if(!(I|c)){(0,e.push)(g,d),c!==h?((0,e.push)(g,x),a<f-1&&(p.push(g),g=[])):a===f-1&&(0,e.push)(g,x);break}if(I&c)break;I?(r(d,x,I,n,d),I=o(d,n)):(r(d,x,c,n,x),c=o(x,n))}I=h}return g.length&&p.push(g),p}function n(t,n,i){const{size:l=2,endIndex:s=t.length}=i||{};let u,f,p,d,x,{startIndex:c=0}=i||{},h=(s-c)/l;for(let g=1;g<=8;g*=2){u=[],x=!(o(p=(0,e.getPointAtIndex)(t,h-1,l,c,p),n)&g);for(let i=0;i<h;i++)(d=!(o(f=(0,e.getPointAtIndex)(t,i,l,c,f),n)&g))!==x&&(0,e.push)(u,r(p,f,g,n)),d&&(0,e.push)(u,f),(0,e.copy)(p,f),x=d;if(t=u,c=0,!(h=u.length/l))break}return u}function r(e,t,n,r,o=[]){let i,l;if(8&n)i=(r[3]-e[1])/(t[1]-e[1]),l=3;else if(4&n)i=(r[1]-e[1])/(t[1]-e[1]),l=1;else if(2&n)i=(r[2]-e[0])/(t[0]-e[0]),l=2;else{if(!(1&n))return null;i=(r[0]-e[0])/(t[0]-e[0]),l=0}for(let s=0;s<e.length;s++)o[s]=(1&l)===s?r[l]:i*(t[s]-e[s])+e[s];return o}function o(e,t){let n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}
},{"./utils":"P0NL"}],"Ep9P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cutPolygonByGrid=p,exports.cutPolylineByGrid=s;var t=require("./lineclip"),e=require("./utils");function s(s,n){const{size:o=2,broken:l=!1,gridResolution:p=10,gridOffset:h=[0,0],startIndex:i=0,endIndex:c=s.length}=n||{},g=(c-i)/o;let f=[];const y=[f],d=(0,e.getPointAtIndex)(s,0,o,i);let x,a;const I=r(d,p,h,[]),P=[];(0,e.push)(f,d);for(let r=1;r<g;r++){for(x=(0,e.getPointAtIndex)(s,r,o,i,x),a=(0,t.bitCode)(x,I);a;){(0,t.intersect)(d,x,a,I,P);const s=(0,t.bitCode)(P,I);s&&((0,t.intersect)(d,P,s,I,P),a=s),(0,e.push)(f,P),(0,e.copy)(d,P),u(I,p,a),l&&f.length>o&&(f=[],y.push(f),(0,e.push)(f,d)),a=(0,t.bitCode)(x,I)}(0,e.push)(f,x),(0,e.copy)(d,x)}return l?y:y[0]}const n=0,o=1;function l(t,e){for(let s=0;s<e.length;s++)t.push(e[s]);return t}function p(e,s=null,n){if(!e.length)return[];const{size:p=2,gridResolution:u=10,gridOffset:c=[0,0],edgeTypes:g=!1}=n||{},f=[],y=[{pos:e,types:g?new Array(e.length/p).fill(o):null,holes:s||[]}],d=[[],[]];let x=[];for(;y.length;){const{pos:e,types:s,holes:n}=y.shift();i(e,p,n[0]||e.length,d),x=r(d[0],u,c,x);const o=(0,t.bitCode)(d[1],x);if(o){let t=h(e,s,p,0,n[0]||e.length,x,o);const r={pos:t[0].pos,types:t[0].types,holes:[]},u={pos:t[1].pos,types:t[1].types,holes:[]};y.push(r,u);for(let i=0;i<n.length;i++)(t=h(e,s,p,n[i],n[i+1]||e.length,x,o))[0]&&(r.holes.push(r.pos.length),r.pos=l(r.pos,t[0].pos),g&&(r.types=l(r.types,t[0].types))),t[1]&&(u.holes.push(u.pos.length),u.pos=l(u.pos,t[1].pos),g&&(u.types=l(u.types,t[1].types)))}else{const t={positions:e};g&&(t.edgeTypes=s),n.length&&(t.holeIndices=n),f.push(t)}}return f}function h(s,o,l,p,h,r,u){const i=(h-p)/l,c=[],g=[],f=[],y=[],d=[];let x,a,I;const P=(0,e.getPointAtIndex)(s,i-1,l,p);let b=Math.sign(8&u?P[1]-r[3]:P[0]-r[2]),A=o&&o[i-1],M=0,C=0;for(let O=0;O<i;O++)x=(0,e.getPointAtIndex)(s,O,l,p,x),a=Math.sign(8&u?x[1]-r[3]:x[0]-r[2]),I=o&&o[p/l+O],a&&b&&b!==a&&((0,t.intersect)(P,x,u,r,d),(0,e.push)(c,d)&&f.push(A),(0,e.push)(g,d)&&y.push(A)),a<=0?((0,e.push)(c,x)&&f.push(I),M-=a):f.length&&(f[f.length-1]=n),a>=0?((0,e.push)(g,x)&&y.push(I),C+=a):y.length&&(y[y.length-1]=n),(0,e.copy)(P,x),b=a,A=I;return[M?{pos:c,types:o&&f}:null,C?{pos:g,types:o&&y}:null]}function r(t,e,s,n){const o=Math.floor((t[0]-s[0])/e)*e+s[0],l=Math.floor((t[1]-s[1])/e)*e+s[1];return n[0]=o,n[1]=l,n[2]=o+e,n[3]=l+e,n}function u(t,e,s){8&s?(t[1]+=e,t[3]+=e):4&s?(t[1]-=e,t[3]-=e):2&s?(t[0]+=e,t[2]+=e):1&s&&(t[0]-=e,t[2]-=e)}function i(t,e,s,n){let o=1/0,l=-1/0,p=1/0,h=-1/0;for(let r=0;r<s;r+=e){const e=t[r],s=t[r+1];o=e<o?e:o,l=e>l?e:l,p=s<p?s:p,h=s>h?s:h}return n[0][0]=o,n[0][1]=p,n[1][0]=l,n[1][1]=h,n}
},{"./lineclip":"AO07","./utils":"P0NL"}],"Z5gV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cutPolygonByMercatorBounds=r,exports.cutPolylineByMercatorBounds=n;var t=require("./cut-by-grid"),o=require("./utils");const e=85.051129;function n(o,e){const{size:n=2,startIndex:r=0,endIndex:s=o.length,normalize:i=!0}=e||{},c=o.slice(r,s);l(c,n,0,s-r);const f=(0,t.cutPolylineByGrid)(c,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(i)for(const t of f)u(t,n);return f}function r(o,e=null,n){const{size:r=2,normalize:c=!0,edgeTypes:f=!1}=n||{};e=e||[];const d=[],a=[];let g=0,h=0;for(let t=0;t<=e.length;t++){const u=e[t]||o.length,c=h,f=s(o,r,g,u);for(let t=f;t<u;t++)d[h++]=o[t];for(let t=g;t<f;t++)d[h++]=o[t];l(d,r,c,h),i(d,r,c,h,null==n?void 0:n.maxLatitude),g=u,a[t]=h}a.pop();const p=(0,t.cutPolygonByGrid)(d,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:f});if(c)for(const t of p)u(t.positions,r);return p}function s(t,o,e,n){let r=-1,s=-1;for(let i=e+1;i<n;i+=o){const o=Math.abs(t[i]);o>r&&(r=o,s=i-1)}return s}function i(t,n,r,s,i=e){const l=t[r],u=t[s-n];if(Math.abs(l-u)>180){const e=(0,o.getPointAtIndex)(t,0,n,r);e[0]+=360*Math.round((u-l)/360),(0,o.push)(t,e),e[1]=Math.sign(e[1])*i,(0,o.push)(t,e),e[0]=l,(0,o.push)(t,e)}}function l(t,o,e,n){let r,s=t[0];for(let i=e;i<n;i+=o){const o=(r=t[i])-s;(o>180||o<-180)&&(r-=360*Math.round(o/360)),t[i]=s=r}}function u(t,o){let e;const n=t.length/o;for(let s=0;s<n&&((e=t[s*o])+180)%360==0;s++);const r=360*-Math.round(e/360);if(0!==r)for(let s=0;s<n;s++)t[s*o]+=r}
},{"./cut-by-grid":"Ep9P","./utils":"P0NL"}],"bJcr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Polygon",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"WINDING",{enumerable:!0,get:function(){return r.WINDING}}),Object.defineProperty(exports,"_Polygon",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"clipPolygon",{enumerable:!0,get:function(){return n.clipPolygon}}),Object.defineProperty(exports,"clipPolyline",{enumerable:!0,get:function(){return n.clipPolyline}}),Object.defineProperty(exports,"cutPolygonByGrid",{enumerable:!0,get:function(){return o.cutPolygonByGrid}}),Object.defineProperty(exports,"cutPolygonByMercatorBounds",{enumerable:!0,get:function(){return u.cutPolygonByMercatorBounds}}),Object.defineProperty(exports,"cutPolylineByGrid",{enumerable:!0,get:function(){return o.cutPolylineByGrid}}),Object.defineProperty(exports,"cutPolylineByMercatorBounds",{enumerable:!0,get:function(){return u.cutPolylineByMercatorBounds}}),Object.defineProperty(exports,"earcut",{enumerable:!0,get:function(){return t.earcut}}),Object.defineProperty(exports,"forEachSegmentInPolygon",{enumerable:!0,get:function(){return r.forEachSegmentInPolygon}}),Object.defineProperty(exports,"getPolygonSignedArea",{enumerable:!0,get:function(){return r.getPolygonSignedArea}}),Object.defineProperty(exports,"getPolygonWindingDirection",{enumerable:!0,get:function(){return r.getPolygonWindingDirection}}),Object.defineProperty(exports,"modifyPolygonWindingDirection",{enumerable:!0,get:function(){return r.modifyPolygonWindingDirection}});var e=i(require("./polygon")),r=require("./polygon-utils"),t=require("./earcut"),n=require("./lineclip"),o=require("./cut-by-grid"),u=require("./cut-by-mercator-bounds");function i(e){return e&&e.__esModule?e:{default:e}}
},{"./polygon":"YiDX","./polygon-utils":"rrZl","./earcut":"BeZ9","./lineclip":"AO07","./cut-by-grid":"Ep9P","./cut-by-mercator-bounds":"Z5gV"}],"XYjb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@deck.gl/core"),t=require("@luma.gl/core"),r=require("@math.gl/polygon");class i extends t.Geometry{constructor(e){const{id:r=(0,t.uid)("column-geometry")}=e,{indices:i,attributes:s}=o(e);super({...e,id:r,indices:i,attributes:s})}}function o(t){const{radius:i,height:o=1,nradial:s=10}=t;let{vertices:a}=t;a&&(e.log.assert(a.length>=s),a=a.flatMap(e=>[e[0],e[1]]),(0,r.modifyPolygonWindingDirection)(a,r.WINDING.COUNTER_CLOCKWISE));const n=o>0,l=s+1,c=n?3*l+1:s,u=2*Math.PI/s,d=new Uint16Array(n?3*s*2:0),f=new Float32Array(3*c),g=new Float32Array(3*c);let h=0;if(n){for(let e=0;e<l;e++){const t=e*u,r=e%s,n=Math.sin(t),l=Math.cos(t);for(let e=0;e<2;e++)f[h+0]=a?a[2*r]:l*i,f[h+1]=a?a[2*r+1]:n*i,f[h+2]=(.5-e)*o,g[h+0]=a?a[2*r]:l,g[h+1]=a?a[2*r+1]:n,h+=3}f[h+0]=f[h-3],f[h+1]=f[h-2],f[h+2]=f[h-1],h+=3}for(let e=n?0:1;e<l;e++){const t=Math.floor(e/2)*Math.sign(.5-e%2),r=t*u,n=(t+s)%s,l=Math.sin(r),c=Math.cos(r);f[h+0]=a?a[2*n]:c*i,f[h+1]=a?a[2*n+1]:l*i,f[h+2]=o/2,g[h+2]=1,h+=3}if(n){let e=0;for(let t=0;t<s;t++)d[e++]=2*t+0,d[e++]=2*t+2,d[e++]=2*t+0,d[e++]=2*t+1,d[e++]=2*t+1,d[e++]=2*t+3}return{indices:d,attributes:{POSITION:{size:3,value:f},NORMAL:{size:3,value:g}}}}exports.default=i;
},{"@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","@math.gl/polygon":"bJcr"}],"OUXU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o="#version 300 es\n\n#define SHADER_NAME column-layer-vertex-shader\n\nin vec3 positions;\nin vec3 normals;\n\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\n\nin vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool stroked;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (stroked) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n    if (isStroke) {\n      strokeOffsetRatio -= sign(positions.z) * halfOffset;\n    } else {\n      strokeOffsetRatio -= halfOffset;\n    }\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n#ifdef FLAT_SHADING\n    position_commonspace = geometry.position;\n    vColor = vec4(color.rgb, color.a * opacity);\n#else\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n#endif\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n";exports.default=o;
},{}],"l85h":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o="#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nuniform vec3 project_uCameraPosition;\nuniform bool extruded;\nuniform bool isStroke;\n\nout vec4 fragColor;\n\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  fragColor = vColor;\n#ifdef FLAT_SHADING\n  if (extruded && !isStroke && !picking_uActive) {\n    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n  }\n#endif\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n";exports.default=o;
},{}],"Gz3O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("@luma.gl/core"),i=a(require("./column-geometry")),r=a(require("./column-layer-vertex.glsl")),o=a(require("./column-layer-fragment.glsl"));function a(e){return e&&e.__esModule?e:{default:e}}const n=[0,0,0,255],l={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:e=>e.position},getFillColor:{type:"accessor",value:n},getLineColor:{type:"accessor",value:n},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class d extends t.Layer{getShaders(){const{gl:e}=this.context,i=!(0,s.isWebGL2)(e),a={},n=this.props.flatShading&&(0,s.hasFeature)(e,s.FEATURES.GLSL_DERIVATIVES);return n&&(a.FLAT_SHADING=1),super.getShaders({vs:r.default,fs:o.default,defines:a,transpileToGLSL100:i,modules:[t.project32,n?t.phongLighting:t.gouraudLighting,t.picking]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:n},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:n},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:t,oldProps:s,changeFlags:i}=e,r=i.extensionsChanged||t.flatShading!==s.flatShading;if(r){var o;const{gl:e}=this.context;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}(r||t.diskResolution!==s.diskResolution||t.vertices!==s.vertices||(t.extruded||t.stroked)!==(s.extruded||s.stroked))&&this._updateGeometry(t)}getGeometry(e,t,s){const r=new i.default({radius:1,height:s?2:0,vertices:t,nradial:e});let o=0;if(t)for(let i=0;i<e;i++){const s=t[i];o+=Math.sqrt(s[0]*s[0]+s[1]*s[1])/e}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*o}),r}_getModel(e){return new s.Model(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:t,extruded:s,stroked:i}){const r=this.getGeometry(e,t,s||i);this.setState({fillVertexCount:r.attributes.POSITION.value.length/3,wireframeVertexCount:r.indices.value.length}),this.state.model.setProps({geometry:r})}draw({uniforms:e}){const{lineWidthUnits:s,lineWidthScale:i,lineWidthMinPixels:r,lineWidthMaxPixels:o,radiusUnits:a,elevationScale:n,extruded:l,filled:d,stroked:u,wireframe:c,offset:g,coverage:h,radius:p,angle:m}=this.props,{model:f,fillVertexCount:v,wireframeVertexCount:x,edgeDistance:y}=this.state;f.setUniforms(e).setUniforms({radius:p,angle:m/180*Math.PI,offset:g,extruded:l,stroked:u,coverage:h,elevationScale:n,edgeDistance:y,radiusUnits:t.UNIT[a],widthUnits:t.UNIT[s],widthScale:i,widthMinPixels:r,widthMaxPixels:o}),l&&c&&(f.setProps({isIndexed:!0}),f.setVertexCount(x).setDrawMode(1).setUniforms({isStroke:!0}).draw()),d&&(f.setProps({isIndexed:!1}),f.setVertexCount(v).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!l&&u&&(f.setProps({isIndexed:!1}),f.setVertexCount(2*v/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}exports.default=d,(0,e.default)(d,"layerName","ColumnLayer"),(0,e.default)(d,"defaultProps",l);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./column-geometry":"XYjb","./column-layer-vertex.glsl":"OUXU","./column-layer-fragment.glsl":"l85h"}],"zas9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("@babel/runtime/helpers/esm/defineProperty")),r=require("@luma.gl/core"),t=require("@deck.gl/core"),a=l(require("./column-layer"));function l(e){return e&&e.__esModule?e:{default:e}}const s={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}};class u extends a.default{getGeometry(e){return new r.CubeGeometry}draw({uniforms:e}){const{elevationScale:r,extruded:a,offset:l,coverage:s,cellSize:u,angle:i,radiusUnits:o}=this.props;this.state.model.setUniforms(e).setUniforms({radius:u/2,radiusUnits:t.UNIT[o],angle:i,offset:l,extruded:a,coverage:s,elevationScale:r,edgeDistance:1,isWireframe:!1}).draw()}}exports.default=u,(0,e.default)(u,"layerName","GridCellLayer"),(0,e.default)(u,"defaultProps",s);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@luma.gl/core":"iuAK","@deck.gl/core":"vvxL","./column-layer":"Gz3O"}],"rssX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizePath=r;var e=require("@math.gl/polygon");function r(r,t,o,l){let i;if(Array.isArray(r[0])){const e=r.length*t;i=new Array(e);for(let o=0;o<r.length;o++)for(let e=0;e<t;e++)i[o*t+e]=r[o][e]||0}else i=r;return o?(0,e.cutPolylineByGrid)(i,{size:t,gridResolution:o}):l?(0,e.cutPolylineByMercatorBounds)(i,{size:t}):i}
},{"@math.gl/polygon":"bJcr"}],"lJX3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@deck.gl/core"),e=require("./path");const r=1,i=2,s=4;class o extends t.Tesselator{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?(0,e.normalizePath)(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(n(t)){let e=0;for(const r of t)e+=this.getGeometrySize(r);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&n(t))for(const r of t){const t=this.getGeometrySize(r);e.geometrySize=t,this.updateGeometryAttributes(r,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const o=this.attributes.segmentTypes,n=!!t&&this.isClosed(t),{vertexStart:a,geometrySize:u}=e;o.fill(0,a,a+u),n?(o[a]=s,o[a+u-2]=s):(o[a]+=r,o[a+u-2]+=i),o[a+u-1]=s}_updatePositions(t,e){const{positions:r}=this.attributes;if(!r||!t)return;const{vertexStart:i,geometrySize:s}=e,o=new Array(3);for(let n=i,a=0;a<s;n++,a++)this.getPointOnPath(t,a,o),r[3*n]=o[0],r[3*n+1]=o[1],r[3*n+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,r=[]){const{positionSize:i}=this;e*i>=t.length&&(e+=1-t.length/i);const s=e*i;return r[0]=t[s],r[1]=t[s+1],r[2]=3===i&&t[s+2]||0,r}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:e}=this,r=t.length-e;return t[0]===t[r]&&t[1]===t[r+1]&&(2===e||t[2]===t[r+2])}}function n(t){return Array.isArray(t[0])}exports.default=o;
},{"@deck.gl/core":"vvxL","./path":"rssX"}],"NZD1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n";exports.default=n;
},{}],"YKcs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=n;
},{}],"Exm7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("@luma.gl/core"),i=n(require("./path-tesselator")),a=n(require("./path-layer-vertex.glsl")),r=n(require("./path-layer-fragment.glsl"));function n(e){return e&&e.__esModule?e:{default:e}}const o=[0,0,0,255],d={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:o},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},l={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class u extends t.Layer{constructor(...t){super(...t),(0,e.default)(this,"state",void 0)}getShaders(){return super.getShaders({vs:a.default,fs:r.default,modules:[t.project32,t.picking]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:l,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:l,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:l,defaultValue:o},instancePickingColors:{size:3,type:5121,accessor:(e,{index:t,target:s})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,s)}}),this.setState({pathTesselator:new i.default({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:s}=e,i=this.getAttributeManager();if(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,a=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:a.getPath,buffers:a,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:s.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),s.dataChanged||i.invalidateAll()}if(s.extensionsChanged){var a;const{gl:e}=this.context;null===(a=this.state.model)||void 0===a||a.delete(),this.state.model=this._getModel(e),i.invalidateAll()}}getPickingInfo(e){const t=super.getPickingInfo(e),{index:s}=t,{data:i}=this.props;return i[0]&&i[0].__source&&(t.object=i.find(e=>e.__source.index===s)),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let s=0;s<t.length;s++)t[s].__source.index===e&&this._disablePickingIndex(s);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:s,capRounded:i,billboard:a,miterLimit:r,widthUnits:n,widthScale:o,widthMinPixels:d,widthMaxPixels:l}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(s),capType:Number(i),billboard:a,widthUnits:t.UNIT[n],widthScale:o,miterLimit:r,widthMinPixels:d,widthMaxPixels:l}).draw()}_getModel(e){return new s.Model(e,{...this.getShaders(),id:this.props.id,geometry:new s.Geometry({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}exports.default=u,(0,e.default)(u,"defaultProps",d),(0,e.default)(u,"layerName","PathLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./path-tesselator":"lJX3","./path-layer-vertex.glsl":"NZD1","./path-layer-fragment.glsl":"YKcs"}],"d3f1":[function(require,module,exports) {
"use strict";function e(e,t,x){x=x||2;var i,u,v,o,p,a,y,h=t&&t.length,l=h?t[0]*x:e.length,s=n(e,0,l,x,!0),c=[];if(!s||s.next===s.prev)return c;if(h&&(s=f(e,t,s,x)),e.length>80*x){i=v=e[0],u=o=e[1];for(var Z=x;Z<l;Z+=x)(p=e[Z])<i&&(i=p),(a=e[Z+1])<u&&(u=a),p>v&&(v=p),a>o&&(o=a);y=0!==(y=Math.max(v-i,o-u))?32767/y:0}return r(s,c,x,i,u,y,0),c}function n(e,n,t,r,x){var i,u;if(x===D(e,n,t,r)>0)for(i=n;i<t;i+=r)u=A(i,e[i],e[i+1],u);else for(i=t-r;i>=n;i-=r)u=A(i,e[i],e[i+1],u);return u&&w(u,u.next)&&(B(u),u=u.next),u}function t(e,n){if(!e)return e;n||(n=e);var t,r=e;do{if(t=!1,r.steiner||!w(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(B(r),(r=n=r.prev)===r.next)break;t=!0}}while(t||r!==n);return n}function r(e,n,f,o,p,a,y){if(e){!y&&a&&h(e,o,p,a);for(var l,s,c=e;e.prev!==e.next;)if(l=e.prev,s=e.next,a?i(e,o,p,a):x(e))n.push(l.i/f|0),n.push(e.i/f|0),n.push(s.i/f|0),B(e),e=s.next,c=s.next;else if((e=s)===c){y?1===y?r(e=u(t(e),n,f),n,f,o,p,a,2):2===y&&v(e,n,f,o,p,a):r(t(e),n,f,o,p,a,1);break}}}function x(e){var n=e.prev,t=e,r=e.next;if(g(n,t,r)>=0)return!1;for(var x=n.x,i=t.x,u=r.x,v=n.y,f=t.y,o=r.y,p=x<i?x<u?x:u:i<u?i:u,a=v<f?v<o?v:o:f<o?f:o,y=x>i?x>u?x:u:i>u?i:u,h=v>f?v>o?v:o:f>o?f:o,l=r.next;l!==n;){if(l.x>=p&&l.x<=y&&l.y>=a&&l.y<=h&&Z(x,v,i,f,u,o,l.x,l.y)&&g(l.prev,l,l.next)>=0)return!1;l=l.next}return!0}function i(e,n,t,r){var x=e.prev,i=e,u=e.next;if(g(x,i,u)>=0)return!1;for(var v=x.x,f=i.x,o=u.x,p=x.y,a=i.y,y=u.y,h=v<f?v<o?v:o:f<o?f:o,l=p<a?p<y?p:y:a<y?a:y,c=v>f?v>o?v:o:f>o?f:o,d=p>a?p>y?p:y:a>y?a:y,w=s(h,l,n,t,r),M=s(c,d,n,t,r),z=e.prevZ,m=e.nextZ;z&&z.z>=w&&m&&m.z<=M;){if(z.x>=h&&z.x<=c&&z.y>=l&&z.y<=d&&z!==x&&z!==u&&Z(v,p,f,a,o,y,z.x,z.y)&&g(z.prev,z,z.next)>=0)return!1;if(z=z.prevZ,m.x>=h&&m.x<=c&&m.y>=l&&m.y<=d&&m!==x&&m!==u&&Z(v,p,f,a,o,y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;z&&z.z>=w;){if(z.x>=h&&z.x<=c&&z.y>=l&&z.y<=d&&z!==x&&z!==u&&Z(v,p,f,a,o,y,z.x,z.y)&&g(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;m&&m.z<=M;){if(m.x>=h&&m.x<=c&&m.y>=l&&m.y<=d&&m!==x&&m!==u&&Z(v,p,f,a,o,y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function u(e,n,r){var x=e;do{var i=x.prev,u=x.next.next;!w(i,u)&&M(i,x,x.next,u)&&k(i,u)&&k(u,i)&&(n.push(i.i/r|0),n.push(x.i/r|0),n.push(u.i/r|0),B(x),B(x.next),x=e=u),x=x.next}while(x!==e);return t(x)}function v(e,n,x,i,u,v){var f=e;do{for(var o=f.next.next;o!==f.prev;){if(f.i!==o.i&&d(f,o)){var p=q(f,o);return f=t(f,f.next),p=t(p,p.next),r(f,n,x,i,u,v,0),void r(p,n,x,i,u,v,0)}o=o.next}f=f.next}while(f!==e)}function f(e,t,r,x){var i,u,v,f=[];for(i=0,u=t.length;i<u;i++)(v=n(e,t[i]*x,i<u-1?t[i+1]*x:e.length,x,!1))===v.next&&(v.steiner=!0),f.push(c(v));for(f.sort(o),i=0;i<f.length;i++)r=p(f[i],r);return r}function o(e,n){return e.x-n.x}function p(e,n){var r=a(e,n);if(!r)return n;var x=q(r,e);return t(x,x.next),t(r,r.next)}function a(e,n){var t,r=n,x=e.x,i=e.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var v=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(v<=x&&v>u&&(u=v,t=r.x<r.next.x?r:r.next,v===x))return t}r=r.next}while(r!==n);if(!t)return null;var f,o=t,p=t.x,a=t.y,h=1/0;r=t;do{x>=r.x&&r.x>=p&&x!==r.x&&Z(i<a?x:u,i,p,a,i<a?u:x,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(x-r.x),k(r,e)&&(f<h||f===h&&(r.x>t.x||r.x===t.x&&y(t,r)))&&(t=r,h=f)),r=r.next}while(r!==o);return t}function y(e,n){return g(e.prev,e,n.prev)<0&&g(n.next,e,e.next)<0}function h(e,n,t,r){var x=e;do{0===x.z&&(x.z=s(x.x,x.y,n,t,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,l(x)}function l(e){var n,t,r,x,i,u,v,f,o=1;do{for(t=e,e=null,i=null,u=0;t;){for(u++,r=t,v=0,n=0;n<o&&(v++,r=r.nextZ);n++);for(f=o;v>0||f>0&&r;)0!==v&&(0===f||!r||t.z<=r.z)?(x=t,t=t.nextZ,v--):(x=r,r=r.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;t=r}i.nextZ=null,o*=2}while(u>1);return e}function s(e,n,t,r,x){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-t)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*x|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function c(e){var n=e,t=e;do{(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next}while(n!==e);return t}function Z(e,n,t,r,x,i,u,v){return(x-u)*(n-v)>=(e-u)*(i-v)&&(e-u)*(r-v)>=(t-u)*(n-v)&&(t-u)*(i-v)>=(x-u)*(r-v)}function d(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!b(e,n)&&(k(e,n)&&k(n,e)&&j(e,n)&&(g(e.prev,e,n.prev)||g(e,n.prev,n))||w(e,n)&&g(e.prev,e,e.next)>0&&g(n.prev,n,n.next)>0)}function g(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function w(e,n){return e.x===n.x&&e.y===n.y}function M(e,n,t,r){var x=m(g(e,n,t)),i=m(g(e,n,r)),u=m(g(t,r,e)),v=m(g(t,r,n));return x!==i&&u!==v||(!(0!==x||!z(e,t,n))||(!(0!==i||!z(e,r,n))||(!(0!==u||!z(t,e,r))||!(0!==v||!z(t,n,r)))))}function z(e,n,t){return n.x<=Math.max(e.x,t.x)&&n.x>=Math.min(e.x,t.x)&&n.y<=Math.max(e.y,t.y)&&n.y>=Math.min(e.y,t.y)}function m(e){return e>0?1:e<0?-1:0}function b(e,n){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&M(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function k(e,n){return g(e.prev,e,e.next)<0?g(e,n,e.next)>=0&&g(e,e.prev,n)>=0:g(e,n,e.prev)<0||g(e,e.next,n)<0}function j(e,n){var t=e,r=!1,x=(e.x+n.x)/2,i=(e.y+n.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&x<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next}while(t!==e);return r}function q(e,n){var t=new C(e.i,e.x,e.y),r=new C(n.i,n.x,n.y),x=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=x,x.prev=t,r.next=t,t.prev=r,i.next=r,r.prev=i,r}function A(e,n,t,r){var x=new C(e,n,t);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function B(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,n,t){this.i=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(e,n,t,r){for(var x=0,i=n,u=t-r;i<t;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}module.exports=e,module.exports.default=e,e.deviation=function(e,n,t,r){var x=n&&n.length,i=x?n[0]*t:e.length,u=Math.abs(D(e,0,i,t));if(x)for(var v=0,f=n.length;v<f;v++){var o=n[v]*t,p=v<f-1?n[v+1]*t:e.length;u-=Math.abs(D(e,o,p,t))}var a=0;for(v=0;v<r.length;v+=3){var y=r[v]*t,h=r[v+1]*t,l=r[v+2]*t;a+=Math.abs((e[y]-e[l])*(e[h+1]-e[y+1])-(e[y]-e[h])*(e[l+1]-e[y+1]))}return 0===u&&0===a?0:Math.abs((a-u)/u)},e.flatten=function(e){for(var n=e[0][0].length,t={vertices:[],holes:[],dimensions:n},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;u<n;u++)t.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,t.holes.push(r))}return t};
},{}],"dIsy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getHoleIndices=u,exports.getPositions=l,exports.getSurfaceIndices=m,exports.normalize=a;var n=e(require("earcut")),t=require("@math.gl/polygon");function e(n){return n&&n.__esModule?n:{default:n}}const o=t.WINDING.CLOCKWISE,r=t.WINDING.COUNTER_CLOCKWISE,i={isClosed:!0};function s(n){if(n=n&&n.positions||n,!Array.isArray(n)&&!ArrayBuffer.isView(n))throw new Error("invalid polygon")}function l(n){return"positions"in n?n.positions:n}function u(n){return"holeIndices"in n?n.holeIndices:null}function c(n){return Array.isArray(n[0])}function f(n){return n.length>=1&&n[0].length>=2&&Number.isFinite(n[0][0])}function p(n){const t=n[0],e=n[n.length-1];return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function d(n,t,e,o){for(let r=0;r<t;r++)if(n[e+r]!==n[o-t+r])return!1;return!0}function g(n,e,o,r,s){let l=e;const u=o.length;for(let t=0;t<u;t++)for(let e=0;e<r;e++)n[l++]=o[t][e]||0;if(!p(o))for(let t=0;t<r;t++)n[l++]=o[0][t]||0;return i.start=e,i.end=l,i.size=r,(0,t.modifyPolygonWindingDirection)(n,s,i),l}function h(n,e,o,r,s=0,l,u){const c=(l=l||o.length)-s;if(c<=0)return e;let f=e;for(let t=0;t<c;t++)n[f++]=o[s+t];if(!d(o,r,s,l))for(let t=0;t<r;t++)n[f++]=o[s+t];return i.start=e,i.end=f,i.size=r,(0,t.modifyPolygonWindingDirection)(n,u,i),f}function a(n,t){s(n);const e=[],i=[];if("positions"in n){const{positions:s,holeIndices:l}=n;if(l){let n=0;for(let u=0;u<=l.length;u++)n=h(e,n,s,t,l[u-1],l[u],0===u?o:r),i.push(n);return i.pop(),{positions:e,holeIndices:i}}n=s}if(!c(n))return h(e,0,n,t,0,e.length,o),e;if(!f(n)){let s=0;for(const[l,u]of n.entries())s=g(e,s,u,t,0===l?o:r),i.push(s);return i.pop(),{positions:e,holeIndices:i}}return g(e,0,n,t,o),e}function I(n,t,e){const o=n.length/3;let r=0;for(let i=0;i<o;i++){const s=(i+1)%o;r+=n[3*i+t]*n[3*s+e],r-=n[3*s+t]*n[3*i+e]}return Math.abs(r/2)}function y(n,t,e,o){const r=n.length/3;for(let i=0;i<r;i++){const r=3*i,s=n[r+0],l=n[r+1],u=n[r+2];n[r+t]=s,n[r+e]=l,n[r+o]=u}}function m(t,e,o,r){let i=u(t);i&&(i=i.map(n=>n/e));let s=l(t);const c=r&&3===e;if(o){const n=s.length;s=s.slice();const t=[];for(let r=0;r<n;r+=e){t[0]=s[r],t[1]=s[r+1],c&&(t[2]=s[r+2]);const n=o(t);s[r]=n[0],s[r+1]=n[1],c&&(s[r+2]=n[2])}}if(c){const n=I(s,0,1),t=I(s,0,2),e=I(s,1,2);if(!n&&!t&&!e)return[];n>t&&n>e||(t>e?(o||(s=s.slice()),y(s,0,2,1)):(o||(s=s.slice()),y(s,1,2,0)))}return(0,n.default)(s,i,e)}
},{"earcut":"d3f1","@math.gl/polygon":"bJcr"}],"XYVo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("./polygon")),t=require("@deck.gl/core"),i=require("@math.gl/polygon");function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(r=function(e){return e?i:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=r(t);if(i&&i.has(e))return i.get(e);var s={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var a=o?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(s,n,a):s[n]=e[n]}return s.default=e,i&&i.set(e,s),s}class o extends t.Tesselator{constructor(e){const{fp64:t,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const r=e.normalize(t,this.positionSize);return this.opts.resolution?(0,i.cutPolygonByGrid)(e.getPositions(r),e.getHoleIndices(r),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?(0,i.cutPolygonByMercatorBounds)(e.getPositions(r),e.getHoleIndices(r),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):r}return t}getGeometrySize(t){if(n(t)){let e=0;for(const i of t)e+=this.getGeometrySize(i);return e}return e.getPositions(t).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&n(e))for(const i of e){const e=this.getGeometrySize(i);t.geometrySize=e,this.updateGeometryAttributes(i,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}_updateIndices(t,{geometryIndex:i,vertexStart:r,indexStart:s}){const{attributes:o,indexStarts:n,typedArrayManager:a}=this;let u=o.indices;if(!u||!t)return;let l=s;const p=e.getSurfaceIndices(t,this.positionSize,this.opts.preproject,this.opts.full3d);u=a.allocate(u,s+p.length,{copy:!0});for(let e=0;e<p.length;e++)u[l++]=p[e]+r;n[i+1]=s+p.length,o.indices=u}_updatePositions(t,{vertexStart:i,geometrySize:r}){const{attributes:{positions:s},positionSize:o}=this;if(!s||!t)return;const n=e.getPositions(t);for(let e=i,a=0;a<r;e++,a++){const t=n[a*o],i=n[a*o+1],r=o>2?n[a*o+2]:0;s[3*e]=t,s[3*e+1]=i,s[3*e+2]=r}}_updateVertexValid(t,{vertexStart:i,geometrySize:r}){const{positionSize:s}=this,o=this.attributes.vertexValid,n=t&&e.getHoleIndices(t);if(t&&t.edgeTypes?o.set(t.edgeTypes,i):o.fill(1,i,i+r),n)for(let e=0;e<n.length;e++)o[i+n[e]/s-1]=0;o[i+r-1]=0}}function n(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}exports.default=o;
},{"./polygon":"dIsy","@deck.gl/core":"vvxL","@math.gl/polygon":"bJcr"}],"aSKL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n";exports.default=o;
},{}],"mAGb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o=e(require("./solid-polygon-layer-vertex-main.glsl"));function e(o){return o&&o.__esModule?o:{default:o}}var n="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(o.default,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n");exports.default=n;
},{"./solid-polygon-layer-vertex-main.glsl":"aSKL"}],"XZyr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=o(require("./solid-polygon-layer-vertex-main.glsl"));function o(n){return n&&n.__esModule?n:{default:n}}var i="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(n.default,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");exports.default=i;
},{"./solid-polygon-layer-vertex-main.glsl":"aSKL"}],"mYK0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e="#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=e;
},{}],"KN28":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("@luma.gl/core"),i=n(require("./polygon-tesselator")),o=n(require("./solid-polygon-layer-vertex-top.glsl")),r=n(require("./solid-polygon-layer-vertex-side.glsl")),a=n(require("./solid-polygon-layer-fragment.glsl"));function n(e){return e&&e.__esModule?e:{default:e}}const l=[0,0,0,255],d={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:l},getLineColor:{type:"accessor",value:l},material:!0},u={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class c extends t.Layer{constructor(...t){super(...t),(0,e.default)(this,"state",void 0)}getShaders(e){return super.getShaders({vs:"top"===e?o.default:r.default,fs:a.default,defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[t.project32,t.gouraudLighting,t.picking]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:o}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:a}=this.props;let n;o.isGeospatial&&r===t.COORDINATE_SYSTEM.DEFAULT&&(r=t.COORDINATE_SYSTEM.LNGLAT),r===t.COORDINATE_SYSTEM.LNGLAT&&(n=a?o.projectPosition.bind(o):o.projectFlat.bind(o)),this.setState({numInstances:0,polygonTesselator:new i.default({preproject:n,fp64:this.use64bitPositions(),IndexType:!e||(0,s.hasFeatures)(e,s.FEATURES.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const d=this.getAttributeManager();d.remove(["instancePickingColors"]),d.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:u,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:u,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:u,accessor:"getFillColor",defaultValue:l,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:u,accessor:"getLineColor",defaultValue:l,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(e,{index:t,target:s})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,s),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:s}=t,{data:i}=this.props;return i[0]&&i[0].__source&&(t.object=i.find(e=>e.__source.index===s)),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let s=0;s<t.length;s++)t[s].__source.index===e&&this._disablePickingIndex(s);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:s,wireframe:i,elevationScale:o}=this.props,{topModel:r,sideModel:a,polygonTesselator:n}=this.state,l={...e,extruded:Boolean(t),elevationScale:o};a&&(a.setInstanceCount(n.instanceCount-1),a.setUniforms(l),i&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),s&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),r&&(r.setVertexCount(n.vertexCount),r.setUniforms(l).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:s,changeFlags:i}=e,o=this.getAttributeManager();var r;(i.extensionsChanged||t.filled!==s.filled||t.extruded!==s.extruded)&&(null===(r=this.state.models)||void 0===r||r.forEach(e=>e.delete()),this.setState(this._getModels(this.context.gl)),o.invalidateAll())}updateGeometry({props:e,oldProps:t,changeFlags:s}){if(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getPolygon)){const{polygonTesselator:t}=this.state,i=e.data.attributes||{};t.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:s.dataChanged,full3d:e._full3d}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),s.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:t,filled:i,extruded:o}=this.props;let r,a;if(i){const i=this.getShaders("top");i.defines.NON_INSTANCED_MODEL=1,r=new s.Model(e,{...i,id:"".concat(t,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return o&&((a=new s.Model(e,{...this.getShaders("side"),id:"".concat(t,"-side"),geometry:new s.Geometry({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1})).userData.excludeAttributes={indices:!0}),{models:[a,r].filter(Boolean),topModel:r,sideModel:a}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}exports.default=c,(0,e.default)(c,"defaultProps",d),(0,e.default)(c,"layerName","SolidPolygonLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./polygon-tesselator":"XYVo","./solid-polygon-layer-vertex-top.glsl":"mAGb","./solid-polygon-layer-vertex-side.glsl":"XZyr","./solid-polygon-layer-fragment.glsl":"mYK0"}],"kI2N":[function(require,module,exports) {
"use strict";function e({data:e,getIndex:t,dataRange:n,replace:l}){const{startRow:o=0,endRow:r=1/0}=n,a=e.length;let s=a,c=a;for(let f=0;f<a;f++){const n=t(e[f]);if(s>f&&n>=o&&(s=f),n>=r){c=f;break}}let g=s;const d=c-s!==l.length?e.slice(c):void 0;for(let f=0;f<l.length;f++)e[g++]=l[f];if(d){for(let t=0;t<d.length;t++)e[g++]=d[t];e.length=g}return{startRow:s,endRow:s+l.length}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.replaceInRange=e;
},{}],"ByLy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),i=s(require("../solid-polygon-layer/solid-polygon-layer")),r=s(require("../path-layer/path-layer")),a=n(require("../solid-polygon-layer/polygon")),o=require("../utils");function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(l=function(e){return e?i:t})(e)}function n(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=l(t);if(i&&i.has(e))return i.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var n=a?Object.getOwnPropertyDescriptor(e,o):null;n&&(n.get||n.set)?Object.defineProperty(r,o,n):r[o]=e[o]}return r.default=e,i&&i.set(e,r),r}function s(e){return e&&e.__esModule?e:{default:e}}const d=[0,0,0,255],g=[0,0,0,255],h={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:e=>e.polygon},getFillColor:{type:"accessor",value:g},getLineColor:{type:"accessor",value:d},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class u extends t.CompositeLayer{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&t.log.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const t=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(t&&Array.isArray(e.dataChanged)){const t=this.state.paths.slice(),i=e.dataChanged.map(e=>(0,o.replaceInRange)({data:t,getIndex:e=>e.__source.index,dataRange:e,replace:this._getPaths(e)}));this.setState({paths:t,pathsDiff:i})}else t&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:i,getPolygon:r,positionFormat:o,_normalize:l}=this.props,n=[],s="XY"===o?2:3,{startRow:d,endRow:g}=e,{iterable:h,objectInfo:u}=(0,t.createIterable)(i,d,g);for(const t of h){u.index++;let e=r(t,u);l&&(e=a.normalize(e,s));const{holeIndices:i}=e,o=e.positions||e;if(i)for(let r=0;r<=i.length;r++){const e=o.slice(i[r-1]||0,i[r]||o.length);n.push(this.getSubLayerRow({path:e},t,u.index))}else n.push(this.getSubLayerRow({path:o},t,u.index))}return n}renderLayers(){const{data:e,_dataDiff:t,stroked:a,filled:o,extruded:l,wireframe:n,_normalize:s,_windingOrder:g,elevationScale:h,transitions:u,positionFormat:p}=this.props,{lineWidthUnits:y,lineWidthScale:c,lineWidthMinPixels:f,lineWidthMaxPixels:L,lineJointRounded:P,lineMiterLimit:m,lineDashJustified:C}=this.props,{getFillColor:b,getLineColor:_,getLineWidth:S,getLineDashArray:v,getElevation:x,getPolygon:w,updateTriggers:W,material:D}=this.props,{paths:M,pathsDiff:A}=this.state,O=this.getSubLayerClass("fill",i.default),R=this.getSubLayerClass("stroke",r.default),F=this.shouldRenderSubLayer("fill",M)&&new O({_dataDiff:t,extruded:l,elevationScale:h,filled:o,wireframe:n,_normalize:s,_windingOrder:g,getElevation:x,getFillColor:b,getLineColor:l&&n?_:d,material:D,transitions:u},this.getSubLayerProps({id:"fill",updateTriggers:W&&{getPolygon:W.getPolygon,getElevation:W.getElevation,getFillColor:W.getFillColor,lineColors:l&&n,getLineColor:W.getLineColor}}),{data:e,positionFormat:p,getPolygon:w});return[!l&&F,!l&&a&&this.shouldRenderSubLayer("stroke",M)&&new R({_dataDiff:A&&(()=>A),widthUnits:y,widthScale:c,widthMinPixels:f,widthMaxPixels:L,jointRounded:P,miterLimit:m,dashJustified:C,_pathType:"loop",transitions:u&&{getWidth:u.getLineWidth,getColor:u.getLineColor,getPath:u.getPolygon},getColor:this.getSubLayerAccessor(_),getWidth:this.getSubLayerAccessor(S),getDashArray:this.getSubLayerAccessor(v)},this.getSubLayerProps({id:"stroke",updateTriggers:W&&{getWidth:W.getLineWidth,getColor:W.getLineColor,getDashArray:W.getLineDashArray}}),{data:M,positionFormat:p,getPath:e=>e.path}),l&&F]}}exports.default=u,(0,e.default)(u,"layerName","PolygonLayer"),(0,e.default)(u,"defaultProps",h);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","../solid-polygon-layer/solid-polygon-layer":"KN28","../path-layer/path-layer":"Exm7","../solid-polygon-layer/polygon":"dIsy","../utils":"kI2N"}],"phHP":[function(require,module,exports) {
"use strict";function e(e,r){if(!e)return null;const t="startIndices"in e?e.startIndices[r]:r,o=e.featureIds.value[t];return-1!==t?n(e,o,t):null}function n(e,n,r){const t={properties:{...e.properties[n]}};for(const o in e.numericProps)t.properties[o]=e.numericProps[o].value[r];return t}function r(e,n){const r={points:null,lines:null,polygons:null};for(const t in r){const o=e[t].globalFeatureIds.value;r[t]=new Uint8ClampedArray(3*o.length);const s=[];for(let e=0;e<o.length;e++)n(o[e],s),r[t][3*e+0]=s[0],r[t][3*e+1]=s[1],r[t][3*e+2]=s[2]}return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.binaryToFeatureForAccesor=e,exports.calculatePickingColors=r;
},{}],"h6ea":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=n;
},{}],"oA4s":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),r=s(require("../../icon-layer/icon-layer")),o=s(require("./multi-icon-layer-fragment.glsl"));function s(e){return e&&e.__esModule?e:{default:e}}const a=.75,n=[],i={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class u extends r.default{constructor(...t){super(...t),(0,e.default)(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:o.default}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(e,{index:t,target:r})=>this.encodePickingColor(t,r)}})}updateState(e){super.updateState(e);const{props:r,oldProps:o}=e;let{outlineColor:s}=r;s!==o.outlineColor&&((s=s.map(e=>e/255))[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!r.sdf&&r.outlineWidth&&t.log.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:r,outlineWidth:o}=this.props,{outlineColor:s}=this.state,n=o?Math.max(r,a*(1-o)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:a,outlineBuffer:n,gamma:r,sdf:Boolean(t),outlineColor:s},super.draw(e),t&&o){const{iconManager:e}=this.state;e.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:a}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(e=>super.getInstanceOffset(e)):n}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(e=>super.getInstanceIconFrame(e)):n}}exports.default=u,(0,e.default)(u,"defaultProps",i),(0,e.default)(u,"layerName","MultiIconLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","../../icon-layer/icon-layer":"NHB3","./multi-icon-layer-fragment.glsl":"h6ea"}],"XggI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const t=1e20;class e{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:s=.25,fontFamily:a="sans-serif",fontWeight:n="normal",fontStyle:r="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=i;const o=this.size=t+4*e,h=this._createCanvas(o),l=this.ctx=h.getContext("2d",{willReadFrequently:!0});l.font=`${r} ${n} ${t}px ${a}`,l.textBaseline="alphabetic",l.textAlign="left",l.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Uint16Array(o)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(e){const{width:s,actualBoundingBoxAscent:a,actualBoundingBoxDescent:n,actualBoundingBoxLeft:r,actualBoundingBoxRight:o}=this.ctx.measureText(e),h=Math.ceil(a),l=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-r))),f=Math.min(this.size-this.buffer,h+Math.ceil(n)),c=l+2*this.buffer,u=f+2*this.buffer,d=Math.max(c*u,0),g=new Uint8ClampedArray(d),x={data:g,width:c,height:u,glyphWidth:l,glyphHeight:f,glyphTop:h,glyphLeft:0,glyphAdvance:s};if(0===l||0===f)return x;const{ctx:y,buffer:p,gridInner:m,gridOuter:w}=this;y.clearRect(p,p,l,f),y.fillText(e,p,p+h);const M=y.getImageData(p,p,l,f);w.fill(t,0,d),m.fill(0,0,d);for(let i=0;i<f;i++)for(let e=0;e<l;e++){const s=M.data[4*(i*l+e)+3]/255;if(0===s)continue;const a=(i+p)*c+e+p;if(1===s)w[a]=0,m[a]=t;else{const t=.5-s;w[a]=t>0?t*t:0,m[a]=t<0?t*t:0}}i(w,0,0,c,u,c,this.f,this.v,this.z),i(m,p,p,l,f,c,this.f,this.v,this.z);for(let t=0;t<d;t++){const e=Math.sqrt(w[t])-Math.sqrt(m[t]);g[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return x}}function i(t,e,i,a,n,r,o,h,l){for(let f=e;f<e+a;f++)s(t,i*r+f,r,n,o,h,l);for(let f=i;f<i+n;f++)s(t,f*r+e,1,a,o,h,l)}function s(e,i,s,a,n,r,o){r[0]=0,o[0]=-t,o[1]=t,n[0]=e[i];for(let h=1,l=0,f=0;h<a;h++){n[h]=e[i+h*s];const a=h*h;do{const t=r[l];f=(n[h]-n[t]+a-t*t)/(h-t)/2}while(f<=o[l]&&--l>-1);r[++l]=h,o[l]=f,o[l+1]=t}for(let t=0,h=0;t<a;t++){for(;o[h+1]<t;)h++;const a=r[h],l=t-a;e[i+t*s]=n[a]+l*l}}exports.default=e;
},{}],"lEi6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.autoWrapping=l,exports.buildMapping=n,exports.getTextFromBuffer=u,exports.nextPowOfTwo=r,exports.transformParagraph=s;var t=require("@deck.gl/core");const e=32,o=[];function r(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function n({characterSet:t,getFontWidth:e,fontHeight:o,buffer:n,maxCanvasWidth:a,mapping:i={},xOffset:f=0,yOffset:l=0}){let c=0,s=f;const u=o+2*n;for(const r of t)if(!i[r]){const t=e(r);s+t+2*n>a&&(s=0,c++),i[r]={x:s+n,y:l+c*u+n,width:t,height:u,layoutWidth:t,layoutHeight:o},s+=t+2*n}return{mapping:i,xOffset:s,yOffset:l+c*u,canvasHeight:r(l+(c+1)*u)}}function a(t,e,o,r){let n=0;for(let i=e;i<o;i++){var a;n+=(null===(a=r[t[i]])||void 0===a?void 0:a.layoutWidth)||0}return n}function i(t,e,o,r,n,i){let f=e,l=0;for(let c=e;c<o;c++){const e=a(t,c,c+1,n);l+e>r&&(f<c&&i.push(c),f=c,l=0),l+=e}return l}function f(t,e,o,r,n,f){let l=e,c=e,s=e,u=0;for(let h=e;h<o;h++)if(" "===t[h]?s=h+1:" "!==t[h+1]&&h+1!==o||(s=h+1),s>c){let e=a(t,c,s,n);u+e>r&&(l<c&&(f.push(c),l=c,u=0),e>r&&(e=i(t,c,s,r,n,f),l=f[f.length-1])),c=s,u+=e}return u}function l(t,e,o,r,n=0,a){void 0===a&&(a=t.length);const l=[];return"break-all"===e?i(t,n,a,o,r,l):f(t,n,a,o,r,l),l}function c(o,r,n,a,i,f){let l=0,c=0;for(let s=r;s<n;s++){const r=o[s],n=a[r];n?(c||(c=n.layoutHeight),i[s]=l+n.layoutWidth/2,l+=n.layoutWidth):(t.log.warn("Missing character: ".concat(r," (").concat(r.codePointAt(0),")"))(),i[s]=l,l+=e)}f[0]=l,f[1]=c}function s(t,e,r,n,a){const i=Array.from(t),f=i.length,s=new Array(f),u=new Array(f),h=new Array(f),d=("break-word"===r||"break-all"===r)&&isFinite(n)&&n>0,g=[0,0],p=[0,0];let y=0,x=0,w=0;for(let m=0;m<=f;m++){const t=i[m];if("\n"!==t&&m!==f||(w=m),w>x){const t=d?l(i,r,n,a,x,w):o;for(let o=0;o<=t.length;o++){const r=0===o?x:t[o-1],n=o<t.length?t[o]:w;c(i,r,n,a,s,p);for(let t=r;t<n;t++){var v;const e=(null===(v=a[i[t]])||void 0===v?void 0:v.layoutOffsetY)||0;u[t]=y+p[1]/2+e,h[t]=p[0]}y+=p[1]*e,g[0]=Math.max(g[0],p[0])}x=w}"\n"===t&&(s[x]=0,u[x]=0,h[x]=0,x++)}return g[1]=y,{x:s,y:u,rowWidth:h,size:g}}function u({value:t,length:e,stride:o,offset:r,startIndices:n,characterSet:a}){const i=t.BYTES_PER_ELEMENT,f=o?o/i:1,l=r?r/i:0,c=n[e]||Math.ceil((t.length-l)/f),s=a&&new Set,u=new Array(e);let h=t;if(f>1||l>0){h=new(0,t.constructor)(c);for(let e=0;e<c;e++)h[e]=t[e*f+l]}for(let d=0;d<e;d++){const t=n[d],e=n[d+1]||c,o=h.subarray(t,e);u[d]=String.fromCodePoint.apply(null,o),s&&o.forEach(s.add,s)}if(s)for(const d of s)a.add(String.fromCodePoint(d));return{texts:u,characterCount:c}}
},{"@deck.gl/core":"vvxL"}],"QqKM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("@babel/runtime/helpers/esm/defineProperty"));function t(e){return e&&e.__esModule?e:{default:e}}class r{constructor(t=5){(0,e.default)(this,"limit",void 0),(0,e.default)(this,"_cache",{}),(0,e.default)(this,"_order",[]),this.limit=t}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}exports.default=r;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3"}],"dOP1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DEFAULT_FONT_SETTINGS=void 0,exports.setFontAtlasCacheLimit=m;var t=s(require("@babel/runtime/helpers/esm/defineProperty")),e=s(require("@mapbox/tiny-sdf")),a=require("@deck.gl/core"),n=require("./utils"),o=s(require("./lru-cache"));function s(t){return t&&t.__esModule?t:{default:t}}function i(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const r={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:i(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};exports.DEFAULT_FONT_SETTINGS=r;const f=1024,c=.9,u=1.2,h=3;let l=new o.default(h);function p(t,e){let a;a="string"==typeof e?new Set(Array.from(e)):new Set(e);const n=l.get(t);if(!n)return a;for(const o in n.mapping)a.has(o)&&a.delete(o);return a}function d(t,e){for(let a=0;a<t.length;a++)e.data[4*a+3]=t[a]}function g(t,e,a,n){t.font="".concat(n," ").concat(a,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function m(t){a.log.assert(Number.isFinite(t)&&t>=h,"Invalid cache limit"),l=new o.default(t)}class y{constructor(){(0,t.default)(this,"props",{...r}),(0,t.default)(this,"_key",void 0),(0,t.default)(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:t,buffer:e}=this.props;return(t*u+2*e)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();const e=p(this._key,this.props.characterSet),a=l.get(this._key);if(a&&0===e.size)return void(this._atlas!==a&&(this._atlas=a));const n=this._generateFontAtlas(e,a);this._atlas=n,l.set(this._key,n)}_generateFontAtlas(t,a){const{fontFamily:o,fontWeight:s,fontSize:i,buffer:r,sdf:h,radius:l,cutoff:p}=this.props;let m=a&&a.data;m||((m=document.createElement("canvas")).width=f);const y=m.getContext("2d",{willReadFrequently:!0});g(y,o,i,s);const{mapping:_,canvasHeight:x,xOffset:S,yOffset:b}=(0,n.buildMapping)({getFontWidth:t=>y.measureText(t).width,fontHeight:i*u,buffer:r,characterSet:t,maxCanvasWidth:f,...a&&{mapping:a.mapping,xOffset:a.xOffset,yOffset:a.yOffset}});if(m.height!==x){const t=y.getImageData(0,0,m.width,m.height);m.height=x,y.putImageData(t,0,0)}if(g(y,o,i,s),h){const a=new e.default({fontSize:i,buffer:r,radius:l,cutoff:p,fontFamily:o,fontWeight:"".concat(s)});for(const e of t){const{data:t,width:n,height:o,glyphTop:s}=a.draw(e);_[e].width=n,_[e].layoutOffsetY=i*c-s;const r=y.createImageData(n,o);d(t,r),y.putImageData(r,_[e].x,_[e].y)}}else for(const e of t)y.fillText(e,_[e].x,_[e].y+r+i*c);return{xOffset:S,yOffset:b,mapping:_,data:m,width:m.width,height:m.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:a,buffer:n,sdf:o,radius:s,cutoff:i}=this.props;return o?"".concat(t," ").concat(e," ").concat(a," ").concat(n," ").concat(s," ").concat(i):"".concat(t," ").concat(e," ").concat(a," ").concat(n)}}exports.default=y;
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@mapbox/tiny-sdf":"XggI","@deck.gl/core":"vvxL","./utils":"lEi6","./lru-cache":"QqKM"}],"eZdq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n";exports.default=n;
},{}],"whYR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";exports.default=n;
},{}],"hOrs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("@luma.gl/core"),i=r(require("./text-background-layer-vertex.glsl")),a=r(require("./text-background-layer-fragment.glsl"));function r(e){return e&&e.__esModule?e:{default:e}}const n={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class o extends t.Layer{constructor(...t){super(...t),(0,e.default)(this,"state",void 0)}getShaders(){return super.getShaders({vs:i.default,fs:a.default,modules:[t.project32,t.picking]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;if(t.extensionsChanged){var s;const{gl:e}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:s,sizeScale:i,sizeUnits:a,sizeMinPixels:r,sizeMaxPixels:n,getLineWidth:o}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(e).setUniforms({billboard:s,stroked:Boolean(o),padding:l,sizeUnits:t.UNIT[a],sizeScale:i,sizeMinPixels:r,sizeMaxPixels:n}).draw()}_getModel(e){return new s.Model(e,{...this.getShaders(),id:this.props.id,geometry:new s.Geometry({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}exports.default=o,(0,e.default)(o,"defaultProps",n),(0,e.default)(o,"layerName","TextBackgroundLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","@luma.gl/core":"iuAK","./text-background-layer-vertex.glsl":"eZdq","./text-background-layer-fragment.glsl":"whYR"}],"pt2s":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=g(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),r=g(require("./multi-icon-layer/multi-icon-layer")),i=s(require("./font-atlas-manager")),o=require("./utils"),n=g(require("./text-background-layer/text-background-layer"));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var s=o?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(i,n,s):i[n]=e[n]}return i.default=e,r&&r.set(e,i),i}function g(e){return e&&e.__esModule?e:{default:e}}const l={start:1,middle:0,end:-1},c={top:1,center:0,bottom:-1},u=[0,0,0,255],d=1,f={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:u},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:i.DEFAULT_FONT_SETTINGS.characterSet},fontFamily:i.DEFAULT_FONT_SETTINGS.fontFamily,fontWeight:i.DEFAULT_FONT_SETTINGS.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:u},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:u},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class p extends t.CompositeLayer{constructor(...t){super(...t),(0,e.default)(this,"state",void 0),(0,e.default)(this,"getBoundingRect",(e,t)=>{let{size:[r,i]}=this.transformParagraph(e,t);const{fontSize:o}=this.state.fontAtlasManager.props;r/=o,i/=o;const{getTextAnchor:n,getAlignmentBaseline:a}=this.props;return[(l["function"==typeof n?n(e,t):n]-1)*r/2,(c["function"==typeof a?a(e,t):a]-1)*i/2,r,i]}),(0,e.default)(this,"getIconOffsets",(e,t)=>{const{getTextAnchor:r,getAlignmentBaseline:i}=this.props,{x:o,y:n,rowWidth:a,size:[s,g]}=this.transformParagraph(e,t),u=l["function"==typeof r?r(e,t):r],d=c["function"==typeof i?i(e,t):i],f=o.length,p=new Array(2*f);let h=0;for(let l=0;l<f;l++){const e=(1-u)*(s-a[l])/2;p[h++]=(u-1)*s/2+e+o[l],p[h++]=(d-1)*g/2+n[l]}return p})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new i.default},this.props.maxWidth>0&&t.log.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==r.lineHeight||t.wordBreak!==r.wordBreak||t.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:o}=this.state,n={...e,characterSet:o,fontFamily:t,fontWeight:r};if(!i.mapping)return i.setProps(n),!0;for(const a in n)if(n[a]!==i.props[a])return i.setProps(n),!0;return!1}_updateText(){var e;const{data:r,characterSet:i}=this.props,n=null===(e=r.attributes)||void 0===e?void 0:e.getText;let a,{getText:s}=this.props,g=r.startIndices;const l="auto"===i&&new Set;if(n&&g){const{texts:e,characterCount:t}=(0,o.getTextFromBuffer)({...ArrayBuffer.isView(n)?{value:n}:n,length:r.length,startIndices:g,characterSet:l});a=t,s=((t,{index:r})=>e[r])}else{const{iterable:e,objectInfo:i}=(0,t.createIterable)(r);g=[0],a=0;for(const t of e){i.index++;const e=Array.from(s(t,i)||"");l&&e.forEach(l.add,l),a+=e.length,g.push(a)}}this.setState({getText:s,startIndices:g,numInstances:a,characterSet:l||i})}transformParagraph(e,t){const{fontAtlasManager:r}=this.state,i=r.mapping,n=this.state.getText,{wordBreak:a,lineHeight:s,maxWidth:g}=this.props,l=n(e,t)||"";return(0,o.transformParagraph)(l,s,a,g*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:t,getText:o,fontAtlasManager:{scale:a,texture:s,mapping:g},styleVersion:l}=this.state,{data:c,_dataDiff:u,getPosition:d,getColor:f,getSize:p,getAngle:h,getPixelOffset:x,getBackgroundColor:y,getBorderColor:P,getBorderWidth:b,backgroundPadding:m,background:T,billboard:S,fontSettings:A,outlineWidth:C,outlineColor:z,sizeScale:v,sizeUnits:B,sizeMinPixels:O,sizeMaxPixels:k,transitions:F,updateTriggers:_}=this.props,W=this.getSubLayerClass("characters",r.default),I=this.getSubLayerClass("background",n.default);return[T&&new I({getFillColor:y,getLineColor:P,getLineWidth:b,padding:m,getPosition:d,getSize:p,getAngle:h,getPixelOffset:x,billboard:S,sizeScale:v,sizeUnits:B,sizeMinPixels:O,sizeMaxPixels:k,transitions:F&&{getPosition:F.getPosition,getAngle:F.getAngle,getSize:F.getSize,getFillColor:F.getBackgroundColor,getLineColor:F.getBorderColor,getLineWidth:F.getBorderWidth,getPixelOffset:F.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:_.getPosition,getAngle:_.getAngle,getSize:_.getSize,getFillColor:_.getBackgroundColor,getLineColor:_.getBorderColor,getLineWidth:_.getBorderWidth,getPixelOffset:_.getPixelOffset,getBoundingRect:{getText:_.getText,getTextAnchor:_.getTextAnchor,getAlignmentBaseline:_.getAlignmentBaseline,styleVersion:l}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new W({sdf:A.sdf,smoothing:Number.isFinite(A.smoothing)?A.smoothing:i.DEFAULT_FONT_SETTINGS.smoothing,outlineWidth:C/(A.radius||i.DEFAULT_FONT_SETTINGS.radius),outlineColor:z,iconAtlas:s,iconMapping:g,getPosition:d,getColor:f,getSize:p,getAngle:h,getPixelOffset:x,billboard:S,sizeScale:v*a,sizeUnits:B,sizeMinPixels:O*a,sizeMaxPixels:k*a,transitions:F&&{getPosition:F.getPosition,getAngle:F.getAngle,getColor:F.getColor,getSize:F.getSize,getPixelOffset:F.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:_.getText,getPosition:_.getPosition,getAngle:_.getAngle,getColor:_.getColor,getSize:_.getSize,getPixelOffset:_.getPixelOffset,getIconOffsets:{getTextAnchor:_.getTextAnchor,getAlignmentBaseline:_.getAlignmentBaseline,styleVersion:l}}}),{data:c,_dataDiff:u,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:o})]}static set fontAtlasCacheLimit(e){(0,i.setFontAtlasCacheLimit)(e)}}exports.default=p,(0,e.default)(p,"defaultProps",f),(0,e.default)(p,"layerName","TextLayer");
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","./multi-icon-layer/multi-icon-layer":"oA4s","./font-atlas-manager":"dOP1","./utils":"lEi6","./text-background-layer/text-background-layer":"hOrs"}],"kNZX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.POLYGON_LAYER=exports.POINT_LAYER=exports.LINE_LAYER=void 0,exports.forwardProps=g,exports.getDefaultProps=d;var e=n(require("../icon-layer/icon-layer")),t=n(require("../scatterplot-layer/scatterplot-layer")),i=n(require("../text-layer/text-layer")),l=n(require("../path-layer/path-layer")),o=n(require("../solid-polygon-layer/solid-polygon-layer"));function n(e){return e&&e.__esModule?e:{default:e}}const r={circle:{type:t.default,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:e.default,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:i.default,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}};exports.POINT_LAYER=r;const a={type:l.default,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}};exports.LINE_LAYER=a;const s={type:o.default,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function d({type:e,props:t}){const i={};for(const l in t)i[l]=e.defaultProps[t[l]];return i}function g(e,t){const{transitions:i,updateTriggers:l}=e.props,o={updateTriggers:{},transitions:i&&{getPosition:i.geometry}};for(const n in t){const r=t[n];let a=e.props[n];n.startsWith("get")&&(a=e.getSubLayerAccessor(a),o.updateTriggers[r]=l[n],i&&(o.transitions[r]=i[n])),o[r]=a}return o}exports.POLYGON_LAYER=s;
},{"../icon-layer/icon-layer":"NHB3","../scatterplot-layer/scatterplot-layer":"s9mM","../text-layer/text-layer":"pt2s","../path-layer/path-layer":"Exm7","../solid-polygon-layer/solid-polygon-layer":"KN28"}],"Rrkn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getGeojsonFeatures=t,exports.separateGeojsonFeatures=o,exports.validateGeometry=s;var e=require("@deck.gl/core");function t(t){if(Array.isArray(t))return t;switch(e.log.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return e.log.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function o(t,o,n={}){const s={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:a=0,endRow:i=t.length}=n;for(let u=a;u<i;u++){const n=t[u],{geometry:a}=n;if(a)if("GeometryCollection"===a.type){e.log.assert(Array.isArray(a.geometries),"GeoJSON does not have geometries array");const{geometries:t}=a;for(let e=0;e<t.length;e++){r(t[e],s,o,n,u)}}else r(a,s,o,n,u)}return s}function r(t,o,r,n,a){const{type:i,coordinates:u}=t,{pointFeatures:c,lineFeatures:l,polygonFeatures:y,polygonOutlineFeatures:g}=o;if(s(i,u))switch(i){case"Point":c.push(r({geometry:t},n,a));break;case"MultiPoint":u.forEach(e=>{c.push(r({geometry:{type:"Point",coordinates:e}},n,a))});break;case"LineString":l.push(r({geometry:t},n,a));break;case"MultiLineString":u.forEach(e=>{l.push(r({geometry:{type:"LineString",coordinates:e}},n,a))});break;case"Polygon":y.push(r({geometry:t},n,a)),u.forEach(e=>{g.push(r({geometry:{type:"LineString",coordinates:e}},n,a))});break;case"MultiPolygon":u.forEach(e=>{y.push(r({geometry:{type:"Polygon",coordinates:e}},n,a)),e.forEach(e=>{g.push(r({geometry:{type:"LineString",coordinates:e}},n,a))})})}else e.log.warn("".concat(i," coordinates are malformed"))()}const n={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function s(t,o){let r=n[t];for(e.log.assert(r,"Unknown GeoJSON type ".concat(t));o&&--r>0;)o=o[0];return o&&Number.isFinite(o[0])}
},{"@deck.gl/core":"vvxL"}],"RGbO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLayerPropsFromBinary=n,exports.createLayerPropsFromFeatures=s;var e=require("./geojson-binary");function t(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function o(e){return e.geometry.coordinates}function s(e,s){const n=t(),{pointFeatures:i,lineFeatures:r,polygonFeatures:a,polygonOutlineFeatures:p}=e;return n.points.data=i,n.points._dataDiff=s.pointFeatures&&(()=>s.pointFeatures),n.points.getPosition=o,n.lines.data=r,n.lines._dataDiff=s.lineFeatures&&(()=>s.lineFeatures),n.lines.getPath=o,n.polygons.data=a,n.polygons._dataDiff=s.polygonFeatures&&(()=>s.polygonFeatures),n.polygons.getPolygon=o,n.polygonsOutline.data=p,n.polygonsOutline._dataDiff=s.polygonOutlineFeatures&&(()=>s.polygonOutlineFeatures),n.polygonsOutline.getPath=o,n}function n(o,s){const n=t(),{points:i,lines:r,polygons:a}=o,p=(0,e.calculatePickingColors)(o,s);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:p.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:p.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:a.polygonIndices.value.length-1,startIndices:a.polygonIndices.value,attributes:{...a.attributes,getPolygon:a.positions,pickingColors:{size:3,value:p.polygons}},properties:a.properties,numericProps:a.numericProps,featureIds:a.featureIds},n.polygons._normalize=!1,a.triangles&&(n.polygons.data.attributes.indices=a.triangles.value),n.polygonsOutline.data={length:a.primitivePolygonIndices.value.length-1,startIndices:a.primitivePolygonIndices.value,attributes:{...a.attributes,getPath:a.positions,instancePickingColors:{size:3,value:p.polygons}},properties:a.properties,numericProps:a.numericProps,featureIds:a.featureIds},n.polygonsOutline._pathType="open",n}
},{"./geojson-binary":"phHP"}],"qWvc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("@babel/runtime/helpers/esm/defineProperty")),t=require("@deck.gl/core"),s=require("../utils"),r=require("./geojson-binary"),a=require("./sub-layer-map"),o=require("./geojson"),i=require("./geojson-layer-props");function n(e){return e&&e.__esModule?e:{default:e}}const p=["points","linestrings","polygons"],u={...(0,a.getDefaultProps)(a.POINT_LAYER.circle),...(0,a.getDefaultProps)(a.POINT_LAYER.icon),...(0,a.getDefaultProps)(a.POINT_LAYER.text),...(0,a.getDefaultProps)(a.LINE_LAYER),...(0,a.getDefaultProps)(a.POLYGON_LAYER),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class d extends t.CompositeLayer{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:s}=this.props,r=s&&"points"in s&&"polygons"in s&&"lines"in s;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){const s=(0,i.createLayerPropsFromBinary)(e.data,this.encodePickingColor);this.setState({layerProps:s})}_updateStateJSON({props:e,changeFlags:t}){const r=(0,o.getGeojsonFeatures)(e.data),a=this.getSubLayerRow.bind(this);let n={};const p={};if(Array.isArray(t.dataChanged)){const e=this.state.features;for(const t in e)n[t]=e[t].slice(),p[t]=[];for(const i of t.dataChanged){const t=(0,o.separateGeojsonFeatures)(r,a,i);for(const r in e)p[r].push((0,s.replaceInRange)({data:n[r],getIndex:e=>e.__source.index,dataRange:i,replace:t[r]}))}}else n=(0,o.separateGeojsonFeatures)(r,a);const u=(0,i.createLayerPropsFromFeatures)(n,p);this.setState({features:n,featuresDiff:p,layerProps:u})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:s,sourceLayer:r}=t;return t.featureType=p.find(e=>r.id.startsWith("".concat(this.id,"-").concat(e,"-"))),s>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[s]),t}_updateAutoHighlight(e){const t="".concat(this.id,"-points-"),s="points"===e.featureType;for(const r of this.getSubLayers())r.id.startsWith(t)===s&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:s}=this.state,r="polygons-fill",o=this.shouldRenderSubLayer(r,s.polygons.data)&&this.getSubLayerClass(r,a.POLYGON_LAYER.type);if(o){const i=(0,a.forwardProps)(this,a.POLYGON_LAYER.props),n=e&&t;return n||delete i.getLineColor,i.updateTriggers.lineColors=n,new o(i,this.getSubLayerProps({id:r,updateTriggers:i.updateTriggers}),s.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:s}=this.state,r=!e&&t&&this.shouldRenderSubLayer("polygons-stroke",s.polygonsOutline.data)&&this.getSubLayerClass("polygons-stroke",a.LINE_LAYER.type),o=this.shouldRenderSubLayer("linestrings",s.lines.data)&&this.getSubLayerClass("linestrings",a.LINE_LAYER.type);if(r||o){const e=(0,a.forwardProps)(this,a.LINE_LAYER.props);return[r&&new r(e,this.getSubLayerProps({id:"polygons-stroke",updateTriggers:e.updateTriggers}),s.polygonsOutline),o&&new o(e,this.getSubLayerProps({id:"linestrings",updateTriggers:e.updateTriggers}),s.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:s}=this.state;let{highlightedObjectIndex:r}=this.props;!s&&Number.isFinite(r)&&(r=t.points.data.findIndex(e=>e.__source.index===r));const o=new Set(e.split("+")),i=[];for(const n of o){const e="points-".concat(n),o=a.POINT_LAYER[n],p=o&&this.shouldRenderSubLayer(e,t.points.data)&&this.getSubLayerClass(e,o.type);if(p){const u=(0,a.forwardProps)(this,o.props);let d=t.points;if("text"===n&&s){const{instancePickingColors:e,...t}=d.data.attributes;d={...d,data:{...d.data,attributes:t}}}i.push(new p(u,this.getSubLayerProps({id:e,updateTriggers:u.updateTriggers,highlightedObjectIndex:r}),d))}}return i}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"==typeof e?(t,s)=>{const{data:a,index:o}=s,i=(0,r.binaryToFeatureForAccesor)(a,o);return e(i,s)}:super.getSubLayerAccessor(e)}}exports.default=d,(0,e.default)(d,"layerName","GeoJsonLayer"),(0,e.default)(d,"defaultProps",u);
},{"@babel/runtime/helpers/esm/defineProperty":"iDM3","@deck.gl/core":"vvxL","../utils":"kI2N","./geojson-binary":"phHP","./sub-layer-map":"kNZX","./geojson":"Rrkn","./geojson-layer-props":"RGbO"}],"aWVN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ArcLayer",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"BitmapLayer",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"ColumnLayer",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(exports,"GeoJsonLayer",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(exports,"GridCellLayer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"IconLayer",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"LineLayer",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"PathLayer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"PointCloudLayer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"PolygonLayer",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(exports,"ScatterplotLayer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(exports,"SolidPolygonLayer",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(exports,"TextLayer",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"_MultiIconLayer",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(exports,"_TextBackgroundLayer",{enumerable:!0,get:function(){return b.default}});var e=g(require("./arc-layer/arc-layer")),r=g(require("./bitmap-layer/bitmap-layer")),t=g(require("./icon-layer/icon-layer")),n=g(require("./line-layer/line-layer")),u=g(require("./point-cloud-layer/point-cloud-layer")),a=g(require("./scatterplot-layer/scatterplot-layer")),l=g(require("./column-layer/column-layer")),o=g(require("./column-layer/grid-cell-layer")),i=g(require("./path-layer/path-layer")),y=g(require("./polygon-layer/polygon-layer")),c=g(require("./geojson-layer/geojson-layer")),f=g(require("./text-layer/text-layer")),p=g(require("./solid-polygon-layer/solid-polygon-layer")),d=g(require("./text-layer/multi-icon-layer/multi-icon-layer")),b=g(require("./text-layer/text-background-layer/text-background-layer"));function g(e){return e&&e.__esModule?e:{default:e}}
},{"./arc-layer/arc-layer":"x0jA","./bitmap-layer/bitmap-layer":"hMcC","./icon-layer/icon-layer":"NHB3","./line-layer/line-layer":"RubV","./point-cloud-layer/point-cloud-layer":"cUWd","./scatterplot-layer/scatterplot-layer":"s9mM","./column-layer/column-layer":"Gz3O","./column-layer/grid-cell-layer":"zas9","./path-layer/path-layer":"Exm7","./polygon-layer/polygon-layer":"ByLy","./geojson-layer/geojson-layer":"qWvc","./text-layer/text-layer":"pt2s","./solid-polygon-layer/solid-polygon-layer":"KN28","./text-layer/multi-icon-layer/multi-icon-layer":"oA4s","./text-layer/text-background-layer/text-background-layer":"hOrs"}],"Qf5s":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.style=void 0;var e={backgroundColor:"#ECE0CA",styleGroups:{landuse:[{zIndex:0,type:"Polygon",fill:"#ECE0CA"}],pier:[{zIndex:1,type:"Polygon",fill:"#ECE0CA",stroke:"#c8b89d",strokeWidth:2}],park:[{zIndex:1,type:"Polygon",fill:"#c8dd97"}],nature_reserve:[{zIndex:1,type:"Polygon",fill:"#dadeb0"}],hospital:[{zIndex:1,type:"Polygon",fill:"#f3d3d3"}],water:[{zIndex:2,type:"Polygon",fill:"rgb(120,188,237)"}],path:[{zIndex:3,type:"Line",stroke:"#c8b89d",strokeWidth:"1m"}],tunnel:[{zIndex:3,type:"Line",stroke:"#ffffff",strokeWidth:{15:4,20:16},strokeDasharray:[4,4]}],ferry:[{zIndex:4,type:"Line",stroke:"#164ac8",strokeWidth:1}],highway:[{zIndex:5,type:"Line",stroke:"white",repeat:128,strokeWidth:{10:1.5,15:4,16:"12m"}}],boundaries:[{zIndex:6,type:"Line",stroke:"#b3b1ad",strokeWidth:{10:.5,20:2}}],buildings:[{zIndex:7,type:"Polygon",fill:"rgba(170,170,170,0.7)",stroke:"rgba(30,30,30,0.7)",extrude:function(e){return e.properties.height||0},extrudeBase:function(e){return e.properties.min_height||0}}],roads:[{zIndex:4,type:"Line",stroke:"#ffffff",strokeWidth:{15:1,16:"5m"}},{zIndex:6,type:"Text",fill:"#222222",font:"12px sans-serif",strokeWidth:4,stroke:"white",text:function(e){return e.properties.name},repeat:128,alignment:"map",priority:2}],places:[{zIndex:8,type:"Text",text:function(e){return e.properties.name},stroke:"black",fill:"white",font:"18px sans-serif",strokeWidth:4,collide:!1,alignment:"viewport",priority:1}]},assign:function(e,t){var r=e.properties,n=r.kind,i=r.layer,s=e.geometry.type;if("landuse"==i)switch(n){case"pier":return"pier";case"nature_reserve":return"nature_reserve";case"park":case"garden":case"pedestrian":case"forrest":return"park";case"hospital":return"hospital";default:return"landuse"}if("water"==i){if("LineString"==s||"MultiLineString"==s)return}else if("roads"==i){if("rail"==n||"ferry"==n)return;if(r.is_tunnel&&t>13)return"tunnel";if("highway"==n||"path"==n)return n}return i}};exports.style=e;
},{}],"uecR":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec3=exports.parseJSONArray=exports.global=exports.geotools=exports.geometry=exports.default=exports.TaskManager=exports.Task=exports.Set=exports.Queue=exports.Map=exports.Listener=exports.LRU=exports.JSUtils=void 0;var e="undefined"!=typeof window?window:t,n=0,r=function(){function t(t,e,r,i,o,s,a,u){this.id=++n,this.exec=r,i&&(this.init=i),this.delay=0^u,this.name=a,this.time=o||100,this.priority=Math.max(Math.min(0^e,5),1),this.manager=t,s&&(this.onDone=s)}return t.prototype.start=function(t){var e=this;return e._data=t,e.manager.start(e)},t.prototype.restart=function(t){void 0===t&&(t={});var e=this._data;this.cancel(),this.canceled=!1,this.paused=!1,this.delayed=null,this.heap=null,this._data=e,t.init&&(this.init=t.init),t.priority&&(this.priority=t.priority),t.onDone&&(this.onDone=t.onDone),this.start()},t.prototype.init=function(t){return t},t.prototype.cancel=function(){var t=this;return t._data=null,t.manager.cancel(t)},t}();exports.Task=r,exports.global=e,r.prototype.CONTINUE=!0,r.prototype.BREAK=!1,r.prototype.onDone=null,r.prototype.heap=null,r.prototype.paused=!1,r.prototype.delayed=null,r.prototype.yielded=!1,r.prototype.canceled=!1;var i,o=1e3/60,s=0,a=function(){function t(t){this.time=o,this._delayed=null,this.now=Date.now;var n=this;if(n.queue=[[],[],[],[],[],[]],n.id=s++,n.active=!1,t>1&&(n.time=t||o),e.postMessage){var r="tm-"+n.id;e.addEventListener("message",function(t){t.source==e&&t.data==r&&(t.stopPropagation(),n.runner())},!0),n._resume=function(){n.active=!0,e.postMessage(r,"*")}}else n._resume=function(){n.active=!0,setTimeout(n.runner.bind(n),0)}}return t.prototype.runner=function(t){var e,n,r,i,o,s,a,u,h,p=this,c=!0;if(t=t||p.now(),p.active){for(;(c=p.now()-t<p.time)&&(p.task=s=p._next());){for(h=!1,a=!1,s.paused?(s.paused=!1,u=s.heap):(r=p.now(),u=s.init(s._data));!a;)if(i=r||p.now(),a=!s.exec(u)||s.canceled,n=(o=p.now())-i,r=null,e=o-t>p.time,p.task=null,!a&&(s.paused||n>=s.time)||e){if(a||(p._insert(p.task=s,!0),s.paused=!0,s.heap=u),e)return a&&!s.canceled&&(s.started=!1,s.onDone&&s.onDone(u)),p._resume();h=!0;break}h||(s.paused=!1,s.heap=null,s.canceled||(s.started=!1,s.onDone&&s.onDone(u)))}if(!c)return p._resume();p.active=!1}else p._resume()},t.prototype.setExclusiveTime=function(t){this.time=0^t},t.prototype._next=function(){var t,n=this,r=n.queue,i=r[0][0],o=n.now();if(i&&o>=i.delayed)return n._delayed&&e.clearTimeout(n._delayed),n.queue[0].shift();for(var s=1,a=r.length;s<a;s++)if(t=r[s].shift())return t;i&&(n._delayed&&e.clearTimeout(n._delayed),n._delayed=e.setTimeout(function(){n._delayed=null,n.active=!0,n.runner()},i.delayed-o))},t.prototype.create=function(t){return new r(this,t.priority,t.exec,t.init,t.time,t.onDone,t.name,t.delay)},t.prototype._insert=function(t,e){var n;if(t.delay){t.delayed=this.now()+t.delay;for(var r=0,i=(n=this.queue[0]).length-1,o=void 0;r<=i;)if(n[o=(r+i)/2|0].delayed>t.delayed)i=o-1;else if(r=o+1,n[o].delayed==t.delayed)break;n.splice(r,0,t)}else n=this.queue[t.priority],e?n.unshift(t):n.push(t)},t.prototype.isWaiting=function(t){return-1!=this.queue[t.delay?0:t.priority].indexOf(t)},t.prototype.start=function(t,e){var n=this.task;t.started||(t.started=!0,t!=n&&(t.canceled=!1,this._insert(t),this.active?n&&n.priority>t.priority&&(n.paused=!0):(this.active=!!e,this.runner())))},t.prototype.cancel=function(t){t.canceled=!0,t.paused=!1,t.started=!1;var e=t==this.task,n=t.delay?0:t.priority,r=this.queue[n],i=r.indexOf(t);return-1!=i&&r.splice(i,1),e&&(this.task=null),e},t}(),u={getInstance:function(t){return i?"number"==typeof t&&(i.time=t):i=this.createInstance(t),i},createInstance:function(t){return this.active=!0,new a(t)},active:!1},h=function(t,e,n){for(var r=-1,i=0;i<t.length;i++)if(t[i][0]==e&&t[i][1]==n){r=i;break}return r},p=function(){function t(t){this._l={},this._sync=!1,this._exec={};for(var e=0;e<t.length;e++)this.addEvent(t[e])}return t.prototype.addEvent=function(t){this._l[t]||(this._l[t]=[],this._exec[t]=void 0)},t.prototype.sync=function(t){return this._sync=!!t,this},t.prototype.removeEvent=function(t){delete this._l[t]},t.prototype.getEvents=function(){var t=[];for(var e in this._l)t[t.length]=e;return t},t.prototype.get=function(t){var e=this._l[t];return e&&e.slice()},t.prototype.isDefined=function(t){return!!this._l[t]},t.prototype.isListened=function(t){return this._l[t]&&this._l[t].length},t.prototype.add=function(t,e,n){var r=!1;return this._l.hasOwnProperty(t)&&-1==h(this._l[t],e,n)&&(this._l[t].push([e,n]),r=!0),r},t.prototype.remove=function(t,e,n){if(this._l.hasOwnProperty(t)){var r=h(this._l[t],e,n);if(-1!=r)return this._exec[t]--,this._l[t].splice(r,1),!0}return!1},t.prototype.trigger=function(t,e,n,r){var i,o=!1;if(this._l[t]){var s=this._l[t].length;for(this._exec[t]=0;this._exec[t]<s;this._exec[t]++)if(o=!0,i=this._l[t][this._exec[t]]){if(r&&!r(i))continue;var a=i[0],u=i[1];n||this._sync?Array.isArray(e)?a.apply(u,e):a.call(u,e):function(t,e,n){setTimeout(function(){Array.isArray(n)?t.apply(e,n):t.call(e,n)},0)}(a,u,e)}this._exec[t]=void 0}return o},t}(),c=function(t,e){this.key=t,this.data=e};exports.Listener=p,exports.TaskManager=u,c.prototype.data=null,c.prototype.next=null,c.prototype.prev=null;var l=function(){function t(t){this.length=0,this.head=null,this.tail=null,this.max=t||5e3,this._={},this.tail=null}return t.prototype.setSize=function(t){if(this.length>t)for(var e=this.length-t;e--;)this.remove(this.tail.key);this.max=t},t.prototype.get=function(t){var e,n,r;return(e=this._[t])&&(e!=this.head&&(this.tail==e&&(this.tail=e.next),n=e.prev,r=e.next,n&&(n.next=e.next||e),r&&(r.prev=n),(n=this.head)&&(n.next=e),e.prev=this.head,e.next=null,this.head=e),e=e.data),e},t.prototype.toArray=function(){for(var t=[],e=this.tail,n=0;e;)t[n++]=e.data,e=e.next;return t},t.prototype.forEach=function(t){for(var e=this.tail,n=0;e;)t(e.data,n++),e=e.next},t.prototype.clear=function(){this._={},this.head=null,this.tail=null,this.length=0},t.prototype.remove=function(t){var e,n,r;return(e=this._[t])&&(n=e.prev,r=e.next,n&&(n.next=r),r&&(r.prev=n),r||(this.head=n),n||(this.tail=r),delete this._[t],e=e.data,this.length--),e},t.prototype.set=function(t,e){var n,r,i;return(n=this._[t])?(n.data=e,n!=this.head&&this.get(t)):(this.length==this.max?(i=this.tail.data,delete this._[this.tail.key],this.tail=this.tail.next,this.tail.prev=null):this.length++,n=new c(t,e),this._[t]=n,(r=this.head)?(n.prev=r,r.next=n):this.tail=n,this.head=n),i},t}(),f=u.getInstance(13),d=function(t,e,n){n=n||f;var r=t.indexOf("["),i=t.lastIndexOf("]"),o=function(e,n){e.grp=20,e.elements.push.apply(e.elements,JSON.parse("["+t.slice(e.start,n)+"]")),e.start=null};n.create({name:"PJA",priority:4,time:4,onDone:function(n){if(e){var o=void 0,s=n.elements;if(s.length)if(-1!=t.indexOf('"type":"FeatureCollection"')){var a=JSON.parse(t.substr(0,r+1)+t.substr(i));a.features=s,o=a}else o=s;else o=JSON.parse(t);e(o)}},init:function(){return{i:r,open:0,start:null,len:i,elements:[],grp:20,last:null}},exec:function(e){var n,r,i=e.elements,s=e.len;if(e.i<s){for(;(n=e.i++)<s;)if('"'!=(r=t.charAt(n))){if("{"==r)e.open++,null==e.start&&(e.start=n);else if("}"==r){if(0==--e.open)return--e.grp&&n<s-2||(e.grp=20,i.push.apply(i,JSON.parse("["+t.slice(e.start,e.last=n+1)+"]")),e.start=null),this.CONTINUE}else if(0==e.open&&!isNaN(r)){20!=e.grp&&o(e,n-1);var a=t.substr(n),u=a.search("[0-9](]|,)")+1;i.push(parseFloat(a.substring(0,u))),e.i=n+u}}else e.i=t.indexOf('"',n+1)+1;20!=e.grp&&null!=e.last&&i.push.apply(i,JSON.parse("["+t.slice(e.last+1,t.lastIndexOf("]"))+"]"))}}}).start()},y=function(t,e,n){if(null==n||"object"!=typeof n)return n;if(n.constructor!=Object&&n.constructor!=Array)return n;if(n.constructor==Date||n.constructor==RegExp||n.constructor==Function||n.constructor==String||n.constructor==Number||n.constructor==Boolean)return new n.constructor(n);for(var r in e=e||new n.constructor,n)e[r]=y(t,t?e[r]:null,n[r]);return e},v=function(t,e){for(var n in e)"constructor"!=n&&(t[n]=e[n]);return t},_=function(t){var e,n;if("object"!=typeof t)return t;if(!t)return t;if("[object Array]"===Object.prototype.toString.apply(t)){for(e=[],n=0;n<t.length;n+=1)e[n]=_(t[n]);return e}for(n in e={},t)t.hasOwnProperty(n)&&(e[n]=_(t[n]));return e},x={loglevel:"debug",dump:function(t,e){var n=!!x.loglevel,r=Array.prototype.slice.call(arguments),i=r[r.length-1],o=window.console;if(n&&o&&(i in o?r.pop():i="log",!0===n||n===i))if(Function.prototype.bind&&"object"==typeof o.log){Function.prototype.bind.call(o[i],o).apply(o,r)}else o[i].apply(o,r);return x},extend:function(t,e,n){return"boolean"!=typeof t&&(n=e,e=t,t=!1),y(t,e,n)},clone:_,createObject:Object.create||function(t){var e=function(){};return e.prototype=t,new e},inheritClass:function(t,e,n){var r=e.prototype,i=t.prototype;for(var o in"object"==typeof e&&(n=e,e.constructor==Object.prototype.constructor&&(e.constructor=function(){t.apply(this,arguments)}),e=e.constructor),e.prototype=x.createObject(i),r&&r!=Object.prototype&&v(e.prototype,r),t)e[o]=t[o];return n&&v(e.prototype,n),e},isFunction:function(t){return"function"==typeof t},isNumeric:function(t){return!isNaN(+t)&&isFinite(t)},isPlainObject:function(t){if(!t||"object"!=typeof t||t.nodeType||t==t.window)return!1;try{if(t.constructor&&!t.hasOwnProperty("constructor")&&!t.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1}catch(t){return!1}var e;for(e in t);return void 0===e||t.hasOwnProperty(e)},String:{round:function(t,e){return e?Number(t.toFixed(e)):Math.round(t)},random:function(t){t=t||16;for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz",r=n.length,i=0;i<t;i++)e+=n.charAt(Math.random()*r^0);return e}}},g=Math.PI/180,M=180/Math.PI,m={calcBearing:function(t,e){var n,r,i,o,s;return n=Math.PI/180,r=t[1]*n,i=e[1]*n,o=t[0]*n,s=e[0]*n,(Math.atan2(Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(s-o),Math.sin(s-o)*Math.cos(i))/n+360)%360},movePoint:function(t,e,n,r){var i=e/(r=void 0===r?6371e3:r),o=n*g,s=t[1]*g,a=t[0]*g,u=Math.asin(Math.sin(s)*Math.cos(i)+Math.cos(s)*Math.sin(i)*Math.cos(o)),h=a+Math.atan2(Math.sin(o)*Math.sin(i)*Math.cos(s),Math.cos(i)-Math.sin(s)*Math.sin(u));return[(h=(h+3*Math.PI)%(2*Math.PI)-Math.PI)*M,u*M]},getPointBBox:function(t,e){var n=t[1],r=t[0],i=Math.asin(e/(6371e3*Math.cos(Math.PI*n/180)))*M,o=Math.asin(e/6371e3)*M;return[r-i,n-o,r+i,n+o]},mergeBBoxes:function(t,e){return t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[2]&&(t[2]=e[2]),t[3]<e[3]&&(t[3]=e[3]),t},extendBBox:function(t,e){var n=Math.abs(Math.asin(e/(6371e3*Math.cos(t[0]*g))))*M,r=Math.abs(Math.asin(e/(6371e3*Math.cos(t[2]*g))))*M,i=Math.abs(Math.asin(e/6371e3))*M;return[t[0]-n,t[1]-i,t[2]+r,t[3]+i]},distance:function(t,e){var n=g*(e[1]-t[1]),r=g*(e[0]-t[0]),i=Math.sin(n/2)*Math.sin(n/2)+Math.cos(g*t[1])*Math.cos(g*e[1])*Math.sin(r/2)*Math.sin(r/2),o=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371e3;if(null!=t[2]&&null!=e[2]){var s=t[2]-e[2];o=Math.sqrt(o*o+s*s)}return o}},b={centroid:function(t){for(var e,n,r=t[0],i=r[0][0],o=r[0][1],s=0,a=0,u=0,h=0,p=r.length,c=p-1,l=void 0,f=void 0,d=void 0;h<p;c=h,h++)e=r[h][0]-i,n=r[h][1]-o,a+=(e+(l=r[c][0]-i))*(d=n*l-(f=r[c][1]-o)*e),u+=(n+f)*d,s+=d;return(s*=3)?[a/s+i,u/s+o]:[e,n]}},O=function(){function t(t){if(this.size=0,this._=[],t)for(var e=0;e<t.length;e++)this.add(t[e])}return t.prototype.add=function(t){var e=!this.has(t);return e&&(this.size=this._.push(t)),e},t.prototype.clear=function(){this.size=this._.length=0},t.prototype.delete=function(t){var e=this._.indexOf(t),n=-1!=e;return n&&(this._.splice(e,1),this.size--),n},t.prototype.has=function(t){return-1!=this._.indexOf(t)},t.prototype.toArray=function(){return this._.slice(0)},t}(),w=function(){function t(t){if(this._={},this.size=0,t)for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1])}return t.prototype.clear=function(){this.size=0,this._={}},t.prototype.delete=function(t){var e=this.has(t);return e&&(delete this._[t],this.size--),e},t.prototype.get=function(t){return this._[t]},t.prototype.has=function(t){return null!=this._[t]},t.prototype.set=function(t,e){var n=!this.has(t);return n&&(this.size++,this._[t]=e),n},t.prototype.values=function(){var t=this._,e=[];for(var n in t)e[e.length]=t[n];return e},t.prototype.keys=function(){var t=this._,e=[];for(var n in t)e[e.length]=n;return e},t.prototype.forEach=function(t){var e=this._;for(var n in e)t(e[n],n,this)},t}(),P=function(){function t(){this.queue=[]}return t.prototype.add=function(t){if("function"==typeof t)return this.queue.push(t)},t.prototype.done=function(t,e,n){for(var r=this.queue;r.length;)r.shift().apply(void 0,arguments)},t}(),N=Object.freeze({__proto__:null,sub:function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},multiply:function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},scale:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},normalize:function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},cross:function(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t},transform:function(t,e,n){var r=e[0],i=e[1],o=e[2]||0,s=n[3]*r+n[7]*i+n[11]*o+n[15];return s||(s=1),t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}}),k=e;exports.vec3=N,exports.Queue=P,exports.Map=w,exports.Set=O,exports.geometry=b,exports.geotools=m,exports.JSUtils=x,exports.parseJSONArray=d,exports.LRU=l,"here.xyz.maps".split(".").forEach(function(t){return k=k[t]=k[t]||{}}),e.HERE=e.here;var S={LRU:l,TaskManager:u,Listener:p,parseJSONArray:d,JSUtils:x,geotools:m,global:e,Queue:P,Set:O,Map:w,vec3:N,geometry:b};exports.default=S,k.common=S;
},{}],"V0BL":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,e=arguments[3];!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof t&&t.amd?t(r):((e="undefined"!=typeof globalThis?globalThis:e||self).here=e.here||{},e.here.xyz=e.here.xyz||{},e.here.xyz.maps=r())}(this,function(){"use strict";let t,r;function n(e,n){if(t)if(r){const e=here.xyz.maps,i={};t(i),e.__workerURL=window.URL.createObjectURL(new Blob(["var shared={};("+t+")(shared);("+r+")(shared);"],{type:"text/javascript"})),n(e,i,e.common)}else r=n;else t=n}n(0,function(t){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,r)};function r(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}t.__assign=function(){return t.__assign=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},t.__assign.apply(this,arguments)};var n=function(){function t(t){this.bO=0,"number"==typeof t&&(t=new ArrayBuffer(t)),this.dV=new DataView(t),this.aB=t}return t.prototype.setUint16Array=function(t){var e=this.bO,r=t.length;this.dV.setUint32(e,r),new Uint16Array(this.aB,e+4,r).set(t),this.bO+=4+2*r},t.prototype.setLayer=function(t,e){var r=this.dV,n=this.bO;r.setUint16(n,Number(t)),r.setUint32(n+2,e),this.bO+=6},t.prototype.setFeature=function(t,e){this.dV.setUint16(this.bO,t),this.bO+=2,this.setUint16Array(e)},t.prototype.getLayers=function(){for(var t=this.dV,e=t.byteLength,r=0,n={};r<e;){var i=t.getUint16(r),o=2*t.getUint32(r+2);r+=6,n[i]={offset:r,length:o,features:null},r+=o}return n},t.prototype.getFeatures=function(t){if(t.features)return t.features;for(var e=t.features={},r=this.dV,n=this.aB,i=t.offset,o=i+t.length;i<o;){var s=r.getUint16(i),a=r.getUint32(i+2);i+=6,e[s]=new Uint16Array(n,i,a),i+=2*a}},t.prototype.getBuffer=function(){return this.aB},t}(),i=function(){function t(t){for(var e in this.withCredentials=!1,this.responseType="",t)this[e]=t[e]}return t.prototype.send=function(t){var e=t.success,r=t.error,n=t.responseType||this.responseType,i=t.headers,o=new XMLHttpRequest,s=t.withCredentials;if(o.withCredentials=null!=s?s:this.withCredentials,o.responseType="json"==n?"text":n,o.onload=function(){var t,r,i=this.responseType;""==i||"text"==i?(r=(t=this.responseText).length,"json"==n&&204!=this.status&&(t=JSON.parse(t))):r=(t=this.response).byteLength,this.status>=200&&this.status<=226&&e(t,r)},o.onreadystatechange=function(){4==this.readyState&&(this.status<200||this.status>=300)&&(this.onload=null,0!==this.status&&r&&r(this))},o.open(t.type||"GET",t.url,!0),i)for(var a in i)o.setRequestHeader(a,i[a]);return o.send(t.data||null),o},t}(),o={},s=/{([xX]|(COL))}/,a=/{([yY]|(ROW))}/,u=/{([zZ]|(LEVEL))}/,h=/{((qk)|(QK)|(quadkey)|(QUADKEY))}/,p=/{SUBDOMAIN_INT_1_4}/,l=/{SUBDOMAIN_INT}/,f=/{SUBDOMAIN_CHAR}/,c=function(t){function e(e){var r=t.call(this,"Service request failed with HTTP status: '"+e.status+" "+e.statusText+"'")||this;r.name="NetworkError";var n=r,i=e.responseType;return n.statusCode=e.status,""!=i&&"text"!=i||(n.responseText=e.responseText||null),r}return r(e,t),e}(Error),d=function(){function e(e){this.withCredentials=!1,this.headers=null,this.store=null,this.baseUrl=null,this.q={};var r=e.responseType||"json",n=e.src||e.url,s=!!e.withCredentials;this.withCredentials=s,this.baseUrl=n,this.headers=t.__assign(t.__assign({},o),e.headers||{}),"function"==typeof n&&(this.getUrl=function(t){return n(t.z,t.y,t.x,t.quadkey)}),this.http=new i({responseType:r,withCredentials:s}),this.tileType=e.tileType}return e.createImageFromBlob=function(t,e){var r=new Image;return r.onload=function(t){window.URL.revokeObjectURL(r.src),e&&e(r)},r.src=window.URL.createObjectURL(t),r},e.prototype.getUrl=function(t){var e=4*Math.random()^0;return this.baseUrl.replace(p,e+1).replace(l,e).replace(f,"abcd"[e]).replace(h,t.quadkey).replace(u,t.z).replace(s,t.x).replace(a,t.y)},e.prototype.setUrl=function(t){this.baseUrl=t},e.prototype.load=function(t,r,n){var i,o=this.getUrl(t),s=t.quadkey,a=this.q,u={id:s,url:o,success:r,error:n},h=this.tileType||t.type;"image"==h?(u.responseType="blob",u.success=function(t){a[s]=i,e.createImageFromBlob(t,function(t){delete a[s],i._aborted||r(t)})}):("json"==h&&(u.success=function(t,e){r("FeatureCollection"==t.type?t.features:t,e)}),u.headers=this.headers),i=this.send(u)},e.prototype.abort=function(t){var e=this.q,r=t.quadkey,n=e[r];n&&("image"==t.type&&(n.onload=void 0,n._aborted=!0),n.abort&&n.abort(),delete e[r])},e.prototype.send=function(t){var e=t.id||t.key||Math.random(),r=this.q,n=t.success,i=t;i.success=function(t,i){delete r[e],n(t,i)};var o=t.error;return i.error=function(t){delete r[e],o&&o(new c(t),t)},r[e]=this.http.send(i)},e}(),y=g,v={read:function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,h=u>>1,p=-7,l=r?i-1:0,f=r?-1:1,c=t[e+l];for(l+=f,o=c&(1<<-p)-1,c>>=-p,p+=a;p>0;o=256*o+t[e+l],l+=f,p-=8);for(s=o&(1<<-p)-1,o>>=-p,p+=n;p>0;s=256*s+t[e+l],l+=f,p-=8);if(0===o)o=1-h;else{if(o===u)return s?NaN:1/0*(c?-1:1);s+=Math.pow(2,n),o-=h}return(c?-1:1)*s*Math.pow(2,o-n)},write:function(t,e,r,n,i,o){var s,a,u,h=8*o-i-1,p=(1<<h)-1,l=p>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,c=n?0:o-1,d=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=p):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+l>=1?f/u:f*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=p?(a=0,s=p):s+l>=1?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[r+c]=255&a,c+=d,a/=256,i-=8);for(s=s<<i|a,h+=i;h>0;t[r+c]=255&s,c+=d,s/=256,h-=8);t[r+c-d]|=128*y}};function g(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}g.Varint=0,g.Fixed64=1,g.Bytes=2,g.Fixed32=5;var x=4294967296,m=1/x,_="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function w(t){return t.type===g.Bytes?t.readVarint()+t.pos:t.pos+1}function b(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function L(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function T(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function M(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function F(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function P(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function S(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function B(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function k(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function E(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function U(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function O(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function C(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function R(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}g.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=O(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=R(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=O(this.buf,this.pos)+O(this.buf,this.pos+4)*x;return this.pos+=8,t},readSFixed64:function(){var t=O(this.buf,this.pos)+R(this.buf,this.pos+4)*x;return this.pos+=8,t},readFloat:function(){var t=v.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=v.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,o=r.buf;if(n=(112&(i=o[r.pos++]))>>4,i<128)return b(t,n,e);if(n|=(127&(i=o[r.pos++]))<<3,i<128)return b(t,n,e);if(n|=(127&(i=o[r.pos++]))<<10,i<128)return b(t,n,e);if(n|=(127&(i=o[r.pos++]))<<17,i<128)return b(t,n,e);if(n|=(127&(i=o[r.pos++]))<<24,i<128)return b(t,n,e);if(n|=(1&(i=o[r.pos++]))<<31,i<128)return b(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&_?function(t,e,r){return _.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){for(var n="",i=e;i<r;){var o,s,a,u=t[i],h=null,p=u>239?4:u>223?3:u>191?2:1;if(i+p>r)break;1===p?u<128&&(h=u):2===p?128==(192&(o=t[i+1]))&&(h=(31&u)<<6|63&o)<=127&&(h=null):3===p?(o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&((h=(15&u)<<12|(63&o)<<6|63&s)<=2047||h>=55296&&h<=57343)&&(h=null)):4===p&&(o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((h=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,p=1):h>65535&&(h-=65536,n+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),n+=String.fromCharCode(h),i+=p}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==g.Bytes)return t.push(this.readVarint(e));var r=w(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==g.Bytes)return t.push(this.readSVarint());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==g.Bytes)return t.push(this.readBoolean());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==g.Bytes)return t.push(this.readFloat());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==g.Bytes)return t.push(this.readDouble());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed32());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed32());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed64());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed64());var e=w(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===g.Varint)for(;this.buf[this.pos++]>127;);else if(e===g.Bytes)this.pos=this.readVarint()+this.pos;else if(e===g.Fixed32)this.pos+=4;else{if(e!==g.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),C(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),C(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),C(this.buf,-1&t,this.pos),C(this.buf,Math.floor(t*m),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),C(this.buf,-1&t,this.pos),C(this.buf,Math.floor(t*m),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&L(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),v.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),v.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&L(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,g.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,T,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,M,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,S,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,F,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,P,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,B,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,k,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,E,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,U,e)},writeBytesField:function(t,e){this.writeTag(t,g.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,g.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,g.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,g.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,g.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,g.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,g.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,g.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,g.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,g.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var z={},V=q;function q(t,e){this.x=t,this.y=e}q.prototype={clone:function(){return new q(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},q.convert=function(t){return t instanceof q?t:Array.isArray(t)?new q(t[0],t[1]):t};var D=V,A=I;function I(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(Y,this,e)}function Y(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function X(t){for(var e,r,n=0,i=0,o=t.length,s=o-1;i<o;s=i++)e=t[i],n+=((r=t[s]).x-e.x)*(e.y+r.y);return n}I.types=["Unknown","Point","LineString","Polygon"],I.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,n=1,i=0,o=0,s=0,a=[];t.pos<r;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)o+=t.readSVarint(),s+=t.readSVarint(),1===n&&(e&&a.push(e),e=[]),e.push(new D(o,s));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&a.push(e),a},I.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,s=1/0,a=-1/0,u=1/0,h=-1/0;t.pos<e;){if(n<=0){var p=t.readVarint();r=7&p,n=p>>3}if(n--,1===r||2===r)(i+=t.readSVarint())<s&&(s=i),i>a&&(a=i),(o+=t.readSVarint())<u&&(u=o),o>h&&(h=o);else if(7!==r)throw new Error("unknown command "+r)}return[s,u,a,h]},I.prototype.toGeoJSON=function(t,e,r){var n,i,o=this.extent*Math.pow(2,r),s=this.extent*t,a=this.extent*e,u=this.loadGeometry(),h=I.types[this.type];function p(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+a)/o;t[e]=[360*(r.x+s)/o-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var l=[];for(n=0;n<u.length;n++)l[n]=u[n][0];p(u=l);break;case 2:for(n=0;n<u.length;n++)p(u[n]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],o=0;o<e;o++){var s=X(t[o]);0!==s&&(void 0===n&&(n=s<0),n===s<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}return r&&i.push(r),i}(u),n=0;n<u.length;n++)for(i=0;i<u[n].length;i++)p(u[n][i])}1===u.length?u=u[0]:h="Multi"+h;var f={type:"Feature",geometry:{type:h,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f};var j=A,G=Z;function Z(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(N,this,e),this.length=this._features.length}function N(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(r))}Z.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new j(this._pbf,e,this.extent,this._keys,this._values)};var H=G;function J(t,e,r){if(3===t){var n=new H(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}var W=z.VectorTile=function(t,e){this.layers=t.readFields(J,{},e)};z.VectorTileFeature=A,z.VectorTileLayer=G,t.HTTPLoader=d,t.VectorTile=W,t.XYZBin=n,t.__extends=r,t.pbf=y,t.vectorTile=z}),n(0,function(t){var e={exports:{}};function r(t,e,r){r=r||2;var i,s,a,u,h,f,c,y=e&&e.length,v=y?e[0]*r:t.length,g=n(t,0,v,r,!0),x=[];if(!g||g.next===g.prev)return x;if(y&&(g=function(t,e,r,i){var o,s,a,u=[];for(o=0,s=e.length;o<s;o++)(a=n(t,e[o]*i,o<s-1?e[o+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),u.push(d(a));for(u.sort(p),o=0;o<u.length;o++)r=l(u[o],r);return r}(t,e,g,r)),t.length>80*r){i=a=t[0],s=u=t[1];for(var m=r;m<v;m+=r)(h=t[m])<i&&(i=h),(f=t[m+1])<s&&(s=f),h>a&&(a=h),f>u&&(u=f);c=0!==(c=Math.max(a-i,u-s))?32767/c:0}return o(g,x,r,i,s,c,0),x}function n(t,e,r,n,i){var o,s;if(i===P(t,e,r,n)>0)for(o=e;o<r;o+=n)s=T(o,t[o],t[o+1],s);else for(o=r-n;o>=e;o-=n)s=T(o,t[o],t[o+1],s);return s&&x(s,s.next)&&(M(s),s=s.next),s}function i(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!x(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(M(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function o(t,e,r,n,p,l,f){if(t){!f&&l&&function(t,e,r,n){var i=t;do{0===i.z&&(i.z=c(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,s,a,u,h=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,n=r,a=0,e=0;e<h&&(a++,n=n.nextZ);e++);for(u=h;a>0||u>0&&n;)0!==a&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,h*=2}while(s>1)}(i)}(t,n,p,l);for(var d,y,v=t;t.prev!==t.next;)if(d=t.prev,y=t.next,l?a(t,n,p,l):s(t))e.push(d.i/r|0),e.push(t.i/r|0),e.push(y.i/r|0),M(t),t=y.next,v=y.next;else if((t=y)===v){f?1===f?o(t=u(i(t),e,r),e,r,n,p,l,2):2===f&&h(t,e,r,n,p,l):o(i(t),e,r,n,p,l,1);break}}}function s(t){var e=t.prev,r=t,n=t.next;if(g(e,r,n)>=0)return!1;for(var i=e.x,o=r.x,s=n.x,a=e.y,u=r.y,h=n.y,p=i<o?i<s?i:s:o<s?o:s,l=a<u?a<h?a:h:u<h?u:h,f=i>o?i>s?i:s:o>s?o:s,c=a>u?a>h?a:h:u>h?u:h,d=n.next;d!==e;){if(d.x>=p&&d.x<=f&&d.y>=l&&d.y<=c&&y(i,a,o,u,s,h,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function a(t,e,r,n){var i=t.prev,o=t,s=t.next;if(g(i,o,s)>=0)return!1;for(var a=i.x,u=o.x,h=s.x,p=i.y,l=o.y,f=s.y,d=a<u?a<h?a:h:u<h?u:h,v=p<l?p<f?p:f:l<f?l:f,x=a>u?a>h?a:h:u>h?u:h,m=p>l?p>f?p:f:l>f?l:f,_=c(d,v,e,r,n),w=c(x,m,e,r,n),b=t.prevZ,L=t.nextZ;b&&b.z>=_&&L&&L.z<=w;){if(b.x>=d&&b.x<=x&&b.y>=v&&b.y<=m&&b!==i&&b!==s&&y(a,p,u,l,h,f,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,L.x>=d&&L.x<=x&&L.y>=v&&L.y<=m&&L!==i&&L!==s&&y(a,p,u,l,h,f,L.x,L.y)&&g(L.prev,L,L.next)>=0)return!1;L=L.nextZ}for(;b&&b.z>=_;){if(b.x>=d&&b.x<=x&&b.y>=v&&b.y<=m&&b!==i&&b!==s&&y(a,p,u,l,h,f,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;L&&L.z<=w;){if(L.x>=d&&L.x<=x&&L.y>=v&&L.y<=m&&L!==i&&L!==s&&y(a,p,u,l,h,f,L.x,L.y)&&g(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function u(t,e,r){var n=t;do{var o=n.prev,s=n.next.next;!x(o,s)&&m(o,n,n.next,s)&&b(o,s)&&b(s,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),M(n),M(n.next),n=t=s),n=n.next}while(n!==t);return i(n)}function h(t,e,r,n,s,a){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&v(u,h)){var p=L(u,h);return u=i(u,u.next),p=i(p,p.next),o(u,e,r,n,s,a,0),void o(p,e,r,n,s,a,0)}h=h.next}u=u.next}while(u!==t)}function p(t,e){return t.x-e.x}function l(t,e){var r=function(t,e){var r,n=e,i=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s&&(s=a,r=n.x<n.next.x?n:n.next,a===i))return r}n=n.next}while(n!==e);if(!r)return null;var u,h=r,p=r.x,l=r.y,c=1/0;n=r;do{i>=n.x&&n.x>=p&&i!==n.x&&y(o<l?i:s,o,p,l,o<l?s:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),b(n,t)&&(u<c||u===c&&(n.x>r.x||n.x===r.x&&f(r,n)))&&(r=n,c=u)),n=n.next}while(n!==h);return r}(t,e);if(!r)return e;var n=L(r,t);return i(n,n.next),i(r,r.next)}function f(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function c(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function y(t,e,r,n,i,o,s,a){return(i-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(n-a)>=(r-s)*(e-a)&&(r-s)*(o-a)>=(i-s)*(n-a)}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&m(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||x(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,r,n){var i=w(g(t,e,r)),o=w(g(t,e,n)),s=w(g(r,n,t)),a=w(g(r,n,e));return i!==o&&s!==a||!(0!==i||!_(t,r,e))||!(0!==o||!_(t,n,e))||!(0!==s||!_(r,t,n))||!(0!==a||!_(r,e,n))}function _(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function w(t){return t>0?1:t<0?-1:0}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function L(t,e){var r=new F(t.i,t.x,t.y),n=new F(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function T(t,e,r,n){var i=new F(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,r,n){for(var i=0,o=e,s=r-n;o<r;o+=n)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}e.exports=r,e.exports.default=r,r.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,s=Math.abs(P(t,0,o,r));if(i)for(var a=0,u=e.length;a<u;a++){var h=e[a]*r,p=a<u-1?e[a+1]*r:t.length;s-=Math.abs(P(t,h,p,r))}var l=0;for(a=0;a<n.length;a+=3){var f=n[a]*r,c=n[a+1]*r,d=n[a+2]*r;l+=Math.abs((t[f]-t[d])*(t[c+1]-t[f+1])-(t[f]-t[c])*(t[d+1]-t[f+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},r.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[i][o][s]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var S=function(t){var e=t._pbf;e.pos=t._geometry;for(var r,n=e.readVarint()+e.pos,i=1,o=0,s=0,a=0,u=[];e.pos<n;){if(o<=0){var h=e.readVarint();i=7&h,o=h>>3}if(o--,1===i||2===i)s+=e.readSVarint(),a+=e.readSVarint(),1===i&&(r&&u.push(r),r=[]),r.push([s,a]);else{if(7!==i)throw new Error("unknown command "+i);r&&r.push(r[0].slice())}}return r&&u.push(r),u};function B(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],o=0;o<e;o++){var s=k(t[o]);0!==s&&(void 0===n&&(n=s<0),n===s<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}return r&&i.push(r),i}function k(t){for(var e,r,n=0,i=0,o=t.length,s=o-1;i<o;s=i++)e=t[i],n+=((r=t[s])[0]-e[0])*(e[1]+r[1]);return n}var E=function(t,e){void 0===e&&(e=[]);for(var r=[],n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)e[e.length]=t[i][o][0],e[e.length]=t[i][o][1];i>0&&(n+=t[i-1].length,r[r.length]=n)}return{vertices:e,holes:r,dimensions:t[0][0].length}},U=[{id:"MVTWorker",Worker:function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(n,r),n.prototype.process=function(r,n,i,o){var s=function(r,n,i,o){var s=new t.VectorTile(new t.pbf(r)),a={},u=0,h=0,p=0;for(var l in s.layers){for(var f=s.layers[l],c=0,d=a[u++]={length:0,features:{}};c<f.length;){if(3==(C=f.feature(c)).type){for(var y=[],v=[],g=0,x=0,m=B(S(C));x<m.length;x++){var _=m[x],w=E(_),b=e.exports(w.vertices,w.holes,w.dimensions);v.push(g);for(var L=0,T=b;L<T.length;L++){var M=T[L];y[y.length]=g+M}g+=w.vertices.length/w.dimensions}d.features[c]={tris:y,verts:[],polys:v,holes:[]},d.length+=y.length+2+1}c++}d.length&&(p++,h+=2*d.length)}var F=new t.XYZBin(6*p+h);if(h>0)for(var P in a){var k=(d=a[P]).length;if(k){F.setLayer(P,k);var U=d.features;for(var O in U){var C;b=(C=U[O]).tris,F.setFeature(Number(O),b)}}}return F.getBuffer()}(r);return{data:{mvt:r,triangles:s},transfer:[r,s]}},n}(function(){function e(){var e=this.loader=new t.HTTPLoader({responseType:"arraybuffer"}),r=this;self.addEventListener("message",function(t){var n=t.data,i=n.msg,o=n.quadkey,s=n.url,a=n.x,u=n.y,h=n.z;switch(i){case"abort":e.abort({quadkey:o});break;case"load":e.baseUrl=s,e.load({quadkey:o},function(t){var e=r.process(t,a,u,h),n=e.data,i=e.transfer;self.postMessage({msg:"success",url:s,quadkey:o,data:n},i)},function(t){self.postMessage({msg:"error",url:s,quadkey:o,data:t})})}})}return e.prototype.process=function(t,e,r,n){return{data:t,transfer:[t]}},e}())}];self.addEventListener("message",function t(e){var r=e.data,n=r.msg,i=r.worker;if(r.payload,"init"==n){var o=U.find(function(t){return t.id==i}).Worker;o&&(new o,o=null),U=null,self.removeEventListener("message",t)}})}),n(0,function(t,r,n){var i=function(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}),e.default=t,Object.freeze(e)}(n),o=function(t,e){this.x=t,this.y=e},s=function(t,e,r,n){this.minX=t,this.minY=e,this.maxX=r,this.maxY=n},a=function(t,e){this.longitude=t,this.latitude=e},u=function(t,e,r,n){this.minLon=t,this.minLat=e,this.maxLon=r,this.maxLat=n},h=[{zIndex:0,type:"Circle",radius:6,fill:"#ff0000"}],p=[{zIndex:0,type:"Line",strokeWidth:10,stroke:"#ff0000"}],l=[{zIndex:0,type:"Polygon",strokeWidth:1,stroke:"#ffffff",fill:"#ff0000"}],f={styleGroups:{Point:h,MultiPoint:h,LineString:p,MultiLineString:p,Polygon:l,MultiPolygon:l},assign:function(t){return t.geometry.type}};function c(t,e){for(var r in e)t[r]=e[r];return t}var d=[],y=function(){function t(t,e){this.styleGroups=null,this._c=null;var r=function(t,e){if("object"!=typeof t||null===t)return t;for(var n in e=e||(Array.isArray(t)?[]:{}),t)e[n]=r(t[n]);return e};for(var n in t)this[n]="styleGroups"==n?r(t.styleGroups,{}):t[n];this._c=e||{}}return t.prototype.assign=function(t,e){return t.geometry.type},t.prototype.getCustomStyleGroup=function(t){return this._c[t.id]},t.prototype.getStyleGroup=function(t,e,r){var n=this._c[t.id];return(null==n||r)&&"object"!=typeof(n=this.assign(t,e))&&(n=this.styleGroups[n]),n},t.prototype.setStyleGroup=function(t,e,r){var n=t.id,i=this._c;return e&&r&&(e=this.merge(this.getStyleGroup(t),e)),e?i[n]=e:null===e||!1===e?e=i[n]=d:i[n]&&delete i[n],e},t.prototype.merge=function(t,e){if(null===e||!1===e)return null;for(var r,n=[],i=0,o=t.length;i<o;i++)r=c({},t[i]),e[i]&&c(r,e[i]),n[i]=r;return n},t}(),v=function(){function t(t){this.name="",this.__type="Layer";var e=this;for(var r in t)e[r]=t[r];null==e.id&&(e.id="L-"+(1e8*Math.random()^0)),e._l=new n.Listener(["layerAdd","layerRemove"])}return t.prototype.addEventListener=function(t,e,r){var n=this._l;if(n.isDefined(t))return n.add(t,e,r)},t.prototype.removeEventListener=function(t,e,r){var n=this._l;if(n.isDefined(t))return n.remove(t,e,r)},t.prototype.dispatchEvent=function(t,e){e.layer=this;var r=new CustomEvent(t,{detail:e});this._l.trigger(t,r,!0)},t}(),g="featureRemove",x="featureAdd",m="featureCoordinatesChange",_="styleGroupChange",w="styleChange",b="viewportReady",L="clear",T=function(t){function e(e){var n=this,i=e.pointerEvents;delete e.pointerEvents,(n=t.call(this,r.__assign({min:15,max:32,tiled:!0},e))||this)._p=[],n._sd=null,n._pev=!0,n.__type="Layer",n.margin=20,n.tiled=!0,n.levelOffset=0,n.custom=!1;var o=n;[x,g,m,L,_,b,w].forEach(function(t){return o._l.addEvent(t)}),"boolean"==typeof i&&n.pointerEvents(i);var s,a=e.providers||e.provider,u=256,h=function(t,e,r){for(var n=t;n<=e;n++)o._p[n]=r};if(a instanceof Array)for(var p=0,l=a;p<l.length;p++){var c=l[p];h(c.min,c.max,c.provider)}else{u=n.tileSize?a.size=n.tileSize:Math.max(u,a.size);var d=Number(512==u),y=o.min,v=o.max;h(y-d,v-d,a),o._fp=a,a.minLevel=y,a.maxLevel=v}n.tileSize||u%256||(n.tileSize=u),n.levelOffset=Math.round(Math.log(n.tileSize)/Math.log(2)-8),o._p.forEach(function(t,e){t&&("FeatureProvider"==t.__type&&(t.addEventListener(x,o._eventProxy,o),t.addEventListener(g,o._eventProxy,o),t.addEventListener(m,o._eventProxy,o)),t.addEventListener(L,o._eventProxy,o))}),o.setMargin(o.getMargin());var T=n._fp&&n._fp.styles;return(s=e.style||e.styles||T||f)&&o.setStyle(s),["style","styles","provider","providers"].forEach(function(t){delete o[t]}),n}return r.__extends(e,t),e.prototype.getProvider=function(t){return t?this._p[Math.floor(t)-this.levelOffset]:this._fp},e.prototype.addEventListener=function(e,r,n){var i;return this._l.isDefined(e)?t.prototype.addEventListener.call(this,e,r,n):null===(i=this._fp)||void 0===i?void 0:i.addEventListener(e,r,n)},e.prototype.removeEventListener=function(e,r,n){return this._l.isDefined(e)?t.prototype.removeEventListener.call(this,e,r,n):this._fp.removeEventListener(e,r,n)},e.prototype._eventProxy=function(t){var e=t.type,r=t.detail;r.layer=this,e==g&&this.setStyleGroup(r.feature),this._l.trigger(e,t,!0)},e.prototype.setFeatureCoordinates=function(t,e){return this._fp.setFeatureCoordinates(t,e)},e.prototype.addFeature=function(t,e){var r=this._fp;if(r.addFeature){var n=r.addFeature(t);return e&&this.setStyleGroup(n,e),n}},e.prototype.removeFeature=function(t){var e=this._fp;if(e.removeFeature)return e.removeFeature(t)},e.prototype.setStyleGroup=function(t,e,r){this._sd&&this.dispatchEvent(_,{feature:t,styleGroup:this._sd.setStyleGroup(t,e,r)})},e.prototype.getStyleGroup=function(t,e,r){var n;return null===(n=this._sd)||void 0===n?void 0:n.getStyleGroup(t,e,r)},e.prototype._getCustomStyleGroup=function(t){var e;return null===(e=this._sd)||void 0===e?void 0:e.getCustomStyleGroup(t)},e.prototype.search=function(t,e){var r=this._fp;if(r&&r.search)return r.search.apply(this._fp,arguments)},e.prototype.getTile=function(t,e){var r=t.length,n=this._p[r];if(n)return n.getTile(t,e)},e.prototype.cancelTile=function(t,e){var r="string"==typeof t?t.length:t.quadkey.length,n=this._p[r];if(n&&n.cancel)return n.cancel(t,e)},e.prototype.getCachedTile=function(t){var e=t.length,r=this._p[e];if(r)return r.getCachedTile(t)},e.prototype.setStyle=function(t,e){void 0===e&&(e=!1);var r=function(t){return"function"==typeof t};r(t.getStyleGroup)&&r(t.setStyleGroup)||(t=new y(t,e&&this._sd&&this._sd._c)),this._sd=t,this.dispatchEvent(w,{style:t})},e.prototype.getStyle=function(){return this._sd},e.prototype.getMargin=function(){return this.margin},e.prototype.setMargin=function(t){void 0===t&&(t=0),t=Number(t);for(var e=this._p,r=e.length;r--;)e[r]&&e[r].setMargin(t);return this.margin=t},e.prototype.pointerEvents=function(t){return null!=t&&(this._pev=!!t),this._pev},e.prototype.getCopyright=function(t){for(var e,r=this._p.filter(function(t,e,r){return r.indexOf(t)===e}),n=[],i=0,o=function(e){e.length&&n.push.apply(n,e),--i||t&&t(n)};e=r.pop();)e&&e.getCopyright&&(i++,e.getCopyright(o))},e}(v);T.prototype.modifyFeatureCoordinates=T.prototype.setFeatureCoordinates;var M=function(t){function e(e){return t.call(this,"MVTWorker",e)||this}return r.__extends(e,t),e.prototype.processData=function(t){var e=new r.XYZBin(t.triangles),n=e.getLayers();for(var i in n)e.getFeatures(n[i]);return{mvt:t.mvt,xyz:n}},e}(function(t){function e(e,r,n){var i=t.call(this,r)||this;return i.cbs=new Map,n||(n=new ArrayBuffer(0)),i.worker=new Worker(window.here.xyz.maps.__workerURL),i.worker.postMessage({msg:"init",worker:e,payload:n},[n]),i.worker.addEventListener("message",i.receiveMessage.bind(i)),i}return r.__extends(e,t),e.prototype.processData=function(t){return t.data},e.prototype.receiveMessage=function(t){var e=t.data;if("success"===e.msg){var r=e.quadkey,n=this.cbs.get(r);n&&(this.cbs.delete(r),n.success(this.processData(e.data)))}},e.prototype.load=function(t,e,r){var n=this.getUrl(t),i=t.quadkey,o=t.x,s=t.y,a=t.z;this.cbs.set(i,{tile:t,success:e,error:r}),this.worker.postMessage({msg:"load",url:n,quadkey:i,x:o,y:s,z:a})},e.prototype.abort=function(t){var e=this.getUrl(t),r=t.quadkey,n=t.x,i=t.y,o=t.z;this.cbs.get(r)&&(this.cbs.delete(r),this.worker.postMessage({msg:"abort",url:e,quadkey:r,x:n,y:i,z:o}))},e}(r.HTTPLoader)),F=function(){function t(t,e){this._m=0,this.id=t.id,this.properties=t.properties,this.geometry=t.geometry,this.bbox=t.bbox,this._provider=e}return t.prototype.toJSON=function(){return n.JSUtils.clone({id:this.id,type:this.type,bbox:this.bbox,properties:this.properties,geometry:{type:this.geometry.type,coordinates:this.geometry.coordinates}})},t.prototype.getProvider=function(){return this._provider},t.prototype.getBBox=function(){return this._provider.decBBox(this)},t}();F.prototype.type="Feature","undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self;var P=r.vectorTile.VectorTile,S=r.vectorTile.VectorTileFeature;S.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,n=1,i=0,o=0,s=0,a=[];t.pos<r;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)o+=t.readSVarint(),s+=t.readSVarint(),1===n&&(e&&a.push(e),e=[]),e.push([o,s]);else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].slice())}}return e&&a.push(e),a};var B=n.TaskManager.getInstance(),k=0;function E(t){for(var e,r,n=0,i=0,o=t.length,s=o-1;i<o;s=i++)e=t[i],n+=((r=t[s])[0]-e[0])*(e[1]+r[1]);return n}var U=function(t,e){return 360*t/e-180},O=function(t,e){var r=180-360*t/e;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90},C=function(t,e,r,n,i){var o=t.loadGeometry();switch(t.type){case 1:for(var s=[],a=0;a<o.length;a++)s[a]=o[a][0];i(o=s,e,r,n,t);break;case 2:for(a=0;a<o.length;a++)i(o[a],e,r,n,t);break;case 3:for(o=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],o=0;o<e;o++){var s=E(t[o]);0!==s&&(void 0===n&&(n=s<0),n===s<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}return r&&i.push(r),i}(o),a=0;a<o.length;a++)for(var u=0;u<o[a].length;u++)i(o[a][u],e,r,n,t)}return o};function R(t,e,r){var n=function(t,e,r,n){var i=1/0,o=-i,s=i,a=-s,u=t.extent*(1<<n),h=t.extent*e,p=t.extent*r,l=S.types[t.type];return C(t,e,r,n,function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e],u=n[0],h=n[1];u<i&&(i=u),u>o&&(o=u),h<s&&(s=h),h>a&&(a=h)}}).length>1&&(l="Multi"+l),{bbox:[U(i+h,u),O(a+p,u),U(o+h,u),O(s+p,u)],type:l}}(t,e.x,e.y,e.z),i={type:"Feature",geometry:new V(n.type,t,e),properties:t.properties};return"id"in t&&(i.id=t.id),r&&(i.bbox=n.bbox),i}var z=function(t,e,r,n,i){for(var o=i.extent,s=1<<n,a=0,u=t;a<u.length;a++){var h=u[a];h[0]=(e+h[0]/o)/s,h[1]=(r+h[1]/o)/s}},V=function(){function t(t,e,r){this.type=t,this._vtf=e,this.__xyz=r}return t.prototype._coordinates=function(){var t=this.type,e=this.__xyz,r=e.x,n=e.y,i=e.z,o=C(this._vtf,r,n,i,z);return"Point"!=t&&"Polygon"!=t&&"LineString"!=t||(o=o[0]),o},Object.defineProperty(t.prototype,"coordinates",{get:function(){var t=this.__xyz,e=t.x,r=t.y,n=t.z;return function(t,e,r,n){var i=t.extent*(1<<n),o=t.extent*e,s=t.extent*r,a=C(t,e,r,n,function(t){for(var e=0;e<t.length;e++){var r=t[e],n=U(r[0]+o,i),a=O(r[1]+s,i);t[e]=[n,a]}});return 1===a.length&&(a=a[0]),a}(this._vtf,e,r,n)},enumerable:!1,configurable:!0}),t}();function q(t){B.create({init:function(){var e=[],n=new P(new r.pbf(t.data.mvt)),i=t.tile;for(var o in n.layers)e.push(o);return{xyz:{x:i.x,y:i.y,z:i.z},mvt:n,xyzLayers:t.data.xyz,layers:e,l:0,f:0,geojson:[]}},priority:4,exec:function(t){for(var e,r,n,i,o=t.mvt,s=t.xyz,a=t.layers,u=t.xyzLayers,h=t.l,p=t.f,l=t.geojson;h<a.length;){for(e=o.layers[a[h]],i={x:s.x,y:s.y,z:s.z,l:e.name};p<e.length;){if("MultiPolygon"==(n=(r=R(e.feature(p),i,!0)).geometry.type)||"Polygon"==n){var f=u[h]&&u[h].features[p];f&&(r.geometry._xyz=f)}if(r.id=++k,p++,null==r.properties.layer&&(r.properties.layer=e.name),l.push(r),!(p%16))return t.f=p,this.CONTINUE}return t.l=++h,t.f=0,this.CONTINUE}return this.BREAK},onDone:function(e){t.ready(e.geojson)}}).start()}var D=Math.PI,A=D/180,I=2*D*(19113026/3),Y=Array.from({length:33},function(t,e){return 40075017/256/(1<<e)}),X=function(t,e){return(t+180)/360*e},j=function(t,e){return(180-180/D*Math.log(Math.tan(D/4+t*D/360)))*e/360},G=function(t,e){return 360*t/e-180},Z=function(t,e){var r=180-360*t/e;return 360/D*Math.atan(Math.exp(r*A))-90},N=function(t){return void 0===t&&(t=0),I*Math.cos(t*A)},H={mapSizePixel:function(t,e){return Math.pow(2,e)*t},lon2x:X,lat2y:j,x2lon:G,y2lat:Z,pixelToGeo:function(t,e,r){return new a(G(t,r),Z(e,r))},geoToPixel:function(t,e,r){return new o(X(t,r),j(e,r))},meterToPixel:function(t,e){return t/Y[e]},pixelToMeter:function(t,e){return t*Y[e]},getGroundResolution:function(t){return Y[t]},alt2z:function(t,e){return t/N(e)},earthCircumference:N},J=n.global.Math,W=256,K=function(t,e,r){var n=1<<r;return[J.floor(H.lon2x(t,n)),J.floor(H.lat2y(e,n)),r]},Q=function(t){"number"==typeof t&&(t=String(t));for(var e=t.length,r=0,n=0,i=0;i<e;++i)switch(r*=2,n*=2,t[i]){case"1":n++;break;case"3":n++;case"2":r++}return[e,r,n]},$=function(t,e,r){for(var n,i="";t-- >0;)i+=(0!=(r&(n=1<<t)))+2*(0!=(e&n));return i},tt=function(t,e,r){var n=W<<t,i=W*r,o=W*e;return[H.x2lon(i,n),H.y2lat(o+W,n),H.x2lon(i+W,n),H.y2lat(o,n)]},et=function(t,e){for(var r=[],n=e[1]-t[1]+1,i=e[0]-t[0]+1,o=t[2],s=0;s<n;s++)for(var a=0;a<i;a++)r[r.length]=$(o,t[1]+s,t[0]+a);return r},rt={geoToGrid:K,pixelToGrid:function(t,e,r){return[J.floor(t),J.floor(e),r]},quadToGrid:Q,tileXYToQuadKey:$,getGeoBounds:tt,getTilesOfLevel:function(t,e){var r=[t],n=0,i=r.length,o=t.length;if(e<=o)return[t.substring(0,e)];for(;o<e;){for(;n<i;n++)r.push(r[n]+"0",r[n]+"1",r[n]+"2",r[n]+"3");n=i,i=r.length,o++}return r.slice(n)},getTilesIds:et,getTilesInRect:function(t,e,r,n,i){r>=180&&(r=179.999999),t<=-180&&(t=-180),n>=85.05112878&&(n=85.05112778),e<-85.05112878&&(e=-85.05112778);var o=K(t,n,i),s=K(r,e,i);return et(o,s)}},nt={exports:{}};nt.exports=function(){function t(t,n,i,o,s){!function t(r,n,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,u=n-i+1,h=Math.log(a),p=.5*Math.exp(2*h/3),l=.5*Math.sqrt(h*p*(a-p)/a)*(u-a/2<0?-1:1);t(r,n,Math.max(i,Math.floor(n-u*p/a+l)),Math.min(o,Math.floor(n+(a-u)*p/a+l)),s)}var f=r[n],c=i,d=o;for(e(r,i,n),s(r[o],f)>0&&e(r,i,o);c<d;){for(e(r,c,d),c++,d--;s(r[c],f)<0;)c++;for(;s(r[d],f)>0;)d--}0===s(r[i],f)?e(r,i,d):e(r,++d,o),d<=n&&(i=d+1),n<=d&&(o=d-1)}}(t,n,i||0,o||t.length-1,s||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,r,n,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var s=t.children[o];a(i,t.leaf?n(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function p(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function c(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,r,n,i,o){for(var s=[r,n];s.length;)if(!((n=s.pop())-(r=s.pop())<=i)){var a=r+Math.ceil((n-r)/i/2)*i;t(e,a,r,n,o),s.push(r,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!c(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;c(t,a)&&(e.leaf?r.push(s):f(t,a)?this._all(s,r):i.push(s))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!c(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(c(t,o)){if(e.leaf||f(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,s=this.data,a=this.toBBox(t),u=[],h=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],r=h.pop(),o=!0),s.leaf){var p=i(t,s.children,e);if(-1!==p)return s.children.splice(p,1),u.push(s),this._condense(u),this}o||s.leaf||!f(s,a)?n?(r++,s=n.children[r],o=!1):s=null:(u.push(s),h.push(r),r=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,s=r-e+1,a=this._maxEntries;if(s<=a)return o(i=d(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(i=d([])).leaf=!1,i.height=n;var u=Math.ceil(s/a),h=u*Math.ceil(Math.sqrt(a));y(t,e,r,h,this.compareMinX);for(var p=e;p<=r;p+=h){var l=Math.min(p+h-1,r);y(t,p,l,u,this.compareMinY);for(var f=p;f<=l;f+=u){var c=Math.min(f+u-1,l);i.children.push(this._build(t,f,c,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var u=e.children[a],h=p(u),l=(f=t,c=u,(Math.max(c.maxX,f.maxX)-Math.min(c.minX,f.minX))*(Math.max(c.maxY,f.maxY)-Math.min(c.minY,f.minY))-h);l<o?(o=l,i=h<i?h:i,s=u):l===o&&h<i&&(i=h,s=u)}e=s||e.children[0]}var f,c;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),a(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var s=this._chooseSplitIndex(r,i,n),a=d(r.children.splice(s,r.children.length-s));a.height=r.height,a.leaf=r.leaf,o(r,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,a,u,h,l,f=1/0,c=1/0,d=e;d<=r-e;d++){var y=s(t,0,d,this.toBBox),v=s(t,d,r,this.toBBox),g=(i=y,o=v,void 0,void 0,void 0,void 0,a=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),h=Math.min(i.maxX,o.maxX),l=Math.min(i.maxY,o.maxY),Math.max(0,h-a)*Math.max(0,l-u)),x=p(y)+p(v);g<f?(f=g,n=d,c=x<c?x:c):g===f&&x<c&&(c=x,n=d)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=s(t,0,e,i),u=s(t,r-e,r,i),h=l(o)+l(u),p=e;p<r-e;p++){var f=t.children[p];a(o,t.leaf?i(f):f),h+=l(o)}for(var c=r-e-1;c>=e;c--){var d=t.children[c];a(u,t.leaf?i(d):d),h+=l(u)}return h},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}();var it=function(t){function e(e){return t.call(this,e)||this}return r.__extends(e,t),e.prototype.toBBox=function(t){var e=t.bbox;return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e.prototype.compareMinX=function(t,e){return t.bbox[0]-e.bbox[0]},e.prototype.compareMinY=function(t,e){return t.bbox[1]-e.bbox[1]},e}(nt.exports),ot=function(){function t(t,e,r,n){var i=Q(t);this.quadkey=t,this.z=i[0],this.y=i[1],this.x=i[2],this.type=e,this.bounds=tt(i[0],i[1],i[2]),this.expire=n,this.clipped=r}return t.prototype.expired=function(t){return(t=t||Date.now())-this.loadStopTs>1e3*this.expire},t.prototype.add=function(t){var e=this.data;e&&-1==e.indexOf(t)&&(e.push(t),this.tree&&this.tree.insert(t))},t.prototype.remove=function(t){var e=this.data.indexOf(t);-1!==e&&(this.data.splice(e,1),this.tree&&this.tree.remove(t))},t.prototype.search=function(t){if(this.data)return this.tree||(this.tree=new it(9),this.tree.load(this.data)),this.tree.search(t)},t.prototype.isLoaded=function(){return"number"==typeof this.loadStopTs},t.prototype.getContentBounds=function(){if(!this.cbnds){var t=this.bounds,e=this.provider,r=e.margin;if(r){var n=e.size,i=n<<this.z,o=H.lon2x(t[0],i),s=H.lat2y(t[1],i);this.cbnds=[H.x2lon(o-r,i),H.y2lat(s+r,i),H.x2lon(o+r+n,i),H.y2lat(s-r-n,i)]}else this.cbnds=this.bounds}return this.cbnds},t.prototype.project=function(t,e){var r=256<<this.z,n=256*this.x,i=256*this.y;return[Math.round(H.lon2x(t,r)-n),Math.round(H.lat2y(e,r)-i)]},t.prototype.lon2x=function(t,e){void 0===e&&(e=256);var r=e<<this.z,n=this.x*e;return H.lon2x(t,r)-n},t.prototype.lat2y=function(t,e){void 0===e&&(e=256);var r=e<<this.z,n=this.y*e;return H.lat2y(t,r)-n},t.prototype.isInside=function(t){var e=this.bounds,r=t[0],n=t[1];return r>e[0]&&r<=e[2]&&n>e[1]&&n<=e[3]},t}(),st=ot.prototype;st.expire=1/0,st.error=null,st.canvasX=null,st.canvasY=null;var at=function(t){function e(e,r,n,i){var o=t.call(this,e,r,n,i)||this;return o.s=1<<o.z,o}return r.__extends(e,t),e.prototype.lon2x=function(t,e){return void 0===e&&(e=256),(t*this.s-this.x)*e},e.prototype.lat2y=function(t,e){return void 0===e&&(e=256),(t*this.s-this.y)*e},e.prototype.isInside=function(t){var e=t[0]*this.s-this.x,r=t[1]*this.s-this.y;return!(e<0||e>1||r<0||r>1)},e}(ot),ut=function(){function t(t,e,r){this.lvl=t,this.main="object"==typeof e?e:new n.LRU(e||256),this.sub="object"==typeof r?r:new n.LRU(e||1024)}return t.prototype.forEach=function(t){this.main.forEach(t),this.sub.forEach(t)},t.prototype.clear=function(){this.main.clear(),this.sub.clear()},t.prototype.getCache=function(t){return t==this.lvl?this.main:this.sub},t.prototype.remove=function(t){this.getCache(t.z).remove(t.quadkey)},t.prototype.get=function(t){return this.getCache(t.length).get(t)},t.prototype.set=function(t){var e=this.getCache(t.z).set(t.quadkey,t),r=this._onDrop;e&&r&&r(e)},t.prototype.onDrop=function(t){this._onDrop=t},t}(),ht=function(){function t(t){this.margin=0,this.Tile=ot,this.size=256,this.expire=1/0,this.clipped=!1;var e=this;for(var r in t=t||{})this[r]=t[r];null==this.id&&(this.id="TP-"+(1e6*Math.random()^0)),e.storage=t.storage||new ut(e.level),e.initStorage(e.storage),this.listeners=new n.Listener(["clear","error"])}return t.prototype.dispatchEvent=function(t,e){e.provider=this;var r=new CustomEvent(t,{detail:e});this.listeners.trigger(t,r,!0)},t.prototype.initStorage=function(t){t.onDrop(function(t){return t.provider._removeTile(t)})},t.prototype.addEventListener=function(t,e,r){return this.listeners.add(t,e,r)},t.prototype.removeEventListener=function(t,e,r){return this.listeners.remove(t,e,r)},t.prototype.clear=function(t){this.storage.clear()},t.prototype.getCachedTile=function(t){return this.storage.get(t)},t.prototype.setMargin=function(t){void 0===t&&(t=0),this.margin=Number(t),this.storage.forEach(function(t){return t.cbnds=null})},t.prototype.getCachedTilesOfBBox=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],s=[];return e^=0,this.storage.forEach(function(t){var a,u,h,p,l=t.getContentBounds();a=l[0],u=l[2],h=l[1],p=l[3],a<=i&&r<=u&&h<=o&&n<=p&&(!e||t.z==e)&&(s[s.length]=t)}),s},t.prototype.config=function(t){for(var e in t=t||{})this.config[e]=t[e];return this},t.prototype.createTile=function(t){var e=new this.Tile(t,this.dataType,this.clipped,this.expire);return e.provider=this,e},t}();ht.prototype.__type="Provider";var pt,lt=function(t,e){var r,n;e&&((r=t[0])<e[0]&&(e[0]=r),r>e[2]&&(e[2]=r),(n=t[1])<e[1]&&(e[1]=n),n>e[3]&&(e[3]=n))},ft=function(t,e){for(var r=t.length;r--;)lt(t[r],e)},ct=function(t,e){var r=t.geometry.type,n=t.geometry.coordinates;if("Point"==r)e?lt(n,e):e=[n[0],n[1],n[0],n[1]];else if(e=e||[1/0,1/0,-1/0,-1/0],"MultiLineString"==r)for(var i=0;i<n.length;i++)ft(n[i],e);else if("MultiPolygon"==r)for(var o=0;o<n.length;o++)ft(n[o][0],e);else if("LineString"==r||"MultiPoint"==r)ft(n,e);else{if("Polygon"!=r)return!1;ft(n[0],e)}return e},dt={calcBBox:ct},yt="featureRemove",vt="featureAdd",gt="featureCoordinatesChange";function xt(t){this.feature=t}xt.prototype.cnt=0;var mt=function(t){function e(e){var r=t.call(this,e)||this;return r.IDPOOL={},r.dataType="json",r.ignore=!1,r.cnt=0,r.__type="FeatureProvider",r.tree=new it(9),r.Feature=r.Feature||F,[vt,yt,gt].forEach(function(t){return r.listeners.addEvent(t)}),r}return r.__extends(e,t),e.prototype.isDroppable=function(t){return!0},e.prototype.loadTileData=function(t,e,r){for(var n,i,o,s=this,a=[],u=e.length,h=0;h<u;h++)!1!==(n=s.prepareFeature(o=e[h]))?(o=n,(i=s._insert(o,t))?(o=i,a[a.length]=o):s.tree||(a[a.length]=s.getFeature(o.id))):(e.splice(h--,1),u--);e=a,s.tree&&s.tree.load(e),r(e=s.clipped?e:s.search(t.getContentBounds()))},e.prototype.addFeature=function(t){var e,r,n=this;if("object"==typeof t){if("FeatureCollection"==t.type&&(t=t.features||[]),Array.isArray(t)){for(var i=[],o=0,s=t.length;o<s;o++)i[o]=n.addFeature(t[o]);return i}if(n.isFeatureInstance(t,F)){var a=t.getProvider();a&&a!=n&&(t=t.toJSON())}if(!1!==(e=n.prepareFeature(t))){if((r=n._insert(e))!=pt){t=r;for(var u=n.getCachedTilesOfBBox(n.decBBox(t)),h=0,p=void 0;h<u.length;h++)(p=u[h]).add(t),p.z==n.level&&this._mark(t,p);n.tree&&n.tree.insert(t),n.ignore||n.dispatchEvent(vt,{feature:t,tiles:u})}}else t=null;return t}},e.prototype.addEventListener=function(e,r,n){return t.prototype.addEventListener.call(this,e,r,n)},e.prototype.removeEventListener=function(e,r,n){return t.prototype.removeEventListener.call(this,e,r,n)},e.prototype.all=function(){var t=this;return t.tree?t.tree.all():t._s({minX:-180,maxX:180,minY:-90,maxY:90})},e.prototype.getFeature=function(t){if(this.IDPOOL[t])return this.IDPOOL[t].feature},e.prototype.getFeatures=function(t){t instanceof Array||(t=[t]);for(var e=[],r=0;r<t.length;r++)e[r]=this.getFeature(t[r]);return 1==e.length?e[0]:e},e.prototype.getTile=function(t,e){var r=this,n=r.storage,i=n.get(t);return i===pt&&(n.set(i=r.createTile(t)),i.loadStartTs=i.loadStopTs=Date.now(),i.data=r.search(i.getContentBounds())),e&&e(i),i},e.prototype.setFilter=function(t){this.filter="function"==typeof t?t:pt},e.prototype.getFeatureClass=function(t){return this.Feature},e.prototype.isFeatureInstance=function(t,e){return t instanceof e},e.prototype.createFeature=function(t,e){return new e(t,this)},e.prototype.search=function(t,e){var r,i,o=this;if("object"==typeof t)if(e)for(var s in t)e[s]=t[s];else e=t;var a=e&&e.radius||1;if(t instanceof Array)i=4==t.length?t:n.geotools.getPointBBox(t,a);else{if("number"==typeof t||"string"==typeof t||!t)return o.getFeatures(t);if(t.longitude!=pt&&t.latitude!=pt)i=n.geotools.getPointBBox([t.longitude,t.latitude],a);else if(t.minLon!=pt&&t.minLat!=pt&&t.maxLon!=pt&&t.maxLat!=pt)i=[t.minLon,t.minLat,t.maxLon,t.maxLat];else{if(r=t.point||t.rect||t.viewport)return o.search(r,e);if(t.id||t.ids)return o.getFeatures(t.id||t.ids)}}return i={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]},o._s(i)},e.prototype.exists=function(t){return this.IDPOOL[t.id]},e.prototype.setFeatureCoordinates=function(t,e){var r=t;if(t=this.getFeature(t.id)){var n=t.getBBox(),i=t.geometry,o=i.coordinates;this.ignore=!0,this.removeFeature(t),i._xyz&&delete i._xyz,i.coordinates=this.encCoord(i.type,e),t.bbox=null,this.addFeature(t),this.ignore=!1,this.dispatchEvent(gt,{feature:t,prevBBox:n,prevCoordinates:o,provider:this})}else r.geometry.coordinates=e,r.bbox=null,this.updateBBox(r)},e.prototype.removeFeature=function(t){if(t){if("FeatureCollection"==t.type&&(t=t.features),Array.isArray(t)){for(var e=[],r=0,n=t.length;r<n;r++)e[r]=this.removeFeature(t[r]);return e}if(t=this.getFeature(t.id)){for(var i=this.getCachedTilesOfBBox(this.decBBox(t)),o=void 0,s=0;s<i.length;s++)(o=i[s]).isLoaded()&&o.remove(t);this.cnt--,delete this.IDPOOL[t.id],this.tree&&this.tree.remove(t),this.ignore||this.dispatchEvent(yt,{feature:t,tiles:i})}}return t},e.prototype.clear=function(t){var e,r=this,n=null;if(4==arguments.length&&(t=Array.prototype.slice.call(arguments)),t instanceof Array){n=r.getCachedTilesOfBBox(t,r.level);for(var i=0,o=void 0;i<n.length;i++)o=n[i],r._removeTile(o,!1),n[i]=o.quadkey}else if(0==arguments.length){var s={},a=r.IDPOOL,u=0;for(var h in r.tree&&r.tree.clear(),a)e=r.getFeature(h),r.isDroppable(e)||(s[h]=new xt(e),u++,r.tree&&r.tree.insert(e));r.cnt=u,r.IDPOOL=s,ht.prototype.clear.call(this,t)}r.dispatchEvent("clear",{tiles:n})},e.prototype._insert=function(t,e){var r=t.id,n=null,i=this.getFeatureClass(t),o=this.filter;return o&&!o(t)||(this.IDPOOL[r]===pt&&(this.cnt++,this.isFeatureInstance(t,i)?t._provider=this:t=this.createFeature(t,i),this.updateBBox(t),this.IDPOOL[r]=new xt(t),n=t),e&&this._mark(t,e)),n},e.prototype._mark=function(t,e){var r=this.IDPOOL[t.id];r[e.quadkey]||(r.cnt++,r[e.quadkey]=!0)},e.prototype._removeTile=function(t,e){var r,n=t.quadkey;if(this.storage.remove(t),r=t.data)for(var i=0;i<r.length;i++)this._dropFeature(r[i],n,e)},e.prototype._dropFeature=function(t,e,r){var n=this,i=n.IDPOOL[t.id];i&&(i[e]&&(i[e]=pt,i.cnt--),n.isDroppable(t)&&(i.cnt||(n.cnt--,delete n.IDPOOL[t.id],n.tree&&n.tree.remove(t),r&&n.dispatchEvent(yt,{feature:t}))))},e.prototype._s=function(t){if(this.tree)return this.tree.search(t);var e,r,n=1e8*Math.random()^0,i=this.level;return this.storage.forEach(function(o){if(o.z==i&&o.isLoaded()&&(r=o.search(t)).length)if(e)for(var s=0,a=r;s<a.length;s++)(p=a[s])._m!=n&&(p._m=n,e[e.length]=p);else for(var u=0,h=e=r;u<h.length;u++){var p;(p=h[u])._m=n}}),e||[]},e.prototype.encCoord=function(t,e){return e},e.prototype.decCoord=function(t){return t.geometry.coordinates},e.prototype.decBBox=function(t){return t.bbox},e.prototype.prepareFeature=function(t){return t.id==pt&&(t.id=1e8*Math.random()^0),t.bbox?(6===t.bbox.length&&(t.bbox=[t.bbox[0],t.bbox[1],t.bbox[3],t.bbox[4]]),t):this.updateBBox(t)&&t},e.prototype.updateBBox=function(t){if(!t.bbox){var e=ct(t);if(!e)return!1;t.bbox=e,t.geometry._c&&(t.geometry._c=null)}return!0},e}(ht);mt.prototype.modifyFeatureCoordinates=mt.prototype.setFeatureCoordinates;var _t=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.executing=0,this.parallel=16,this.q=[],this.lq={},this.src=t}return t.prototype.exec=function(){for(var t=this,e=t.q;e.length&&t.executing<t.parallel;)t.fire(e.pop(),e.pop(),e.pop())},t.prototype.fire=function(t,e,r,n){var i=this,o=i.src,s=i.lq;n^=0,i.executing++,s[t.quadkey]=[t,e,r,n],o[n].load(t,function(r,n){i.executing--,delete s[t.quadkey],i.exec(),e(r,n)},function(e,n){r(e,n),i.executing--,delete s[t.quadkey],i.exec()})},t.prototype.tile=function(t,e,r){this.q.push(r,e,t),this.exec()},t.prototype.abort=function(t){var e,r,n=this,i=n.q,o=n.lq,s=n.src,a=!0;return-1!==(e=i.indexOf(t))?i.splice(e-2,3):(r=o[t.quadkey])?(n.executing--,delete o[t.quadkey],s[r[3]].abort(t)):a=!1,n.exec(),a},t.prototype.store=function(t,e){var r=this.src;for(var n in r)if(r[n].store){r[n].store(t,e);break}},t.prototype.clear=function(){this.src.forEach(function(t){t.clear&&t.clear()})},t.prototype.setUrl=function(){var t=this.src;for(var e in t)t[e].setUrl&&t[e].setUrl.apply(t[e],arguments)},t}();_t.prototype;var wt=function(){function t(t,e){this.c=0,this.cbs=[],this.qks=e,this.tile=t}return t.prototype.receive=function(t){var e=this;if(!e.ready){var r=e.tile,n=e.qks,i=n.indexOf(t.quadkey);if(-1!=i&&(n[i]=null,++e.c==n.length)){e.ready=!0,r.processedData=void 0;var o=t.error;o?r.error=o:r.data=r.provider.search(r.getContentBounds()),r.loadStopTs=Date.now(),e.exec(),r.onLoaded.length=0,e.qks=null}}},t.prototype.exec=function(){for(var t=this.cbs,e=t.length,r=this.tile,n=0;n<e;)t[n++](r,r.error);t.length=0},t.prototype.add=function(t){var e=this.cbs;if("function"==typeof t&&-1==e.indexOf(t))return e.push(t),!0},t.prototype.remove=function(t){var e=this.cbs,r=e.indexOf(t);return-1!=r&&e.splice(r,1),e.length},t}();wt.prototype.ready=!1;var bt,Lt=function(t){return"function"==typeof t},Tt=function(t){return Lt(t)},Mt=function(t){return function(e,r,n){var i={data:e,provider:this,ready:r};n&&(i.tile={x:n.x,y:n.y,z:n.z}),function(t,e){void 0===e&&(e={});var r,n,i=e.ready;!(n=r=Tt(t)?t(e):e.data)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then?void 0!==r&&i(r):r.then(i)}(t,i)}},Ft=function(){function t(t){var e=t.loader;if(!e)throw new Error("no tile loader defined.");e instanceof _t||(e=new _t(e)),this.loader=e,this.provider=t.provider;var r=t.preProcessor;this.preprocess=Mt(r),"function"==typeof t.processTileResponse&&(this.processTileResponse=t.processTileResponse)}return t.prototype.cancel=function(t,e){var r,n=this.provider,i=n.storage,o=null==e;if(r=t instanceof n.Tile?t:i.get(t)){var s=r.onLoaded;s&&(o?s.length=0:s.splice(s.indexOf(e),1),s.length||this.loader.abort(r)&&i.remove(r))}},t.prototype.execTile=function(t){var e,r=t.onLoaded;if(r){for(var n=0,i=r.length;n<i;n++)(e=r[n])instanceof wt?e.receive(t):e(t);r.length=0}},t.prototype.processTileResponse=function(t,e,r,n){r(e)},t.prototype.handleTileResponse=function(t,e,r,n){var i=this;t.loadStopTs=Date.now(),this.processTileResponse(t,e,function(e){t.data=e,i.execTile(t),n&&n()},r)},t.prototype.completeTile=function(t,e){this.handleTileResponse(t,e)},t.prototype.getTile=function(t,e){var r,n=this,i=this.provider,o=i.storage;if(null==(r=o.get(t)))(r=i.createTile(t)).onLoaded=[],r.data=[],o.set(r);else if(r.isLoaded())return e&&e(r,r.error),r;return e&&-1==r.onLoaded.indexOf(e)&&r.onLoaded.push(e),r.loadStartTs||(r.loadStartTs=Date.now(),this.loader.tile(r,function(t,e){n.preprocess(t,function(t){return n.completeTile(r,t)},r)},function(t,e){r.error=t,n.handleTileResponse(r,void 0,e,function(){return i.listeners.trigger("error",[t,r],!0)})})),r},t.prototype.drop=function(t){this.provider.storage.remove(t),t.isLoaded()||this.loader.abort(t)},t}(),Pt=function(t){function e(e){var r=t.call(this,e)||this;return r.dep={},r.level=e.level,r}return r.__extends(e,t),e.prototype.cancel=function(t,e){var r,n,i=this.provider,o=i.storage,s=e==bt;if(n=t instanceof i.Tile?t:o.get(t)){t=n.quadkey,r=rt.getTilesOfLevel(t,this.level);for(var a=0,u=void 0,h=void 0;a<r.length;a++)if(u=(h=r[a])==t?n:o.get(h)){var p=u.onLoaded,l=void 0;p&&(s?n.onLoaded.length=0:i.level&&n.z!=i.level?-1!=(l=p.indexOf(n.onLoaded[0]))&&(p[l].remove(e)||p.splice(l,1)):p.splice(p.indexOf(e),1),p.length||this.loader.abort(u)&&o.remove(u))}}},e.prototype.clear=function(){this.loader.clear(),this.dep={}},e.prototype.createTile=function(t){var e,r,n=this.provider.createTile(t),i=n.z,o=this.level;if(o&&i!=o&&(i>o?e=[t.substr(0,o)]:i<o&&(e=rt.getTilesOfLevel(t,o)),e))for(var s=0,a=e.length;s<a;s++){var u=e[s];(r=this.dep[u])||(r=this.dep[u]=[]),r[r.length]=n}return n},e.prototype.getTile=function(t,e){var r,n=this,i=this.provider,o=i.storage,s=this.level;if((r=o.get(t))==bt)(r=this.createTile(t)).onLoaded=[],r.data=[],o.set(r);else if(r.isLoaded())return e&&e(r,r.error),r;if(t.length!=s){var a=rt.getTilesOfLevel(t,s),u=void 0,h=void 0;r.loadStartTs=Date.now(),r.onLoaded.length?h=r.onLoaded[0]:(h=new wt(r,a),r.onLoaded.push(h)),h.add(e);for(var p=0;p<a.length;p++)(u=o.get(a[p]))==bt?u=i.getTile(a[p],h):u.isLoaded()?h.receive(u):-1==u.onLoaded.indexOf(h)&&u.onLoaded.push(h)}else e&&-1==r.onLoaded.indexOf(e)&&r.onLoaded.push(e),r.loadStartTs||(r.loadStartTs=Date.now(),this.loader.tile(r,function(t){n.preprocess(t,function(t){return n.completeTile(r,t)},r)},function(t,e){r.error=t,n.handleTileResponse(r,void 0,e,function(){return i.listeners.trigger("error",[t,r],!0)})}));return r},e.prototype.drop=function(e){var r,n=e.quadkey,i=this.provider.storage;if(r=this.dep[n]){for(var o=0;o<r.length;o++)i.remove(r[o]);delete this.dep[n]}t.prototype.drop.call(this,e)},e}(Ft),St=function(t){function e(e){var n=t.call(this,r.__assign({minLevel:8,maxLevel:20,staticData:!1},e))||this;n.sizeKB=0;var i=n,o=e.loader;if(!o)throw new Error("no tile loader defined.");o instanceof _t||(o=new _t(o));var s=e.preProcessor;return n.remoteTileLoader=new Pt({provider:i,loader:o,level:i.level,preProcessor:s,processTileResponse:function(t,e,r){if(t.error)return r(t.data);n.loadTileData(t,e,r)}}),n}return r.__extends(e,t),e.prototype.cancel=function(t,e){this.remoteTileLoader.cancel(t,e)},e.prototype.getLoader=function(){return this.remoteTileLoader.loader},e.prototype.config=function(e){return t.prototype.config.call(this,e)},e.prototype.clear=function(e){0==arguments.length&&this.remoteTileLoader.clear(),t.prototype.clear.apply(this,arguments)},e.prototype.getTile=function(t,e){return this.remoteTileLoader.getTile(t,e)},e.prototype._removeTile=function(e,r){this.remoteTileLoader.drop(e),t.prototype._removeTile.call(this,e,r)},e}(mt),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getMvtLayer=function(){return this.geometry.__xyz.l},e}(F),kt=function(t){function e(e){var r=t.call(this,n.JSUtils.extend({loader:e.loader||new M(e),margin:0,Tile:at,Feature:Bt,preProcessor:q},e))||this;return r.c=null,r.clipped=!0,r.tree=null,r}return r.__extends(e,t),e.prototype.decCoord=function(t){return t.geometry._coordinates()},e.prototype.getCopyright=function(t){var e=this,r=e.url;"function"==typeof r&&(r=r(0,0,0,""));var i=(null==r?void 0:r.match)&&r.match(/.*xyz+.*here\.com\/tiles\/[a-zA-Z]+[\.\d]*\//),o=e.c;t&&(null==o?i?((o=new n.Queue).add(t),e.c=o,e.getLoader().src[0].send({url:i+"copyright",responseType:"json",success:function(t){e.c=t,o.done(t)}})):t(e.c=[]):o instanceof n.Queue?o.add(t):t(o))},e}(St),Et={backgroundColor:"#555555",strokeWidthZoomScale:function(t){return t>17?1:t>14?.5:.25},styleGroups:{earth:[{zIndex:1,type:"Polygon",fill:"#555555"}],landuse:[{zIndex:2,type:"Polygon",fill:"#666666"}],water:[{zIndex:3,type:"Polygon",fill:"#353535"}],roads:[{zIndex:4,type:"Line",stroke:"#ffffff",strokeWidth:4}],highway:[{zIndex:5,type:"Line",stroke:"#ffffff",strokeWidth:6}],buildings:[{zIndex:6,type:"Polygon",fill:"#999999"}]},assign:function(t,e){var r=t.properties,n=r.kind,i=r.layer,o=t.geometry.type;if("water"!=i||"LineString"!=o&&"MultiLineString"!=o){if("roads"==i){if("rail"==n||"ferry"==n)return;if("highway"==n)return n}return i}}},Ut=function(t){function e(e){var i=e.remote,o=i.url,s=i.min||1,a=i.max||16,u=e.tileSize||i.tileSize,h=e.name||"",p=e.max||32,l=new M(i),f=[];if(!u){var c="string"==typeof o&&o.match(/256|512|1024|2048|4096/);u=c?Number(c[0]):512}for(var d=new n.LRU(256/Math.pow(2,0)),y=new n.LRU(4*d.max),v=s;v<=a;v++)f.push({min:v,max:v==a?p:v,provider:new kt({name:h+"-L"+v,url:o,level:v-0,loader:l,size:u,storage:new ut(v-0,d,y)})});return t.call(this,r.__assign(r.__assign({min:s,max:p,style:Et,margin:0,pointerEvents:!1},e),{tileSize:u,providers:f}))||this}return r.__extends(e,t),e.prototype.getProvider=function(t){var e=Math.floor(t)-this.levelOffset;return this._p[e]},e.prototype.getCopyright=function(t){this.getProvider(this.max).getCopyright(t)},e}(T),Ot=function(t){function e(e){var r=t.call(this,e||{})||this;r.custom=!0,r.style={},r.tiled=!1;var n=r,i=n.onLayerAdd,o=n.onLayerRemove;return i&&n.addEventListener("layerAdd",n.onLayerAdd=function(t){n.init(),i.call(n,t)}),o&&n.addEventListener("layerRemove",n.onLayerRemove=o.bind(n)),r}return r.__extends(e,t),e.prototype.init=function(){var t=this.renderOptions||(this.renderOptions={}),e=t.mode||(t.mode="2d");this.flat="2d"==e},e.prototype.onLayerAdd=function(t){},e.prototype.onLayerRemove=function(t){},e.prototype.render=function(t,e){},e.prototype.pointerEvents=function(t){return!1},e.prototype.getCopyright=function(){},e.prototype.getStyle=function(){return this.style},e}(v);function Ct(t,e,r){var n=new XMLHttpRequest;return n.onload=function(){e(JSON.parse(this.responseText))},n.onreadystatechange=function(){var t=this.status;4==this.readyState&&(t<200||t>=300)&&0!==t&&r&&r(this)},n.open("GET",t,!0),n.send(),n}var Rt=function(){function t(t){var e=".json";(t=t||{}).host=t.host||"geocoder.api.here.com",t.version=t.version||"6.2",this.url="https://"+t.host+"/"+t.version+"/geocode"+e,this.reverseUrl="https://reverse."+t.host+"/"+t.version+"/reversegeocode"+e,this.cfg=t}return t.prototype.createUrl=function(t,e){var r="";for(var n in e=e||{})r+="&"+n+"="+encodeURIComponent(e[n]);return this.reverseUrl+"?app_id="+this.cfg.app_id+"&app_code="+this.cfg.app_code+r},t.prototype.geocode=function(t,e,r){Ct(this.createUrl(this.url,t),e,r)},t.prototype.reverseGeocode=function(t,e,r){Ct(this.createUrl(this.reverseUrl,t),e,r)},t.prototype.getIsoCountryCode=function(t,e,r){var n={mode:"retrieveAddresses",maxresults:1,jsonattributes:1};n.prox=t instanceof Array?t[1]+","+t[0]:t.latitude+","+t.longitude,this.reverseGeocode(n,function(t){var r=null;try{r=t.response.view[0].result[0].location.address.country}catch(t){}e&&e(r,t)},r)},t}(),zt=function(){function t(t){this.cache=new n.LRU(t||256)}return t.prototype.forEach=function(t){this.cache.forEach(t)},t.prototype.clear=function(){this.cache.clear()},t.prototype.remove=function(t){this.cache.remove(t.quadkey)},t.prototype.get=function(t){return this.cache.get(t)},t.prototype.set=function(t){var e=this.cache.set(t.quadkey,t),r=this._onDrop;e&&r&&r(e)},t.prototype.onDrop=function(t){this._onDrop=t},t}(),Vt=function(t){function e(e){var n=t.call(this,r.__assign({storage:new zt(512)},e))||this;if(n.name="",n.opacity=1,n.dataType="image","string"==typeof e.errorImage){var i=new Image;i.src=e.errorImage,n.errorImage=i}return n.tileLoader=new Ft({provider:n,loader:new _t(new r.HTTPLoader({url:e.url,headers:{Accept:"*/*"}})),preProcessor:e.preProcessor,processTileResponse:function(t,e,i,o){if(t.error)if(n.errorImage)e=n.errorImage;else if(404==t.error.statusCode){var s=o.response;if(s instanceof Blob&&s.type.startsWith("image"))return r.HTTPLoader.createImageFromBlob(s,function(t){i(t)})}i(e)}}),n}return r.__extends(e,t),e.prototype.getTile=function(t,e){return this.tileLoader.getTile(t,e)},e.prototype._removeTile=function(t){this.tileLoader.drop(t)},e.prototype.clear=function(t){var e=this,r=null;if(t instanceof Array){r=e.getCachedTilesOfBBox(t,e.level);for(var n=0,i=void 0;n<r.length;n++)i=r[n],this.tileLoader.drop(i),r[n]=i.quadkey}else 0==arguments.length&&this.storage.clear();e.dispatchEvent("clear",{tiles:r})},e.prototype.cancel=function(t){return this.tileLoader.cancel(t)},e}(ht);Vt.prototype.__type="ImageProvider";var qt,Dt=function(t){function e(e){var n=t.call(this,r.__assign({editable:!0,enforceRandomFeatureId:!0},e))||this;return n.blocked={},n}return r.__extends(e,t),e.prototype.detectFeatureClass=function(t){switch(t.geometry.type){case"Point":return"MARKER";case"LineString":return"LINE";case"Polygon":case"MultiPolygon":return"AREA"}},e.prototype.getFeatureProperties=function(t){return t.properties},e.prototype.readRoutingPoint=function(t){return{link:this.readRoutingLink(t),position:this.readRoutingPosition(t)}},e.prototype.blockFeature=function(t,e){var r=t.id||t,n=typeof r;"string"!=n&&"number"!=n||(e?this.blocked[r]=!0:delete this.blocked[r])},e.prototype._insert=function(e,r){return this.blocked[e.id]?null:t.prototype._insert.call(this,e,r)},e.prototype.reserveId=function(t,e){setTimeout(function(){return e(t.map(function(t){return t.id}))},0)},e.prototype.isoCC=function(t,e){return!0},e.prototype.prepareFeature=function(t){return t.properties||(t.properties={}),null==t.id&&(t.id=n.JSUtils.String.random()),t},e}(mt),At="Method not implemented.",It=function(t){function e(e,r){var n=t.call(this,e)||this;return n.name="FeatureError",n.feature=r,n}return r.__extends(e,t),e}(Error),Yt=function(t){function e(e){var n=t.call(this,r.__assign({minLevel:8,maxLevel:20,staticData:!1},e))||this;n.sizeKB=0,n._clearOnCommit=!0;var i=n,o=e.loader;if(!o)throw new Error("no tile loader defined.");o instanceof _t||(o=new _t(o));var s,a=e.preProcessor;return i.preprocess=Mt(a||e.preprocessor),i.postprocess=Mt(e.postProcessor),n.remoteTileLoader=new Pt({provider:i,loader:o,level:i.level,preProcessor:a,processTileResponse:function(t,e,r){if(t.error)return r(t.data);n.loadTileData(t,e,r)}}),i.commit&&(i.commit=(s=i.commit,function(t,e,r){var n,o=this,a=this.postProcessor,u=function(t){Array.isArray(t)||(t=[t]);for(var e,r=t.length;r--;)(e=(t[r]=F.prototype.toJSON.call(t[r])).properties)&&delete e["@ns:com:here:editor"];return t};return"object"==typeof t&&(t.put=u(t.put||[]),t.remove=u(t.remove||[]),Lt(a))?(i.postprocess(t,function(t){n=s.call(o,t,e,r)}),n):s.call(this,t,e,r)})),n}return r.__extends(e,t),e.prototype.getFeatures=function(e,r){var n=this;r=r||{},e instanceof Array||("object"==typeof e&&(e.remote&&(r.remote=e.remote),e.onload&&(r.onload=e.onload),e=e.ids||e.id),e=[].concat(e));var i=this,o=!0,s=r.onload,a=r.remote;(p=t.prototype.getFeatures.call(this,e))instanceof Array||(p=[p]);for(var u=0;u<p.length;u++)p[u]||(p[u]=e[u],o=!1);function h(){return 1==(p=p.map(function(t){return"object"==typeof t?t:qt})).length?p[0]:p}if(o||!a){var p=h();return s&&s(p),p}e=p.filter(function(t){return"object"!=typeof t});var l=function(t){var e=r.onerror;e&&e(t)};i._requestFeatures(e,function(t){for(var e=0,r=t;e<r.length;e++){var o=r[e],a=o.geometry;if(!a||!a.type||!a.coordinates)return void l(new It("Invalid geometry",o))}n.preprocess(t,function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];p[p.indexOf(n.id)]=i.addFeature(n)}s&&s(h())})},l,r)},e.prototype.cancel=function(t,e){this.remoteTileLoader.cancel(t,e)},e.prototype.search=function(t,e){var r,i,o=this;if("object"==typeof t)if(e)for(var s in t)e[s]=t[s];else e=t;var a=(e=e||{}).onload,u=e.radius,h=e.remote,p=e.onerror;if(u==qt&&(u=1),t instanceof Array)i=4==t.length?t:n.geotools.getPointBBox(t,u);else{if("number"==typeof t||"string"==typeof t||!t)return o.getFeatures(t,e);if(t.longitude!=qt&&t.latitude!=qt)i=n.geotools.getPointBBox([t.longitude,t.latitude],u);else if(t.minLon!=qt&&t.minLat!=qt&&t.maxLon!=qt&&t.maxLat!=qt)i=[t.minLon,t.minLat,t.maxLon,t.maxLat];else{if(r=t.point||t.rect||t.viewport)return o.search(r,e);if(t.id||t.ids)return o.getFeatures(t.id||t.ids,e)}}if(i={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]},h){for(var l,f=rt.getTilesInRect(i.minX,i.minY,i.maxX,i.maxY,o.level),c=function(t){f.splice(f.indexOf(t.quadkey),1),l=l||t.error,f.length||(l?p(l):a&&a(o._s(i)))},d=0;d<f.length;d++){var y=f[d],v=o.getCachedTile(y);if(v&&v.isLoaded()){if(v.error)return void(p&&p(v.error));f.splice(d--,1)}else o.getTile(y,c)}if(f.length)return}var g=o._s(i);return a&&a(g),g},e.prototype.getLoader=function(){return this.remoteTileLoader.loader},e.prototype.config=function(e){return t.prototype.config.call(this,e)},e.prototype.clear=function(e){0==arguments.length&&this.remoteTileLoader.clear(),t.prototype.clear.apply(this,arguments)},e.prototype.getTile=function(t,e){return this.remoteTileLoader.getTile(t,e)},e.prototype._removeTile=function(e,r){this.remoteTileLoader.drop(e),t.prototype._removeTile.call(this,e,r)},e.prototype.readDirection=function(t){throw new Error(At)},e.prototype.readPedestrianOnly=function(t){throw new Error(At)},e.prototype.writeTurnRestriction=function(t,e,r){throw new Error(At)},e.prototype.readRoutingProvider=function(t,e){return this.id},e.prototype.readRoutingPosition=function(t){throw new Error(At)},e.prototype.readRoutingLink=function(t){throw new Error(At)},e.prototype.writeRoutingPosition=function(t,e){throw new Error(At)},e.prototype.writeRoutingLink=function(t,e){throw new Error(At)},e.prototype.readTurnRestriction=function(t,e){throw new Error(At)},e.prototype.writeRoutingPoint=function(t,e,r){this.writeRoutingLink(t,e),this.writeRoutingPosition(t,r)},e.prototype.writeEditState=function(t,e){},e.prototype.readFeatureHeight=function(t){return null},e.prototype.writeFeatureHeight=function(t,e){throw new Error(At)},e.prototype.reserveId=function(t,e){for(var r,i=t.length,o=[];i--;)"string"==typeof(r=t[i].id)&&r.length>15?o.push(t[i].id):o.push(n.JSUtils.String.random(16));setTimeout(function(){e(o.reverse())},0)},e.prototype.isDroppable=function(t){var e=t.editState&&t.editState();return!e||!e.modified&&!e.removed&&!e.split},e}(Dt),Xt="Method not implemented.",jt=function(t){function e(e){var n=this,i=e.loader;return i?i instanceof _t||(i=new _t(i)):i=new _t(new r.HTTPLoader({url:e.url,withCredentials:e.withCredentials,headers:e.headers})),e.loader=i,(n=t.call(this,e)||this).setParams(e.params||{}),n.setHeaders(e.headers||{}),n}return r.__extends(e,t),e.prototype._httpLoader=function(){var t=this.remoteTileLoader.loader.src;return t[t.length-1]},e.prototype.getHeader=function(t){return this._httpLoader().headers[t]||null},e.prototype.getHeaders=function(){return n.JSUtils.clone(this._httpLoader().headers)},e.prototype.setHeader=function(t,e){var r=this.getHeaders();r[t]=e,this._httpLoader().headers=r,this.headers=r},e.prototype.setHeaders=function(t){var e=this.getHeaders();n.JSUtils.extend(e,t),this._httpLoader().headers=e,this.headers=e},e.prototype.getParams=function(){return this.params},e.prototype.getParam=function(t){return this.params[t]||null},e.prototype.setParams=function(t){var e=this._httpLoader(),r=e.baseUrl,i=this.params||{};if(n.JSUtils.extend(i,t),this.params=i,"string"==typeof r){i=n.JSUtils.extend(function(t,e){return e=e||{},r.split(/\?|\&/).slice(1).map(function(t){t=t.split(/\=/),e[t[0]]=t[1]}),e}(),i);var o=r.split(/\?/)[0],s="?";for(var a in i){var u=i[a];void 0===u?delete i[a]:(o+=s+a+"="+u,s="&")}e.setUrl(o)}},e.prototype.setParam=function(t,e){var r={};r[t]=e,this.setParams(r)},e.prototype.config=function(e){return t.prototype.config.call(this,e),e&&e.url&&this.setParams({}),this},e.prototype.commit=function(t,e,r,n){throw new Error(Xt)},e.prototype._requestFeatures=function(t,e,r,n){throw new Error(Xt)},e.prototype.readZLevels=function(t){throw new Error(Xt)},e.prototype.writeZLevels=function(t,e){throw new Error(Xt)},e}(Yt);jt.prototype.getFeatureUrl=jt.prototype.getLayerUrl=jt.prototype.getTileUrl=function(){throw new Error(Xt)};var Gt="Method not implemented.",Zt=function(t){function e(e){return e.level=e.level||13,e.headers=n.JSUtils.extend({Accept:"application/geo+json"},e.headers||{}),t.call(this,e)||this}return r.__extends(e,t),e.prototype.getFeatureUrl=function(t,e){throw new Error(Gt)},e.prototype.getLayerUrl=function(t){throw new Error(Gt)},e.prototype.getTileUrl=function(t){throw new Error(Gt)},e}(jt),Nt="Method not implemented.",Ht=function(t){function e(e){var n=t.call(this,r.__assign({minLevel:8,maxLevel:20,storage:new zt(512),editable:!1,size:512},e))||this;return n._clearOnCommit=!1,delete n.level,n.editable||(n.Feature=F,n.detectFeatureClass=function(){return null}),n}return r.__extends(e,t),e.prototype.cancel=function(t){},e.prototype.delete=function(t){this.tree.remove(t)},e.prototype.import=function(t){var e=this;e.tree.fromJSON(t);for(var r=(t=e.tree.all()).length;r--;)e._insert(t[r])},e.prototype.initStorage=function(t){},e.prototype.commit=function(t,e,r){return"function"==typeof e&&setTimeout(function(){return e({})},0),!0},e.prototype.readDirection=function(t){throw new Error(Nt)},e.prototype.readPedestrianOnly=function(t){throw new Error(Nt)},e.prototype.writeTurnRestriction=function(t,e,r){throw new Error(Nt)},e.prototype.readRoutingProvider=function(t,e){return this.id},e.prototype.readRoutingPosition=function(t){throw new Error(Nt)},e.prototype.readRoutingLink=function(t){throw new Error(Nt)},e.prototype.writeRoutingPosition=function(t,e){throw new Error(Nt)},e.prototype.writeRoutingLink=function(t,e){throw new Error(Nt)},e.prototype.readTurnRestriction=function(t,e){throw new Error(Nt)},e.prototype.writeRoutingPoint=function(t,e,r){this.writeRoutingLink(t,e),this.writeRoutingPosition(t,r)},e.prototype.readZLevels=function(t){throw new Error("Method not implemented.")},e.prototype.writeZLevels=function(t,e){throw new Error("Method not implemented.")},e.prototype.writeEditState=function(t,e){},e.prototype.readFeatureHeight=function(t){return null},e.prototype.writeFeatureHeight=function(t,e){throw new Error(Nt)},e}(Dt),Jt={environment:"prd",space:"",credentials:{access_token:""},withCredentials:!1,tags:!1,https:!0,clip:!1,url:null,headers:null,propertySearch:null,editable:!0,level:0},Wt="@ns:com:here:xyz",Kt="http://",Qt={prd:Kt+"xyz.api.here.com/hub/spaces"},$t=function(t,e){return(t=n.JSUtils.extend(n.JSUtils.clone(Jt),t)).params=n.JSUtils.extend(t.params||{},t.credentials),delete t.credentials,Tt(e)&&(t.preProcessor=e),t.url||(t.url=Qt[t.environment]),t.https&&(t.url=t.url.replace(Kt,"https://")),t},te=function(t){function e(e){var r=t.call(this,$t(e,arguments[1]))||this;return r.definition=null,r.setUrl(r.getTileUrl(r.space)),e.propertySearch&&r.setPropertySearch(e.propertySearch),r}return r.__extends(e,t),e.prototype.getHttpLoader=function(){var t=this.getLoader().src;return t[t.length-1]},e.prototype.config=function(e){var r=null==e?void 0:e.credentials;return r&&(delete e.credentials,this.setParams(r)),t.prototype.config.call(this,e)},e.prototype.commit=function(t,e,r){var n=this.getHttpLoader(),i=0,o=function(t){!--i&&e&&e(t)},s=function(t){r&&r(t)};if("object"==typeof t){var a=t.put||[],u=t.remove||[];a.length&&(i++,n.send(this.createUpdateFeatureRequest(a,{success:o,error:s}))),u.length&&(i++,n.send(this.createRemoveFeatureRequest(u,{success:o,error:s})))}},e.prototype.getLayerUrl=function(t){return this.url+"/"+t},e.prototype.getTileUrl=function(t){return this._addUrlFilters(this.getLayerUrl(t)+"/tile/quadkey/{QUADKEY}?margin="+this.margin+"&clip="+!!this.clip)},e.prototype.getFeatureUrl=function(t,e){return e instanceof Array||(e=[e]),this.getLayerUrl(t)+"/features?id="+e.join("&id=")},e.prototype.createUpdateFeatureRequest=function(t,e){void 0===e&&(e={});var n=this,i=n._addUrlCredentials(n.getLayerUrl(n.space)+"/features","?");return r.__assign({type:"POST",url:i,headers:r.__assign(r.__assign({},n.headers),{"Content-Type":"application/geo+json"}),data:JSON.stringify({type:"FeatureCollection",features:t})},e)},e.prototype.createRemoveFeatureRequest=function(t,e){void 0===e&&(e={});var n=this,i=n._addUrlCredentials(n.getLayerUrl(n.space)+"/features","?");return r.__assign({type:"DELETE",url:i+"&id="+t.map(function(t){return t.id}).join(","),headers:r.__assign(r.__assign({},n.headers),{Accept:"application/json"})},e)},e.prototype.prepareFeature=function(e){var r=(e=t.prototype.prepareFeature.call(this,e)).properties;return r[Wt]||(r[Wt]={}),e},e.prototype.setMargin=function(t){Zt.prototype.setMargin.call(this,t),this.setUrl(this.getTileUrl(this.space))},e.prototype.setUrl=function(t){this._httpLoader().setUrl(this._addUrlCredentials(t))},e.prototype.setTags=function(t){"string"==typeof t&&(t=[t]),this.tags=t,this.setUrl(this.getTileUrl(this.space)),this.clear()},e.prototype.setPropertySearch=function(t,e,r){var i,o="";for(var s in"string"==typeof t?(i={})[t]={operator:e,value:r}:i=t,i){var a=i[s];e=a.operator.replace(">=","=gte=").replace("<=","=lte=").replace(">","=gt=").replace("<","=lt="),(r=null==a.values?a.value:a.values)instanceof Array||(r=[r]),r=r.map(function(t){return"string"==typeof t&&(n.JSUtils.isNumeric(t)||"true"==t||"false"==t||"null"==t)&&(t='"'+t+'"'),encodeURIComponent(t)});var u=s.slice(0,2);"f."!=u&&"p."!=u&&(s="p."+s),o+=s+e+r+"&"}this.psf=o.slice(0,-1),this.setUrl(this.getTileUrl(this.space)),this.clear()},e.prototype.getCopyright=function(t,e){this.getDefinition(function(e){t&&t(e.copyright||[])},e)},e.prototype.getDefinition=function(t,e){var i=this,o=i.getHttpLoader(),s=i.definition;if(null==s){var a=new n.Queue;s=this.definition=a,o.send({url:i._addUrlCredentials(i.getLayerUrl(i.space),"?"),id:"def",success:function(t){i.definition=t,a.done(t)},error:function(t){i.definition=[],e&&e(t)},headers:r.__assign(r.__assign({},this.headers),{Accept:"application/json"})})}t&&(s instanceof n.Queue?s.add(t):t(s))},e.prototype._requestFeatures=function(t,e,r,n){this.getHttpLoader().send({id:t.join("&"),url:this._addUrlCredentials(this.getFeatureUrl(this.space,t)),success:function(t){e(t.features)},headers:this.headers,error:r})},e.prototype._addUrlCredentials=function(t,e){return t=function(t,e,r){for(var n in e)t+=r+n+"="+e[n],r="&";return t}(t,this.params,e||"&")},e.prototype._addUrlFilters=function(t){var e=this.tags,r=this.psf;return e&&e.length&&(t+="&tags="+e.join(",")),r&&(t+="&"+r),t},e}(Zt),ee=function(t){function e(e){var n,i=this;return(i=t.call(this,function(t){var e=r.__assign(r.__assign({url:"http://interactive.data.api.platform.here.com/interactive/v1",https:!0,space:t.layer},t),{credentials:r.__assign({},t.credentials)});return delete e.credentials.token,e}(e))||this).definition=[],i.token=null===(n=e.credentials)||void 0===n?void 0:n.token,i}return r.__extends(e,t),e.prototype.addRequestToken=function(t){return(t.headers=t.headers||{}).Authorization="Bearer "+this.token,t},e.prototype.createUpdateFeatureRequest=function(e,r){return void 0===r&&(r={}),this.addRequestToken(t.prototype.createUpdateFeatureRequest.call(this,e,r))},e.prototype.createRemoveFeatureRequest=function(e,r){return void 0===r&&(r={}),this.addRequestToken(t.prototype.createRemoveFeatureRequest.call(this,e,r))},e.prototype.getLayerUrl=function(t){return this.url+"/catalogs/"+this.catalog+"/layers/"+t},e.prototype.config=function(e){var r,n=null===(r=null==e?void 0:e.credentials)||void 0===r?void 0:r.token;return n&&(this.token=n,delete e.credentials.token),t.prototype.config.call(this,e)},e}(te),re=H,ne=r.__assign({name:"xyz-maps"},{version:"0.32.0",revision:"f28fa04",date:"2022-10-14T17:30:53Z"}),ie=i.global.here.xyz.maps;ie.common=i;var oe=ie.geo={Point:a,Rect:u},se=ie.pixel={Point:o,Rect:s},ae=ie.layers={TileLayer:T,MVTLayer:Ut,CustomLayer:Ot},ue=ie.features={Feature:F},he=ie.tile={Tile:ot,Utils:rt};ie.build=ne;var pe=ie.providers={ImageProvider:Vt,GeoJSONProvider:Zt,FeatureProvider:mt,LocalProvider:Ht,RemoteTileProvider:St,EditableRemoteTileProvider:Yt,SpaceProvider:te,IMLProvider:ee,MVTProvider:kt,EditableFeatureProvider:Dt},le=ie.projection={webMercator:re},fe=ie.loaders={HTTPLoader:r.HTTPLoader,Manager:_t},ce=ie.service||{Geocoder:Rt},de={tile:he,layers:ae,geo:oe,pixel:se,features:ue,providers:pe,projection:le,loaders:fe,service:ce,build:ne,common:i};t.CustomLayer=Ot,t.DEFAULT_LAYER_MAX_ZOOM=32,t.DEFAULT_LAYER_MIN_ZOOM=15,t.EditableFeatureProvider=Dt,t.EditableRemoteTileProvider=Yt,t.Feature=F,t.FeatureProvider=mt,t.GeoCoder=Rt,t.GeoJSONProvider=Zt,t.GeoPoint=a,t.GeoRect=u,t.HTTPProvider=jt,t.IMLProvider=ee,t.ImageProvider=Vt,t.Layer=v,t.LocalProvider=Ht,t.MVTLayer=Ut,t.MVTProvider=kt,t.PixelPoint=o,t.PixelRect=s,t.RemoteTileProvider=St,t.SpaceProvider=te,t.Tile=ot,t.TileLayer=T,t.build=ne,t.default=de,t.features=ue,t.layers=ae,t.loaders=fe,t.pixel=se,t.projection=le,t.providers=pe,t.service=ce,t.tile=he,t.tileUtils=rt,t.utils=dt,t.webMercator=re,Object.defineProperty(t,"__esModule",{value:!0})});let i=window;return"here.xyz.maps".split(".").forEach(t=>i=i[t]=i[t]||{}),i});
},{}],"TWyQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.styleTools=exports.default=exports.MapEvent=exports.Map=void 0;var t=require("@here/xyz-maps-common"),e=require("@here/xyz-maps-core"),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function o(t,e,i,r){return new(i||(i=Promise))(function(n,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,s)}l((r=r.apply(t,e||[])).next())})}function a(t,e){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var s=function(t,e,i,r){("string"==typeof e?[e]:e).forEach(function(e){t.addEventListener(e,i,r)})},l=function(t,e,i,r){("string"==typeof e?[e]:e).forEach(function(e){t.removeEventListener(e,i,r)})},u=function(t,e){return Math.round(parseFloat((r=e,(o=(i=t).ownerDocument.defaultView.getComputedStyle(i,null))&&""===(n=o.getPropertyValue(r))&&(n=i.style[r]),n)))||0;var i,r,n,o},h=function(t,e,i,r){this.lrTs=!1,this.x=t,this.y=e,this.size=i,this.tile=r},f=function(){function t(t,e){this.ready=!1,this.cnt=0,this.z={},this.zLength=0,this.zd=!1,this._z3d=1/0,this.layer=t,this.tileSize=t.tileSize||null,this.layers=e,this.id=Math.floor(1e16*Math.random())}return t.prototype.getZ=function(t){var e=this.z;if(this.zd){var i=0;for(var r in e)e[r]=i++;this.zLength=i,this.zd=!1,this.z3d=e[this._z3d]}return e[t]||0},t.prototype.getAbsoluteZ=function(t){for(var e=this.index,i=this.layers,r=0,n=0;r<e;)n+=i[r++].zLength;return null!=t&&(n+=this.getZ(t)),n},t.prototype.addZ=function(t,e){var i=this.z;null==i[t]&&(i[t]=0,this.zd=!0,e&&t<this._z3d&&(this._z3d=t))},t.prototype.getZ3d=function(){for(var t,e=this.layers,i=0,r=0;t=e[i++];){if(t._z3d>=0)return r+t.z3d;r+=t.zLength}return r},t}(),c=function(t){function e(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var n=t.apply(this,i)||this;return n._map={},Object.setPrototypeOf(n,e.prototype),n}return r(e,t),e.prototype.indexOf=function(e){var i=this._map[e.id];return t.prototype.indexOf.call(this,i)},e.prototype.fixZ=function(){for(var t=0;t<this.length;t++)this[t].index=t},e.prototype.add=function(e,i){var r,n=e.id,o=this._map[n];return o?(this.splice(t.prototype.indexOf.call(this,o),1),this.splice(i,0,o),r=!1):(o=this._map[n]=new f(e,this),this.splice(i,0,o),r=!0),this.fixZ(),r},e.prototype.remove=function(t){var e=this.indexOf(t);return-1!==e&&(this.splice(e,1),delete this._map[t.id],this.fixZ()),e},e.prototype.get=function(t){return"string"!=typeof t&&(t=t.id),this._map[t]},e.prototype.reset=function(t){for(var e,i=new Set,r=0;r<this.length;r++){var n=this[r];if(e=n.layer,n.error=!1,n.cnt=0,n.tiles=[],n.visible=t>=e.min&&t<=e.max){if(n.ready=!1,e.custom)continue;i.add(e.tileSize)}else n.ready=!0}return Array.from(i)},e}(Array),p=function(){function t(t,e){this.display=t,this.render=e}return t.prototype.forEachTile=function(t,e){t.getProvider().getCachedTilesOfBBox(t.getBBox()).forEach(e)},t.prototype.remove=function(t,e,i){for(var r=0,n=e;r<n.length;r++){var o=n[r];this.removeFromTile(t,o,i)}},t.prototype.modifyInTile=function(t,e,i,r){var n=this.isVertexDataInitialized(e);return!!n&&(this.display.updateTile(e,n,r,t),!0)},t.prototype.isVertexDataInitialized=function(t){return this.display.getBucket(t.quadkey)},t.prototype.addToTile=function(t,e,i){var r=this.isVertexDataInitialized(e);r&&this.display.updateTile(e,r,i,t)},t.prototype.removeFromTile=function(t,e,i){var r=this.isVertexDataInitialized(e);r&&this.display.updateTile(e,r,i,t)},t.prototype.add=function(t,e,i){for(var r=0,n=e;r<n.length;r++){var o=n[r];this.addToTile(t,o,i)}},t.prototype.updateGeometry=function(t,e,i,r){for(var n=r.getProvider(),o=n.getCachedTilesOfBBox(e),a=n.getCachedTilesOfBBox(t.getBBox()),s=0,l=a.length;s<l;s++){var u=o.indexOf(a[s]);-1===u?this.addToTile(t,a[s],r):(this.modifyInTile(t,a[s],i,r),o.splice(u,1))}for(s=0,l=o.length;s<l;s++)this.removeFromTile(t,o[s],r),this.removeFromTile(t,o[s],r)},t.prototype.repaint=function(t,e,i){var r=this;r.forEachTile(t,function(e){var n=r.isVertexDataInitialized(e);n?r.display.updateTile(e,n,i,t):e.preview&&(e.preview=void 0)})},t.prototype.clear=function(t,e){e=e||[];var i=this.display,r=i.layers.indexOf(t);i.buckets.forEach(function(i){e.length&&!function(t,e){for(var i,r,n=t.length,o=0;o<e.length;o++)if(r=t,i=e[o],n>e[o].length&&(i=r,r=e[o]),0===i.search(r))return!0}(i.quadkey,e)||(i.clear(r),i.ready(r,!1),i.cancelTasks(t),i.luTs=null)}),i.update()},t}(),d=[],v=function(){function t(t,e){this.display=t,"number"==typeof e?(this.down=e,this.up=e):(this.down=e[0],this.up=e[1])}return t.prototype.lookUp=function(t,e,i,r,n,o){var a,s,l,u=t.quadkey,h=i-r;if(a=Number(u[h]),o.x+=a%2*e/2,o.y+=Number(a>1)*e/2,l=u.substring(0,h),this.hasData(l,n)){var f=e/Math.pow(2,r);return s=[],this.add(s,l,o.x,o.y,f,0,0,e),s}o.x/=2,o.y/=2},t.prototype.add=function(t,e,i,r,n,o,a,s){t.push([e,i,r,n,n,0^o,0^a,s,s])},t.prototype.hasData=function(t,e){var i=this.display.buckets.get(t,!0);if(i)return i.ready(e)&&i.getData(e)},t.prototype.lookDown=function(t,i,r,n,o){var a,s,l,u,h,f,c=r+n;a=e.tileUtils.getTilesOfLevel(t.quadkey,c);for(var p=0;p<a.length;p++){s=l=0,u=i;for(var d=0;d<n;d++)u/=2,s+=(h=a[p][r+d])%2*u,l+=Number(h>1)*u,d==n-1&&this.hasData(a[p],o)&&(f=f||[],this.add(f,a[p],0,0,i,s,l,u))}return f},t.prototype.create=function(t,e,i,r){var n,o=t.quadkey.length,a=e.min,s=e.max,l=s-o,u=o-a,h={x:0,y:0},f=0,c=e.tileSize;i=i||this.down,(r=r||this.up)>u&&(r=u),i>l&&(i=l);for(var p=r>i?r:i,v=t.index(e);f++<p;){if(o-f>=a&&(n=this.lookUp(t,c,o,f,v,h)))return n;if(o+f<=s&&f<i&&(n=this.lookDown(t,c,o,f,v)))return n}return d},t}(),g=document.createElement("canvas").getContext("2d"),y="abcdefghijklmnopqrstuvwxyz",m=(y=y+y.toUpperCase()+" 0123456789").length,x={},_="normal 12px Arial",w=function(t,e,i,r){t.font=e.font||_,"number"==typeof e.strokeWidth?t.lineWidth=e.strokeWidth:t.lineWidth=1,t.strokeStyle=r,t.fillStyle=i,t.textAlign=e.textAlign||"start",t.lineCap="round",t.lineJoin="round"},b=function(t,e,i,r,n){var o=n.fill,a=n.stroke,s=n.strokeWidth;a&&0!=s&&t.strokeText(e,i,r),o&&t.fillText(e,i,r)},T=function(t,e,i,r,n){r=r||128,n=n||128,t.fillStyle="#000",t.fillRect(0,0,r,n),w(t,e,"#fff","#fff"),b(t,i,0,0,e);for(var o=t.getImageData(0,0,r,n).data,a=-1,s=-1,l=0;l<n;l++)for(var u=0;u<r;u++){if(0!=o[4*(l*r+u)]){-1==a&&(a=l);break}if(u==r-1&&-1!==a){s=l,l=n;break}}return t.clearRect(0,0,r,n),{height:s-a,min:a,max:s}},L=function(t){void 0===t&&(t={});var e=t.font,i=t.strokeWidth,r=(e=e||_)+(i=i||0);return x[r]||(g.font=e,g.textBaseline="top",x[r]={width:g.measureText(y).width/m,height:T(g,t,"gM").height}),x[r]},S=function(t,e){if(!1===e)return[t];null!=e&&!0!==e||(e=14);for(var i,r=[],n=0,o=-1,a=0,s=void 0,l=void 0,u=t.length;a<u;a++)l=a-n," "==(i=t.charAt(a))?o=a:"\n"==i&&(l=1/0,o=a),l>=e&&n<=o&&(s=t.substring(n,o),n=o+1,r.push(s)),a==u-1&&n<=a&&(s=t.substring(n,a+1),r.push(s));return r},M={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},A=function(t){return t.length<5?[parseInt("".concat(t[1]).concat(t[1]),16)/255,parseInt("".concat(t[2]).concat(t[2]),16)/255,parseInt("".concat(t[3]).concat(t[3]),16)/255,1]:[parseInt(t.slice(1,3),16)/255,parseInt(t.slice(3,5),16)/255,parseInt(t.slice(5,7),16)/255,1]};for(var z in M)M[z]=A("#"+M[z]);var P=function(t){var e;return t&&(Array.isArray(t)?3==(e=t).length&&(e[3]=1):e="#"==t[0]?A(t):(e=M[t])?e.slice():function(t){var e=t.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*(?:\.\d+)?))?\)$/);return e&&e.length>3&&[e[1]/255,e[2]/255,e[3]/255,null==e[4]?1:Number(e[4])]}(t)),e},I=function(t,e){for(var i=0,r=[t,e];i<r.length;i++)for(var n=r[i],o=0;o<n.length;o++){for(var a=void 0,s=void 0,l=void 0,u=void 0,h=void 0,f=(o+1)%n.length,c=n[o],p=n[f],d=[p[1]-c[1],c[0]-p[0]],v=0,g=t;v<g.length;v++){var y=g[v];h=d[0]*y[0]+d[1]*y[1],(void 0===a||h<a)&&(a=h),(void 0===s||h>s)&&(s=h)}for(var m=0,x=e;m<x.length;m++)y=x[m],h=d[0]*y[0]+d[1]*y[1],(void 0===l||h<l)&&(l=h),(void 0===u||h>u)&&(u=h);if(s<l||u<a)return!1}return!0},E=function(t,e,i,r,n){var o=Math.sin(n),a=Math.cos(n),s=t-i,l=e-r;return[a*s-o*l+i,o*s+a*l+r]},C=function(t,e,i,r,n,o){return t>i&&t<n&&e>r&&e<o},k=function(t,e,i,r){var n=t-i,o=e-r;return Math.sqrt(n*n+o*o)},D=function(t,e,i,r,n){var o=(r[1]-i[1])*(e[0]-t[0])-(r[0]-i[0])*(e[1]-t[1]);if(0!=o){var a=((r[0]-i[0])*(t[1]-i[1])-(r[1]-i[1])*(t[0]-i[0]))/o,s=((e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]))/o;if(0<=a&&a<=1&&0<=s&&s<=1)return!n||[t[0]+a*(e[0]-t[0]),t[1]+a*(e[1]-t[1]),t[2]+a*(e[2]-t[2])]}return!1},O=function(t){return t>47&&t<58},R=function(){function t(){this.fonts={}}return t.getInstance=function(){return this.instance=this.instance||new t},t.prototype.getFontId=function(t,e){return"".concat(t.font||"normal 12px Arial").concat(t.strokeWidth||1).concat(e)},t.prototype.initFont=function(t,e){void 0===e&&(e=1);var i=this.fonts,r=this.getFontId(t,e);if(!i[r]){var n=96*e,o=function(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i}(n,n),a=o.getContext("2d");a.textBaseline="bottom";var s=T(a,t,"gM").height;a.textBaseline="top";var l=T(a,t,"gM").height;w(a,t,"#fff","#000"),a.setTransform(e,0,0,e,0,0);var u=a.lineWidth,h=Math.floor(u),f=Math.floor(u),c=l+2*f;i[r]={name:r,size:0,glyphs:new Map,paddingX:h,paddingY:f,canvas:o,ctx:a,width:n,offsetX:2*u*e,scale:e,style:t,charWidthCache:new Map,rowHeight:c*e,letterHeightBottom:s,letterHeight:l,spaceWidth:a.measureText(" ").width*e,baselineOffset:e*((l-s)/2+f)}}return i[r]},t.prototype.hasGlyph=function(t,e){return e.glyphs.has(t)},t.prototype.getGlyph=function(t,e){var i,r=e.glyphs.get(t);if(!r){var n=e.canvas.width,o=e.offsetX,a=e.scale;e.ctx.clearRect(0,0,n,n),b(e.ctx,t,e.paddingX,e.paddingY,e.style);var s=e.charWidthCache.get(t);null==s?s=e.ctx.measureText(t).width:e.charWidthCache.delete(t);var l=Math.round((s||0)+2*e.paddingX)*a,u=e.ctx.getImageData(0,0,l,e.rowHeight);r={char:t,width:s,data:u,direction:(i=t.charCodeAt(0),i>=32&&i<=47||i>=58&&i<=64||i>=91&&i<=96||i>=123&&i<=126||O(i)?0:i>=1424&&i<=1791||i>=1872&&i<=1919||i>=2208&&i<=2303||i>=64336&&i<=65023||i>=65136&&i<=65279?-1:1),advanceX:s?u.width-o:0},e.glyphs.set(t,r),e.size++}return r},t.prototype.getTextWidth=function(t,e){for(var i=e.ctx,r=0,n=0,o=t;n<o.length;n++){var a=o[n],s=e.glyphs.get(a);if(s)r+=s.width;else{var l=e.charWidthCache.get(a);null==l&&(l=i.measureText(a).width,e.charWidthCache.set(a,l)),r+=l}}return r},t}(),F=R.getInstance(),U=e.webMercator.meterToPixel,N=e.webMercator.pixelToMeter,B=function(t){return 0^Math.min(t,20)},G={type:1,zIndex:1,fill:1,stroke:1,strokeWidth:1,radius:1,width:1,height:1,font:1,text:1,textRef:1,offsetX:1,offsetY:1,alignment:1,rotation:1,priority:1,repeat:1,collide:1,offset:1,from:1,to:1,checkLineSpace:1,extrude:1,extrudeBase:1},W=new Map,Z=function(t,e,i){var r=X("text",t,e,i);if(!r&&t.textRef&&(null==(r=W.get(t.textRef))&&(r=new Function("f","return f."+t.textRef),W.set(t.textRef,r)),r=r(e,i)),""!=r)return void 0!==r&&"string"!=typeof r&&(r=String(r)),r},X=function(t,e,i,r){var n=e[t];return"function"==typeof n?n(i,r,e):n},Y=function(t,e){void 0===e&&(e=!1);var i="px",r=t;return"string"==typeof t&&(r=parseFloat(t)||0,"m"==t.charAt(t.length-1))?(i="m",[r=Math.round(10*r)/10,i]):(e||(r^=0),[r,i])},H=function(t,e,i,r,n){var o=X(t,e,i,r),a=Y(o,n),s=a[0];if("m"==a[1]){var l=B(r);s=Math.pow(2,r%l)*U(s,l)}return s},j=function(t,e,i,r){var n=X("zIndex",t,e,i),o=X("zLayer",t,e,i);return"number"!=typeof o&&(o=r+1),1e6*o+n},V=function(t,e,i,r){for(var n=0,o=B(i),a=0,s=t;a<s.length;a++){var l=s[a],u=j(l,e,o,r);u>n&&(n=u)}return n},q=function(t,e,i,r,n){for(var o,a=0,s=0,l=B(i),u=0;u<t.length;u++)if(o=t[u],!("Line"!=X("type",o,e,l)||n&&X("altitude",o,e,l))){var h=j(o,e,l,r);h>s&&(s=h);var f=H("strokeWidth",o,e,i,!0);f>a&&(a=f)}return[a,s]},K=function(t,e,i,r,n,o){var a,s,l,u,h,f,c=B(i),p=X("type",t,e,c);n=n||[1/0,1/0,-1/0,-1/0];var d=X("fill",t,e,c),v=!o&&X("stroke",t,e,c);if("Image"!=p&&!d&&!v)return null;if("Text"==p){var g=Z(t,e,c);if(!g)return null;var y=X("strokeWidth",t,e,c),m=X("font",t,e,c),x=F.initFont({font:m,strokeWidth:y,fill:d,stroke:v},r),_=void 0;if(h=0,"LineString"==e.geometry.type||"MultiLineString"==e.geometry.type)h=F.getTextWidth(g,x),f=x.letterHeight;else{for(var w=X("lineWrap",t,e,c),b=0,T=_=S(g,w);b<T.length;b++){var L=T[b],M=F.getTextWidth(L,x);M>h&&(h=M)}f=_.length*x.letterHeight}}else y=X("strokeWidth",t,e,c),isNaN(y)&&(y=1),"Circle"==p?f=h=2*H("radius",t,e,c)^0:(h=0^H("width",t,e,c),f=0^((f=H("height",t,e,c))||h)),f+=y,h+=y;var A=0^X("offsetX",t,e,c),z=0^X("offsetY",t,e,c),P="Circle"!=p&&0^X("rotation",t,e,c);if(P){var I=function(t,e,i,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var o=r-(e*=.5),a=r+e,s=n-(i*=.5),l=n+i,u=E(o,s,r,n,t),h=E(a,l,r,n,t),f=E(o,l,r,n,t),c=E(a,s,r,n,t);return[Math.min(u[0],h[0],f[0],c[0]),Math.min(u[1],h[1],f[1],c[1]),Math.max(u[0],h[0],f[0],c[0]),Math.max(u[1],h[1],f[1],c[1])]}(P,h,f,A,z);a=I[0],l=I[1],s=I[2],u=I[3]}else s=(a=A-.5*h)+h,u=(l=z-.5*f)+f;return a<n[0]&&(n[0]=a),s>n[2]&&(n[2]=s),l<n[1]&&(n[1]=l),u>n[3]&&(n[3]=u),n},Q=function(t,e,i,r,n,o){for(var a,s,l=B(i),u=0,h=0,f=t;h<f.length;h++){var c=f[h];o&&X("altitude",c,e,l)||(s=K(c,e,i,r,s,!0)||s,(a=j(c,e,l,n))>u&&(u=a))}if(s)return s[4]=u,s},J=function(t){return t.type&&null!=t.zIndex},$=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),Math.min(i,Math.max(e,t))},tt=function(t,e,i,r,n){return function(t,e,i){return t*(1-i)+e*i}(i,r,function(t,e,i){return $((n-t)/(e-t))}(t,e))},et=function(t,e){var i,r,n,o,a,s=0;for(var l in t){var u=Number(l);r=t[u];var h=Array.isArray(r),f=void 0,c=void 0;if(h?f=r:(f=(i=Y(r))[0],c=i[1]),"px"==c&&(r=f),e<=u){if(0==s)return"m"==c?t[u]:f;if(h){for(var p=[],d=0;d<f.length;d++)p[d]=tt(a,u,n[d],f[d],e);return p}if(u-a>1){var v=n,g=f,y=c!=o,m="m"==c;return y&&(m?v=N(v,a):g=N(g,u)),tt(a,u,v,g,e)+(y||m?"m":0)}return r}a=u,n=f,o=c,s++}return r},it=function(t,e){for(var i=1;i<=20;i++)t[i]=et(e,i);return t},rt=function(t){for(var e in t)t[e]=P(t[e])},nt=function(t){var e=function(e,i){return t[i]};return e.map=t,e},ot=function(t){if(!t.__p){t.__p=!0;for(var e=0,i=t;e<i.length;e++){var r=i[e];for(var n in r)if(n in G){var o=r[n];if("object"==typeof o&&!Array.isArray(o)){"stroke"!=n&&"fill"!=n||rt(o);var a=it({},o);r[n]=nt(a)}}}}},at=Object.freeze({__proto__:null,getTextString:Z,calcBBox:K,is3d:function(t,e,i){for(var r=B(i),n=0,o=t;n<o.length;n++){var a=o[n];if(X("altitude",a,e,r)||X("extrude",a,e,r))return!0}return!1},getExtrude:function(t,e,i){for(var r=B(i),n=0,o=t;n<o.length;n++){var a=o[n],s=X("extrude",a,e,r);if(s)return s}return null},getValue:X,parseSizeValue:Y,getLineWidth:q,getPixelSize:Q,getSizeInPixel:H,merge:function(t,e){if(null===e||!1===e)return null;for(var i,r=[],n=0,o=t.length;n<o;n++){for(var a in i=t[n],r.push([i[0],{}]),i[1])r[n][1][a]=i[1][a];if(e[n])for(var a in r[n][0]=e[n][0],e[n][1])r[n][1][a]=e[n][1][a]}return r},isStyle:J,getMaxZoom:V,parseStyleGroup:ot}),st=function(){return 1},lt=function(){function t(t,e){this.tm=t,this.ms=e}return t.prototype.exclusiveRuntime=function(t){this.ms=t},t.prototype.spawn=function(t,e,i,r,n,o,a,s){var l=this.createTask(t,e,i,r,n,o,a);return this.tm.start(l,s),l},t.prototype.createTask=function(t,e,i,r,n,o,a){var s=[],l=this.ms,u=this.tm.create({time:l,priority:t,init:function(){if(r){for(var t=r.length,o=Date.now();t--;)r[t];u.time=l-(Date.now()-o)}return[i,r,n,0,s,300,e,{}]},name:"cluster",onDone:function(){var t=e.getStyle(),r=t&&(t.strokeWidthZoomScale||t.LineStringZoomScale)||st;s.swzs=r(i.z),a(s,this)},exec:function(t){var e,i,r,n,a,s,l,u,h,f,c,p,d,v,g,y,m,x,_,w=t[0],b=t[1],T=t[2],L=t[6],S=b.length,M=t[4],A=w.z;if(b&&!(t[3]>=S)){for(;t[5]--&&(a=b[t[3]++]);)if(!T[s=a.id]&&(T[s]=!0,r=L.getStyleGroup(a,A))){r.length||(r=[r]);for(var z=0,P=r.length;z<P;z++)n=r[z],J(n)&&(e=X("zIndex",n,a,A),l=X("type",n,a,A),g=X("opacity",n,a,A),p=void 0,c=void 0,d=void 0,v=void 0,x=void 0,y=void 0,m=void 0,_=void 0,"Image"==l?i="I":(c=X("fill",n,a,A),d=X("stroke",n,a,A),v=X("strokeWidth",n,a,A),i="Line"==l?"L"+((y=X("strokeLinecap",n,a,A))||"*")+((m=X("strokeLinejoin",n,a,A))||"*")+((x=X("strokeDasharray",n,a,A))||"*"):"Text"==l?"T"+((p=X("font",n,a,A)||"normal 12px Arial")||"*"):"Circle"==l?"C"+X("radius",n,a,A)||"*":"R"+(_=X("width",n,a,A))+(X("height",n,a,A)||_),i+=(d||"*")+(v||"*")+(c||"*")),null!=g&&(i+=100*g^0),null==(f=(u=M[e]=M[e]||[])[i])?(f=u[i]=u.length,h=u[f]={shared:{font:p,fill:c,opacity:g,stroke:d,strokeWidth:v,strokeLinecap:y,strokeLinejoin:m,strokeDasharray:x},data:new o}):h=u[f],h.data.add(a,n))}return t[5]=300,t[3]<S}}});return u},t}(),ut=function(){function t(t){this.tiles={},this.size=t}return t.prototype.init=function(t,e,i,r,n){this.cwpx=t[0],this.cwpy=t[1],this.width=i,this.height=r,this.bounds=n;for(var o=1/0,a=-o,s=1/0,l=-s,u=0,h=n;u<h.length;u++){var f=h[u],c=f[0],p=f[1];c<o&&(o=c),c>a&&(a=c),p<s&&(s=p),p>l&&(l=p)}this.minX=o,this.maxX=a,this.minY=s,this.maxY=l},t.prototype.getTiles=function(t,i){void 0===i&&(i=this.size);for(var r=this.width,n=this.height,o=Math.pow(2,t)*i,a=this.bounds,s=[],l=this.cwpx*o,u=this.cwpy*o,h=(l-r/2+this.minX)/i,f=(u-n/2+this.minY)/i,c=(l+r/2+this.maxX-r)/i,p=(u+n/2+this.maxY-n)/i,d=e.tileUtils.pixelToGrid(h,f,t),v=e.tileUtils.pixelToGrid(c,p,t),g=v[0]-d[0]+1,y=v[1]-d[1]+1,m=(d[0]-h)*i+this.minX,x=(d[1]-f)*i+this.minY,_=0;_<y;_++)for(var w=0;w<g;w++){var b=m+w*i,T=x+_*i,L=b+i,S=T+i;if(I(a,[[b,T],[L,T],[L,S],[b,S]])){var M=e.tileUtils.tileXYToQuadKey(t,f+_,h+w);s.push({quadkey:M,x:b,y:T})}}return this.tiles[i]=s,s},t}(),ht=60/180*Math.PI;function ft(t,e,i){if(e[t+="EventListener"])for(var r in i)e[t](r,i[r])}exports.styleTools=at;var ct=function(){function e(i,r,n,o,a,s){this.updating=!1,this._gridClip={rz:0,rx:0,s:0,top:0},this.dirty=!1,this.globalBgc=!1;var l=this,h=u(i,"width"),f=u(i,"height"),d=function(t,e,i,r,n){var o,a=document.createElement("canvas"),s=a.style;return function(t,e,i){t.setAttribute("width",e),t.setAttribute("height",i)}(a,e,i),a.setAttribute("oncontextmenu","return false;"),function(t,e){["-webkit-user-select","-moz-user-select","-ms-user-select","user-select"].forEach(function(e){t.style[e]="none"})}(a),s.top=s.left="0px",s.position="absolute",s.opacity=String(n),t.querySelectorAll("canvas[type=layer]"),a.setAttribute("type","layer"),(o=t.querySelectorAll("canvas")[0])?t.insertBefore(a,o):t.appendChild(a),a}(i,h,f);l.previewer=new v(l,s),l.cluster=new lt(t.TaskManager.getInstance(),4),l.grid=new ut(r),l.tiles={256:[],512:[]},l.render=a,l.tileSize=r,l.buckets=o,l.layers=new c,l.w=h,l.h=f,l.canvas=d,d.className="tmc",l.dpr=e.getPixelRatio(n),l.setSize(h,f),l.setBGColor();var g=new p(l,a);l.listeners={clear:function(t){var e=t.detail,i=e.tiles,r=e.layer;g.clear(r,i)},featureAdd:function(t){var e=t.detail,i=e.feature,r=e.tiles,n=e.layer;r&&g.add(i,r,n)},featureRemove:function(t){var e=t.detail,i=e.feature,r=e.tiles,n=e.layer;r&&g.remove(i,r,n)},featureCoordinatesChange:function(t){var e=t.detail,i=e.feature,r=e.prevBBox,n=e.prevCoordinates,o=e.layer;g.updateGeometry(i,r,n,o)},styleGroupChange:function(t){var e=t.detail,i=e.feature,r=e.styleGroup,n=e.layer;g.repaint(i,r,n)},styleChange:function(t){var e=t.detail,i=e.layer,r=e.style,n=l.layers.indexOf(i);l.setLayerBgColor(r,l.layers[n]),l.buckets.tiles.forEach(function(t){return t.clear(n)})}}}return e.getPixelRatio=function(e){return(e="auto"==e?Math.min(2,t.global.devicePixelRatio||1):e||1)<1?1:e},e.prototype.addLayer=function(t,e,i){var r=this,n=r.layers,o=!1;if(n.add(t,i)){var a=n.get(t);if(o=!0,r.buckets.forEach(function(t){t.addLayer(i)}),ft("add",t,r.listeners),t.custom)return o;a.handleTile=function(e){r.isVisible(e,a)&&r.handleTile(e,t)},0==i&&r.setLayerBgColor(t.getStyle(),a)}return o},e.prototype.removeLayer=function(t){var e=this,i=this.layers,r=i.get(t),n=r.tiles,o=i.indexOf(t);if(-1!==o){e.buckets.forEach(function(e){e.cancelTasks(t),e.removeLayer(o)});for(var a=0,s=n;a<s.length;a++){var l=s[a].tile.quadkey;e.releaseTile(l,r),e.cancel(l,t)}i.remove(t),ft("remove",t,e.listeners)}return o},e.prototype.getBucket=function(t,e){var i=this;return e?i.buckets.create(t,i.layers):i.buckets.get(t)},e.prototype.handleTile=function(t,e,i,r){var n,o=this,a=!1;if(i?a=!0:i=o.getBucket(t.quadkey,!0),null==r&&(r=o.layers.indexOf(e)),t.error&&(o.layers[r].error=!0),!i.ready(r)&&!i.busy(e)&&(n=t.data)){var s=function(e,i){t.isLoaded()&&e.ready(e.index(i),!0),o.update(a)};i.ready(r,!1);var l=e.render;l?l(t,n,e,i,s):o.prepareTile(t,n,e,i,s)}},e.prototype.setLayerBgColor=function(t,e){var i=t.backgroundColor;i&&(e.bgColor=this.render.convertColor(i))},e.prototype.isVisible=function(t,e){for(var i=t.quadkey,r=0,n=e.tiles;r<n.length;r++)if(n[r].tile.quadkey==i)return!0;return!1},e.prototype.getContext=function(){return this.render.getContext()},e.prototype.copyCanvas2d=function(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.w),void 0===r&&(r=this.h);var n=this.canvas,o=this.dpr;t*=o,e*=o,i*=o,r*=o;var a=document.createElement("Canvas");return a.width=i,a.height=r,this.viewport(),a.getContext("2d").drawImage(n,t,e,i,r,0,0,i,r),a},e.prototype.getScreenTile=function(t,e){return this.grid.tiles[e].find(function(e){return e.quadkey==t})},e.prototype.updateTile=function(t,e,i,r){if(e&&!e.busy(i)){var n=this,o=e.index(i);e.ready(o,!1),n.isVisible(t,n.layers[o])&&n.handleTile(t,i,e,o)}},e.prototype.setSize=function(t,e){var i=this,r=i.dpr,n=i.canvas;i.w=t,i.h=e,n.width=t*r,n.height=e*r,n.style.width=t+"px",n.style.height=e+"px"},e.prototype.cancel=function(t,e){var i=this.buckets.get(t,!0);i&&i.cancelTasks(e)},e.prototype.preview=function(t,e,i){var r=this.previewer.create(t,e);return t.preview(i,r),r},e.prototype.initVpTiles=function(t,e,i){for(var r=this,n=this.layers,o=r.tiles[i],a=r.tiles[i]=[],s=[],l=0,u=t;l<u.length;l++){var f=u[l],c=f.x,p=f.y,d=f.quadkey,v=r.getBucket(d,!0),g=new h(c,p,i,v);v.i=++this.ti,s.push(g),a.push(g);for(var y=0,m=n;y<m.length;y++){var x=m[y],_=x.layer;_.tiled&&(_.tileSize||256)==i&&(x.tiles!=s&&(x.tiles=s),e>=_.min&&e<=_.max&&(r.initTile(v,x),_.getTile(d,x.handleTile)))}}o.forEach(function(t){for(var e=t.tile.quadkey,o=0,s=a;o<s.length;o++)if(s[o].tile.quadkey==e)return;for(var l=0,u=n;l<u.length;l++){var h=u[l];h.layer.tileSize==i&&r.releaseTile(e,h)}r.cancel(e)})},e.prototype.clipGridHeight=function(t){var e=this,i=e.rz,r=e.rx,n=e.s,o=e._gridClip,a=e.centerWorld;if(o.rx!=r||o.rz!=i){o.rz=i,o.rx=r,this.setView(a,n,i,-t);var s=this.unproject(this.w/2,0);this.setView(a,n,i,r),o.top=this.project(s[0],s[1])[1]}return o.top},e.prototype.updateGrid=function(t,e,i){var r=this.centerWorld,n=0^t;this.viewChange=!0,this.sx=e,this.sy=i;var o=this,a=this.rz,s=this.w,l=this.h,u=s,h=l,f=this.grid,c=0;-this.rx>ht&&(c=this.clipGridHeight(ht));var p=[o.unproject(0,c),o.unproject(u-1,c),o.unproject(u-1,h-1),o.unproject(0,h-1)];f.init(r,a,s,l,p);var d=this.layers.reset(n+Math.log(this.s)/Math.LN2);this.ti=0;for(var v=0,g=d;v<g.length;v++){var y=g[v],m=o.grid.getTiles(n-Number(512==y),y);this.initVpTiles(m,n,y)}-1==d.indexOf(512)&&o.grid.getTiles(n-1,512),this.dirty=!0,o.update()},e.prototype.releaseTile=function(t,e){var i=e.layer,r=i.getCachedTile(t);r&&r.loadStartTs&&(r.isLoaded()||i.cancelTile(r,e.handleTile))},e.prototype.initTile=function(t,e){var i=e.index;e.visible?t.ready(i)||t.preview(i)||this.preview(t,e.layer,i):t.ready(i,!0)},e.prototype.update=function(t){var e=this;e.dirty||(e.dirty=t),e.updating||(e.updating=!0,requestAnimationFrame(function(){e.viewport(),e.updating=!1}))},e.prototype.setBGColor=function(e){var i=this,r=i.render,n=e||t.global.getComputedStyle(i.canvas.parentElement,null).getPropertyValue("background-color");n&&"rgba(0, 0, 0, 0)"!=n&&"transparent"!=n||(n="#ffffff"),n=r.convertColor(n),i.globalBgc=n,r.setBackgroundColor(n)},e.prototype.showGrid=function(t){this.render.grid(!!t)},e.prototype.setView=function(t,e,i,r,n,o){this.centerWorld=t,this.setTransform(e,i,r)},e.prototype.setTransform=function(t,e,i){this.render.setScale(this.s=t,0,0),this.render.setRotation(this.rz=e,this.rx=i),this.render.applyTransform()},e.prototype.getLayers=function(){return this.layers},e.prototype.destroy=function(){this.render.destroy();var t=this.canvas;t.parentElement.removeChild(t),t.width=t.height=1},e.prototype.clearLayer=function(t){var e=this.getLayers().indexOf(t);this.buckets.forEach(function(t){t.preview(e,!1),t.ready(e,!1)})},e.prototype.viewChangeDone=function(){this.viewChange=!1},e.prototype.getRenderedFeatureAt=function(t,e,i){return null},e}(),pt=document.createElement("canvas"),dt=pt.getContext("2d");function vt(){var t=this,e=t._cbs,i=Math.max(t.width,t.height);if(t._cbs=null,i>64){var r=64/i;t=t._r[t.src]=function(t,e){var i=document.createElement("canvas"),r=i.getContext("2d");return i.width=t.width*e,i.height=t.height*e,r.drawImage(t,0,0,i.width,i.height),i}(t,r)}else dt.drawImage(t,0,0);for(var n in t.ready=!0,t._r=null,e)e[n][0](t,e[n][1])}pt.width=1,pt.height=1;var gt,yt=function(){function t(){this.imgData={}}return t.prototype.isRequested=function(t){return!!this.imgData[t]},t.prototype.isReady=function(t){return this.imgData[t]&&this.imgData[t].ready},t.prototype.get=function(t,e,i,r){var n=this.imgData;if(null==n[t]){var o=n[t]=new Image;o.ready=!1,o._cbs={},e&&(o._cbs[i]=[e,r]),o._r=n,o.crossOrigin="Anonymous",o.onload=vt,o.src=t}else e&&(n[t].ready?e(n[t],r):n[t]._cbs[i]=[e,r]);return n[t]},t}(),mt=function(){function t(t,e,i){this.gl=t,this.format=i||t.RGBA,e&&this.set(e)}return t.prototype.bind=function(){var t=this.gl,e=this.texture;e&&t.bindTexture(t.TEXTURE_2D,e)},t.prototype.set=function(t,e,i){var r=this,n=r.gl,o=r.texture,a=r.format,s=t.width,l=t.height,u=a,h="number"==typeof e;o||(this.texture=o=n.createTexture()),n.bindTexture(n.TEXTURE_2D,o),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),h||this.width==s&&!this.height&&!l?n.texSubImage2D(n.TEXTURE_2D,0,e||0,i||0,a,n.UNSIGNED_BYTE,t):(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement?n.texImage2D(n.TEXTURE_2D,0,u,a,n.UNSIGNED_BYTE,t):n.texImage2D(n.TEXTURE_2D,0,u,s,l,0,a,n.UNSIGNED_BYTE,t.pixels),this.width=s,this.height=l),s==l&&0==(l&l-1)?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.generateMipmap(n.TEXTURE_2D)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR))},t.prototype.destroy=function(){var t=this.gl,e=this.texture;e&&(t.deleteTexture(e),this.texture=null)},t}(),xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.destroy=function(e){e&&t.prototype.destroy.call(this)},e}(mt),_t=function(t,e,i,r,n){this.i=t,this.u1=e,this.v1=r,this.u2=i,this.v2=n},wt=function(){function e(e){var i=e.gl,r=e.maxImgSize||256,n=Math.pow(1024/r,2),o=Math.sqrt(n);this.c=new t.LRU(n),this.max=n,this.maxSize=r,this.gl=i,this.d=o}return e.prototype.get=function(t){return this.c.get(t)},e.prototype.init=function(){var t=this;t.texture,t.gl;var e=t.maxSize,i=t.d;if(!this.texture){var r=i*e;this.texture=new xt(this.gl,{width:r,height:r})}},e.prototype.set=function(t,e){var i,r=this.c,n=this.d,o=this.maxSize,a=r.get(t),s=!1;a?i=a.i:((i=r.length)>=r.max&&(i=(a=r.tail.data).i),s=!0);var l=i%n^0,u=i/n^0,h=l*o,f=u*o,c=h+e.width,p=f+e.height;return a?(a.u1=h,a.u2=c,a.v1=f,a.v2=p):a=new _t(i,h,c,f,p),(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)&&(this.init(),this.texture.set(e,l*o,u*o)),s&&r.set(t,a),a},e.prototype.destroy=function(){var t=this.texture;t&&t.destroy(!0)},e}(),bt=function(){function t(t,e){this.images=new yt,this.atlas=new wt({gl:t,maxImgSize:64})}return t.prototype.getTexture=function(){return this.atlas.texture},t.prototype.get=function(t,e,i,r){var n=this,o=n.atlas,a=n.images,s=n.onLoad,l=o.get(t);return!(!l&&!a.get(t,function(e){l=o.set(t,e),r&&r(l),s&&s(l)}).ready)&&l},t.prototype.destroy=function(){this.atlas.destroy()},t}(),Tt=window.console.error,Lt=function(t,e,i,r){r=r||Tt;var n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(r("compileShader "+t.getShaderInfoLog(n)),t.deleteShader(n),null)},St=function(t,e,i){return function(t,e,i){i=i||Tt;for(var r=t.createProgram(),n=0,o=e;n<o.length;n++){var a=o[n];t.attachShader(r,a)}return t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)?r:(i("linkProgram "+t.getProgramInfoLog(r)),t.deleteProgram(r),null)}(t,[Lt(t,e,t.VERTEX_SHADER),Lt(t,i,t.FRAGMENT_SHADER)])},Mt=function(t){for(var e in t)this[e]=t[e]};!function(t){t[t.OPAQUE=0]="OPAQUE",t[t.ALPHA=1]="ALPHA",t[t.POST_ALPHA=2]="POST_ALPHA"}(gt||(gt={}));var At,zt=function(){function t(t,e,i,r,n,o){this.attributes={},this.uniforms={},this.uniformSetters={},this.macros={M_PI:3.1415927410125732},this.dpr=n,this.mode=e,this.usage=t.STATIC_DRAW,this.gl=t,this.glStates=new Mt({scissor:!0,blend:!1,depth:!0}),this.compile(i,r,o)}return t.prototype.createUniformSetter=function(t,e){var i=this.gl;switch(t.type){case i.FLOAT:return function(t){return i.uniform1f(e,t)};case i.FLOAT_MAT4:return function(t){return i.uniformMatrix4fv(e,!1,t)};case i.FLOAT_VEC2:return function(t){return i.uniform2fv(e,t)};case i.FLOAT_VEC3:return function(t){return i.uniform3fv(e,t)};case i.FLOAT_VEC4:return function(t){return i.uniform4fv(e,t)};case i.BOOL:case i.SAMPLER_2D:return function(t){return i.uniform1i(e,t)}}return function(){}},t.prototype.buildSource=function(t,e,i){i=n(n(n({},this.macros),{DEVICE_PIXEL_RATIO:this.dpr.toFixed(1)}),i);var r="";for(var o in i)r+="#define ".concat(o," ").concat(i[o],"\n");return[r+"#define GLSLIFY 1\nvec2 round(vec2 point){vec2 fractPoint=fract(point);point+=step(0.5,fractPoint)-fractPoint;return point;}vec4 snapToScreenPixel(vec4 position,vec2 resolution){resolution*=DEVICE_PIXEL_RATIO;vec2 screenPixel=((position.xy/position.w+1.0)/2.0)*resolution;position.xy=(round(screenPixel)/resolution*2.0-1.0)*position.w;return position;}vec2 rotateZ(vec2 v,float a){float rotSin=sin(a);float rotCos=cos(a);mat2 m=mat2(rotCos,-rotSin,rotSin,rotCos);return v*m;}float toPixel(vec2 size,float zoom){float value=size.x;if(size.y>0.0){value*=zoom*size.y;}return value;}const float SCALE_UINT16_Z=9000.0/65535.0;"+t,r+e]},t.prototype.compile=function(t,e,i){var r=this.gl,n=this.buildSource(t,e,i||{}),o=n[0],a=n[1],s=St(r,o,a);this.prog=s;for(var l=r.getProgramParameter(s,r.ACTIVE_ATTRIBUTES),u=0;u<l;++u){var h=r.getActiveAttrib(s,u).name;this.attributes[h]=r.getAttribLocation(s,h)}for(var f=r.getProgramParameter(s,r.ACTIVE_UNIFORMS),c=0;c<f;c++){var p=r.getActiveUniform(s,c),d=p.name,v=r.getUniformLocation(s,d);this.uniforms[d]=v,this.uniformSetters[p.name]=this.createUniformSetter(p,v)}},t.prototype.setBufferCache=function(t){this.buffers=t},t.prototype.getUniformLocation=function(t){return this.uniforms[t]},t.prototype.setUniform=function(t,e){var i;(i=this.uniformSetters[t])&&i(e)},t.prototype.initUniforms=function(t){for(var e in t){var i=this.uniformSetters[e];i&&i(t[e])}},t.prototype.initAttributes=function(t){var e,i,r=this.gl;for(var n in t)e=t[n],i=this.attributes[n],r.bindBuffer(r.ARRAY_BUFFER,this.buffers.get(e)),r.vertexAttribPointer(i,e.size,e.type,e.normalized,e.stride,e.offset),r.enableVertexAttribArray(i)},t.prototype.initIndex=function(t){var e=this.buffers,i=this.gl,r=e.get(t),n=!0;r||(r=i.createBuffer(),e.set(t,r),n=!1),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),n||i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.data,i.STATIC_DRAW)},t.prototype.pass=function(t){return t==gt.OPAQUE},t.prototype.draw=function(t){var e=this.gl,i=t.texture,r=t.groups,n=this._pass==gt.ALPHA&&t.alpha==gt.POST_ALPHA;n&&e.colorMask(!1,!1,!1,!1),i&&(e.activeTexture(e.TEXTURE0),i.bind());for(var o=0,a=r;o<a.length;o++){var s=a[o],l=s.mode||this.mode;s.uniforms&&this.initUniforms(s.uniforms),s.index?(this.initIndex(s.index),e.drawElements(l,s.index.length,s.index.type,0)):e.drawArrays(l,s.arrays.first,s.arrays.count)}n&&e.colorMask(!0,!0,!0,!1)},t.prototype.setStates=function(t,e,i,r){var n=this.gl;t?n.enable(n.SCISSOR_TEST):n.disable(n.SCISSOR_TEST),r?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),e?n.enable(n.BLEND):n.disable(n.BLEND),i?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST)},t.prototype.init=function(t,e,i,r){var n=this.gl,o=e==gt.OPAQUE,a=this.glStates,s=a.blend,l=a.scissor,u=a.depth;this._pass=e,null!=t.scissor&&(l=t.scissor),null!=t.blend&&(s=t.blend),null!=t.depth&&(u=t.depth),this.setStates(l,s,u,i&&!o&&s&&l),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA);var h=t.cullFace();h?(n.cullFace(h),n.enable(n.CULL_FACE)):n.disable(n.CULL_FACE),n.depthMask(!t.isFlat()||o),n.disable(n.POLYGON_OFFSET_FILL),e==gt.POST_ALPHA&&(n.enable(n.STENCIL_TEST),n.stencilFunc(n.GREATER,1,255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE))},t}(),Pt=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,"precision lowp float;\n#define GLSLIFY 1\nattribute highp vec3 a_position;uniform float u_scale;uniform vec4 u_size;uniform mat4 u_matrix;uniform float u_strokeWidth;uniform vec2 u_topLeft;uniform float u_rotation;uniform vec4 u_offset;uniform vec2 u_offsetZ;uniform float u_zMeterToPixel;uniform bool u_alignMap;uniform vec2 u_resolution;varying vec2 vSize;varying vec2 vDir;const float EXTENT_SCALE=1.0/32.0;void main(void){if(mod(a_position.x,2.0)==1.0){vec2 dir=mod(floor(a_position.xy/2.0),2.0)*2.0-1.0;vec2 pos=floor(a_position.xy/4.0)*EXTENT_SCALE;vec2 size=vec2(toPixel(u_size.xy,u_scale),toPixel(u_size.zw,u_scale));size=(size+u_strokeWidth)*.5;float rotation=u_rotation;if(!u_alignMap){rotation*=-1.0;}vec2 pixel_offset=vec2(toPixel(u_offset.xy,u_scale),toPixel(u_offset.zw,u_scale));float z=a_position.z*SCALE_UINT16_Z+toPixel(u_offsetZ,u_scale)/u_zMeterToPixel/u_scale;if(u_alignMap){vec2 shift=(pixel_offset+rotateZ(dir*vec2(size.x,-size.y),rotation))/u_scale;gl_Position=u_matrix*vec4(u_topLeft+pos+shift,-z,1.0);}else{vec4 cpos=u_matrix*vec4(u_topLeft+pos,-z,1.0);vec2 shift=rotateZ(dir*size,rotation);vec2 offset=pixel_offset*vec2(1.0,-1.0);gl_Position=vec4(cpos.xy/cpos.w+(offset+shift)/u_resolution*2.0,cpos.z/cpos.w,1.0);}vSize=size;vDir=dir;}}","precision lowp float;\n#define GLSLIFY 1\nuniform vec4 u_fill;uniform vec4 u_stroke;uniform float u_strokeWidth;varying vec2 vSize;varying vec2 vDir;\n#define COLOR_UNDEF -1.0\nvoid main(void){float dx=distance(vDir.x,0.0)*vSize.x;float dy=distance(vDir.y,0.0)*vSize.y;if(dx>vSize.x-u_strokeWidth||dy>vSize.y-u_strokeWidth){gl_FragColor=u_stroke;}else{gl_FragColor=u_fill;if(u_fill[0]==COLOR_UNDEF){gl_FragColor.a=0.0;};}}",i)||this;return r.name="Rect",r.glStates=new Mt({scissor:!1,blend:!1,depth:!0}),r}return r(e,t),e}(zt),It=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,"precision lowp float;\n#define GLSLIFY 1\nattribute highp vec3 a_position;uniform vec2 u_radius;uniform mat4 u_matrix;uniform vec2 u_topLeft;uniform vec4 u_offset;uniform float u_scale;uniform vec2 u_resolution;uniform bool u_alignMap;uniform float u_strokeWidth;uniform vec2 u_offsetZ;uniform float u_zMeterToPixel;varying vec2 v_position;varying float v_radius;const float EXTENT_SCALE=1.0/32.0;void main(void){if(mod(a_position.x,2.0)==1.0){vec2 dir=mod(floor(a_position.xy/2.0),2.0)*2.0-1.0;vec2 pos=floor(a_position.xy/4.0)*EXTENT_SCALE;float radius=toPixel(u_radius,u_scale);radius=radius+u_strokeWidth/2.0;v_position=dir*radius;v_radius=radius;vec2 pixel_offset=vec2(toPixel(u_offset.xy,u_scale),toPixel(u_offset.zw,u_scale));float z=a_position.z*SCALE_UINT16_Z+toPixel(u_offsetZ,u_scale)/u_zMeterToPixel/u_scale;if(u_alignMap){vec2 shift=(pixel_offset+v_position*vec2(1.0,-1.0))/u_scale;gl_Position=u_matrix*vec4(u_topLeft+pos+shift,-z,1.0);}else{vec4 cpos=u_matrix*vec4(u_topLeft+pos,-z,1.0);vec2 offset=pixel_offset*vec2(1.0,-1.0);gl_Position=vec4(cpos.xy/cpos.w+(offset+v_position)/u_resolution*2.0,cpos.z/cpos.w,1.0);}}}","precision lowp float;\n#define GLSLIFY 1\nuniform vec4 u_fill;uniform vec4 u_stroke;uniform float u_strokeWidth;varying float v_radius;varying vec2 v_position;\n#define COLOR_UNDEF -1.0\nvoid main(void){float r=length(v_position);if(r>v_radius)discard;if(r<v_radius-u_strokeWidth){if(u_fill[0]==COLOR_UNDEF)discard;gl_FragColor=u_fill;}else{gl_FragColor=u_stroke;}}",i)||this;return r.name="Circle",r.glStates=new Mt({scissor:!1,blend:!1,depth:!0}),r}return r(e,t),e}(zt),Et="precision lowp float;\n#define GLSLIFY 1\nattribute vec3 a_position;attribute highp vec4 a_normal;attribute float a_lengthSoFar;uniform mat4 u_matrix;uniform highp vec2 u_strokeWidth;uniform highp float u_scale;uniform vec2 u_topLeft;uniform float u_texWidth;varying vec2 v_normal;varying float v_lengthSoFar;varying vec2 v_width;uniform vec2 u_offset;uniform float u_tileScale;uniform bool u_no_antialias;const float N_SCALE=1.0/8191.0;void main(void){float strokeWidth=toPixel(u_strokeWidth,u_scale);float alias=u_no_antialias? .0: strokeWidth<1. ? .65 : 1.;float width=(strokeWidth+alias)/u_scale;v_width=vec2(strokeWidth,alias*.5);vec2 dir2=mod(a_normal.zw,2.0)*2.0-1.0;vec2 aliasNormal=floor(a_normal.zw*.5)*N_SCALE;v_normal=dir2*aliasNormal;vec2 dir=mod(a_normal.xy,2.0)*2.0-1.0;vec2 normal=floor(a_normal.xy*.5)*N_SCALE;v_lengthSoFar=a_lengthSoFar/u_texWidth;float lineOffset=toPixel(u_offset,u_scale);vec2 position=a_position.xy+normal*-lineOffset/u_scale;gl_PointSize=8.0;gl_Position=u_matrix*vec4(u_topLeft+position*u_tileScale+dir*normal*width,-a_position.z,1.0);}",Ct=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,Et,"precision lowp float;\n#define GLSLIFY 1\nuniform sampler2D u_pattern;uniform vec4 u_fill;varying vec2 v_normal;varying float v_lengthSoFar;varying vec2 texCoord;varying vec2 v_width;void main(void){float width=length(v_normal)*(v_width.s+v_width.t);float alpha=1.0-clamp(.5*(width-v_width.s+v_width.t)/v_width.t,.0,1.);gl_FragColor=u_fill;if(v_width.t==0.0&&alpha<1.0)discard;gl_FragColor.a*=alpha;}",i)||this;return r.name="Line",r.glStates=new Mt({blend:!0,scissor:!0,depth:!0}),r}return r(e,t),e.prototype.pass=function(t){return t==gt.ALPHA||t==gt.POST_ALPHA},e}(zt),kt=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,Et,"precision lowp float;\n#define GLSLIFY 1\nuniform vec4 u_fill;varying vec2 v_normal;varying vec2 v_width;varying float v_lengthSoFar;uniform sampler2D u_pattern;void main(void){float width=length(v_normal)*(v_width.s+v_width.t);float alpha=1.0-clamp(.5*(width-v_width.s+v_width.t)/v_width.t,.0,1.);gl_FragColor=u_fill;gl_FragColor.a*=alpha*texture2D(u_pattern,vec2(fract(v_lengthSoFar))).r;}",i)||this;return r.name="Line",r.glStates=new Mt({blend:!0,scissor:!0,depth:!0}),r}return r(e,t),e.prototype.pass=function(t){return t==gt.ALPHA},e.prototype.init=function(e,i,r){var n=this.gl;t.prototype.init.call(this,e,i,r),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)},e}(zt),Dt=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,"precision lowp float;\n#define GLSLIFY 1\nattribute vec3 a_position;uniform vec2 u_offsetZ;uniform float u_scale;uniform float u_zMeterToPixel;uniform float u_tileScale;uniform mat4 u_matrix;uniform vec2 u_topLeft;void main(void){float z=a_position.z+u_offsetZ.x/u_zMeterToPixel/u_scale;gl_Position=u_matrix*vec4(u_topLeft+a_position.xy*u_tileScale,-z,1.0);}","precision lowp float;\n#define GLSLIFY 1\nuniform vec4 u_fill;void main(void){gl_FragColor=u_fill;}",i)||this;return r.name="Polygon",r}return r(e,t),e}(zt),Ot=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,"precision lowp float;\n#define GLSLIFY 1\nattribute vec2 a_position;attribute vec2 a_textureCoord;uniform highp mat4 u_matrix;uniform highp vec2 u_topLeft;uniform highp vec2 u_resolution;varying vec2 v_textureCoord;void main(void){v_textureCoord=a_textureCoord;vec4 position=u_matrix*vec4(u_topLeft+a_position,0.0,1.0);gl_Position=snapToScreenPixel(position,u_resolution);}","precision lowp float;\n#define GLSLIFY 1\nvarying vec2 v_textureCoord;uniform sampler2D u_sampler;void main(void){gl_FragColor=texture2D(u_sampler,v_textureCoord);}",i)||this;return r.name="Image",r.glStates=new Mt({scissor:!0,blend:!1,depth:!0}),r}return r(e,t),e}(zt),Rt=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,"precision highp float;\n#define GLSLIFY 1\nattribute vec3 a_point;attribute vec3 a_position;attribute vec2 a_texcoord;uniform vec2 u_resolution;uniform mat4 u_matrix;uniform vec2 u_topLeft;uniform vec4 u_offset;uniform vec2 u_offsetZ;uniform float u_zMeterToPixel;uniform float u_scale;uniform float u_rotate;uniform bool u_alignMap;uniform bool u_fixedView;uniform float u_atlasScale;varying vec2 v_texcoord;varying vec4 vColor;const float EXTENT_SCALE=1.0/64.0;const float OFFSET_SCALE=1.0/32.0;const float PI_05=M_PI*0.5;const float PI_15=M_PI*1.5;const float PI_20=M_PI*2.0;mat3 rotation3dY(float angle){float s=sin(angle);float c=cos(angle);return mat3(c,0.0,-s,0.0,1.0,0.0,s,0.0,c);}vec3 rotateY(vec3 v,float angle){return rotation3dY(angle)*v;}vec3 rotateY(vec2 v,float angle){return rotation3dY(angle)*vec3(v,0.0);}void main(void){if(mod(a_position.x,2.0)==1.0){vec2 position=floor(a_position.xy/2.0)*EXTENT_SCALE;vec2 rotLowHi=mod(a_texcoord,32.0);float rotation=rotLowHi.y*32.0+rotLowHi.x;v_texcoord=floor(a_texcoord/32.0)*u_atlasScale;vec2 labelOffset=vec2(toPixel(u_offset.xy,u_scale),toPixel(u_offset.zw,u_scale));labelOffset*=DEVICE_PIXEL_RATIO;rotation=rotation/1024.0*PI_20;float z=a_position.z*SCALE_UINT16_Z+toPixel(u_offsetZ,u_scale)/u_zMeterToPixel/u_scale;if(u_alignMap){float absRotation=mod(u_rotate+rotation,PI_20);if(absRotation>PI_05&&absRotation<PI_15){rotation+=M_PI;labelOffset*=-1.0;}vec2 _p=a_point.xy*OFFSET_SCALE+labelOffset;vec3 p=rotateY(vec3(_p,1.0),a_point.z/32767.0*PI_20);p.xy=rotateZ(_p,rotation);p=p/u_scale/DEVICE_PIXEL_RATIO;gl_Position=u_matrix*vec4(u_topLeft+position+p.xy,p.z-z,1.0);}else{vec4 cpos=u_matrix*vec4((u_topLeft+position),-z,1.0);vec2 offset=rotateZ(a_point.xy*OFFSET_SCALE+labelOffset,rotation);gl_Position=vec4(cpos.xy/cpos.w+vec2(1,-1)*offset/DEVICE_PIXEL_RATIO/u_resolution*2.0,cpos.z/cpos.w,1.0);}if(u_fixedView){gl_Position=snapToScreenPixel(gl_Position,u_resolution);}}}","precision mediump float;\n#define GLSLIFY 1\nvarying vec2 v_texcoord;uniform sampler2D u_texture;uniform bool u_strokeOnly;uniform vec4 u_fillColor;uniform vec4 u_strokeColor;void main(){vec4 glyph=texture2D(u_texture,v_texcoord);vec4 color;float glyphAlpha;if(u_strokeOnly){color=u_strokeColor;glyphAlpha=glyph.a;}else{color=u_fillColor;glyphAlpha=glyph.r;}gl_FragColor=glyphAlpha*vec4(color.rgb*color.a,color.a);}",i)||this;return r.name="Text",r.glStates=new Mt({blend:!0,scissor:!1,depth:!0}),r}return r(e,t),e.prototype.pass=function(t){return t==gt.ALPHA},e.prototype.init=function(e,i,r,n){var o=this.gl;t.prototype.init.call(this,e,i,r),o.depthMask(!1),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.polygonOffset(0,2048*-n),o.enable(o.POLYGON_OFFSET_FILL)},e.prototype.draw=function(e){var i=this.gl,r=this.uniforms;i.uniform1f(r.u_strokeOnly,1),t.prototype.draw.call(this,e),i.uniform1f(r.u_strokeOnly,0),t.prototype.draw.call(this,e)},e}(zt),Ft=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,"precision lowp float;\n#define GLSLIFY 1\nattribute vec2 a_size;attribute highp vec3 a_position;attribute vec2 a_texcoord;uniform mat4 u_matrix;uniform vec2 u_topLeft;uniform float u_scale;uniform float u_atlasScale;uniform vec4 u_offset;uniform vec2 u_offsetZ;uniform bool u_alignMap;uniform vec2 u_resolution;uniform bool u_fixedView;uniform float u_zMeterToPixel;varying float vOpacity;varying vec2 v_texcoord;const float EXTENT_SCALE=1.0/32.0;void main(void){if(mod(a_position.x,2.0)==1.0){vec2 rotLowHi=mod(a_texcoord,32.0);float rotation=rotLowHi.x+floor(rotLowHi.y*32.0);rotation=rotation/1024.0*2.0*M_PI;vec2 dir=mod(floor(a_position.xy/2.0),2.0)*2.0-1.0;vec2 pos=floor(a_position.xy/4.0)*EXTENT_SCALE;float z=a_position.z*SCALE_UINT16_Z+toPixel(u_offsetZ,u_scale)/u_zMeterToPixel/u_scale;vec2 offsetXY=vec2(toPixel(u_offset.xy,u_scale),toPixel(u_offset.zw,u_scale));if(u_alignMap){vec2 shift=rotateZ(offsetXY+dir*vec2(a_size.x,-a_size.y)*0.5,rotation)/u_scale;gl_Position=u_matrix*vec4(u_topLeft+pos+shift,-z,1.0);}else{vec4 cpos=u_matrix*vec4(u_topLeft+pos,-z,1.0);vec2 shift=rotateZ(dir*a_size,-rotation)*0.5;vec2 offset=offsetXY*vec2(1.0,-1.0);gl_Position=vec4(cpos.xy/cpos.w+(offset+shift)/u_resolution*2.0,cpos.z/cpos.w,1.0);}if(u_fixedView){gl_Position=snapToScreenPixel(gl_Position,u_resolution);}v_texcoord=floor(a_texcoord/32.0)*u_atlasScale;}}","precision mediump float;\n#define GLSLIFY 1\nvarying vec2 v_texcoord;uniform float u_opacity;uniform sampler2D u_texture;void main(){gl_FragColor=texture2D(u_texture,v_texcoord);gl_FragColor.a*=u_opacity;}",i)||this;return r.name="icon",r.glStates=new Mt({blend:!0,scissor:!1,depth:!0}),r}return r(e,t),e.prototype.pass=function(t){return t==gt.ALPHA},e.prototype.init=function(e,i,r){var n=this.gl;t.prototype.init.call(this,e,i,r),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA)},e}(zt),Ut=function(t){function e(e,i){var r=t.call(this,e,e.TRIANGLES,"precision lowp float;\n#define GLSLIFY 1\nattribute vec3 a_position;attribute vec3 a_normal;uniform mat4 u_matrix;uniform vec2 u_topLeft;varying vec3 v_normal;void main(void){gl_Position=u_matrix*vec4(u_topLeft+a_position.xy,-a_position.z,1.0);v_normal=a_normal;}","precision lowp float;\n#define GLSLIFY 1\nuniform vec4 u_fill;uniform vec4 u_stroke;uniform bool u_strokePass;varying vec3 v_normal;\n#define lightDir normalize(vec3(0.5, 0.0, -1.0))\n#define top vec2(0.0)\nvoid main(void){if(u_strokePass){gl_FragColor=u_stroke;}else{if(v_normal.xy==top){gl_FragColor=u_fill;}else{float diffuse=0.3+dot(v_normal,lightDir)*0.7;gl_FragColor.rgb=u_fill.rgb*diffuse;}gl_FragColor.a=u_fill.a;}}",i)||this;return r.name="Extrude",r.glStates=new Mt({scissor:!1,blend:!1,depth:!0}),r}return r(e,t),e.prototype.init=function(e,i,r){var n=this.gl;t.prototype.init.call(this,e,i,r),n.polygonOffset(1,1),n.enable(n.POLYGON_OFFSET_FILL)},e.prototype.draw=function(e){var i=this.gl;t.prototype.draw.call(this,e),i.disable(i.POLYGON_OFFSET_FILL)},e}(zt),Nt=function(t){function e(e,i,r){var n=t.call(this,e,e.TRIANGLES,"precision mediump float;\n#define GLSLIFY 1\nvarying vec3 v_normal;attribute vec3 a_normal;attribute highp vec3 a_position;attribute highp vec3 a_point;uniform float u_scale;uniform vec4 u_size;uniform mat4 u_matrix;uniform mat4 u_inverseMatrix;uniform float u_strokeWidth;uniform vec2 u_topLeft;uniform float u_rotation;uniform vec4 u_offset;uniform bool u_alignMap;uniform vec2 u_resolution;uniform vec2 u_offsetZ;uniform float u_zMeterToPixel;\n#ifdef SPHERE\nvarying vec3 v_rayOrigin;varying vec3 v_rayDirecton;varying vec3 v_worldPos;uniform vec2 u_radius;\n#else\nvarying vec3 vPosition;varying float v_strokeWidth;\n#endif\nvarying vec3 vSize;const float EXTENT_SCALE=1.0/32.0;void main(void){\n#ifdef SPHERE\nvec3 dir=a_point*2.0-1.0;vec3 size=vec3(toPixel(u_radius,u_scale))/u_scale;\n#else\nvec3 dir=mod(a_point,2.0)*2.0-1.0;vec3 size=floor(a_point*.5)/u_scale;\n#endif\nvec3 vertexOffset=vec3(size.xy,-size.z/u_zMeterToPixel)*dir;vec3 boxCenter=vec3(u_topLeft+a_position.xy*EXTENT_SCALE,-a_position.z*SCALE_UINT16_Z);boxCenter+=vec3(toPixel(u_offset.xy,u_scale),toPixel(u_offset.zw,u_scale),-toPixel(u_offsetZ,u_scale)/u_zMeterToPixel)/u_scale;vec3 vertexPos=vec3(boxCenter.xy+rotateZ(vertexOffset.xy,u_rotation),boxCenter.z+vertexOffset.z);vertexPos.z=min(vertexPos.z,0.0);gl_Position=u_matrix*vec4(vertexPos,1.0);\n#ifdef SPHERE\nvec4 origin=u_inverseMatrix*vec4(gl_Position.xy,-1.0,gl_Position.w);v_rayOrigin=origin.xyz/origin.w;v_rayDirecton=vertexPos-v_rayOrigin;v_worldPos=boxCenter;v_rayOrigin.z*=u_zMeterToPixel;v_rayDirecton.z*=u_zMeterToPixel;v_worldPos.z*=u_zMeterToPixel;\n#else\nvPosition=vec3(vertexOffset.xy,vertexOffset.z*u_zMeterToPixel);v_strokeWidth=u_strokeWidth/u_scale;\n#endif\nvSize=size;v_normal=a_normal;}","precision mediump float;\n#define GLSLIFY 1\nuniform vec4 u_fill;uniform vec4 u_stroke;varying vec3 vSize;\n#ifdef SPHERE\nvarying vec3 v_worldPos;varying vec3 v_rayOrigin;varying vec3 v_rayDirecton;\n#else\nvarying float v_strokeWidth;varying vec3 vPosition;const float smoothness=.25;\n#endif\nuniform float u_zMeterToPixel;varying vec3 v_normal;\n#define lightDir vec3(.5, .0, -1.0)\n#ifdef SPHERE\nfloat sphereIntersect(vec3 rayOrigin,vec3 rayDirection,vec3 spherePosition,float sphereRadius){vec3 oc=rayOrigin-spherePosition.xyz;float b=dot(oc,rayDirection);float c=dot(oc,oc)-sphereRadius*sphereRadius;float d=b*b-c;return(d<0.0)?-1.0 :-b-sqrt(d);}\n#endif\nvoid main(void){vec4 color=u_fill;vec3 normal;\n#ifdef SPHERE\nfloat radius=vSize.x;float distance=sphereIntersect(v_rayOrigin,normalize(v_rayDirecton),v_worldPos,radius);if(distance==-1.0)discard;vec3 surfacePos=normalize(v_rayDirecton)*distance+v_rayOrigin;normal=normalize(surfacePos-v_worldPos);\n#else\nvec3 size=vSize;vec3 pos=vPosition;float a=smoothstep(v_strokeWidth,v_strokeWidth+smoothness,length(abs(pos.xy)-size.xy));a*=smoothstep(v_strokeWidth,v_strokeWidth+smoothness,length(abs(pos.yz)-size.yz));a*=smoothstep(v_strokeWidth,v_strokeWidth+smoothness,length(abs(pos.xz)-size.xz));color=mix(u_stroke,u_fill,a);normal=normalize(v_normal);\n#endif\nfloat light=clamp(0.0,1.0,dot(normal,lightDir));color.rgb*=light;gl_FragColor=color;}",i,r)||this;return n.name="Box",n.glStates=new Mt({scissor:!1,blend:!1,depth:!0}),n}return r(e,t),e}(zt),Bt=function(t){function e(e,i){var r=t.call(this,e,i,{SPHERE:!0})||this;return r.name="Sphere",r}return r(e,t),e}(Nt),Gt=function(){function t(t,e,i){this.attributes={},this.uniforms={},this.alpha=0,this.flat=!0,this.groups=[],this._cullFace=0,t&&(this.addGroup(t,i),this.type=e)}return t.fromTemplateBuffer=function(e,i){var r,n=i.flexAttributes;if(i.hasIndex()){var o=i.index();if(!o.length)return null;r=new t(o,e,i.i32)}else r=new t({first:i.first,count:i.count()},e);for(var a in n){var s=n[a];s.data.length&&r.addAttribute(a,i.trimAttribute(s))}return r.idOffsets=i.idOffsets,r.rayIntersects=i.rayIntersects,r.cullFace(i.cullFace),r},t.prototype.createIndex=function(t,e){return{index:e?{data:new Uint32Array(t),type:5125,length:t.length}:{data:new Uint16Array(t),type:5123,length:t.length}}},t.prototype.createArrays=function(t){return{arrays:t}},t.prototype.addGroup=function(t,e,i){if(t){var r=void 0;return r=Array.isArray(t)?this.createIndex(t,e):this.createArrays(t),i&&(r.mode=i),this.groups[this.groups.length]=r}},t.prototype.addUniform=function(t,e){this.uniforms[t]=e},t.prototype.getUniform=function(t){return this.uniforms[t]},t.prototype.addAttribute=function(t,e){var i=e.data;e.type=i instanceof Int8Array?5120:i instanceof Uint8Array?5121:i instanceof Int16Array?5122:i instanceof Uint16Array?5123:i instanceof Int32Array?5124:i instanceof Uint32Array?5125:i instanceof Float32Array?5126:void 0,null==e.stride&&(e.stride=0),null==e.dirty&&(e.dirty=!0),this.attributes[t]=e,this.size=i.length},t.prototype.getAttributes=function(){return this.attributes},t.prototype.destroy=function(){},t.prototype.isPointBuffer=function(){var t=this.type;return"Line"!=t&&"Extrude"!=t},t.prototype.isFlat=function(){return this.flat},t.prototype.rayIntersects=function(t,e,i,r,n){return null},t.prototype.cullFace=function(t){return void 0!==t&&(this._cullFace=t),this._cullFace},t.MODE_GL_LINES=1,t}();!function(t){t[t.INSIDE=0]="INSIDE",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=4]="BOTTOM",t[t.TOP=8]="TOP"}(At||(At={}));var Wt,Zt=function(t,e,i,r,n,o){var a=At.INSIDE;return t<i?a|=At.LEFT:t>r&&(a|=At.RIGHT),e<n?a|=At.BOTTOM:e>o&&(a|=At.TOP),a},Xt=function(t){var e=t[0],i=t[1],r=e*e+i*i;return r>0&&(r=1/Math.sqrt(r),t[0]=e*r,t[1]=i*r),t},Yt=function(t,e,i,r,n,o,a,s,l){if(void 0===l&&(l=1),"round"==t)!1===r?a.push(e,i,e,i,e,i):a.push(e,i,r,e,i,r,e,i,r),n*=Math.SQRT2*l,o*=Math.SQRT2*l,s.push(n<<1|0,o<<1|1,n<<1|0,o<<1|1,n<<1|1,o<<1|0,n<<1|1,o<<1|0,o<<1|1,n<<1|1,o<<1|1,n<<1|1);else if("square"==t){!1===r?a.push(e,i,e,i,e,i,e,i,e,i,e,i):a.push(e,i,r,e,i,r,e,i,r,e,i,r,e,i,r,e,i,r);var u=o-n,h=n+o;s.push(n<<1|0,o<<1|1,0,0,h<<1|1,u<<1|0,0,0,n<<1|1,o<<1|0,0,0,u<<1|1,h<<1|1,n<<1|1,o<<1|1,h<<1|1,u<<1|0,n<<1|1,o<<1|1,n<<1|0,o<<1|1,0,0)}},Ht=function(t,e,i,r,n,o,a,s,l,u,h,f,c,p,d,v,g){void 0===v&&(v=0),void 0===g&&(g=0),f*=.5;var y=!!a;!0===a&&2==o&&(a=0);var m=s+16,x=-16,_=r[n/o-1],w=v*_,b=g*_;if((v||g)&&(p=!1),w&&b&&g<v){var T=w;w=b,b=T}d&&(u="butt","none"!=h&&(h="miter")),a&&(u="butt",h="none"),c&&(u="butt",d||(h="none"));for(var L,S,M=Zt(i[0],i[1],x,m,x,m),A=null,z=null,P=0,I=o;I<n;P=I,I+=o){var E=i[P],C=i[P+1];!0===a&&i[P+2];var k=i[I],D=i[I+1];for(!0===a&&i[I+2],L=S=Zt(k,D,x,m,x,m);;){if(!(M|L)){null==A&&(A=P),L!==S&&(z=I);break}if(M&L)break;var O=M||L,R=void 0,F=void 0;O&At.TOP?(R=E+(m-C)/(D-C)*(k-E),F=m):O&At.BOTTOM?(R=E+(x-C)/(D-C)*(k-E),F=x):O&At.RIGHT?(F=C+(m-E)/(k-E)*(D-C),R=m):O&At.LEFT&&(F=C+(x-E)/(k-E)*(D-C),R=x),O=Zt(R,F,x,m,x,m),M?(M=O,E=R,C=F):(L=O,k=R,D=F)}null==A||null==z&&I!=n-o||(z||(z=n-o),p&&(A-=o),jt(t,o,e,i,y,a,r,n,A,z+o,s,u,u,h,f,c,w,b,d,p),A=null,z=null),M=S}return t.length},jt=function(t,e,i,r,n,o,a,s,l,u,h,f,c,p,d,v,g,y,m,x,_,w){var b,T=l;l<0&&(T=s-e+l);var L=r[T],S=r[T+1],M=!0===o?r[T+2]:o;_&&(L=_[0],S=_[1],M=_[2]);var A,z,P,I,E,C,k,D,O,R,F,U,N,B,G,W,Z,X,Y,H,j,V,q,K=a[T/e],Q=u,J=null,$=null,tt=null,et=null,it=null,rt=null;if(y&&y<K)return K;for(var nt=x,ot=l+e;ot<Q;ot+=e){var at=!x&&ot==Q-e,st=null,lt=!1,ut=void 0,ht=void 0;at&&w?(I=w[0],E=w[1],C=w[2]):(I=r[ot],E=r[ot+1],C=!0===o?r[ot+2]:o),P=p,O=(q=Xt([k=L-I,D=S-E]))[1],R=q[0],tt=null==tt;var ft=K,ct=(K=a[ot/e])-ft;if(length=ct,y&&y<K&&y>ft){var pt=(y-ft)/ct;I=L-k*pt,E=S-D*pt,C=M,length*=pt,at=!0,Q=0}if(g){if(!(g<K)){L=I,S=E,M=C;continue}if(g>ft){var dt=(g-ft)/ct;L-=k*dt,S-=D*dt,length*=1-dt,tt=!0}}if(tt&&at&&(p="none"),!at){var vt=ot%(s-e)+e,gt=r[vt];ut=k*($=E-r[vt+1])-D*(J=I-gt)<0;var yt=[F=(st=Xt([J,$]))[1]+O,U=-st[0]-R];(ht=1/(yt[0]*O-yt[1]*R))==1/0?(lt=!0,F=2,U=2):(lt=ht>3,"miter"==p&&lt&&(P="bevel"),ht>2?(F=(b=Xt(yt))[0],U=b[1],F*=2,U*=2):(F=yt[0]*ht,U=yt[1]*ht)),F*=-8191,U*=-8191}if(Y=X=[1^(G=[-(O*=8191)<<1|1,(R*=8191)<<1|1])[0],1^G[1]],H=X,W=G,Z=G,"none"!=p){if(!at&&"miter"==P&&Q>2*e&&(H=[F<<1|0,U<<1|0],Z=[F<<1|1,U<<1|1]),tt||j||(V?(W=[N<<1|1,B<<1|1],"miter"==p&&(Y=[N<<1|0,B<<1|0])):(Y=[N<<1|0,B<<1|0],"miter"==p&&(W=[N<<1|1,B<<1|1]))),!lt&&!at&&"miter"!=p){var mt=d*F/-8191,xt=d*U/-8191;ut&&(mt*=-1,xt*=-1);var _t=q[0]*mt+q[1]*xt;length<_t?lt=!0:ut?Z=[F<<1|1,U<<1|1]:H=[F<<1|0,U<<1|0]}if((!tt||at)&&K&&("round"==p&&(V?i.push(z[0],z[1],z[0],z[1],Y[0],Y[1],Y[0],Y[1],N<<1|0,B<<1|0,N<<1|0,B<<1|0):i.push(N<<1|1,B<<1|1,N<<1|1,B<<1|1,W[0],W[1],W[0],W[1],A[0],A[1],A[0],A[1]),n?t.push(et,it,rt,et,it,rt,et,it,rt):t.push(et,it,et,it,et,it)),!tt))if(j){if(!m){var wt,bt=0,Tt=0;"round"!=p&&(bt=8191*(wt=Xt([F,U]))[0],Tt=8191*wt[1]),bt=bt<<1|1,Tt=Tt<<1|1,V?i.push(0,0,0,0,X[0],X[1],bt,Tt,z[0],z[1],bt,Tt):i.push(0,0,0,0,A[0],A[1],bt,Tt,G[0],G[1],bt,Tt),n?t.push(et,it,rt,et,it,rt,et,it,rt):t.push(et,it,et,it,et,it)}}else"miter"!=p&&((wt=Xt([N,B]))[0]*=8191,wt[1]*=8191,V?"bevel"==p?i.push(N<<1|1,B<<1|1,wt[0]<<1|1,wt[1]<<1|1,Y[0],Y[1],wt[0]<<1|0,wt[1]<<1|0,z[0],z[1],wt[0]<<1|0,wt[1]<<1|0):i.push(N<<1|1,B<<1|1,wt[0]<<1|1,wt[1]<<1|1,Y[0],Y[1],Y[0],Y[1],z[0],z[1],z[0],z[1]):"bevel"==p?i.push(W[0],W[1],wt[0]<<1|1,wt[1]<<1|1,N<<1|0,B<<1|0,wt[0]<<1|0,wt[1]<<1|0,A[0],A[1],wt[0]<<1|1,wt[1]<<1|1):i.push(W[0],W[1],W[0],W[1],N<<1|0,B<<1|0,wt[0]<<1|0,wt[1]<<1|0,A[0],A[1],A[0],A[1]),n?t.push(et,it,rt,et,it,rt,et,it,rt):t.push(et,it,et,it,et,it))}if(!nt&&(i.push(W[0],W[1],G[0],G[1],H[0],H[1],X[0],X[1],Y[0],Y[1],X[0],X[1],W[0],W[1],G[0],G[1],Z[0],Z[1],G[0],G[1],H[0],H[1],X[0],X[1]),n?t.push(L,S,M,I,E,C,L,S,M,L,S,M,I,E,C,I,E,C):t.push(L,S,I,E,L,S,L,S,I,E,I,E),tt&&Yt(f,L,S,n&&M,O,R,t,i),at&&Yt(c,I,E,n&&C,-O,-R,t,i),v)){var Lt=K-length;v.push(Lt,K,Lt,Lt,K,K)}nt=!1,A=G,z=X,N=F,B=U,et=I,it=E,rt=C,L=I,S=E,M=C,V=ut,j=lt}},Vt=function(t,e,i){for(var r;++e<t.length;){var n=t.charAt(e),o=null===(r=i.glyphInfos[n])||void 0===r?void 0:r.glyph;if(o){var a=o.direction;if(a)return a}}},qt=function(t,e,i,r,n,o,a){var s=a.offset,l=a.x,u=e.spaceWidth,h=e.glyphInfos[t],f=0,c=n.data,p=null!=r,d=n.length,v=o.data,g=o.length,y=i>>5,m=31&i;if(h){var x=h.glyph,_=h.u1<<5|m,w=h.u2<<5|m,b=h.v1<<5|y,T=h.v2<<5|y,L=x.advanceX,S=x.data,M=S.width,A=S.height,z=32*l;A*=32,f=z+32*M,c[d++]=z,c[d++]=0,p&&(c[d++]=r),c[d++]=f,c[d++]=A,p&&(c[d++]=r),c[d++]=z,c[d++]=A,p&&(c[d++]=r),c[d++]=f,c[d++]=0,p&&(c[d++]=r),c[d++]=f,c[d++]=A,p&&(c[d++]=r),c[d++]=z,c[d++]=0,p&&(c[d++]=r),v[g++]=_,v[g++]=b,v[g++]=w,v[g++]=T,v[g++]=_,v[g++]=T,v[g++]=w,v[g++]=b,v[g++]=w,v[g++]=T,v[g++]=_,v[g++]=b,l+=L,s+=12}else" "==t&&(l+=u);n.length=d,o.length=g,a.x=l,a.offset=s,a.x2=f},Kt=function(t,e,i,r,n,o,a,s,l,u){for(var h=e,f=i,c=void 0,p=void 0;h<f;h++){if(c=r?e+(f-1-h):h,p=t.charAt(c),r&&O(t.charCodeAt(c))){for(var d=c,v=0;--d>=0;)if(!O(t.charCodeAt(d))){for(;++d<=c;)qt(t.charAt(d),n,o,a,s,l,u),v++;break}if(v){h+=v-1;continue}}qt(p,n,o,a,s,l,u)}},Qt=function(t,e,i,r,n,o){var a;void 0===n&&(n=0);var s=t.length;i.reserve(18*s),r.reserve(12*s),o&&(o=32767*o/(2*Math.PI)^0);var l,u,h,f={x:0,x2:0,offset:0},c=0;n=Math.round(n);for(var p=0;p<s;p++){var d=t.charAt(p),v=e.glyphInfos[d],g=p==s-1,y=(null===(a=null==v?void 0:v.glyph)||void 0===a?void 0:a.direction)||0;if(!l){if(" "==d)continue;l=y=y||1}if(void 0!==u){var m=!0;if(!y){var x=Vt(t,p,e);m=x&&x!=u}if(m&&y!=u){var _=p-1;" "==h&&1==y&&_--,Kt(t,c,++_,-1==u,e,n,o,i,r,f),c=_}}g&&c<=p&&(_=p+Number(" "!=d),Kt(t,c,_,y?-1==y:u!=l,e,n,o,i,r,f)),y&&(u=y),h=d}var w=f.x2;return{count:f.offset/2,position:i.data,texcoord:r.data,width:w/32/e.scale}},Jt=R.getInstance(),$t=function(){function t(t,e,i,r){this.x=0,this.y=0,this.glyphInfos={},this.avgCharWidth=0,this.glyphs=0;var n=Jt.initFont(t,e);if(this.style=t,this.letterHeight=n.letterHeight,this.lineHeight=n.letterHeight*e,this.baselineOffset=n.baselineOffset,this.rowHeight=n.rowHeight,this.spaceWidth=n.spaceWidth,this.fontScale=n.fontScale,!i)for(i=1;i<n.rowHeight;)i*=2;i*=e,this.width=i,this.height=i,this.maxWidth=i,this.maxHeight=i,this.style=t,this.scale=e,this.font=n,r&&this.addChars(r)}return t.prototype.getTextWidth=function(t){return Jt.getTextWidth(t,this.font)},t.prototype.placeGlyph=function(t){var e=this.rowHeight;if(this.x+t>this.width){var i=this.y+2*e;i>this.maxHeight?i>this.height?(this.height*=2,this.width*=2,0==this.x?this.maxWidth=this.maxWidth=this.width:(this.x=this.maxWidth,this.y=0)):(this.x=0,this.y+=e,this.maxHeight=this.height,this.maxWidth=this.width):(this.y+=e,this.maxHeight<this.height?this.x=this.maxWidth:this.x=0)}},t.prototype.addChars=function(t){for(var e=this.glyphInfos,i=this.rowHeight,r=!1,n=0,o=t;n<o.length;n++){var a=o[n];if(" "!=a&&!e[a]){var s=Jt.getGlyph(a,this.font),l=a.charCodeAt(0),u=s.data.width,h=s.width;if(l){this.avgCharWidth=(this.avgCharWidth*this.glyphs+h)/++this.glyphs,r=!0,this.placeGlyph(u);var f=this.x,c=this.y;e[a]={u1:f,v1:c,u2:f+u,v2:c+i,glyph:s},this.x+=u}}}return r},t}(),te=function(t){function e(e,i,r){var n=t.call(this,e)||this;n.dirty=!1;var o=e.dpr;return n.atlas=new $t(i,o,r),n.format=e.LUMINANCE_ALPHA,n}return r(e,t),e.prototype.addChars=function(t){this.dirty=this.atlas.addChars(t)||this.dirty},e.prototype.bufferLength=function(t,e){void 0===e&&(e=2);for(var i=0,r=0,n=t;r<n.length;r++)" "!=n[r]&&i++;return 6*i*e},e.prototype.getAtlas=function(){return this.atlas},e.prototype.sync=function(){if(this.dirty){var t=this.atlas;this.gl;var e=t.glyphInfos;for(var i in this.set({width:t.width,height:t.height}),e){var r=e[i];this.set(r.glyph.data,r.u1,r.v1)}}},e.prototype.destroy=function(){this.atlas=null,t.prototype.destroy.call(this)},e}(mt),ee=function(){function t(t,e){void 0===e&&(e=!1),this.i32=!1,this._flat=!0,this._flat=t,this.scissor=e,t||(this.idOffsets=[]),this.cullFace=1028}return t.prototype.count=function(){var t=this.flexAttributes.a_position;return t.data.length/t.size-this.first},t.prototype.index=function(){return this._index=this._index||[]},t.prototype.hasIndex=function(){return!!this._index},t.prototype.isEmpty=function(){return 0==this.count()},t.prototype.trimAttribute=function(t){var e=t;return e.data=e.data.trim(),e},t.prototype.isFlat=function(){return this._flat},t.prototype.finalize=function(t){var e,i=this,r=i.flexAttributes;if(i.hasIndex()){var n=i.index();if(!n.length)return null;e=new Gt(n,t,i.i32)}else e=new Gt({first:i.first,count:i.count()},t);for(var o in r){var a=r[o];a.data.length&&e.addAttribute(o,i.trimAttribute(a))}return e.idOffsets=i.idOffsets,e},t.prototype.setIdOffset=function(t){var e;null===(e=this.idOffsets)||void 0===e||e.push(t)},t.prototype.rayIntersects=function(t,e,i,r,n){return null},t}(),ie=function(){function t(t,e){void 0===e&&(e=128),this.length=0,this.data=new t(this.size=e)}return t.prototype.get=function(t){return this.data[t]},t.prototype.push=function(t){var e=arguments.length;this.reserve(e);for(var i=0;i<e;i++)this.data[this.length++]=arguments[i];return this.length},t.prototype.reserve=function(t){var e=this.data,i=t-(this.size-this.length);i>0&&(this.size+=Math.max(i,this.size),this.data=new e.constructor(this.size),this.length&&this.data.set(e))},t.prototype.trim=function(){return this.data=this.data.slice(0,this.length)},t}(),re="undefined"!=typeof Float32Array?Float32Array:Array;function ne(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function oe(t,e){var i=e[0],r=e[1],n=e[2],o=i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function ae(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function se(t,e,i){var r=e[0],n=e[1],o=e[2],a=i[0],s=i[1],l=i[2];return t[0]=n*l-o*s,t[1]=o*a-r*l,t[2]=r*s-n*a,t}function le(t,e,i){var r=e[0],n=e[1],o=e[2],a=i[3]*r+i[7]*n+i[11]*o+i[15];return a=a||1,t[0]=(i[0]*r+i[4]*n+i[8]*o+i[12])/a,t[1]=(i[1]*r+i[5]*n+i[9]*o+i[13])/a,t[2]=(i[2]*r+i[6]*n+i[10]*o+i[14])/a,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),Wt=new re(3),re!=Float32Array&&(Wt[0]=0,Wt[1]=0,Wt[2]=0);var ue,he=function(){function t(t,e){this.sMat=t,this.iSMat=e,this.origin=[0,0,0],this.direction=[0,0,0],this.sOrigin=[0,0,0],this.sDirection=[0,0,0],this.pIntersection=[0,0,0],this.intersectRayLength=0}return t.rayIntersectsTriangle=function(t,e,i,r,n,o){var a=ne([0,0,0],r,i),s=ne([0,0,0],n,i),l=se([0,0,0],e,s),u=ae(a,l);if(u>-1e-7&&u<1e-7)return null;var h=1/u,f=ne([0,0,0],t,i),c=h*ae(f,l);if(c<0||c>1)return null;var p=se([0,0,0],f,a),d=h*ae(e,p);if(d<0||c+d>1)return null;var v=h*ae(s,p);return v>1e-7?(o&&function(t,e,i){t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2]}(o,t,function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}(o,e,v)),v):null},t.prototype.getInverseScale=function(t){return t?this.invMapScale:this.invVpScale},t.prototype.intersectAABBox=function(t,e,i,r,n,o){var a=this.direction[0],s=this.direction[1],l=this.direction[2],u=this.origin[0],h=this.origin[1],f=this.origin[2],c=1/a,p=1/s,d=1/l,v=(t-u)*c,g=(r-u)*c,y=(e-h)*p,m=(n-h)*p,x=(i-f)*d,_=(o-f)*d,w=Math.min(Math.min(Math.max(v,g),Math.max(y,m)),Math.max(x,_));if(w<0)return null;var b=Math.max(Math.max(Math.min(v,g),Math.min(y,m)),Math.min(x,_));return b>w?null:b},t.prototype.intersectSphere=function(t,e){var i=ne([],t,this.origin),r=ae(i,this.direction),n=ae(i,i)-r*r,o=e*e;if(n>o)return null;var a=Math.sqrt(o-n),s=r-a,l=r+a;return s<0&&l<0?null:s<0?l:s},t.prototype.intersectEllipsoid=function(t,e){var i=ne([],this.origin,t),r=this.direction,n=e[0]*e[0],o=e[1]*e[1],a=e[2]*e[2],s=r[0]*r[0]/n+r[1]*r[1]/o+r[2]*r[2]/a,l=2*i[0]*r[0]/n+2*i[1]*r[1]/o+2*i[2]*r[2]/a,u=l*l-4*s*(i[0]*i[0]/n+i[1]*i[1]/o+i[2]*i[2]/a-1);if(u<0)return null;var h=(-l+(u=Math.sqrt(u)))/(2*s),f=(-l-u)/(2*s);return h<f?h:f},t.prototype.init=function(t,e,i,r,n,o){var a=this,s=a.sMat,l=a.iSMat,u=a.origin,h=a.direction,f=a.sOrigin,c=a.sDirection;this.w=i,this.h=r,this.scale=n,this.invMapScale=[1/n,1/n,1/n/o],this.invVpScale=[2/i,2/r],this.scaleZ=o,u[0]=t,u[1]=e,u[2]=-1,h[0]=t,h[1]=e,h[2]=0,le(u,u,l),le(h,h,l),le(c,h,s),le(f,u,s),ne(c,c,f),oe(c,c),ne(h,h,u),oe(h,h),this.result={id:null,z:1/0,layerIndex:null}},t.prototype.rayLengthScreenToWorld=function(t){var e=this.iSMat,i=this.origin[2],r=this.direction[2],n=t[0],o=t[1],a=t[2],s=e[3]*n+e[7]*o+e[11]*a+e[15];return((a=(e[2]*n+e[6]*o+e[10]*a+e[14])/(s||1))-i)/r},t.prototype.getIntersectionTop=function(){return this.result},t.prototype.intersect=function(t,e,i,r){if("Image"!=i.type&&!1!==i.pointerEvents){var n=this.result,o=i.rayIntersects(i,n,t,e,this);null!=o&&(n.id=o,n.layerIndex=r)}},t}(),fe=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this,e,!0)||this;return e||(i.cullFace=null),i.flexAttributes={a_position:{data:new ie(Float32Array),size:e?2:3},a_normal:{data:new ie(Int16Array),size:4},a_lengthSoFar:{data:new ie(Uint16Array),size:1}},i.first=0,i}return r(e,t),e.prototype.setIdOffset=function(t){var e;null===(e=this.idOffsets)||void 0===e||e.push(this.flexAttributes.a_position.data.length,t)},e.prototype.rayIntersects=function(t,e,i,r,n){for(var o,a=t.attributes,s=a.a_position.data,l=a.a_normal.data,u=a.a_position.size,h=[0,0,0],f=[0,0,0],c=[0,0,0],p=n.origin,d=n.direction,v=t.getUniform("u_strokeWidth")[0],g=1/8192,y=0,m=0;y<s.length;y+=u,m+=12){var x=l[m],_=l[m+1];x=(2*(1&x)-1)*(x>>1)*g,_=(2*(1&_)-1)*(_>>1)*g;var w=s[y],b=s[y+1],T=3==u?-s[y+2]:0;y+=u;var L=l[m+4],S=l[m+5];L=(2*(1&L)-1)*(L>>1)*g,S=(2*(1&S)-1)*(S>>1)*g;var M=s[y],A=s[y+1],z=3==u?-s[y+2]:0;y+=u;var P=l[m+8],I=l[m+9];P=(2*(1&P)-1)*(P>>1)*g,I=(2*(1&I)-1)*(I>>1)*g;var E=s[y],C=s[y+1],k=3==u?-s[y+2]:0;h[0]=i+w+x*v,h[1]=r+b+_*v,h[2]=T,f[0]=i+M+L*v,f[1]=r+A+S*v,f[2]=z,c[0]=i+E+P*v,c[1]=r+C+I*v,c[2]=k;var D=he.rayIntersectsTriangle(p,d,h,f,c);null!=D&&D<=e.z&&(e.z=D,o=y)}if(null!=o)for(var O=0,R=t.idOffsets,F=R.length;O<F;O+=2)if(o<R[O])return e.id=R[O+1]},e}(ee);function ce(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pe(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],h=e[8],f=e[9],c=e[10],p=e[11],d=e[12],v=e[13],g=e[14],y=e[15],m=i*s-r*a,x=i*l-n*a,_=i*u-o*a,w=r*l-n*s,b=r*u-o*s,T=n*u-o*l,L=h*v-f*d,S=h*g-c*d,M=h*y-p*d,A=f*g-c*v,z=f*y-p*v,P=c*y-p*g,I=m*P-x*z+_*A+w*M-b*S+T*L;return I?(I=1/I,t[0]=(s*P-l*z+u*A)*I,t[1]=(n*z-r*P-o*A)*I,t[2]=(v*T-g*b+y*w)*I,t[3]=(c*b-f*T-p*w)*I,t[4]=(l*M-a*P-u*S)*I,t[5]=(i*P-n*M+o*S)*I,t[6]=(g*_-d*T-y*x)*I,t[7]=(h*T-c*_+p*x)*I,t[8]=(a*z-s*M+u*L)*I,t[9]=(r*M-i*z-o*L)*I,t[10]=(d*b-v*_+y*m)*I,t[11]=(f*_-h*b-p*m)*I,t[12]=(s*S-a*A-l*L)*I,t[13]=(i*A-r*S+n*L)*I,t[14]=(v*x-d*w-g*m)*I,t[15]=(h*w-f*x+c*m)*I,t):null}var de=function(t,e,i,r,n){var o,a=1/Math.tan(e/2);return t[0]=a/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(o=1/(r-n),t[10]=(n+r)*o,t[14]=2*n*r*o):(t[10]=-1,t[14]=-2*r),t},ve={create:function(){var t=new re(16);return re!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},lookAt:function(t,e,i,r){var n,o,a,s,l,u,h,f,c,p,d=e[0],v=e[1],g=e[2],y=r[0],m=r[1],x=r[2],_=i[0],w=i[1],b=i[2];return Math.abs(d-_)<1e-6&&Math.abs(v-w)<1e-6&&Math.abs(g-b)<1e-6?ce(t):(h=d-_,f=v-w,c=g-b,n=m*(c*=p=1/Math.hypot(h,f,c))-x*(f*=p),o=x*(h*=p)-y*c,a=y*f-m*h,(p=Math.hypot(n,o,a))?(n*=p=1/p,o*=p,a*=p):(n=0,o=0,a=0),s=f*a-c*o,l=c*n-h*a,u=h*o-f*n,(p=Math.hypot(s,l,u))?(s*=p=1/p,l*=p,u*=p):(s=0,l=0,u=0),t[0]=n,t[1]=s,t[2]=h,t[3]=0,t[4]=o,t[5]=l,t[6]=f,t[7]=0,t[8]=a,t[9]=u,t[10]=c,t[11]=0,t[12]=-(n*d+o*v+a*g),t[13]=-(s*d+l*v+u*g),t[14]=-(h*d+f*v+c*g),t[15]=1,t)},multiply:function(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],h=e[7],f=e[8],c=e[9],p=e[10],d=e[11],v=e[12],g=e[13],y=e[14],m=e[15],x=i[0],_=i[1],w=i[2],b=i[3];return t[0]=x*r+_*s+w*f+b*v,t[1]=x*n+_*l+w*c+b*g,t[2]=x*o+_*u+w*p+b*y,t[3]=x*a+_*h+w*d+b*m,x=i[4],_=i[5],w=i[6],b=i[7],t[4]=x*r+_*s+w*f+b*v,t[5]=x*n+_*l+w*c+b*g,t[6]=x*o+_*u+w*p+b*y,t[7]=x*a+_*h+w*d+b*m,x=i[8],_=i[9],w=i[10],b=i[11],t[8]=x*r+_*s+w*f+b*v,t[9]=x*n+_*l+w*c+b*g,t[10]=x*o+_*u+w*p+b*y,t[11]=x*a+_*h+w*d+b*m,x=i[12],_=i[13],w=i[14],b=i[15],t[12]=x*r+_*s+w*f+b*v,t[13]=x*n+_*l+w*c+b*g,t[14]=x*o+_*u+w*p+b*y,t[15]=x*a+_*h+w*d+b*m,t},perspective:de,rotateX:function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],h=e[9],f=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+u*r,t[5]=a*n+h*r,t[6]=s*n+f*r,t[7]=l*n+c*r,t[8]=u*n-o*r,t[9]=h*n-a*r,t[10]=f*n-s*r,t[11]=c*n-l*r,t},rotateZ:function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+u*r,t[1]=a*n+h*r,t[2]=s*n+f*r,t[3]=l*n+c*r,t[4]=u*n-o*r,t[5]=h*n-a*r,t[6]=f*n-s*r,t[7]=c*n-l*r,t},translate:function(t,e,i){var r,n,o,a,s,l,u,h,f,c,p,d,v=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],h=e[7],f=e[8],c=e[9],p=e[10],d=e[11],t[0]=r,t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=h,t[8]=f,t[9]=c,t[10]=p,t[11]=d,t[12]=r*v+s*g+f*y+e[12],t[13]=n*v+l*g+c*y+e[13],t[14]=o*v+u*g+p*y+e[14],t[15]=a*v+h*g+d*y+e[15]),t},scale:function(t,e,i){var r=i[0],n=i[1],o=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},clone:function(t){var e=new re(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},invert:pe,identity:ce},ge=2*Math.PI,ye=2*Math.atan(1/3),me=function(t,e){return Math.round((t+1)/2*e)},xe={font:"bold 14px Arial",stroke:"red",fill:"white",strokeWidth:3},_e=function(){function t(t){this.gridTextBuf=new WeakMap,this.tileGrid=!1,this.dbgTile=function(t,e){void 0===t&&(t=[1,0,0,1]),void 0===e&&(e=2);var i=new fe,r=i.flexAttributes;Ht(r.a_position.data,r.a_normal.data,new Float32Array([0,0,1,0,1,1,0,1,0,0]),new Float32Array([0,1,2,3,4]),10,2,0,1,0,"butt","none",e);var n=i.finalize("Line");return n.addUniform("u_zIndex",0),n.addUniform("u_fill",t),n.addUniform("u_strokeWidth",[e,0]),n.addUniform("u_offset",[0,0]),n.scissor=!1,n.depth=!1,n}(),this.buffers=new WeakMap,this.ctxAttr=n({alpha:!0,antialias:!1,depth:!0,stencil:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1},t),this.vPMat=ve.create(),this.vMat=ve.create(),this.invVPMat=ve.create(),this.screenMat=ve.create(),this.invScreenMat=ve.create(),this.worldMatrix=new Float64Array(16),this.tilePreviewTransform={m:ve.create(),tx:0,ty:0,s:0};var e,i,r=(1,e=new Gt([0,1,3,3,1,2],"Polygon"),i=Int8Array,e.addAttribute("a_position",{data:new i([0,0,1,0,1,1,0,1]),size:2}),e.addUniform("u_offsetZ",[0,0]),e.addUniform("u_zIndex",0),e.addUniform("u_fill",[1,0,1,1]),e.scissor=!0,e.depth=!1,e.alpha=0,e);r.alpha=gt.ALPHA,r.blend=!0,this.stencilTile=r}return t.prototype.getContext=function(){return this.gl},t.prototype.setPass=function(t){var e=this.gl;this.pass=t,this.depthFnc=t!=gt.OPAQUE?e.LEQUAL:e.LESS,t==gt.POST_ALPHA&&e.clear(e.STENCIL_BUFFER_BIT)},t.prototype.convertColor=function(t){return P(t)},t.prototype.setBackgroundColor=function(t){this.gl&&this.gl.clearColor(t[0],t[1],t[2],1)},t.prototype.setScale=function(t,e,i){},t.prototype.setRotation=function(t,e){},t.prototype.clear=function(t){var e=this.gl;t&&this.setBackgroundColor(t),e.colorMask(!0,!0,!0,!0),e.disable(e.SCISSOR_TEST),e.depthMask(!0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.colorMask(!0,!0,!0,!1)},t.prototype.init=function(t,e){this.dpr=e;var i=t.getContext("webgl",this.ctxAttr);i.dpr=e,i.getExtension("OES_element_index_uint"),this.gl=i,this.initContext(),this.depthBufferSize=1<<i.getParameter(i.DEPTH_BITS);var r=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS);for(var n in this.icons=new bt(i,r-2),this.programs={Rect:new Pt(i,e),Line:new Ct(i,e),DashedLine:new kt(i,e),Text:new Rt(i,e),Image:new Ot(i,e),Circle:new It(i,e),Polygon:new Dt(i,e),Extrude:new Ut(i,e),Icon:new Ft(i,e),Box:new Nt(i,e),Sphere:new Bt(i,e)},this.programs)this.programs[n].setBufferCache(this.buffers)},t.prototype.initContext=function(){var t=this.gl;t.enable(t.CULL_FACE),t.cullFace(t.FRONT),t.enable(t.DEPTH_TEST),t.enable(t.SCISSOR_TEST),t.clearStencil(0),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},t.prototype.grid=function(t){this.tileGrid=t},t.prototype.applyTransform=function(){},t.prototype.initView=function(t,e,i,r,n,o,a,s,l){var u=this.vPMat,h=this.vMat,f=.5*ye,c=.5*t,p=.5*e,d=p/Math.tan(f),v=Math.cos(f),g=Math.sin(f)*d,y=Math.max(.01,.5*Math.PI-f+r),m=.1*d,x=v*(v*d+g/Math.tan(y));x*=1.005,this.tilePreviewTransform.tx=null,this.tilePreviewTransform.ty=null,this.tilePreviewTransform.s=null,this.w=t,this.h=e,this.rz=(n+ge)%ge,this.rx=r,this.scale=i,this.zMeterToPixel=1/o,this.gl.viewport(0,0,t*this.dpr,e*this.dpr),ve.perspective(u,ye,t/e,m,x);var _=ve.copy(this.worldMatrix,u);ve.scale(_,_,[1,-1,1]),ve.translate(_,_,[0,0,-d]),ve.rotateX(_,_,-r),ve.rotateZ(_,_,n),ve.scale(_,_,[l,l,l]),ve.translate(_,_,[-a,-s,0]),ve.lookAt(h,[c,p,-d],[c,p,0],[0,-1,0]),ve.translate(h,h,[c,p,0]),ve.rotateX(h,h,r),ve.rotateZ(h,h,n),ve.scale(h,h,[i,i,i/o]),ve.translate(h,h,[-c,-p,0]),ve.multiply(u,u,h),pe(this.invVPMat,this.vPMat);var w=ve.identity(this.screenMat);ve.scale(w,w,[c,-p,1]),ve.translate(w,w,[1,-1,0]),ve.multiply(w,w,this.vPMat),pe(this.invScreenMat,w)},t.prototype.initBuffers=function(t){var e=this.gl;for(var i in t){var r=t[i],n=this.buffers.get(r);n||(n=e.createBuffer(),this.buffers.set(r,n)),r.dirty&&(r.dirty=!1,e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,r.data,e.STATIC_DRAW))}},t.prototype.useProgram=function(t){var e=this.prog;if(e!=t){var i=this.gl;if(e){var r=e.attributes;for(var n in r)i.disableVertexAttribArray(r[n])}return i.useProgram(t.prog),this.prog=t,!0}return!1},t.prototype.drawGrid=function(t,e,i,r){var n=this.pass;this.pass=gt.ALPHA,this.drawBuffer(this.dbgTile,t,e,null,null,r);var o=this.gridTextBuf.get(i);o||(o=function(t,e,i){ue||((ue=new te(e,i)).addChars("L0123456789"),ue.sync());var r=t+" L"+t.length,n=r.length,o=new ie(Int16Array,18*n),a=new ie(Uint16Array,12*n),s=Qt(r,ue.atlas,o,a),l=s.position,u=s.count,h=s.texcoord,f=new Gt({first:0,count:u},"Text");return f.addAttribute("a_position",{data:new Int8Array(l.length).fill(1),size:2,stride:0}),f.addAttribute("a_point",{data:l,size:2,stride:0}),f.addAttribute("a_texcoord",{data:h,size:2,stride:0}),f.depth=!1,f.scissor=!1,f.texture=ue,f.addUniform("u_texture",0),f.addUniform("u_atlasScale",1/ue.width),f.addUniform("u_opacity",1),f.addUniform("u_alignMap",!0),f.addUniform("u_fillColor",P(i.fill)),f.addUniform("u_strokeColor",P(i.stroke)),f}(i.quadkey,this.gl,xe),this.gridTextBuf.set(i,o)),this.drawBuffer(o,t+4,e+4),this.pass=n},t.prototype.deleteBuffer=function(t){var e=this.buffers,i=this.gl,r=t.attributes,n=t.texture;for(var o in n&&n.destroy(),r){var a=r[o],s=e.get(a);i.deleteBuffer(s)}for(var l=0,u=t.groups;l<u.length;l++){var h=u[l].index;h&&i.deleteBuffer(e.get(h))}},t.prototype.initGroundDepth=function(t,e,i){var r=this.gl,n=this.stencilTile,o=this.programs[n.type];o.pass(this.pass);var a=n.getAttributes();this.initBuffers(a),this.useProgram(o),r.depthRange(0,1),r.depthMask(!0),r.disable(r.STENCIL_TEST),r.disable(r.SCISSOR_TEST),r.enable(r.DEPTH_TEST),o.initAttributes(a),o.initUniforms(n.uniforms);var s=o.uniforms;r.uniform2f(s.u_topLeft,t,e),r.uniform1f(s.u_tileScale,i||1),r.uniformMatrix4fv(s.u_matrix,!1,this.vPMat),r.clear(r.DEPTH_BUFFER_BIT),r.depthFunc(r.ALWAYS),r.colorMask(!1,!1,!1,!1),o.draw(n),r.colorMask(!0,!0,!0,!1),r.depthFunc(this.depthFnc)},t.prototype.drawBuffer=function(t,e,i,r,n,o){var a,s,l,u=this.gl,h=this.pass;if(s=this.programs[t.type]){var f=s.pass(h);n=n||1;var c=this.zIndex,p=t.flat&&c>this.min3dZIndex,d=t.alpha==gt.POST_ALPHA&&h==gt.POST_ALPHA;if((t.alpha||p)&&(f=h==gt.ALPHA||d),f){if(this.stencilVal&&t.alpha){var v=this.stencilVal;this.stencilVal=null,this.drawStencil(v)}a=t.getAttributes(),this.initBuffers(a),this.useProgram(s),u.depthFunc(this.depthFnc);var g=(65535-c)/65536;u.depthRange(t.flat?g:0,g),s.init(t,h,Boolean(this.rx||this.rz),c),p&&u.disable(this.gl.DEPTH_TEST),s.initAttributes(a),s.initUniforms(t.uniforms),l=s.uniforms,u.uniform1i(l.u_fixedView,this.fixedView),u.uniform1f(l.u_rotate,this.rz),u.uniform2f(l.u_resolution,this.w,this.h),u.uniform1f(l.u_scale,this.scale*n),u.uniform2f(l.u_topLeft,e,i),u.uniform1f(l.u_tileScale,o||1),u.uniformMatrix4fv(l.u_matrix,!1,r||this.vPMat),u.uniformMatrix4fv(l.u_inverseMatrix,!1,this.invVPMat),u.uniform1f(l.u_zMeterToPixel,this.zMeterToPixel/n),s.draw(t)}}},t.prototype.initStencil=function(t,e,i,r){this.stencilVal=t,this.stencilSize=r,this.stencilX=e,this.stencilY=i},t.prototype.drawStencil=function(t){if(this.rx||this.rz){var e=this.gl,i=this.stencilTile,r=this.stencilX,n=this.stencilY;e.stencilFunc(e.ALWAYS,t,255),e.stencilOp(e.REPLACE,e.REPLACE,e.REPLACE),e.colorMask(!1,!1,!1,!1),this.drawBuffer(i,r,n,null,null,this.stencilSize),e.stencilFunc(e.EQUAL,t,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!1)}},t.prototype.initScissor=function(t,e,i,r,n){if(t.scissor){var o=this.gl,a=o.canvas.width,s=o.canvas.height;if(this.scale>4)return o.scissor(0,0,a,s),this.scissorX=null,!0;if(this.scissorX!=e||this.scissorY!=i||this.scissorSize!=r){this.scissorX=e,this.scissorY=i,this.scissorSize=r;for(var l=e+r,u=i+n,h=1/0,f=-h,c=h,p=f,d=0,v=[[e,u,0],[l,u,0],[e,i,0],[l,i,0]];d<v.length;d++){var g=v[d];g=le([],g,this.vPMat);var y=me(g[0],a),m=me(g[1],s);y<h&&(h=y),y>f&&(f=y),m<c&&(c=m),m>p&&(p=m)}o.scissor(h,c,f-h,p-c)}return!0}},t.prototype.draw=function(t,e){var i,r,n,o,a,s,l,u,h,f,c,p=!1,d=!1,v=t.data.tile,g=v.tile,y=v.size,m=v.x,x=v.y,_=t.b,w=t.data.preview;if(this.zIndex=t.z,this.min3dZIndex=e,w){var b=t.data.previewTile;i=w[0],r=w[1],n=w[2],o=w[3],a=w[5],s=w[6],u=(l=w[7])/o,h=Math.pow(2,g.quadkey.length-i.length),f=a/u-r,c=s/u-n,this.initScissor(_,m+a,x+s,l,l),h<1?this.initStencil(b.i,m+a,x+s,y*h):d||(d=!0,this.initStencil(g.i,m,x,y));var T=this.initPreviewMatrix(m,x,u);this.drawBuffer(_,f,c,T,h)}else p||(p=this.initScissor(_,m,x,y,y)),d||(this.initStencil(g.i,m,x,y),d=!0),this.drawBuffer(_,m,x)},t.prototype.initPreviewMatrix=function(t,e,i){var r=this.tilePreviewTransform,n=this.vPMat,o=r.m;return r.tx==t&&r.ty==e&&r.s==i||(ve.copy(o,n),ve.translate(o,o,[t,e,0]),ve.scale(o,o,[i,i,1]),r.tx=t,r.ty=e,r.s=i),o},t.prototype.destroy=function(){this.icons.destroy()},t.prototype.prepare=function(t,e,i,r,n,o){},t.prototype.drawCustom=function(t,e){var i,r=this,n=r.gl;r.prog=null;var o=(65535-e)/65536,a="3d"==t.renderOptions.mode?0:o;n.depthRange(a,o),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),t.render(n,r.worldMatrix),null===(i=n.getExtension("OES_vertex_array_object"))||void 0===i||i.bindVertexArrayOES(null),n.bindFramebuffer(n.FRAMEBUFFER,null),this.initContext()},t}(),we=function(){function t(){this.r=[],this.p=[]}return t.prototype.init=function(t,e){this.luTs=null,this.quadkey=t,this.layers=e,this.tasks={},this.r.length=0,this.p.length=0},t.prototype.busy=function(t){var e=t.id;for(var i in this.tasks)if(e==this.tasks[i]._lid)return!0},t.prototype.addTask=function(t,e){t._lid=e.id,this.tasks[t.id]=t},t.prototype.cancelTasks=function(t){var e,i=this.tasks;for(var r in i)e=i[r],t&&t.id!=e._lid||(e.cancel(),delete i[r])},t.prototype.removeTask=function(t,e){delete this.tasks[t.id]},t.prototype.index=function(t){return this.layers.indexOf(t)},t.prototype.ready=function(t,e){return 2==arguments.length&&(this.r[t]=e,e&&(this.luTs=Date.now())),this.r[t]},t.prototype.addLayer=function(t){this.r.splice(t,0,!1),this.p.splice(t,0,void 0)},t.prototype.removeLayer=function(t){this.r.splice(t,1),this.p.splice(t,1)},t.prototype.preview=function(t,e){return 2==arguments.length&&(this.p[t]=e),this.p[t]},t}(),be=function(t){function e(e,i,r){var n=t.call(this)||this;return n.data=[],n.onDrop=r,n.init(e,i),n}return r(e,t),e.prototype.clear=function(t){this.setData(t,void 0),this.ready(t,!1),this.preview(t,!1)},e.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.data.length=0},e.prototype.setData=function(t,e){var i="number"==typeof t?t:this.layers.indexOf(t),r=this.data[i];return r&&r.length&&this.onDrop&&this.onDrop(r,i),this.data[i]=e,i},e.prototype.getData=function(t){return this.data[t]},e.prototype.addLayer=function(e){t.prototype.addLayer.call(this,e),this.data.splice(e,0,void 0)},e.prototype.removeLayer=function(e){t.prototype.removeLayer.call(this,e),this.setData(e,void 0),this.preview(e,void 0),this.data.splice(e,1)},e}(we),Te=function(){function e(e){this.tiles=new t.LRU(e)}return e.prototype.setSize=function(t){this.tiles.setSize(t)},e.prototype.get=function(t,e){if(e){var i=this.tiles._[t];return i&&i.data}return this.tiles.get(t)},e.prototype.forEach=function(t){return this.tiles.forEach(t)},e}(),Le=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.create=function(t,e){var i,r,n=this.tiles,o=this.onDrop,a=n.get(t);if(!a&&(a=new be(t,e,o),(i=n.set(t,a))&&(r=i.data))){for(var s=0;s<r.length;s++)i.setData(s,null),i.preview(s,null);i.data=null}return a},e}(Te),Se=t.geometry.centroid,Me=t.TaskManager.getInstance(),Ae=Math.PI/180,ze=new Float32Array([-1,-1,-1,-1]),Pe=function(t,e,i,r,n,o,a){void 0===a&&(a=0);for(var s=t.z,l=!0,u=0,h=r;u<h.length;u++){var f=h[u],c=f.type,p=X("type",f,e,s);if("Polygon"==p||"Line"==p){if(X("stroke",f,e,s)){f.type="Line";for(var d=0,v=i;d<v.length;d++){var g=v[d];l=l&&t.create(e,"LineString",g,[f],n,o.clipped)}f.type=c}}else if(0==a){var y=o.bounds,m=e.bbox,x=void 0;if("Centroid"==X("anchor",f,e,s)){var _=e.geometry;x=_._c=_._c||Se("Polygon"==_.type?_.coordinates:_.coordinates[0])}else x=[m[0]+(m[2]-m[0])/2,m[1]+(m[3]-m[1])/2];var w=x[0],b=x[1];w>=y[0]&&b>=y[1]&&w<y[2]&&b<y[3]&&(l=l&&t.create(e,"Point",x,[f],n))}}return l},Ie=[0,0,1,0,1,1,0,0,1,1,0,1],Ee=function(t,e,i,r){var n=r.length,o=t=32*t<<2|1,a=e=32*e<<2|1,s=2|t,l=a,u=o,h=2|e,f=s,c=h;return"number"==typeof i?(i=Math.round(i/9e3*65535),r.push(o,a,i,u,h,i,f,c,i,o,a,i,f,c,i,s,l,i),n+=18):(r.push(o,a,u,h,f,c,o,a,f,c,s,l),n+=12),n},Ce=function(t,e,i,r,n){for(var o="number"==typeof n,a=t.length,s=[],l=0,u=0;u<e.length;u++){for(var h=0,f=void 0,c=void 0;h<e[u].length;h++)f=i.lon2x(e[u][h][0],r),c=i.lat2y(e[u][h][1],r),o?t.push(f,c,n):t.push(f,c);u>0&&(l+=e[u-1].length,s[s.length]=l)}return{dimensions:o?3:2,vertices:t,holes:s,start:a,stop:t.length}},ke=function(t,e,i,r,n){var o;if("number"!=typeof e[0][0][0]){o=[];for(var a=0,s=e;a<s.length;a++){var l=s[a];o.push(Ce(t,l,i,r,n))}}else o=[Ce(t,e,i,r,n)];return o},De=function(t,e,i){for(var r=0,n=e,o=i-1;n<o;n+=3){var a=t[n],s=t[n+1];r+=(t[n+3]-a)*(s+t[n+4])}return r},Oe=function(t,e,i,r,n,o,a,s){var l=t.holes,u=t.vertices,h=t.stop-3,f=t.start,c=0,p=f+3*l[c]-6,d=De(e.data,f,p?p+3:h)>=0;for(a=a||0;f<h;){var v=void 0,g=void 0,y=void 0,m=void 0;if(d){var x=t.start+h-f;v=u.get(x),y=u.get(x+1),g=u.get(x-3),m=u.get(x-2)}else v=u.get(f),y=u.get(f+1),g=u.get(f+3),m=u.get(f+4);var _=Math.round(v)-Math.round(g),w=Math.round(y)-Math.round(m);if((_||w)&&(C(v,y,0,0,n,n)||C(g,m,0,0,n,n))){var b=e.length/3;r[r.length]=b+2,r[r.length]=b,r[r.length]=b+1,r[r.length]=b+3,r[r.length]=b+2,r[r.length]=b+1,null==s||s.push(b,b+1,b+2,b+3,b,b+2,b+1,b+3),e.push(v,y,o,v,y,a,g,m,o,g,m,a);var T=_*_+w*w,L=w,S=-_;L*=T=127/Math.sqrt(T),S*=T,i.push(L,S,L,S,L,S,L,S)}f==p?(f+=6,p=t.start+3*l[++c]-6,d=De(e.data,f,p?p+3:h)<0):f+=3}},Re=function(t,e,i,r,n,o,a,s,l){for(var u=t.length,h=ke(t,r,n,o,a);u<t.length;)e.push(0,0),u+=3;if(a)for(var f=0,c=h;f<c.length;f++){var p=c[f];Oe(p,t,e,i,o,a,s,l)}return h},Fe={exports:{}};function Ue(t,e,i){i=i||2;var r,n,o,a,s,l,u,h=e&&e.length,f=h?e[0]*i:t.length,c=Ne(t,0,f,i,!0),p=[];if(!c||c.next===c.prev)return p;if(h&&(c=function(t,e,i,r){var n,o,a,s=[];for(n=0,o=e.length;n<o;n++)(a=Ne(t,e[n]*r,n<o-1?e[n+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(Ke(a));for(s.sort(He),n=0;n<s.length;n++)i=je(s[n],i);return i}(t,e,c,i)),t.length>80*i){r=o=t[0],n=a=t[1];for(var d=i;d<f;d+=i)(s=t[d])<r&&(r=s),(l=t[d+1])<n&&(n=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-r,a-n))?32767/u:0}return Ge(c,p,i,r,n,u,0),p}function Ne(t,e,i,r,n){var o,a;if(n===ui(t,e,i,r)>0)for(o=e;o<i;o+=r)a=ai(o,t[o],t[o+1],a);else for(o=i-r;o>=e;o-=r)a=ai(o,t[o],t[o+1],a);return a&&ti(a,a.next)&&(si(a),a=a.next),a}function Be(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!ti(r,r.next)&&0!==$e(r.prev,r,r.next))r=r.next;else{if(si(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function Ge(t,e,i,r,n,o,a){if(t){!a&&o&&function(t,e,i,r){var n=t;do{0===n.z&&(n.z=qe(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,o,a,s,l,u=1;do{for(i=t,t=null,o=null,a=0;i;){for(a++,r=i,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,l--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;i=r}o.nextZ=null,u*=2}while(a>1)}(n)}(t,r,n,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Ze(t,r,n,o):We(t))e.push(s.i/i|0),e.push(t.i/i|0),e.push(l.i/i|0),si(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?Ge(t=Xe(Be(t),e,i),e,i,r,n,o,2):2===a&&Ye(t,e,i,r,n,o):Ge(Be(t),e,i,r,n,o,1);break}}}function We(t){var e=t.prev,i=t,r=t.next;if($e(e,i,r)>=0)return!1;for(var n=e.x,o=i.x,a=r.x,s=e.y,l=i.y,u=r.y,h=n<o?n<a?n:a:o<a?o:a,f=s<l?s<u?s:u:l<u?l:u,c=n>o?n>a?n:a:o>a?o:a,p=s>l?s>u?s:u:l>u?l:u,d=r.next;d!==e;){if(d.x>=h&&d.x<=c&&d.y>=f&&d.y<=p&&Qe(n,s,o,l,a,u,d.x,d.y)&&$e(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function Ze(t,e,i,r){var n=t.prev,o=t,a=t.next;if($e(n,o,a)>=0)return!1;for(var s=n.x,l=o.x,u=a.x,h=n.y,f=o.y,c=a.y,p=s<l?s<u?s:u:l<u?l:u,d=h<f?h<c?h:c:f<c?f:c,v=s>l?s>u?s:u:l>u?l:u,g=h>f?h>c?h:c:f>c?f:c,y=qe(p,d,e,i,r),m=qe(v,g,e,i,r),x=t.prevZ,_=t.nextZ;x&&x.z>=y&&_&&_.z<=m;){if(x.x>=p&&x.x<=v&&x.y>=d&&x.y<=g&&x!==n&&x!==a&&Qe(s,h,l,f,u,c,x.x,x.y)&&$e(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,_.x>=p&&_.x<=v&&_.y>=d&&_.y<=g&&_!==n&&_!==a&&Qe(s,h,l,f,u,c,_.x,_.y)&&$e(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;x&&x.z>=y;){if(x.x>=p&&x.x<=v&&x.y>=d&&x.y<=g&&x!==n&&x!==a&&Qe(s,h,l,f,u,c,x.x,x.y)&&$e(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;_&&_.z<=m;){if(_.x>=p&&_.x<=v&&_.y>=d&&_.y<=g&&_!==n&&_!==a&&Qe(s,h,l,f,u,c,_.x,_.y)&&$e(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function Xe(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!ti(n,o)&&ei(n,r,r.next,o)&&ni(n,o)&&ni(o,n)&&(e.push(n.i/i|0),e.push(r.i/i|0),e.push(o.i/i|0),si(r),si(r.next),r=t=o),r=r.next}while(r!==t);return Be(r)}function Ye(t,e,i,r,n,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Je(a,s)){var l=oi(a,s);return a=Be(a,a.next),l=Be(l,l.next),Ge(a,e,i,r,n,o,0),void Ge(l,e,i,r,n,o,0)}s=s.next}a=a.next}while(a!==t)}function He(t,e){return t.x-e.x}function je(t,e){var i=function(t,e){var i,r=e,n=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>a&&(a=s,i=r.x<r.next.x?r:r.next,s===n))return i}r=r.next}while(r!==e);if(!i)return null;var l,u=i,h=i.x,f=i.y,c=1/0;r=i;do{n>=r.x&&r.x>=h&&n!==r.x&&Qe(o<f?n:a,o,h,f,o<f?a:n,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(n-r.x),ni(r,t)&&(l<c||l===c&&(r.x>i.x||r.x===i.x&&Ve(i,r)))&&(i=r,c=l)),r=r.next}while(r!==u);return i}(t,e);if(!i)return e;var r=oi(i,t);return Be(r,r.next),Be(i,i.next)}function Ve(t,e){return $e(t.prev,t,e.prev)<0&&$e(e.next,t,t.next)<0}function qe(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ke(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Qe(t,e,i,r,n,o,a,s){return(n-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(i-a)*(e-s)&&(i-a)*(o-s)>=(n-a)*(r-s)}function Je(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&ei(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(ni(t,e)&&ni(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&($e(t.prev,t,e.prev)||$e(t,e.prev,e))||ti(t,e)&&$e(t.prev,t,t.next)>0&&$e(e.prev,e,e.next)>0)}function $e(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function ti(t,e){return t.x===e.x&&t.y===e.y}function ei(t,e,i,r){var n=ri($e(t,e,i)),o=ri($e(t,e,r)),a=ri($e(i,r,t)),s=ri($e(i,r,e));return n!==o&&a!==s||!(0!==n||!ii(t,i,e))||!(0!==o||!ii(t,r,e))||!(0!==a||!ii(i,t,r))||!(0!==s||!ii(i,e,r))}function ii(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function ri(t){return t>0?1:t<0?-1:0}function ni(t,e){return $e(t.prev,t,t.next)<0?$e(t,e,t.next)>=0&&$e(t,t.prev,e)>=0:$e(t,e,t.prev)<0||$e(t,t.next,e)<0}function oi(t,e){var i=new li(t.i,t.x,t.y),r=new li(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function ai(t,e,i,r){var n=new li(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function si(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function li(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ui(t,e,i,r){for(var n=0,o=e,a=i-r;o<i;o+=r)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}Fe.exports=Ue,Fe.exports.default=Ue,Ue.deviation=function(t,e,i,r){var n=e&&e.length,o=n?e[0]*i:t.length,a=Math.abs(ui(t,0,o,i));if(n)for(var s=0,l=e.length;s<l;s++){var u=e[s]*i,h=s<l-1?e[s+1]*i:t.length;a-=Math.abs(ui(t,u,h,i))}var f=0;for(s=0;s<r.length;s+=3){var c=r[s]*i,p=r[s+1]*i,d=r[s+2]*i;f+=Math.abs((t[c]-t[d])*(t[p+1]-t[c+1])-(t[c]-t[p])*(t[d+1]-t[c+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},Ue.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)i.vertices.push(t[n][o][a]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i};var hi,fi=function(){function t(t){this.data={},this.gl=t}return t.prototype.create=function(t){var e=t.reduce(function(t,e){return t+e})*(t.length%2+1);e*=Math.ceil(512/e);for(var i=new Uint8Array(e),r=!0,n=0;n<e;)for(var o=0,a=t;o<a.length;o++){var s=a[o];r&&i.fill(255,n,n+s),n+=s,r=!r}return new xt(this.gl,{width:i.length,height:1,pixels:i},this.gl.LUMINANCE)},t.prototype.get=function(t){var e=String(t),i=this.data[e];return i||(i=this.data[e]=this.create(t)),i},t}(),ci=function(){function t(t){void 0===t&&(t=256),this.length=0,this.points=[],this.sqDistance=this.setMinDistance(t)}return t.prototype.setMinDistance=function(t){return this.sqDistance=t*t},t.prototype.add=function(t,e){var i=this.points;i[this.length++]=t,i[this.length++]=e},t.prototype.clear=function(){this.length=0,this.points.length=0},t.prototype.hasSpace=function(t,e){var i=this,r=i.length,n=i.points,o=i.sqDistance,a=0;if(o)for(;a<r;){var s=t-n[a++],l=e-n[a++];if(s*s+l*l<o)return!1}return!0},t}(),pi=180/Math.PI,di=function(){function t(t){this.length=0,this.dashes=new fi(t),this.gl=t,this.pixels=new Float32Array(262144),this.alpha=new Float32Array(131072),this.lineLength=new Float32Array(131072),this.repeat={}}return t.prototype.getDistanceGrp=function(){return this.repeat[this.dId]},t.prototype.projectLine=function(t,e,i){var r=this.pixels,n=this.decimals;if(!this.length){for(var o=0,a="number"==typeof t[0][2]?3:2,s=3===a,l=0,u=t.length,h=void 0,f=void 0,c=void 0,p=void 0,d=void 0,v=void 0;l<u;l++){var g=t[l];if(h=e.lon2x(g[0],i),f=e.lat2y(g[1],i),c=g[2]||0,(!l||Math.round(p*n)-Math.round(h*n)||Math.round(d*n)-Math.round(f*n)||s&&c!=v)&&(r[o++]=h,r[o++]=f,s&&(r[o++]=c),o>a)){var y=p-h,m=d-f;this.lineLength[l]=this.lineLength[l-1]+Math.sqrt(y*y+m*m)}p=h,d=f,v=c}this.length=o,this.dimensions=a}return this.length},t.prototype.placeCached=function(t,e,i,r){for(var n=this.collisions,o=0,a=void 0;o<n.length;o++){var s=(a=n[o]).cx,l=a.cy,u=a.cz;256==i&&(s-=e.x%2*i,l-=e.y%2*i),t(s,l,u,r?this.alpha[o]:0,0,a)}},t.prototype.initTile=function(){var t=this.repeat;for(var e in t)t[e].clear()},t.prototype.initFeature=function(t,e,i){this.decimals=t>=20-Number(512==e)?100:1,this.length=0,this.collisions=null;var r=this.repeat;this.dId=i,i&&!r[i]&&(r[i]=new ci)},t.prototype.createLine=function(t,e,i,r,n,o,a,s,l,u,h,f,c){o&&(e.texture=this.dashes.get(o)),e.buffer||(e.buffer=new fe(!u));var p=e.buffer;this.projectLine(t,i,r);var d=this,v=d.pixels,g=d.length,y=d.dimensions,m=g-y,x=v[0]==v[m]&&v[1]==v[m+1];return Ht(p.flexAttributes.a_position.data,p.flexAttributes.a_normal.data,v,this.lineLength,g,y,u,r,0,a,s,l,o&&p.flexAttributes.a_lengthSoFar.data,x,h,f,c)},t.prototype.placeAtSegments=function(t,e,i,r,n,o,a,s,l,u,h,f,c,p){var d;this.projectLine(t,i,r),null===(d=this.getDistanceGrp())||void 0===d||d.setMinDistance(null==a?256:a),this.placeAlongLine(i,r,n,o,s,l,u,h,f,c,e,p)},t.prototype.getAbsOffset=function(t){if("string"==typeof t&&t.endsWith("px"))return parseFloat(t);var e=this,i=e.length,r=e.dimensions;return t*e.lineLength[i/r-1]},t.prototype.placeAtPoints=function(t,e,i,r,n,o,a,s,l,u,h,f,c){void 0===h&&(h=0),void 0===f&&(f=1),this.projectLine(t,i,r);var p=this,d=p.length,v=p.dimensions,g=p.lineLength,y=g[d/v-1],m=h*y,x=f*y;if(this.collisions)return this.placeCached(c,i,r);for(var _,w=n&&[],b="number"==typeof e?e:null,T=0,L=0,S=this.pixels;L<d;L+=v){var M=S[L],A=S[L+1],z=!0===e?S[L+2]:b,P=L/v;if(_=T,T=g[P+1],m){if(!(m<T))continue;var I=(m-_)/(T-_),E=L+v,C=S[E],k=S[E+1],D=!0===e?S[E+2]:b;M+=(C-M)*I,A+=(k-A)*I,null!=z&&(z+=(D-z)*I),m==x&&(d=null,x=null),m=null}if(x&&x&&_>x){var O=(x-_)/(_-g[P-1]),R=L-v,F=S[R],U=S[R+1],N=!0===e?S[R+2]:b;M-=(F-M)*O,A-=(U-A)*O,null!=z&&(z-=(N-z)*O),d=null}var B=void 0;if(M>=0&&A>=0&&M<r&&A<r){var G=void 0;w&&((G=this.getDistanceGrp())&&!G.hasSpace(M,A)||(B=n.insert(M,A,z,l,u,a,s,i,r,o))&&w.push(B)),w&&!B||(c(M,A,z,0,0,B),null==G||G.add(M,A))}}(null==w?void 0:w.length)&&(this.collisions=w)},t.prototype.placeAlongLine=function(t,e,i,r,n,o,a,s,l,u,h,f){if(this.collisions)return this.placeCached(f,t,e,l);var c,p,d,v,g,y,m,x,_,w=this.dimensions,b=i&&[],T=this.length/w,L=this.pixels,S=Math.pow(2*n+a,2),M=Math.floor(T/2)-1,A=1,z=L[M*w],P=L[M*w+1],I=1==h,E=0;I?_=L[M*w+2]:x="number"==typeof h?h:null;for(var C=z,k=P,D=1;D<T;D++){var O=M+A*D;if(O>=T&&(A=-1,O=M-1,M=T-1,z=C,P=k),c=L[O*w],p=L[O*w+1],d=L[O*w+2],m=.5*(g=p-P)+P,(y=.5*(v=c-z)+z)>=0&&m>=0&&y<e&&m<e){var R=u?v*v+g*g:1/0;if(R>S){if(I){var F=d-_;x=_+.5*(d-_),E=Math.asin(F/Math.sqrt(v*v+g*g+F*F))}var U=Math.atan2(g,v);-1==A&&(U+=Math.PI);var N=void 0,B=void 0;if(b&&(!(B=this.getDistanceGrp())||B.hasSpace(y,m))){var G=n,W=o;if(l&&U&&(G||W)){var Z=Math.sin(U),X=Math.cos(U);G=X*n-Z*o,W=Z*n+X*o}var Y=Math.sqrt(S/R),H=[v*Y,g*Y];(N=i.insert(y,m,x,G,W,a/2,s/2,t,e,r,H))&&(this.alpha[b.length]=U*pi,b.push(N))}b&&!N||(f(y,m,x,l?U*pi:0,E,N),null==B||B.add(y,m))}}z=c,P=p,_=d}(null==b?void 0:b.length)&&(this.collisions=b)},t}(),vi=function(t){function e(e,i){void 0===e&&(e=!0);var r=t.call(this,e)||this;return r.flexAttributes={a_position:{data:new ie(Uint16Array),size:e?2:3},a_point:{data:new ie(Int16Array),size:i?3:2},a_texcoord:{data:new ie(Uint16Array),size:2}},r.first=0,r}return r(e,t),e}(ee),gi=function(t){return 9e3*t/65535},yi=function(t,e,i){return e>0?t*e*i:t},mi=function(t,e,i){var r=t.getUniform("u_offset"),n=yi(r[0],r[1],e),o=yi(r[2],r[3],e),a=t.getUniform("u_offsetZ");return[n,o,yi(a[0],a[1],e)]},xi=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this,e)||this;return i.flexAttributes={a_position:{data:new ie(Uint16Array),size:e?2:3}},i.first=0,i}return r(e,t),e.prototype.rayIntersects=function(t,e,i,r,n){var o,a,s,l=t.type,u=t.attributes,h=t.getUniform("u_alignMap"),f=n.scale,c=n.scaleZ,p=h?1/n.scale:1,d=mi(t,f),v=d[0],g=d[1],y=d[2];if(y=-y/c/f,"Rect"===l){var m=t.getUniform("u_size"),x=t.getUniform("u_strokeWidth")||0;a=.5*(m[0]+x),s=.5*(m[2]+x)}else"Circle"==l&&(a=s=t.getUniform("u_radius")[0]);a*=p,s*=p;var _,w,b,T=u.a_position.data,L=u.a_position.size,S=[0,0,0],M=[0,0,0],A=[0,0,0],z=null;h?(_=n.origin,w=n.direction,v/=f,g/=f):b=[0,0,0];for(var P=0,I=0;P<T.length;P+=L,I+=6){var E=(2&T[P])-1,C=i+(T[P]>>2)/32,k=(2&T[P+1])-1,D=r+(T[P+1]>>2)/32,O=3==L?-gi(T[P+2]):0,R=(2&T[P+=L])-1,F=i+(T[P]>>2)/32,U=(2&T[P+1])-1,N=r+(T[P+1]>>2)/32,B=3==L?-gi(T[P+2]):0,G=(2&T[P+=L])-1,W=i+(T[P]>>2)/32,Z=(2&T[P+1])-1,X=r+(T[P+1]>>2)/32,Y=3==L?-gi(T[P+2]):0;if("Icon"===l){var H=null===(o=u.a_size)||void 0===o?void 0:o.data;a=.5*H[I]*p,s=.5*H[I+1]*p}h?(S[0]=C+E*a+v,S[1]=D-k*s+g,S[2]=O+y,M[0]=F+R*a+v,M[1]=N-U*s+g,M[2]=B+y,A[0]=W+G*a+v,A[1]=X-Z*s+g,A[2]=Y+y):(S[0]=C,S[1]=D,S[2]=O+y,le(S,S,n.sMat),S[0]+=v,S[1]+=g,M[0]=S[0]+R*a,M[1]=S[1]-U*s,M[2]=S[2],A[0]=S[0]+G*a,A[1]=S[1]-Z*s,A[2]=S[2],S[0]+=E*a,S[1]-=k*s,_=n.sOrigin,w=n.sDirection);var j=he.rayIntersectsTriangle(_,w,S,M,A,b);j&&(h||(j=n.rayLengthScreenToWorld(b)),j<e.z&&(e.z=j,z=P))}if(null!=z)return t.idOffsets[Math.floor(z/18)]},e}(ee),_i=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this,e)||this;return i.flexAttributes={a_position:{data:new ie(Uint16Array),size:e?2:3},a_size:{data:new ie(Uint8Array),size:2},a_texcoord:{data:new ie(Uint16Array),size:2}},i.first=0,i}return r(e,t),e}(xi),wi=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this,e,!0)||this;return i.flexAttributes={a_position:{data:new ie(Float32Array),size:e?2:3}},i.first=0,i}return r(e,t),e.prototype.setIdOffset=function(t){var e;null===(e=this.idOffsets)||void 0===e||e.push(this.flexAttributes.a_position.data.length,t)},e.prototype.rayIntersects=function(t,e,i,r,n){for(var o,a=t.attributes,s=a.a_position.data,l=a.a_position.size,u=n.origin,h=n.direction,f=[0,0,0],c=[0,0,0],p=[0,0,0],d=null,v=0,g=t.groups;v<g.length;v++){var y=g[v],m=null===(o=y.index)||void 0===o?void 0:o.data,x=null;if(y.mode!=Gt.MODE_GL_LINES){for(var _=0;_<m.length;_+=3){var w=m[_]*l,b=m[_+1]*l,T=m[_+2]*l;f[0]=i+s[w],f[1]=r+s[w+1],f[2]=3==l?-s[w+2]:0,c[0]=i+s[b],c[1]=r+s[b+1],c[2]=3==l?-s[b+2]:0,p[0]=i+s[T],p[1]=r+s[T+1],p[2]=3==l?-s[T+2]:0;var L=he.rayIntersectsTriangle(u,h,f,c,p);L&&L<e.z&&(x=w,e.z=L)}if(null!=x){_=0;for(var S=t.idOffsets,M=S.length;_<M;_+=2)if(x<S[_]){d=S[_+1];break}}}}return d},e}(ee),bi=function(t){function e(){var e=t.call(this,!1)||this;return e.flexAttributes.a_normal={data:new ie(Int8Array),size:2,normalized:!0},e}return r(e,t),e}(wi),Ti=new Map;[[hi,hi,hi],[hi,hi,65154],[hi,hi,65156],[hi,hi,65158],[hi,hi,65160],[65163,65164,65162],[hi,hi,65166],[65169,65170,65168],[hi,hi,65172],[65175,65176,65174],[65179,65180,65178],[65183,65184,65182],[65187,65188,65186],[65191,65192,65190],[hi,hi,65194],[hi,hi,65196],[hi,hi,65198],[hi,hi,65200],[65203,65204,65202],[65207,65208,65206],[65211,65212,65210],[65215,65216,65214],[65219,65220,65218],[65223,65224,65222],[65227,65228,65226],[65231,65232,65230],hi,hi,hi,hi,hi,[1600,1600,1600],[65235,65236,65234],[65239,65240,65238],[65243,65244,65242],[65247,65248,65246],[65251,65252,65250],[65255,65256,65254],[65259,65260,65258],[hi,hi,65262],[hi,hi,65264],[65267,65268,65266]].forEach(function(t,e){Ti.set(1569+e,t&&{initial:t[0],medial:t[1],final:t[2]})}),Ti.set(1662,{initial:64344,medial:64345,final:64343}),Ti.set(1740,{initial:64510,medial:64511,final:64509}),Ti.set(1670,{initial:64380,medial:64381,final:64379}),Ti.set(1705,{initial:64400,medial:64401,final:64399}),Ti.set(1711,{initial:64404,medial:64405,final:64403}),Ti.set(1688,{final:64395});var Li,Si=new Set([1552,1554,1555,1556,1557,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1648,1750,1751,1752,1753,1754,1755,1756,1759,1760,1761,1762,1763,1764,1767,1768,1770,1771,1772,1773]),Mi={1570:{isolated:65269,final:65270},1571:{isolated:65271,final:65272},1573:{isolated:65273,final:65274},1575:{isolated:65275,final:65276}},Ai=function(t,e,i){for(var r=i>0?t.length-e:e+1,n=1,o=void 0;n<r;n++)if(o=t.charCodeAt(e+i*n),!Si.has(o))return{cp:o,map:Ti.get(o)}},zi=function(t){var e;if(!function(t){return/[\u0600-\u06FF]/.test(t)}(t))return t;for(var i="",r=0;r<t.length;++r){var n=t.charCodeAt(r);if(Ti.has(n)){var o=null===(e=Ai(t,r,-1))||void 0===e?void 0:e.map;!o||o.initial||o.medial||(o=hi);var a,s=Ai(t,r,1),l=null==s?void 0:s.map;if(!l||l.medial||l.final||(l=hi),a=1604==n&&Mi[null==s?void 0:s.cp])n=o?a.final:a.isolated,r++;else{var u=Ti.get(n);o&&l&&u.medial?n=u.medial:o&&u.final?n=u.final:l&&u.initial&&(n=u.initial)}}i+=String.fromCharCode(n)}return i},Pi=function(t,e,i,r){if(r){t.buffer||(t.buffer=new wi(!1),t.isVerticalLine=!0);var n=t.buffer.flexAttributes.a_position.data;return n.push(e,i,0,e,i,r),n.length}},Ii=function(t){function e(e){var i=t.call(this,!1)||this;return i.flexAttributes.a_point={data:new ie(Uint8Array),size:3},i.flexAttributes.a_normal={data:new ie(Int8Array),normalized:!0,size:3},i}return r(e,t),e.prototype.rayIntersects=function(t,e,i,r,n){var o=t.attributes,a=o.a_position.data,s=o.a_position.size,l=o.a_point.data,u=n.getInverseScale(!0),h=u[0],f=u[1],c=u[2],p=null,d=6*s*6,v=mi(t,n.scale),g=v[0],y=v[1],m=v[2];g*=h,y*=f,m*=c;for(var x=0,_=a.length;x<_;x+=d){var w=i+.03125*a[x]+g,b=r+.03125*a[x+1]+y,T=(3==s?-gi(a[x+2]):0)-m,L=(l[x]>>1)*h,S=(l[x+1]>>1)*f,M=(l[x+2]>>1)*c,A=n.intersectAABBox(w-L,b-S,T-M,w+L,b+S,T+M);null!=A&&A<e.z&&(e.z=A,p=x)}if(null!=p)return t.idOffsets[Math.floor(p/d)]},e}(xi),Ei=function(t,e,i){var r=e[0]-t[0],n=e[1]-t[1],o=e[2]-t[2],a=i[0]-t[0],s=i[1]-t[1],l=i[2]-t[2];return[Math.floor(127*(n*l-o*s)),Math.floor(127*(o*a-r*l)),Math.floor(127*(r*s-n*a))]},Ci=function(t,e,i,r,n,o,a){Li=Li||function(t,e,i,r,n,o,a){void 0===t&&(t=8),void 0===e&&(e=6),void 0===i&&(i=0),void 0===r&&(r=2*Math.PI),void 0===n&&(n=0),void 0===o&&(o=Math.PI),void 0===a&&(a=1);for(var s=Math.min(n+o,Math.PI),l=[],u=[],h=[],f=0,c=0;c<=e;c++){for(var p=[],d=c/e,v=0;v<=t;v++){var g=v/t,y=Math.sin(n+d*o);h.push(-Math.cos(i+g*r)*y*a,Math.cos(n+d*o)*a,-Math.sin(i+g*r)*y*a),p.push(f++)}l.push(p)}var m=[];for(c=0;c<e;c++)for(v=0;v<t;v++){var x=l[c][v+1],_=l[c][v],w=l[c+1][v],b=l[c+1][v+1];if(0!==c||n>0){u.push(x,_,b);var T=h.slice(3*x,3*x+3),L=h.slice(3*_,3*_+3),S=h.slice(3*b,3*b+3),M=Ei(T,L,S);m.push.apply(m,M),m.push.apply(m,M),m.push.apply(m,M)}if(c!==e-1||s<Math.PI){u.push(_,w,b),L=h.slice(3*_,3*_+3);var A=h.slice(3*w,3*w+3);S=h.slice(3*b,3*b+3),M=Ei(L,A,S),m.push.apply(m,M),m.push.apply(m,M),m.push.apply(m,M)}}for(var z=[],P=0,I=u;P<I.length;P++){var E=I[P];z.push(127+Math.floor(127*h[3*E]),127+Math.floor(127*h[3*E+1]),127+Math.floor(127*h[3*E+2]))}return{normals:z,surfaceNormals:m}}(16,12),t*=32,e*=32,i=Math.round(i/9e3*65535);for(var s=Li.normals,l=Li.surfaceNormals,u=0;u<s.length;u+=3)n.push(t,e,i),o.push(s[u],s[u+1],s[u+2]),null==a||a.push(l[u],l[u+1],l[u+2])},ki=function(t){function e(e){var i=t.call(this,!1)||this;return i.cullFace=1029,i.flexAttributes.a_point={normalized:!0,data:new ie(Uint8Array),size:3},i}return r(e,t),e.prototype.rayIntersects=function(t,e,i,r,n){var o=t.attributes,a=o.a_position.data,s=o.a_position.size,l=n.getInverseScale(!0),u=l[0],h=l[1],f=l[2],c=t.uniforms.u_radius[0],p=[c*u,c*h,c*f],d=mi(t,n.scale),v=d[0],g=d[1],y=d[2];v*=u,g*=h,y*=f;for(var m=null,x=1056*s,_=[0,0,0],w=0,b=a.length;w<b;w+=x){_[0]=i+.03125*a[w]+v,_[1]=r+.03125*a[w+1]+g,_[2]=(3==s?-gi(a[w+2]):0)-y;var T=n.intersectEllipsoid(_,p);null!=T&&T<e.z&&(e.z=T,m=w)}if(null!=m)return t.idOffsets[Math.floor(m/x)]},e}(Ii),Di=function(){function t(t,e,i,r){this.pendingCollisions=[],this.gl=t,this.icons=e,this.dpr=r,this.dashes=new fi(t),this.collisions=i,this.lineFactory=new di(t)}return t.prototype.init=function(t,e,i,r){this.tile=t,this.groups=e,this.tileSize=i,this.z=r,this.lineFactory.initTile(),this.pendingCollisions.length=0},t.prototype.createPoint=function(t,e,i,r,n,o,a,s,l,u,h,f){void 0===l&&(l=0);var c,p,d,v=null===n,g=this.z;if(l=(l+360)%360,"Text"==t){e.texture||(e.texture=new te(this.gl,e.shared),e.buffer=new vi(v,null!=u));var y=e.texture,m=e.buffer.flexAttributes;y.addChars(h);var x=y.getAtlas(),_=X("lineWrap",o,a,g);null==_&&(_=f);var w=S(h,_);d=(p=(c=m.a_position).data.length)+y.bufferLength(h,v?2:3),function(t,e,i,r,n,o,a,s,l,u){void 0===l&&(l=0);var h=r.length,f=s.lineHeight,c=32*(s.baselineOffset+(h-1)*f*.5);t=64*t<<1|1,e=64*e<<1|1,l=Math.round(1024*l/360);var p=null!==i,d=2,v=null==u?2:3;p&&(i=Math.round(i/9e3*65535),d=3);for(var g=o.length/d,y=0,m=r;y<m.length;y++){var x=m[y],_=Qt(x,s,n,a,l,u),w=_.width*s.scale/2*32,b=_.count*d;o.reserve(b);for(var T=n.data,L=o.data,S=g+b/d;g<S;g++)T[g*v]-=w,T[g*v+1]-=c,L[g*d]=t,L[g*d+1]=e,p&&(L[g*d+2]=i);o.length+=b,c-=32*f}}(i,r,n,w,m.a_point.data,m.a_position.data,m.a_texcoord.data,x,l,u)}else{if("Icon"==t){e.buffer||(e.buffer=new _i(v)),m=e.buffer.flexAttributes;var b=X("src",o,a,g),T=X("width",o,a,g),L=X("height",o,a,g)||T,M=this.icons.get(b,T,L);if(!M)return void(this.iconsLoaded=!1);c=m.a_position,function(t,e,i,r,n,o,a,s,l,u){void 0===u&&(u=0);var h=r.u1,f=r.u2,c=r.v1,p=r.v2;Ee(t,e,i,s);var d=(u=Math.round(1024*u/360))>>5,v=31&u;h=h<<5|v,f=f<<5|v,c=c<<5|d,p=p<<5|d,a.push(n,o,n,o,n,o,n,o,n,o,n,o),l.push(h,p,h,c,f,c,h,p,f,c,f,p)}(i,r,n,M,T,L,m.a_size.data,c.data,m.a_texcoord.data,l),e.texture=this.icons.getTexture()}else if("Circle"==t||"Rect"==t)e.buffer||(e.buffer=new xi(v)),c=e.buffer.flexAttributes.a_position,Ee(i,r,n,c.data);else if("Sphere"==t)T=2*X("radius",o,a,g),e.buffer||(e.buffer=new ki(v)),c=e.buffer.flexAttributes.a_position,Ci(i,r,n,0,c.data,e.buffer.flexAttributes.a_point.data,e.buffer.flexAttributes.a_normal.data);else{if("Box"!=t)return void(n>0&&"VerticalLine"==t&&Pi(e,i,r,n));T=X("width",o,a,g),L=X("height",o,a,g)||T;var A=X("depth",o,a,g)||T;e.buffer||(e.buffer=new Ii(v)),function(t,e,i,r,n,o,a,s,l){t*=32,e*=32,"number"==typeof i?(i=Math.round(i/9e3*65535),a.push(t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i,t,e,i)):a.push(t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e,t,e),s.push(0|r,1|n,1|o,1|r,1|n,1|o,0|r,1|n,0|o,0|r,1|n,0|o,1|r,1|n,1|o,1|r,1|n,0|o,0|r,0|n,0|o,1|r,0|n,1|o,0|r,0|n,1|o,1|r,0|n,0|o,1|r,0|n,1|o,0|r,0|n,0|o,0|r,1|n,0|o,0|r,0|n,0|o,0|r,1|n,1|o,0|r,0|n,0|o,0|r,0|n,1|o,0|r,1|n,1|o,1|r,1|n,0|o,1|r,1|n,1|o,1|r,0|n,0|o,1|r,0|n,0|o,1|r,1|n,1|o,1|r,0|n,1|o,0|r,0|n,1|o,1|r,1|n,1|o,0|r,1|n,1|o,0|r,0|n,1|o,1|r,0|n,1|o,1|r,1|n,1|o,0|r,0|n,0|o,1|r,1|n,0|o,0|r,1|n,0|o,0|r,0|n,0|o,1|r,0|n,0|o,1|r,1|n,0|o),l&&l.push(0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1)}(i,r,n,T,L,A,(c=e.buffer.flexAttributes.a_position).data,e.buffer.flexAttributes.a_point.data,e.buffer.flexAttributes.a_normal.data)}p=(d=c.data.length)-12}e.buffer.setIdOffset(a.id),s&&c&&s.attrs.push({buffer:c,start:p,stop:d})},t.prototype.create=function(t,e,i,r,n,o,a,s){var l,u,h,f,c,p,d,v,g,y,m,x,w,b,T,L,S,M,A,z,I,E,C,k,D,O,R,F,U,N,B,G,W,H,j,V,q,Q,J,$,tt,et,it,rt=this,nt=this.tile,ot=this.groups,at=this.tileSize,st=this.z,lt=Number.MAX_SAFE_INTEGER,ut=-Number.MAX_SAFE_INTEGER,ht="";if(this.iconsLoaded=!0,this.lineFactory.initFeature(st,at,null==s?void 0:s.id),void 0===a&&"Point"===e&&!nt.isInside(i))return this.iconsLoaded;for(var ft=0,ct=r.length;ft<ct;ft++)if(m=r[ft],(w=X("type",m,t,st))&&0!==(b=X("opacity",m,t,st))){var pt="Polygon"==e||X("collide",m,t,st);if(null!=a||("Text"!=w||pt)&&!1!==pt){(null==b||b>=.98)&&(b=1),"Image"==w&&(w="Icon"),T=void 0,L=void 0,A=void 0,S=void 0,z=void 0,I=void 0,E=void 0,C=void 0,k=void 0,R=void 0,F=void 0,W=0,H=0,V=void 0,Q=void 0,q=n,J="px",$=void 0;var dt=!0,vt=!1;M=0^X("rotation",m,t,st);var gt=X("altitude",m,t,st);if("Icon"==w)N=(gt?"AI":"I")+((Q=X("alignment",m,t,st)||"viewport")||""),vt=!0;else{if(A=X("stroke",m,t,st),I=X("strokeWidth",m,t,st),"VerticalLine"==w)N="VL"+A+(j=X("offsetZ",m,t,st)||0),null==gt&&(gt=!0);else if("Line"==w){if(!A||!I)continue;var yt=Y(I);I=yt[0],J=yt[1],C=X("strokeLinecap",m,t,st)||"round",k=X("strokeLinejoin",m,t,st)||"round",(E=X("strokeDasharray",m,t,st))instanceof Array&&E.length&&E[0]||(E=void 0);var mt=X("offset",m,t,st);N=(gt?"AL":"L")+J+(W=(l=Y(mt))[0])+($=l[1])+C+k+(E||"*")}else if(L=X("fill",m,t,st),"Polygon"==w){if(!L||"Polygon"!=e)continue;D=X("extrude",m,t,st),O=X("extrudeBase",m,t,st),"number"==typeof D||O?(N="E",w="Extrude"):N="P"}else{if("Polygon"==e)continue;if(Q=X("alignment",m,t,st),"Text"==w){if(!(V=Z(m,t,st)))continue;V=zi(V),null==Q&&(Q="Point"==e?"viewport":"map"),N="T"+((T=X("font",m,t,st)||_)||"*")}else if("Circle"==w)R=F=X("radius",m,t,st),R=(u=Y(R))[0],N=(gt?"AC":"C")+(J=u[1])+R||"*";else if("Rect"==w)R=X("width",m,t,st),R=(h=Y(R))[0],J=h[1],F=(F=X("height",m,t,st))?Y(F)[0]:R,N=(gt?"AR":"R")+M+J+R+F;else if("Box"==w)dt=X("pointerEvents",m,t,st),N="B"+M+dt;else{if("Sphere"!=w)continue;R=F=X("radius",m,t,st),R=(f=Y(R))[0],J=f[1],N="S"+R+(dt=X("pointerEvents",m,t,st))}vt=!0,N+=Q||""}L&&((S=P(L))?S[3]*=b:L=null),A&&((z=P(A))?z[3]*=b:A=null,"Text"==w&&(q=1),("number"!=typeof I||(I*=q)<0)&&(I=1)),N+=(A||"*")+(I||"*")+(L||"*")}vt&&(W=X("offsetX",m,t,st),H=X("offsetY",m,t,st),j=X("offsetZ",m,t,st),$=new Array(3),W=(c=Y(W))[0],$[0]=c[1],H=(p=Y(H))[0],$[1]=p[1],j=(d=Y(j))[0],$[2]=d[1],N+=W+(H<<8)+(j<<16)+$[0]+$[1]+$[2]),N+=100*b^0,x=X("zIndex",m,t,st);var xt=X("zLayer",m,t,st);null!=xt&&(N=xt+":"+N);var _t=void 0;if(gt&&((_t=X("depthTest",m,t,st))||(N="ND"+N)),null==(G=(U=ot[x]=ot[x]||{index:{},groups:[]}).index[N])?(G=U.index[N]=U.groups.length,B=U.groups[G]={type:w,zLayer:xt,depthTest:_t,pointerEvents:dt,shared:{unit:J,font:T,fill:S,opacity:b,stroke:z,strokeWidth:I,strokeLinecap:C,strokeLinejoin:k,strokeDasharray:E,width:R,height:F,depth:void 0,rotation:M,offsetX:W,offsetY:H,offsetZ:j,offsetUnit:$,alignment:Q}}):B=U.groups[G],"Point"==e)if("VerticalLine"==w){if(("number"==typeof gt||i[2]>0)&&(Tt="number"==typeof gt?gt:i[2])>0){var wt=nt.lon2x(i[0],at),bt=nt.lat2y(i[1],at);Pi(B,wt,bt,Tt)}}else{wt=nt.lon2x(i[0],at),bt=nt.lat2y(i[1],at);var Tt="number"==typeof gt?gt:gt?i[2]||0:null;if(s){if(!(it=this.collisions.insert(wt,bt,Tt,s.offsetX,s.offsetY,s.width,s.height,nt,at,s.priority)))return this.iconsLoaded;s=null}this.createPoint(w,B,wt,bt,Tt,m,t,it,M,void 0,V)}else if("LineString"==e)if("Line"==w)this.lineFactory.createLine(i,B,nt,at,o,E,C,k,I,gt,W,X("from",m,t,st),X("to",m,t,st)),B.buffer.setIdOffset(t.id);else{var Lt=X("anchor",m,t,st);null==Lt&&(Lt="Text"==w?"Line":"Coordinate");var St="Text"==w?!pt:!1===pt,Mt=void 0,At=void 0;if("Line"==Lt){var zt="map"==Q;if(s)Mt=2*s.width,At=2*s.height;else if("Icon"==w)Mt=X("width",m,t,st),At=X("height",m,t,st)||R;else if("Text"==w){var Pt=B.texture;Pt||(Pt=B.texture=new te(this.gl,m),B.buffer=new vi(!0,!0));var It=Pt.getAtlas();Mt=It.getTextWidth(V),At=It.letterHeight}else Mt=R,At=F,"Circle"==w&&(Mt*=2,At*=2);var Et=X("checkLineSpace",m,t,st);null==Et&&(Et=!0),this.lineFactory.placeAtSegments(i,gt,nt,at,St&&this.collisions,a,X("repeat",m,t,st),W,H,Mt,At,zt,Et,function(e,i,r,n,o,a){rt.createPoint(w,B,e,i,r,m,t,a,n+M,o,V,!1)})}else s?(Mt=s.width,At=s.height):(Mt=R/2,At=F/2),this.lineFactory.placeAtPoints(i,gt,nt,at,St&&this.collisions,a,Mt,At,W,H,X("from",m,t,st),X("to",m,t,st),function(e,i,r,n,o,a){rt.createPoint(w,B,e,i,r,m,t,a,n+M,void 0,V)})}else if("Polygon"==w||"Extrude"==w){B.buffer||(B.buffer="Polygon"==w?new wi:new bi);var Ct=B.buffer,kt=Ct.index(),Dt=Ct.flexAttributes,Ot=Dt.a_position.data;if(v=Ot.length,"Extrude"==w){var Rt=void 0;A&&(Rt=B.extrudeStrokeIndex=B.extrudeStrokeIndex||[]),g=Re(Ot,Dt.a_normal.data,kt,i,nt,at,D,O,Rt)}else"Polygon"==w&&(g=ke(Ot,i,nt,at));if(B.buffer.setIdOffset(t.id),!y){var Ft=t.geometry;if(Ft._xyz)y=Ft._xyz;else{y=[];for(var Ut=0,Nt=g;Ut<Nt.length;Ut++)for(var Bt=Nt[Ut],Gt=Bt.dimensions,Wt=Ot.data.subarray(Bt.start,Bt.stop),Zt=Fe.exports(Wt,Bt.holes,Gt),Xt=(Bt.start-v)/Gt,Yt=0,Ht=Zt;Yt<Ht.length;Yt++){var jt=Ht[Yt];y.push(Xt+jt)}nt.clipped||(Ft._xyz=y)}}jt=0;for(var Vt,qt=v/g[0].dimensions;jt<y.length;jt++)Vt=qt+y[jt],Ct.i32=Ct.i32||Vt>65535,kt.push(Vt)}}else{var Kt=K(m,t,st,this.dpr,et);if(Kt){et=Kt||et,(tt=tt||[]).push(m);var Qt=X("priority",m,t,st);Qt<lt&&(lt=Qt);var Jt=X("repeat",m,t,st);Jt>ut&&(ut=Jt),ht+=w+(Qt||"?")+(Jt||"?")}}}if(tt){var $t={id:ht,priority:lt,repeat:ut,styleGrp:tt,feature:t,geomType:e,coordinates:i},ee=et[0],ie=et[1],re=.5*(et[2]-ee),ne=.5*(et[3]-ie);$t.offsetX=ee+re,$t.offsetY=ie+ne,$t.width=re,$t.height=ne,this.pendingCollisions.push($t)}return this.iconsLoaded},t}(),Oi=function(){function t(t){this.timer=null,this.tiles=new Map,this.display=t,this.debug(!1)}return t.prototype.debug=function(t){var i=this;t?this.dbgLayers||(this.dbgLayers=[new e.TileLayer({pointerEvents:!1,min:2,max:28,provider:new e.LocalProvider({})}),new e.TileLayer({pointerEvents:!1,min:2,max:28,provider:new e.LocalProvider({})})],setTimeout(function(){return i.dbgLayers.forEach(function(t){return ln.getInstances().pop().addLayer(t)})},0)):this.dbgLayers&&this.dbgLayers.forEach(function(t){return t.getProvider().clear()}),this.dbg=t},t.prototype.dbgBBoxes=function(t,i,r){for(var n=ln.getInstances().pop(),o=2,a=1,s=0,l=t.boxes;s<l.length;s++){var u=l[s],h=.5*(u.maxX-u.minX),f=.5*(u.maxY-u.minY),c=void 0,p=void 0;if("number"==typeof i){var d=e.webMercator.mapSizePixel(512,i);c=e.webMercator.x2lon(u.maxX-h,d),p=e.webMercator.y2lat(u.maxY-f,d),o=3,a=0}else{var v=n.pixelToGeo(u.minX+h,u.minY+f);c=v.longitude,p=v.latitude,r=i?"orange":"green"}this.dbgLayers[Number("number"!=typeof i)].addFeature({type:"Feature",geometry:{type:"Point",coordinates:[c,p]}},[{zLayer:1e5,zIndex:a,type:"Rect",stroke:r,strokeWidth:o,width:2*h,height:2*f,collide:!0}])}},t.prototype.getTileCacheKey=function(t,e){return 256==e.tileSize?t.slice(0,-1):t},t.prototype.getDataKey=function(t,e){return"".concat(e.id,"-").concat(t)},t.prototype.intersects=function(t,e){for(var i=t.boxes,r=0,n=e;r<n.length;r++)for(var o=0,a=n[r].boxes;o<a.length;o++)for(var s=a[o],l=0,u=i;l<u.length;l++){var h=u[l];if(h.minX<=s.maxX&&s.minX<=h.maxX&&h.minY<=s.maxY&&s.minY<=h.maxY)return!0}},t.prototype.updateBBoxes=function(t,e,i,r,n,o,a){for(var s=0;s<=o;s++){var l=.75*(s/o-.5),u=i[0]*l+t,h=i[1]*l+e;a[s]={minX:u-r,maxX:u+r,minY:h-n,maxY:h+n}}},t.prototype.initTile=function(t,i){var r=[],o=t.quadkey,a=t.x,s=t.y,l=t.z;this.clearTile(o,i),256==i.tileSize&&(l--,s=.5*s^0,a=.5*a^0);for(var u=-1;u<2;u++)for(var h=-1;h<2;h++)if(0!=h||0!=u){var f=e.tileUtils.tileXYToQuadKey(l,s+u,a+h),c=this.tiles.get(f);if(c)for(var p in c)for(var d=0,v=c[p];d<v.length;d++){var g=v[d];r[r.length]=g}}var y=this.getTileCacheKey(o,i);this.curLayerTileCollision={tileKey:y,data:[],dataKey:this.getDataKey(o,i),existing:n({neighbours:r},this.tiles.get(y)||{})},this.updated=!1},t.prototype.insert=function(t,e,i,r,n,o,a,s,l,u,h){void 0===u&&(u=Number.MAX_SAFE_INTEGER);var f,c=s.x,p=s.y,d=s.z;256==l&&(t+=c%2*l,e+=p%2*l,l*=2,c=.5*c^0,p=.5*p^0,d--),c=c*l+r,p=p*l+n,o+=4,a+=4;var v=Math.min(o,a),g=Math.max(o,a),y=Math.floor(g/v);h&&y>1.5?(o=v,a=v,y=Math.floor(.7*y),f=new Array(y),this.updateBBoxes(t+c,e+p,h,v,v,y,f)):f=[{minX:c+t-o,maxX:c+t+o,minY:p+e-a,maxY:p+e+a}];var m={cx:t,cy:e,cz:i,halfWidth:o,halfHeight:a,offsetX:r,offsetY:n,boxes:f,slope:h,priority:u,attrs:[]},x=this.curLayerTileCollision,_=x.data,w=x.existing,b=this.dbg;if(this.intersects(m,_))return!1;for(var T in w)if(this.intersects(m,w[T]))return b&&this.dbgBBoxes(m,d,"darkred"),!1;return this.updated=!0,_.push(m),m},t.prototype.completeTile=function(t){var e=this.curLayerTileCollision,i=e.tileKey,r=e.dataKey,n=e.data,o=this.tiles.get(i)||{};return o[r]=n,this.tiles.set(i,o),this.curLayerTileCollision=null,this.updated&&t&&this.updateTileSync(this.display.getScreenTile(i,512)),this.updated},t.prototype.clearTile=function(t,e){var i,r=this.getTileCacheKey(t,e),n=this.getDataKey(t,e);if((null===(i=this.curLayerTileCollision)||void 0===i?void 0:i.dataKey)!=n){var o=this.tiles.get(r);if(o){for(var a in delete o[n],o)return;this.tiles.delete(r)}}},t.prototype.updateTileSync=function(t){return this.updateTiles([t],this.display.s)},t.prototype.update=function(t,e){var i=this;null==this.timer&&(this.timer=setTimeout(function(){var t=i.display.grid.tiles[512],r=i.display.s;i.updateTiles(t,r),i.timer=null,e&&e()},150))},t.prototype.updateTiles=function(t,e){var i=this.display,r=this.dbg,n=[];r&&this.dbgLayers[1].getProvider().clear();for(var o=0,a=t;o<a.length;o++){var s=a[o],l=s.quadkey,u=this.tiles.get(l);if(u)for(var h in u)for(var f=0,c=u[h];f<c.length;f++){var p=c[f],d=p.attrs,v=p.offsetX/e,g=p.offsetY/e,y=p.boxes.length,m=p.slope,x=p.halfWidth,_=p.halfHeight,w=s.x+p.cx,b=s.y+p.cy,T=void 0;if(y>1){T=new Array(y),w+=v,b+=g;var L=i.project(w,b,0,0,0),S=L[0],M=L[1],A=i.project(w+m[0],b+m[1],0,0,0);m=[(A[0]-S)/e,(A[1]-M)/e],this.updateBBoxes(S,M,m,x,_,T.length-1,T)}else{var z=i.project(w,b,0,0,0);T=[{minX:(S=z[0])-x+v,maxX:S+x+v,minY:(M=z[1])-_+g,maxY:M+_+g}]}n.push({boxes:T,attrs:d,slope:m,priority:p.priority})}}n.sort(function(t,e){return t.priority-e.priority});for(var P=[],I=[],E=0,C=n;E<C.length;E++){var k=C[E],D=void 0,O=this.intersects(k,I);k.slope?D=P:(O||(O=this.intersects(k,P)),D=I),O||(D[D.length]=k);for(var R=0,F=k.attrs;R<F.length;R++){var U=F[R],N=U.buffer,B=U.start,G=U.stop,W=N.data,Z=N.size,X=1==(1&W[B]);if(O&&X||!O&&!X){for(;B<G;)W[B]^=1,B+=Z;N.dirty=!0}}r&&this.dbgBBoxes(k,O)}},t.prototype.removeTiles=function(t){var e=t.id;this.tiles.forEach(function(t){for(var i in t)Number(i.split("-")[0])==e&&delete t[i]})},t}(),Ri=[3,9],Fi=function(t){function i(e,i,r,n){var o=t.call(this,e,i,r||"auto",new Le(512),new _e(n),Ri)||this;o.name="gl-test",o.worldCenter=[0,0],o.dpr<2&&o.buckets.setSize(1024);var a=o;o.collision=new Oi(a),o.buckets.onDrop=function(t,e){var i=this.quadkey,r=this.layers;a.collision.clearTile(i,r[e]),a.releaseBuffers(t)};var s=a.render;return s.init(o.canvas,o.dpr),o.rayCaster=new he(s.screenMat,s.invScreenMat),o.factory=new Di(s.gl,s.icons,o.collision,o.dpr),o.tilesNotReady=[],o.render.icons.onLoad=function(t){for(var e=0,i=o.tilesNotReady;e<i.length;e++){var r=i[e],n=r.quadkey,a=r.layerId,s=o.layers.get(a);if(s){var l=o.buckets.get(n,!0);if(l){var u=s.layer,h=s.index;l.preview(h,!1),l.ready(h,!1),l.cancelTasks(u);var f=u.getCachedTile(l.quadkey);f&&o.getScreenTile(n,s.tileSize)&&o.handleTile(f,u,l,h)}}}o.tilesNotReady=[]},o}return r(i,t),i.prototype.releaseBuffers=function(t){var e=this.render;if(t)for(var i=0,r=t;i<r.length;i++){var n=r[i];e.deleteBuffer(n)}},i.prototype.removeLayer=function(e){return this.collision.removeTiles(this.layers.get(e)),t.prototype.removeLayer.call(this,e)},i.prototype.unproject=function(t,e,i){var r=this.render.invScreenMat;if("number"==typeof i){var n=[t,e,i];return le(n,n,r),n[2]*=-1,n}var o=[t,e,0],a=[t,e,1];le(o,o,r),le(a,a,r);var s=o[2],l=a[2],u=s===l?0:(0-s)/(l-s);return[o[0]*(1-u)+a[0]*u,o[1]*(1-u)+a[1]*u]},i.prototype.project=function(t,e,i,r,n){void 0===i&&(i=0),void 0===r&&(r=this.sx),void 0===n&&(n=this.sy);var o=[t-r,e-n,-i];return le(o,o,this.render.screenMat)},i.prototype.setSize=function(e,i){t.prototype.setSize.call(this,e,i),this.initRenderer()},i.prototype.setTransform=function(t,e,i){var r=2*Math.PI;e=(e+r)%r,this.s=t,this.rz=e,this.rx=i},i.prototype.setView=function(e,i,r,n,o,a){void 0===o&&(o=this.groundResolution),void 0===a&&(a=this.worldSize),t.prototype.setView.call(this,e,i,r,n,o,a),this.groundResolution=o,this.worldCenter[0]=e[0],this.worldCenter[1]=e[1],this.worldSize=a,this.initRenderer()},i.prototype.initRenderer=function(){this.render.gl&&this.render.initView(this.w,this.h,this.s,this.rx,this.rz,this.groundResolution,this.worldCenter[0],this.worldCenter[1],this.worldSize)},i.prototype.prepareTile=function(t,i,r,n,o){var a=this,s=this,l=s.render.gl,u=r.tileSize,h=this.layers.get(r.id);if("image"==t.type&&i instanceof Image){var f=function(t,e,i,r){var n=new Gt({first:0,count:6},"Image"),o=new Int16Array(12);return o[0]=0,o[1]=0,o[2]=i,o[3]=0,o[4]=i,o[5]=i,o[6]=0,o[7]=0,o[8]=i,o[9]=i,o[10]=0,o[11]=i,n.addAttribute("a_position",{data:o,size:2,stride:0}),n.addAttribute("a_textureCoord",{data:new Int8Array(Ie),size:2,stride:0}),n.texture=new mt(e,t),n.addUniform("u_sampler",0),n.zIndex=0,n.scissor=!0,n.blend=r,n.alpha=r?gt.ALPHA:gt.OPAQUE,n}(i,l,u,h.index>0);h.addZ(f.zIndex),n.preview(n.setData(r,[f]),null),o(n,r)}else if(i.length){var c=function(t,i,r,n,o,a,s){var l=i.layer,u={},h=!0,f=Me.create({time:4,priority:4,init:function(){var e=n.z+l.levelOffset,i=l.getStyle(),s=1;if(i){var h=i.strokeWidthZoomScale||i.LineStringZoomScale;h&&(s=h(e))}return a&&a(),o.init(n,u,r,e),[n,t,s,0,16,l,e,!1]},name:"createBuffer",onDone:function(t){var r,o,a,f=t[6],c=1/e.webMercator.getGroundResolution(f),p=[];for(a in u){var d=u[a];if(d)for(var v=0,g=d.groups;v<g.length;v++){var y=g[v],m=y.type,x=y.shared,_=x.stroke,w=x.strokeWidth,b=m;if(o=y.buffer,("Text"!=b||y.texture)&&o&&!o.isEmpty()&&null!=(r=Gt.fromTemplateBuffer(m,o))){if(r.pointerEvents=y.pointerEvents,"VerticalLine"==b&&(r.groups[0].mode=Gt.MODE_GL_LINES,r.type="Polygon",r.addUniform("u_fill",x.stroke),r.addUniform("u_offsetZ",[x.offsetZ,0])),p.push(r),"Line"==m)x.strokeDasharray&&(r.type="DashedLine",r.texture=y.texture,r.addUniform("u_texWidth",y.texture.width),r.addUniform("u_pattern",0)),r.addUniform("u_fill",_),r.addUniform("u_strokeWidth",[.5*w,"m"==x.unit?c:0]),r.addUniform("u_offset",[x.offsetX,"m"==x.offsetUnit?c:0]),r.alpha=1;else if("Polygon"==m||"Extrude"==m)r.addUniform("u_fill",x.fill),"Extrude"==m&&(r.addUniform("u_strokePass",0),r.scissor=!1,x.stroke&&(r.addGroup(y.extrudeStrokeIndex,o.i32,1).uniforms={u_strokePass:1,u_stroke:x.stroke}));else{if("Text"==m||"Icon"==m)r.scissor=o.scissor,r.texture=y.texture,"Text"==m?(r.texture.sync(),r.addUniform("u_fillColor",x.fill||ze),r.addUniform("u_strokeColor",x.stroke||ze)):r.addUniform("u_opacity",x.opacity),r.addUniform("u_texture",0),r.addUniform("u_atlasScale",1/r.texture.width),r.addUniform("u_alignMap","map"==x.alignment);else if("Rect"==m||"Circle"==m||"Box"==m||"Sphere"==m){r.scissor=o.scissor;var T=x.fill||ze;r.addUniform("u_fill",T),_&&(r.addUniform("u_stroke",_),null==w&&(w=1)),r.addUniform("u_strokeWidth",0^w);var L="m"==x.unit?c:0;"Circle"==m||"Sphere"==m?r.addUniform("u_radius",[x.width,L]):(T==ze&&(r.alpha=1,r.blend=!0),r.addUniform("u_size",[x.width,L,x.height,L]),r.addUniform("u_rotation",x.rotation*Ae)),r.addUniform("u_alignMap","map"==x.alignment)}x.offsetUnit&&(r.addUniform("u_offset",[x.offsetX,"m"==x.offsetUnit[0]?c:0,x.offsetY,"m"==x.offsetUnit[1]?c:0]),r.addUniform("u_offsetZ",[x.offsetZ,"m"==x.offsetUnit[2]?c:0]))}r.flat=o.isFlat();var S=x.fill&&x.fill[3],M=x.stroke&&x.stroke[3],A=S<1,z=A||M<1;z&&(r.alpha=A&&"Extrude"==m||!r.flat&&"Line"==m?2:1,r.blend=!0,r.depth=!0);var P=y.zLayer;"top"==a&&(P=1/0,a=0),a=Number(a),r.flat||(r.scissor=!1,null!=y.depthTest&&(r.depth=y.depthTest,r.alpha||(r.alpha=1))),i.addZ(a,!r.flat),r.zIndex=a,r.zLayer="number"==typeof P?Math.ceil(P):null,null==r.scissor&&(r.scissor=!n.clipped||l.getMargin()>0||z)}}}s(p.reverse(),h)},exec:function(t){var e,i,r,n=t[0],a=t[1],s=t[2],l=t[5],u=a.length,f=t[6],c=!1;if(!t[7]){for(;t[4]--&&(i=a[t[3]++]);)if(e=l.getStyleGroup(i,f)){r=i.geometry.type,e.length||(e=[e]),ot(e);var p=i.getProvider().decCoord(i),d=!0;if("MultiLineString"==r||"MultiPoint"==r)for(var v="MultiPoint"==r?"Point":"LineString",g=0,y=p;g<y.length;g++){var m=y[g];d=d&&o.create(i,v,m,e,s)}else if("MultiPolygon"==r){d=o.create(i,"Polygon",p,e,s);for(var x=0;x<p.length;x++){var _=p[x];d=d&&Pe(o,i,_,e,s,n,x)}}else d=o.create(i,r,p,e,s),"Polygon"==r&&(d=d&&Pe(o,i,p,e,s,n));h=h&&d}c=t[3]<u}if(!c&&o.pendingCollisions.length){t[7]||(t[7]=o.pendingCollisions.sort(function(t,e){return t.priority-e.priority}),t[3]=0);var w=t[7],b=void 0;if(t[4]>=0)for(;t[4]--&&(b=w[t[3]++]);){p=b.coordinates;var T=b.priority,L=b.geomType;if("Point"==L||"LineString"==L){var S=o.create(b.feature,L,p,b.styleGrp,s,!1,T,b);h=h&&S}}c=t[3]<w.length}return t[4]=16,c}});return Me.start(f),f}(i,h,u,t,this.factory,function(){s.collision.initTile(t,h)},function(t,e){n.removeTask(c,r),n.preview(n.setData(r,t),null),e||s.tilesNotReady.push({quadkey:n.quadkey,layerId:r.id}),s.collision.completeTile(!0)&&(a.dirty=!0),o(n,r)});n.addTask(c,r)}else n.preview(n.setData(r,[]),null),o(n,r)},i.prototype.orderBuffers=function(t,e,i,r,n,o){for(var a=0,s=e;a<s.length;a++){var l=s[a],u=l.zLayer,h=l.zIndex;null==u&&(u=i.index+1);var f=1e6*u+h;r[f]=0,t[t.length]={b:l,z:f,data:n,tiled:o}}},i.prototype.viewport=function(t){var e,i,r=this,n=r.buckets,o=r.layers,a=r.render,s=o.length;r.dirty&&(r.dirty=!1,r.collision.update(r.grid.tiles[512],function(){return r.update()})),a.clear(s&&o[0].bgColor||r.globalBgc),a.fixedView=Number(!this.viewChange);for(var l=[],u={},h=0,f=o;h<f.length;h++){var c=f[h],p=c.tiles;if(c.cnt=0,c.layer.tiled){if(p)for(var d=c.index,v=p.length,g=0;g<v;){var y,m=(G=p[g++]).tile,x=null===(e=m.data)||void 0===e?void 0:e[c.index];if(!c.ready&&m.ready(d)&&++c.cnt==v&&(c.ready=!0),x)x.length&&this.orderBuffers(l,x,c,u,{tile:G},!0);else if((y=m.preview(d))&&y.length)for(var _=0,w=y;_<w.length;_++){var b,T=w[_],L=T[0],S=n.get(L,!0);(null==(b=null==S?void 0:S.getData(d))?void 0:b.length)&&this.orderBuffers(l,b,c,u,{tile:G,preview:T,previewTile:S},!0)}}}else{c.ready=!0;var M=c.layer,A=M.renderOptions;this.orderBuffers(l,[{zLayer:A.zLayer,zIndex:A.zIndex,alpha:A.alpha||1,flat:M.flat}],c,u,c.layer,!1)}}for(var z=0,P=0,I=Object.keys(u).sort(function(t,e){return Number(t)-Number(e)});P<I.length;P++)u[C=I[P]]=z++;for(var E=1/0,C=void(g=0),k=void 0;g<l.length;g++)C=(k=l[g]).z=u[k.z],!k.b.flat&&C<E&&(E=C);a.setPass(gt.OPAQUE),a.zIndexLength=z;for(var D=l.length;D--;)(null==(F=l[D])?void 0:F.tiled)&&a.draw(F,E);a.setPass(gt.ALPHA),l=l.sort(function(t,e){return 10*(t.z-e.z)+t.b.alpha-e.b.alpha});var O=0;do{var R=!1;for(D=0,i=l.length;D<i;D++){var F;2==(F=l[D]).b.alpha&&(R=!0),(null==F?void 0:F.z)==O&&(F.tiled?a.draw(F,E):a.drawCustom(F.data,F.z))}a.pass==gt.POST_ALPHA?a.setPass(gt.ALPHA):R&&(a.setPass(gt.POST_ALPHA),O--)}while(++O<z);if(a.tileGrid)for(var U in r.tiles)if((p=r.tiles[U]).length){for(var N=0,B=p;N<B.length;N++){var G=B[N];a.drawGrid(G.x,G.y,G.tile,Number(U))}break}},i.prototype.destroy=function(){t.prototype.destroy.call(this)},i.prototype.getRenderedFeatureAt=function(t,e,i){var r=this.tiles;for(var n in this.rayCaster.init(t,e,this.w,this.h,this.s,1/this.groundResolution),r)for(var o=0,a=r[n];o<a.length;o++)for(var s=a[o],l=s.x,u=s.y,h=s.tile,f=h.data,c=0;c<f.length;c++){var p=h.layers[c].layer,d=f[c],v=i.indexOf(p);if(d&&-1!=v)for(var g=0,y=d;g<y.length;g++){var m=y[g];m.isFlat()||this.rayCaster.intersect(l,u,m,v)}}var x=this.rayCaster.getIntersectionTop();return this.viewport(!0),x},i.prototype.viewChangeDone=function(){this.viewChange=!1,this.update()},i.zoomBehavior="float",i}(ct),Ui=new yt,Ni=2*Math.PI,Bi=Math.PI/180,Gi=Math.log(2048)/Math.log(2),Wi=Gi+9,Zi=function(t,e,i,r,n,o,a,s,l,u,h,f){var c=a.z;e+=0^X("offsetX",r,n,c),i+=0^X("offsetY",r,n,c);var p,d,v,g,y,m,x=X("rotation",r,n,c),_=e+512<<Gi|i+512^0|(x+360)%360<<Wi;h[_]||(h[_]=1,x&&(x*=Bi,l.translate(e,i),l.rotate(x),y=e,m=i,e=0,i=0),"Text"==t?(r.stroke&&0!=r.strokeWidth&&l.strokeText(o,e,i),r.fill&&l.fillText(o,e,i)):"Circle"==t?(d=X("radius",r,n,c),l.moveTo(e+d,i),l.arc(e,i,d,0,Ni,!1)):(e-=(v=X("width",r,n,c))/2,i-=(g=X("height",r,n,c)||v)/2,"Image"==t?(p=X("src",r,n,c),Ui.isReady(p)?l.drawImage(Ui.get(p),e,i,v,g):Ui.get(p,function(){return f.updateTile(a,s,u)},a.quadkey)):"Rect"==t&&l.rect(e,i,v,g)),x&&(l.rotate(-x),l.translate(-y,-m)))},Xi=Math,Yi=function(){function t(){this.o=.5}return t.prototype.init=function(t){return this.o=t,!0},t.prototype.createSymbol=function(t,e){return t-("Circle"==e.type?e.radius:e.width)>0},t.prototype.drawSymbol=function(t,e,i,r,n,o,a,s,l,u,h){Zi(n.type,e,i,n,a,!1,o,s,r,l,u,h)},t.prototype.angle=function(t,e){return Math.atan2(t,e)},t.prototype.place=function(t,e,i,r,n,o,a,s,l,u){for(var h,f,c,p,d,v,g,y,m,x,_=this.o,w=0;w<t.length;w++)c=Math.round(e.lon2x(t[w][0])),p=Math.round(e.lat2y(t[w][1])),w&&(m=c-h,x=p-f,d=Xi.sqrt(Xi.pow(m,2)+Xi.pow(x,2))-16,(v=this.createSymbol(d,n))&&(g=(m*_+h)*u,y=(x*_+f)*u,i.setTransform(u,0,0,u,g,y),i.rotate(this.angle(x,m)),i.translate(-g,-y),this.drawSymbol(v,g,y,i,n,e,r,o,a,s,l),i.setTransform(u,0,0,u,0,0))),h=c,f=p},t}(),Hi=function(t){function e(e){var i=t.call(this)||this;return t.prototype.init.call(i,.5),i.setCharWidth(e),i}return r(e,t),e.prototype.setCharWidth=function(t){this.cw=t},e.prototype.init=function(t){return"string"!=typeof t&&(t=String(t)),this.lw=t.length*this.cw,this.label=t,!0},e.prototype.angle=function(t,e){return Math.atan(t/e)},e.prototype.createSymbol=function(t){var e,i,r=this.label,n=this.cw,o=this.lw,a=Math.floor(t/o);return a>0&&(e=r,a>1&&(a=1+Math.floor((a-1)/8),i=new Array(Math.floor(1.5*(t-o)/n/a)).join(" "),e=r+new Array(a).join(i+r))),e},e.prototype.drawSymbol=function(t,e,i,r,n){n.stroke&&r.strokeText(t,e,i),n.fill&&r.fillText(t,e,i)},e}(Yi),ji=function(t,e,i){var r,n,o,a,s=t.length-1;for(e.moveTo(o=Math.round(i.lon2x(t[s][0])),a=Math.round(i.lat2y(t[s][1])));s--;)r=Math.round(i.lon2x(t[s][0])),n=Math.round(i.lat2y(t[s][1])),(o-r||a-n)&&e.lineTo(o=r,a=n)},Vi=[],qi=new Hi(L({font:_}).width),Ki=new Yi,Qi=function(t,e,i){t.globalAlpha=null==e.opacity?1:e.opacity;var r,n,o=e.font,a=e.stroke;if(a&&(t.strokeStyle=a,o&&(i=1),(r=e.strokeWidth)&&"number"==typeof r||(r=1),t.lineWidth=r*i),e.fill&&(t.fillStyle=e.fill),o){var s=e.font||_;qi.setCharWidth(L(e).width),t.font=s,t.textAlign=e.textAlign||"center",t.textBaseline=e.textBaseline||"middle"}else t.lineCap=e.strokeLinecap||"round",t.lineJoin=e.strokeLinejoin||"round",(n=e.strokeDasharray)instanceof Array?t.setLineDash(n):t.setLineDash(Vi),(e.fill||e.stroke)&&t.beginPath();return!0},Ji=function(t,e,i,r,n,o,a,s,l,u){var h=i.getProvider().decCoord(i),f=i.geometry.type,c=t.z,p=X("type",n,i,c);if("LineString"==f){if("Circle"==p||"Rect"==p||"Image"==p){var d=X("offset",n,i,c);if(null!=d)return Ki.init(d),void Ki.place(h,t,e,i,n,o,a,s,l,u);f="MultiPoint"}}else if(("Polygon"==f||"MultiPolygon"==f)&&"Polygon"!=p&&"Line"!=p){var v=i.bbox;return Zi(p,Math.round(t.lon2x(v[0]+(v[2]-v[0])/2)),Math.round(t.lat2y(v[1]+(v[3]-v[1])/2)),n,i,r,t,o,e,a,s,l)}if("Point"==f)Zi(p,Math.round(t.lon2x(h[0])),Math.round(t.lat2y(h[1])),n,i,r,t,o,e,a,s,l);else if("Text"==p){if(!qi.init(r))return;if("MultiLineString"==f)for(var g=0;g<h.length;g++)qi.place(h[g],t,e,i,n,o,a,s,l,u);else"LineString"==f&&qi.place(h,t,e,i,n,o,a,s,l,u)}else if("LineString"==f)ji(h,e,t);else if("Polygon"==f||"MultiLineString"==f)for(var y=0;y<h.length;y++)ji(h[y],e,t);else if("MultiPolygon"==f)for(g=0;g<h.length;g++)for(y=0;y<h[g].length;y++)ji(h[g][y],e,t);else if("MultiPoint"==f)for(var m=h.length;m--;)Zi(p,Math.round(t.lon2x(h[m][0])),Math.round(t.lat2y(h[m][1])),n,i,r,t,o,e,a,s,l)},$i=function(){function t(t,e,i){this.tm=t,this.exclusiveTimeMS=i,this.dpr=e}return t.prototype.spawn=function(t,e,i,r,n,o,a,s,l){var u=this.createTask(t,e,i,r,n,i.bounds,o,a,s,l);return this.tm.start(u),u},t.prototype.createTask=function(t,e,i,r,n,o,a,s,l,u){var h=this.dpr,f=n.index(r),c=n.getContext(f);return this.tm.create({priority:t,delay:u,time:this.exclusiveTimeMS,init:function(){if(!l){c.setTransform(h,0,0,h,0,0);var t=r.getStyle().backgroundColor;t?(c.fillStyle=t,c.globalAlpha=1,c.fillRect(0,0,256,256)):c.clearRect(0,0,256,256)}return{tile:i,ctx:c,data:a,lI:0,gI:0,fI:0,style:void 0,dTile:n,layer:r,bI:100}},onDone:function(){n.dirty(f),s(c,this)},exec:function(t){var i,r=t.tile,n=t.data,o=n.length;if(o){for(;!(i=n[t.lI])&&t.lI<o;)++t.lI;if(i){var a=i[t.gI];if(a){var s=t.ctx,l=a.shared,u=null!=l.font;if(t.style!=l){t.style=l;var f=Qi(s,l,n.swzs);if(t.pmap={},!f)return t.fI=0,t.gI++,t.bI=100,this.CONTINUE}for(;t.bI--;){var c=t.fI++,p=a.data,d=p.features[c];if(!d){u?s.setTransform(h,0,0,h,0,0):(l.fill&&s.fill(),l.stroke&&(l.strokeWidth||null==l.strokeWidth)&&s.stroke()),t.fI=0,t.gI++;break}var v=p.styles[c],g=void 0;u&&!(g=Z(v,d,r.z))||Ji(r,s,d,g,v,t.dTile,t.layer,t.pmap,e,h)}}else t.fI=0,t.gI=0,t.lI++;return t.bI=100,this.CONTINUE}}}})},t}(),tr=function(){function e(e,i){this.dpr=1,this.debug=!1,this.rz=0,this.sx=0,this.sy=0,this.s=1;var r=t.TaskManager.getInstance(),n=this;n.ts=e,n.dpr=i,n.painter=new $i(r,i,4)}return e.prototype.drawGrid=function(t,e,i){var r=i+"  L"+i.length,n=this.ctx;n.strokeRect(t,e,256,256),n.strokeText(r,t+8,e+16),n.fillText(r,t+8,e+16)},e.prototype.applyTransform=function(){var t=this,e=t.s,i=t.rz;if(t._s!=e||t._rz!=i){t._s=e,t._rz=i;var r=t.ctx,n=t.canvas,o=n.width,a=n.height,s=o/2-t.sx,l=a/2-t.sy,u=t.dpr;r.setTransform(1,0,0,1,o/2,a/2),r.rotate(i),r.translate(-o/2+s,-a/2+l),r.scale(e,e),r.translate(-s,-l),r.scale(u,u)}},e.prototype.init=function(t){var e=t.getContext("2d",{alpha:!1});e.font="bold 14px Arial",e.lineWidth=3,e.strokeStyle="red",e.fillStyle="white",e.textAlign="start",e.textBaseline="alphabetic",this.ctx=e,this.canvas=t},e.prototype.setBuckets=function(t){this.buckets=t},e.prototype.clear=function(){},e.prototype.convertColor=function(t){return t},e.prototype.setBackgroundColor=function(t){this.buckets.bgColor(t)},e.prototype.grid=function(t){this.debug=t},e.prototype.setScale=function(t,e,i){var r=this;r.s=t,r.sx=e,r.sy=i},e.prototype.setRotation=function(t,e){this.rz=t},e.prototype.prepare=function(t,e,i,r,n,o){return this.painter.spawn(3,r,e,i,n,t,o)},e.prototype.tile=function(t,e,i){var r=this;e=Math.round(e),i=Math.round(i),r.ctx.drawImage(t.combine(),e,i,256,256),r.debug&&r.drawGrid(e,i,t.quadkey)},e.prototype.preview=function(t,e,i,r){var n=t.getContext(r);n.clearRect(0,0,t.size,t.size);for(var o=0,a=e.length;o<a;o++){var s=e[o],l=this.buckets.get(s[0],!0),u=void 0;l&&(u=l.getData(r))&&(n.setTransform(1,0,0,1,0,0),n.drawImage(u,s[1],s[2],s[3],s[4],0+s[5],0+s[6],s[7],s[8]),t.dirty(r))}},e.prototype.destroy=function(){},e.prototype.getContext=function(){return this.ctx},e}(),er=function(t){function e(e,i,r,n,o){var a=t.call(this)||this,s=r.length;return a.c=new Array(s),a.init(i,r),a.size=n,a.bPool=e,a.ctx=e.claimCtx(n),a.canvas=a.ctx.canvas,a.ctx.fillStyle=o,a}return r(e,t),e.prototype.destroy=function(t){if(null!=t)(e=this.c[t])&&(e.canvas&&this.bPool.releaseCtx(e),this.c[t]=void 0);else for(var e,i=this.c.length;i--;)(e=this.c[i])&&e.canvas&&(this.bPool.releaseCtx(e),this.c[i]=void 0)},e.prototype.init=function(e,i){t.prototype.init.call(this,e,i);var r=i.length;for(this.c.length=r;r--;)this.c[r]=void 0;this._c=!1,this._ready=!1},e.prototype.dirty=function(t,e){var i=this.c[t],r=e!=i;e&&i&&r&&this.destroy(t),e||(r=!0,e=this.c[t]),r&&(this.c[t]=e,this._c=!1)},e.prototype.clear=function(t){var e;(e=this.c[t])&&(e.setTransform&&this.bPool.releaseCtx(e),this.c[t]=void 0,this.preview(t,void 0),this.ready(t,!1),this._c=!1,this.combine())},e.prototype.getContext=function(t){return this.c[t]||(this.c[t]=this.bPool.claimCtx(this.size)),this.c[t]},e.prototype.getData=function(t){return this.c[t]&&(this.c[t].canvas||this.c[t])},e.prototype.combine=function(){var t,e=this,i=e.size;if(!e._c){e._c=!0,e.ctx.fillRect(0,0,i,i);for(var r=0;r<e.c.length;r++)(t=this.getData(r))&&e.ctx.drawImage(t,0,0,i,i)}return e.canvas},e.prototype.addLayer=function(e){t.prototype.addLayer.call(this,e);var i=this;i.c.splice(e,0,void 0),i._c=!1,i._ready=!1},e.prototype.removeLayer=function(e){t.prototype.removeLayer.call(this,e),this.destroy(e),this.c.splice(e,1),this._c=!1},e}(we),ir=[],rr={length:0,max:128,clear:function(){this.length=0},create:function(t){var e=document.createElement("canvas");return e.width=e.height=t,this.length++,e.getContext("2d")},get:function(t){return ir.length?(this.length++,ir.shift()):this.create(t)},release:function(t){t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.lineWidth=1,t.globalAlpha=1,ir.push(t),this.length--}},nr=function(t){function e(e,i){var r=t.call(this,e||256)||this;return r.ctxCache=rr,r._bgc=null,r.tSize=i,r}return r(e,t),e.prototype.bgColor=function(t){this._bgc=t,this.forEach(function(e){e.ctx.fillStyle=t})},e.prototype.clear=function(){this.tiles.clear(),rr.clear()},e.prototype.setSize=function(t){this.tiles.setSize(t)},e.prototype.releaseCtx=function(t){return rr.release(t)},e.prototype.claimCtx=function(t){if(rr.length<rr.max)return rr.get(t);var e=this.tiles.tail.data;return e.destroy(),rr.release(e.ctx),e.ctx=null,e.canvas=null,this.tiles.remove(e.quadkey),e.cancelTasks(),this.claimCtx(t)},e.prototype.create=function(t,e){var i=this.tiles.get(t);return i||(this.tiles.length>=this.tiles.max?((i=this.tiles.tail.data).destroy(),i.init(t,e),i.size=this.tSize):i=new er(this,t,e,this.tSize,this._bgc),this.tiles.set(t,i)),i},e}(Te),or={1:[512,3,512],2:[128,2,128],3:[64,1,128]},ar=function(t,e,i,r,n){var o=Math.sin(n),a=Math.cos(n),s=t-i,l=e-r;return[a*s-o*l+i,o*s+a*l+r]},sr=function(){function t(){this.features=[],this.styles=[]}return t.prototype.add=function(t,e){this.features.push(t),this.styles.push(e)},t}(),lr=function(t){function e(e,i,r,n){var o;i=i||256,r=0^ct.getPixelRatio(r);var a=or[r][1],s=new tr(i*r,r),l=or[r][0],u=new nr(l,i*r);return s.setBuckets(u),o=t.call(this,e,i,r,u,s,a)||this,s.init(o.canvas),o}return r(e,t),e.prototype.preview=function(e,i,r){var n=t.prototype.preview.call(this,e,i,r);return n&&this.render.preview(e,n,i,r),n},e.prototype.prepareTile=function(t,e,i,r,n){var o=this,a=o.render;if("image"==t.type){var s=r.index(i);r.dirty(s,e),n(r,i)}else e.length?r.addTask(o.cluster.spawn(4,i,t,e,{},sr,function(e,s){r.removeTask(s,i),null==r&&(r=void 0),r.addTask(a.prepare(e,t,i,o,r,function(t,e){r.removeTask(e,i),n(r,i)}),i)}),i):(s=r.index(i),r.destroy(s),r.dirty(s),n(r,i))},e.prototype.viewport=function(t){var e,i,r=this,n=r.tiles,o=r.render,a=r.layers,s=a.length;for(var l in this.buckets,(this.dirty||t)&&(this.render.clear(),this.dirty=!1),n)if("512"!=l)for(var u=n[l],h=u.length,f=0,c=u;f<c.length;f++){var p=c[f];if(i=(e=p.tile).luTs,p.lrTs!=i||t){p.lrTs=i,o.tile(e,p.x,p.y);for(var d,v=0;v<s;v++)!(d=a[v]).ready&&e.ready(v)&&++d.cnt==h&&(d.ready=!0)}}},e.prototype.addLayer=function(e,i,r){e.tileSize=256;var n=t.prototype.addLayer.call(this,e,i,r);return n&&this.setupTilePool(),n},e.prototype.removeLayer=function(e){var i=t.prototype.removeLayer.call(this,e);return-1!==i&&this.setupTilePool(),i},e.prototype.setSize=function(e,i){var r=this;t.prototype.setSize.call(this,e,i),r.setupTilePool(),r.render._s=void 0,r.setTransform(r.s,r.rz,r.rx)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.buckets.clear()},e.prototype.setupTilePool=function(){var t=this,e=(Math.ceil(t.w/256)+1)*(Math.ceil(t.h/256)+1),i=e,r=or[t.dpr],n=e*t.getLayers().length;i<r[0]&&(i=r[0]),t.buckets.setSize(i),n<r[2]&&(n=r[2]),t.buckets.ctxCache.max=n},e.prototype.update=function(e){t.prototype.update.call(this)},e.prototype.project=function(t,e){var i=this,r=i.s;return ar(t*=r,e*=r,i.w/2,i.h/2,i.rz)},e.prototype.unproject=function(t,e){var i=this,r=i.s,n=i.w/2,o=i.h/2,a=ar(t,e,n,o,-i.rz);return a[0]=(a[0]-n)/r+n,a[1]=(a[1]-o)/r+o,a},e.zoomBehavior="fixed",e}(ct),ur=0===navigator.platform.indexOf("Win")?.0025:.0015,hr=function(){function e(t,e,i,r){var n=this;this.passive=!1;try{var o=Object.defineProperty({},"passive",{get:function(){n.passive=!0}});window.addEventListener("testPassive",null,o),window.removeEventListener("testPassive",null,o)}catch(t){}this.el=t,this.settings=i,this.map=e,this.ams=0^r,this.onSpin=this.onSpin.bind(this)}return e.prototype.onSpin=function(e){var i=this,r=i.settings,n=i.el,o=i.map,a=r.zoom;if(a){var s=-(e=e||t.global.event).deltaY;if(e.deltaMode===e.DOM_DELTA_LINE&&(s*=32.001953125),s){var l=o.getZoomlevel(),u=void 0,h=void 0;"fixed"==a?e.shiftKey?u=l+(s>0?.1:-.1):(u=Math.round(l+(s<0?-1:1)),h=!0):u=l+s*ur;var f=n.getBoundingClientRect();this.zoom(u,e.pageX-f.left,e.pageY-f.top,h)}}e.preventDefault&&e.preventDefault(),e.returnValue=!1},e.prototype.enable=function(){s(this.el,["wheel","DOMMouseScroll"],this.onSpin)},e.prototype.disable=function(){l(this.el,["wheel","DOMMouseScroll"],this.onSpin)},e.prototype.zoom=function(t,e,i,r){var n=this.map,o=this.ams;n.setZoomlevel(t,e,i,r&&o)},e}(),fr=function(t){return t},cr=function(t){return Math.sin(Math.PI*t*.5)},pr=Object.freeze({__proto__:null,linear:fr,easeOut:function(t){return 1-Math.pow(1-t,1.5)},easeOutSine:cr,easeOutCubic:function(t){return 1-(t=1-t)*t*t}}),dr=function(){function t(t,e,i,r,n){this.ts=0,this.af=null,this.from="number"==typeof t?[t]:t,this.to="number"==typeof e?[e]:e,this.duration=i,"function"==typeof r&&(n=r,r="linear"),this.easing=pr[r]||fr,this.animator=n,this.animate=this.animate.bind(this)}return t.prototype.animate=function(){var t=this,e=this.duration,i=Math.min(Date.now()-this.ts,e),r=this.from.map(function(r,n){var o=t.to[n];return r+t.easing(i/e)*(o-r)});this.animator(1==r.length?r[0]:r),i<e?this.af=requestAnimationFrame(this.animate):(this.af=null,this.done())},t.prototype.start=function(){return o(this,void 0,void 0,function(){var t=this;return a(this,function(e){return[2,new Promise(function(e){t.done=e,t.ts?e():(t.ts=Date.now(),t.animate())})]})})},t.prototype.stop=function(){null!=this.af&&(cancelAnimationFrame(this.af),this.af=null)},t}(),vr=function(t,e){var i,r,n=t.targetTouches;if(n){var o=n.length,a=n[o-1],s=void 0;if(o){var l=e.getBoundingClientRect(),u=a.pageX-l.left,h=a.pageY-l.top;o>1?(i=(u+(s=n[o-2]).pageX-l.left)/2,r=(h+s.pageY-l.top)/2):(i=u,r=h)}}else i=t.clientX,r=t.clientY;return[0^i,0^r]},gr=function(t){var e=t.targetTouches,i=e.length,r=e[i-2];if(r){var n=e[i-1],o=r.clientX-n.clientX,a=r.clientY-n.clientY;return 180*Math.atan2(a,o)/Math.PI}},yr=function(e,i,r,n,o){var a=this;this.scrollHandler=new hr(e,i,n,o.zoomAnimationMs);var u,h,f,c,p,d,v,g,y,m,x,_,w,b,T,L=this,S=null,M=Date.now(),A=[],z=[],P=function(t,e,i){var r=o[t];return Math.abs(e-u)>r||Math.abs(i-h)>r},I=function(){v=0,A.length=0,z.length=0};function E(t){var e=1;if(null!=t.scale)return t.scale;var i=t.targetTouches,r=i.length,n=i[r-1],o=i[r-2];if(o){var a=k(n.clientX,n.clientY,o.clientX,o.clientY);null==S&&(S=a),e=a/S}return e}function C(t,e){if(!p){if(!P("minPanMapThreshold",t,e))return!0;r.cancel()}if(d=Date.now(),n.drag&&!i.lockViewport().pan){var o=t-f,a=e-c;v<8?(A[v]=o,z[v]=a,v++):v=0,i.pan(o,a),p=!0}f=t,c=e}function D(t){if(p){var e=Date.now();e-d<25&&r.pan(e,3*A.reduce(function(t,e){return t+e},0),3*z.reduce(function(t,e){return t+e},0))}}var O,R=null;function F(t){I();var r=t.targetTouches,n=r.length,o=vr(t,e);if(f=o[0],c=o[1],u=f,h=c,E(t),p=!1,2==n){O=0;var a=r[n-1],s=r[n-2];_=a.clientX,w=a.clientY,b=s.clientX,T=s.clientY,S=k(_,w,b,T),x=i.getZoomlevel(),g=i.rotate(),y=i.pitch(),m=gr(t)}}function U(t){var r=t.targetTouches,o=r.length,a=vr(t,e),s=E(t);if(o>1){if(n.pitch){if(++O<5)return void t.preventDefault();var l=r[o-1],u=r[o-2],h=w-l.clientY,p=T-u.clientY;if(R||0!=R&&Math.abs(u.clientY-l.clientY)<110&&Math.sign(h)==Math.sign(p))return R=!0,i.pitch(y+.2*h),void t.preventDefault();R=!1}n.zoom&&L.scrollHandler.zoom(x+Math.log2(s),a[0],a[1],!1),n.rotate&&i.rotate(g+gr(t)-m)}C(a[0],a[1]),f=a[0],c=a[1],t.preventDefault()}function N(t){var i=vr(t,e),r=t.targetTouches.length;R=null,i&&(f=i[0],c=i[1],u=f,h=c),r<2&&(S=null);var n=Date.now(),o=n-M;r&&(M=n),E(t),0==r&&1==t.changedTouches.length&&o>350&&D()}var B=null;function G(t){B=t.button,I(),p=!1,s(e,"mousemove",W),g=i.rotate(),y=i.pitch(),f=t.clientX,c=t.clientY,u=f,h=c}function W(t){var e;null===(e=L.resetAnimation)||void 0===e||e.stop();var r=t.clientX,o=t.clientY;0==B?C(r,o):2==B&&(n.rotate&&P("minRotateMapThreshold",r,o)&&i.rotate(g+.25*(f-r)),n.pitch&&P("minPanMapThreshold",r,o)&&i.pitch(y+.1*(c-o)))}function Z(t){if(B=null,l(e,"mousemove",W),p)D();else if(n.rotate){var r=i.rotate();g!=r&&Math.abs(r)<=5&&(L.resetAnimation=new dr(r,0,500,"easeOutSine",function(t){return i.rotate(t)}),L.resetAnimation.start())}}L.scroll=function(t){var e=a.scrollHandler;t?e.enable():e.disable()},L.drag=function(i){var r=i?s:l;setTimeout(function(){r(e,"touchstart",F),r(t.global,"touchend",N),r(e,"touchmove",U),r(e,"mousedown",G),r(t.global,"mouseup",Z)},0)},L.getOptions=function(){return n}},mr=function(){function t(t,e,i,r,n){this.type=t,this.timeStamp=Date.now(),null!=e&&(this.data=this.detail=e),i&&(this.mapX=r,this.mapY=n,this.nativeEvent=i,this.button=i.button)}return t.prototype.stopPropagation=function(){var t=this.nativeEvent;if("mousemove"==t.type||"touchmove"==t.type)return t.stopImmediatePropagation(),t.preventDefault()},t.prototype.toString=function(){return"MapEvent "+this.type},t}(),xr=["pointerup","pointerenter","pointerleave","pointerdown","pointermove","pressmove","tap","dbltap"];function _r(t){return-1!==xr.indexOf(t)}function wr(t,e){var i=e.type;"touchstart"!=i&&"touchmove"!=i&&"touchend"!=i||(e=e.changedTouches[e.changedTouches.length-1]);var r=t.getBoundingClientRect();return[e.pageX-r.left,e.pageY-r.top]}exports.MapEvent=mr;var br,Tr=function(){function e(e,i,r,n){this.disabled={},this.hActive=!1,this.cnt=0,this.el=e,this.cbs=new t.Listener(["click"]);var o,a,s,l,u,h,f=this.disabled,c=!1,p=!1,d=0,v=!1,g=this.cbs;g.sync(!0),xr.forEach(function(t){g.addEvent(t),f[t]=!1});var y=t.TaskManager.getInstance().create({delay:40,priority:5,exec:function(){var t,i,r;i=wr(e,t=h),r=_(i),x("pointermove",t,i,r),r?u?u.feature.id!==r.feature.id&&(x("pointerleave",t,i,u),x("pointerenter",t,i,r)):x("pointerenter",t,i,r):u&&x("pointerleave",t,i,u),u=r,v=!1}});function m(t,e,r,n,o){var a=new mr(t,o,e,r,n);return o&&(a.target=o.feature,a.detail.display=i),a}function x(t,e,i,r){g.trigger(t,[m(t,e,i[0],i[1],r)],!1)}function _(t){return i.getFeatureAt({x:t[0],y:t[1]},{layers:i._layers.filter(function(t){return t.pointerEvents()})})}var w=!1;this.onPointerDown=function(t){var r="touchstart"==t.type;r||!w?(s=i.getCenter(),p=!0,c=!1,o=wr(e,t),a=_(o),x("pointerdown",t,o,a),r&&t.target.parentNode==e&&(w=!0)):w=!1},this.onPointerMove=function(t){var i="mousemove"==t.type;if(!i||!w){var r,s,l;if(p){var u=n.minPanMapThreshold;if(!c&&(s=(r=wr(e,t))[0]-o[0],l=r[1]-o[1],Math.abs(s)<u&&Math.abs(l)<u))return}c=!0,p?a&&g.isListened("pressmove")&&(s=(r=wr(e,t))[0]-o[0],l=r[1]-o[1],g.trigger("pressmove",[m("pressmove",t,r[0],r[1],a),s,l],!1)):i&&(g.isListened("pointerenter")||g.isListened("pointerleave")||g.isListened("pointermove"))&&(h=t,f.pointerenter||f.pointerleave||v||(v=!0,y.start()))}},this.onPointerUp=function(t){if(p){var r=i.getCenter();if(s.longitude==r.longitude&&s.latitude==r.latitude&&t.target.parentNode==e&&(a||!c)){var n=wr(e,t);x("tap",t,n,a),x("pointerup",t,n,a),function(t){var e=Date.now(),i=a&&a.feature;e-d<250&&!c&&l==i&&x("dbltap",t,o,a),l=i,d=e}(t)}p=c=!1}}}return e.prototype.getGlobalHandlers=function(){var t=this,e=t.onPointerDown,i=t.onPointerMove,r=t.onPointerUp;return{touchstart:e,touchmove:i,touchend:r,mousedown:e,mouseup:r,mousemove:i}},e.prototype.enable=function(t){_r(t)&&delete this.disabled[t]},e.prototype.disable=function(t){_r(t)&&(this.disabled[t]=!0)},e.prototype.destroy=function(){var t=this.getGlobalHandlers();if(this.hActive){for(var e in t)l(this.el,e,t[e]);this.hActive=!1}},e.prototype.addEventListener=function(t,e,i){if(_r(t)&&this.cbs.add(t,e,i)){this.cnt++;var r=this.getGlobalHandlers(),n=void 0;if(!this.hActive)for(var o in r){n=r[o];var a=this.el;if("mouseup"==o)for(;a.parentNode;)a=a.parentNode;s(a,o,n),this.hActive=!0}}},e.prototype.removeEventListener=function(t,e,i){var r=this.cbs,n=this.el;if(_r(t)&&r.remove(t,e,i)&&!--this.cnt&&this.hActive){var o=this.getGlobalHandlers();for(var a in o)r.isListened(a)||l(n,a,o[a]);this.hActive=!1}},e}(),Lr=function(t,e,i){for(var r=!1,n=0,o=i.length-1;n<i.length;o=n++){var a=i[n][0],s=i[n][1],l=i[o][0],u=i[o][1];s>e!=u>e&&t<(l-a)*(e-s)/(u-s)+a&&(r=!r)}return r},Sr=function(){function t(t,e){this.map=t,this.dpr=e}return t.prototype.pointToLineDistanceSq=function(t,e,i,r,n,o){var a,s,l,u,h=n-i,f=o-r,c=h*h+f*f,p=-1;0!=c&&(p=((a=t-i)*h+(s=e-r)*f)/c),p<0?(l=i,u=r):p>1?(l=n,u=o):(l=i+p*h,u=r+p*f);var d=t-l,v=e-u;return this.sideOfLine=h*s-a*f<0?-1:1,d*d+v*v},t.prototype.pointInPolygon=function(t,e,i){for(var r=0;r<i.length;r++)if(Lr(t,e,i[r])!=!r)return!1;return!0},t.prototype.pointInBox=function(t,e,i,r,n){for(var o=0,a=t;o<a.length;o++){var s=a[o],l=s[0],u=s[1];if(l>=e&&l<=i&&u>=r&&u<=n)return!0}},t.prototype.linesIntersectBox=function(t,e,i,r,n){for(var o=[[e,n],[i,n],[i,r],[e,r],[e,n]],a=0,s=t.length-1;a<s;a++)for(var l=0;l<o.length-1;l++)if(D(t[a],t[a+1],o[l],o[l+1],!1))return!0},t.prototype.getOffsetLineData=function(t,e,i){for(var r=[],n=function(e){var n=X("offset",e,t,i)||0;if(n&&r.find(function(t){return t.offset==n}))return"continue";r.push({offset:n,width:.5*H("strokeWidth",e,t,i,!0)})},o=0,a=e;o<a.length;o++)n(a[o]);return r.length,r},t.prototype.geometry=function(t,e,i,r,n,o,a,s,l,u){var h,f=!1,c=this.dpr,p=this.map,d=!t&&!e,v=this.screenX,g=this.screenY,y=1;if("Point"==r){if(l=l||Q(n,a,s,c,o,u)){var m=i[0],x=i[1],_=X("alignment",n[0],a,s);if(_&&"viewport"!=_)m=(h=p._g2w(m,x))[0],x=h[1],v=this.worldX,g=this.worldY,y=1/p._s;else{var w=p.geoToPixel(m,x);m=w.x,x=w.y}var b=m+l[0]*y,T=x+l[1]*y,L=m+l[2]*y,S=x+l[3]*y;f=v<=L&&b<=v+t&&g<=S&&T<=g+e}}else if("LineString"==r){l=l||q(n,a,s,o,u);var M=i.length;if(l[0])if(d){var A=p.geoToPixel(i[0][0],i[0][1]),z=this.getOffsetLineData(a,n,s),P=void 0,I=void 0,E=void 0;z.length||(P=Math.pow(.5*l[0],2));for(var C=1;C<M;C++){if(I=p.geoToPixel(i[C][0],i[C][1]),E=this.pointToLineDistanceSq(v,g,A.x,A.y,I.x,I.y),z.length){for(var k=0,D=z;k<D.length;k++){var O=D[k],R=O.offset,F=O.width,U=Math.pow(R-this.sideOfLine*F,2);if(R){if(E>U&&(f=E-Math.pow(R+this.sideOfLine*F,2)<=F*F))break}else if(f=E<=F*F)break}if(f)break}else if(f=E<=P)break;A=I}}else{var N=.5*l[0],B=p.pixelToGeo(v-N,g-N),G=p.pixelToGeo(v+N,g+N),W=B.longitude,Z=G.longitude,Y=G.latitude,H=B.latitude;if(!(f=this.pointInBox(i,W,Z,Y,H)||this.linesIntersectBox(i,W,Z,Y,H)))return!1}}else if("Polygon"==r){var j=!1;if(!n.find(function(t){var e=X("type",t,a,s);return j=j||"Line"==e,"Polygon"==e}))return j&&this.geometry(t,e,i,"MultiLineString",n,o,a,s,null,u);if(d){var K=p.pixelToGeo(v,g),J=K.longitude,$=K.latitude;if(!(f=this.pointInPolygon(J,$,i)))return!1}else{B=p.pixelToGeo(v-t,g-t),G=p.pixelToGeo(v+t,g+t),W=B.longitude,Z=G.longitude,Y=G.latitude,H=B.latitude;for(var tt=0;tt<i.length&&!(f=this.pointInBox(i[tt],W,Z,Y,H));tt++);if(!f){var et=p.pixelToGeo(v,g);if(J=et.longitude,$=et.latitude,!(f=this.pointInPolygon(J,$,i)||this.linesIntersectBox(i[0],W,Z,Y,H)))return!1}}l=l||[V(n,a,s,o)]}else{var it=void 0;if("MultiPolygon"==r?(it="Polygon",l=l||[V(n,a,s,o)]):"MultiPoint"==r?(it="Point",l=l||Q(n,a,s,c,o)):"MultiLineString"==r&&(it="LineString",l=l||q(n,a,s,o)),it){tt=0;for(var rt=i.length;tt<rt;tt++)if(this.geometry(t,e,i[tt],it,n,o,a,s,l,u)){f=!0;break}}}return f&&l},t.prototype.init=function(t,e){var i;this.screenX=t,this.screenY=e,i=this.map._unprj(t,e),this.worldX=i[0],this.worldY=i[1]},t.prototype.feature=function(t,e,i,r,n,o,a){return this.geometry(t,e,i.geometry.coordinates,i.geometry.type,r,n,i,o,null,a)},t}(),Mr=Array.from({length:33},function(t,e){return 32*Math.pow(2,Math.max(0,e-20+3))}),Ar=function(t){return"number"==typeof t},zr=function(){function t(t,e){this.map=t,this.hit=new Sr(t,e)}return t.prototype.getFeaturesInRect=function(t,e,i,r,n,o){var a,s,l,u=this.map,h=this.hit,f=u.getZoomlevel(),c=Mr[Math.ceil(f)],p=0^Math.min(20,f),d={},v=(i-t)/2,g=(r-e)/2,y=t+v,m=e+g,x=180,_=-180,w=180,b=-180;t=(a=u._unprj(t,e))[0],e=a[1],i=(s=u._unprj(i,r))[0],r=s[1];for(var T,L,S,M,A,z,P,I,E=[u._w2g(t-c,e-c),u._w2g(i+c,r+c),u._w2g(t-c,r+c),u._w2g(i+c,e-c)],C=4,k=[];C--;){var D=E[C][0],O=E[C][1];D<x&&(x=D),D>_&&(_=D),O<w&&(w=O),O>b&&(b=O)}T=[x,w,_,b],n&&!Array.isArray(n)&&(n=[]),h.init(y,m);for(var R=n.length;R--;)if(L=null===(l=(S=n[R]).getProvider)||void 0===l?void 0:l.call(S,f),f<=S.max&&f>=S.min&&(null==L?void 0:L.search))for(z=(A=L.search(T)).length;z--;)if(M=A[z],(P=S.getStyleGroup(M,p))&&(I=h.feature(v,g,M,P,R,f,o))){var F=I[I.length-1],U=d[F]=d[F]||[];(U[R]=U[R]||[]).push(M)}for(var N={layer:null,features:null},B=0,G=Object.keys(d).sort(function(t,e){return Number(t)-Number(e)});B<G.length;B++)for(var W=d[G[B]],Z=0,X=void 0;Z<W.length;Z++)if(X=W[Z]){var Y=n[Z];N.layer==Y?N.features=N.features.concat(X):k.push({layer:Y,features:X})}return k},t.prototype.search=function(t,e,i,r,n,o){var a=this.map._layers;if(n=n?n.slice().sort(function(t,e){return Number(a.indexOf(t)>a.indexOf(e))}):a,Ar(t)&&Ar(e)&&Ar(i)&&Ar(r))return this.getFeaturesInRect(t,e,i,r,n,o)},t}(),Pr=t.global.setTimeout,Ir=t.global.setInterval,Er=100,Cr=function(t,e,i){var r;return"function"==typeof Event?r=new Event(t):(r=document.createEvent("Event")).initEvent(t,!0,!0),r.detail=r.data={map:e,layer:i},r},kr=function(){function e(e,i,r){this.watchTimer=null,this.map=e,this.trigger=i,this.renderInfo=r,Er=t.global.__XYZTST_MVCEDelayMs||Er,this.changeWatcher=this.changeWatcher.bind(this),this.readyWatcher=this.readyWatcher.bind(this)}return e.prototype.centerChanged=function(t){return this.center.longitude!=t.longitude||this.center.latitude!=t.latitude},e.prototype.vpChanged=function(t,e,i){var r=this,n=r.viewport,o=r.rz,a=r.rx;return!(n.minLon!=t.minLon||n.maxLon!=t.maxLon||n.minLat!=t.minLat||n.maxLat!=t.maxLat||o!=e||a!=i)},e.prototype.changeWatcher=function(){var t=this,e=t.map,i=t.readyTimer,r=t.watchTimer,n=t.viewport;t.center;var o=e.getViewBounds(),a=e.getCenter(),s=e.rotate(),l=e.pitch(),u="mapviewchange",h={changed:{center:!0}};if(n){if(h.changed.center=this.centerChanged(a),this.vpChanged(o,s,l))return clearInterval(r),this.watchTimer=this.viewport=this.rz=this.rx=null,i&&clearTimeout(i),this.readyTimer=Pr(this.readyWatcher,Er);this.viewport=o,this.rz=s,this.rx=l,this.center=a}else this.triggeredLayers={},u="mapviewchangestart",this.viewport=o,this.rz=s,this.center=a,this.endTriggered=!0;this.trigger(u,h,!0)},e.prototype.readyWatcher=function(){var t,e,i,r=this.map,n=this.triggeredLayers,o=this.renderInfo.getLayers(),a=!0;if(this.endTriggered){this.endTriggered=!1;var s=r.getCenter();this.trigger("mapviewchangeend",{changed:{center:this.centerChanged(s)}},!0)}for(var l=0;l<o.length;l++)if(i=(t=(e=o[l]).layer).id,e.ready){if(!n[i]&&(n[i]=!0,!e.error)){var u=Cr("viewportReady",r,t);t._l.trigger("viewportReady",u,!0)}}else a=!1;a||(this.readyTimer=Pr(this.readyWatcher,Er))},e.prototype.watch=function(t){var e=this.readyTimer,i=this.watchTimer;e&&(clearTimeout(e),this.readyTimer=null),t?i||(this.watchTimer=Ir(this.changeWatcher,33.333333333333336)):i&&(clearInterval(i),this.watchTimer=null)},e}(),Dr=function(){function t(t,e,i,r){this._v=!0;var n=this;n.map=i,n.cPrefix=t.className+"-ui-",n.parent=t,n.opt=e,e.visible&&(n.create(t,e),n.enable())}return t.prototype.show=function(){var t=this;t.html||t.create(t.parent,t.opt),t.html.style.display="inline"},t.prototype.hide=function(){var t=this.html;t&&(t.style.display="none")},t.prototype.enable=function(){this.active=!0,this.toggleListeners(!0)},t.prototype.disable=function(){this.active=!1,this.toggleListeners(!1)},t.prototype.destroy=function(){var t=this;t.disable(),t.parent.removeChild(t.html)},t.prototype.toggleListeners=function(t){var e=this,i=e.listeners,r=function(r){var n=e.querySelectorAll(r),o=function(o){n.forEach(function(n){var a=i[r][o];t?n.addEventListener(o,i[r][o]._=a.bind(e)):n.removeEventListener(o,a._)})};for(var a in i[r])o(a)};for(var n in i)r(n)},t.prototype.insertRule=function(t,e){var i,r=(br=br||(i=document.createElement("style"),document.head.appendChild(i),i)).sheet;r.insertRule?r.insertRule(t+" {"+e+"}",r.cssRules.length):r.addRule&&r.addRule(t,e)},t.prototype.create=function(t,e){var i,r=this.templ.replace(/class\=\"/g,'class="'+this.cPrefix),n=(i=r=r.replace(/\>[\s]+\</g,"><"),(new DOMParser).parseFromString(i,"text/html").body.childNodes[0]),o=n.style,a=e.position,s="."+t.className+" ";for(var l in a)o[l]=a[l];if(this.style)for(var u in this.style)this.insertRule(s+this.prefixClass(u),this.style[u]);this.html=t.appendChild(n)},t.prototype.prefixClass=function(t){return t.replace(/\./g,"."+this.cPrefix)},t.prototype.querySelector=function(t){return this.html.querySelector(this.prefixClass(t))},t.prototype.querySelectorAll=function(t){return this.html.querySelectorAll(this.prefixClass(t))},t}(),Or=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r)||this;return o.maxPitch=n.maxPitch,o}return r(e,t),e.prototype.enable=function(){t.prototype.enable.call(this);var e=this.querySelector(".needle"),i=this.map;i.addEventListener("mapviewchange",this._rl=function(t){e.style.transform="rotate(".concat(i.rotate(),"deg) rotateX(").concat(i.pitch(),"deg) scale(0.7,1.1)")}),this._rl()},e.prototype.disable=function(){t.prototype.disable.call(this),this.map.removeEventListener("mapviewchange",this._rl),this.a&&(this.a.stop(),this.a=null)},e}(Dr);Or.prototype.listeners={".needle":{click:function(t){return o(this,void 0,void 0,function(){var t,e,i,r;return a(this,function(n){switch(n.label){case 0:return this.aip?[3,2]:(t=this.map,e=t.rotate(),i=t.pitch(),r=[0,0],e||i||(r=[0,this.maxPitch]),this.a=new dr([e,i],r,500,"easeOutCubic",function(e){t.rotate(e[0]),t.pitch(e[1])}),[4,this.a.start()]);case 1:n.sent(),this.a=null,n.label=2;case 2:return[2]}})})}}},Or.prototype.style={".compass":"        position: absolute;        right:  10px;        bottom: 96px;        text-align: center;        font-family: sans-serif;        color: white;        height: 28px;        background-color: #0f1621;        user-select: none;        border-radius: 4px;        font-size: 12px;        width: 28px;        margin: 2px;        overflow: hidden;",".compass .needle":"        padding: 4px 0px;        line-height: 10px;",".compass:hover":"        background-color: #383c45;        cursor: pointer;"},Or.prototype.templ='<div class="compass">        <div class="needle">&#9650;<br>&#9661;</div>    </div>';var Rr=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r)||this;o.ams=250;var a=o;return n&&n.zoomAnimationMs&&(a.ams=n.zoomAnimationMs),o}return r(e,t),e.prototype.enable=function(){t.prototype.enable.call(this);var e=this.querySelector(".info"),i=this.map;e.innerText=i.getZoomlevel(),i.addEventListener("mapviewchangeend",this._zll=function(t){e.innerText=Math.round(10*i.getZoomlevel())/10})},e.prototype.disable=function(){t.prototype.disable.call(this),this.map.removeEventListener("mapviewchangeend",this._zll)},e}(Dr);Rr.prototype.listeners={".zoomBtn":{click:function(t){var e=0^t.srcElement.getAttribute("dir");this.map.setZoomlevel(this.map.getZoomlevel()+e,this.ams)}}},Rr.prototype.style={".zoomctrl":"        position: absolute;        right:  10px;        bottom: 20px;        text-align: center;        font-family: sans-serif;        color: white;        user-select: none;",".zoomctrl div":"        background-color: #0f1621;        border-radius: 4px;        font-size: 12px;        width: 28px;        margin: 2px;",".zoomctrl .zoomBtn":"        height: 28px;        font-size: 32px;        /* border: 1px solid white; */        line-height: 22px;        font-weight: 200;",".zoomctrl .zoomBtn:hover":"        background-color: #383c45;        cursor: pointer;"},Rr.prototype.templ='<div class="zoomctrl">         <div class="zoomBtn" dir="1">+</div>         <div class="info">L</div>        <div class="zoomBtn" dir="-1">-</div>     </div>';var Fr=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return r(e,t),e.prototype.add=function(t){var e,i,r,n;e=this.prefixClass(".src").substr(1),i="© "+t.label,r=this.html,n=document.createElement("div"),e&&(n.className=e),i&&(n.innerText=i),r&&r.appendChild(n)},e.prototype.setData=function(t){var e=this;if(e.data=t,e.html){e.html.innerText="";for(var i=0,r=t;i<r.length;i++){var n=r[i];e.add(n)}}},e}(Dr);Fr.prototype.style={".copyright-popup":"        user-select: none;        background-color: rgba(0,0,0,0.1);        position: absolute;        bottom: 15px;        padding: 2px;        right: 120px;        z-index: 1;        width:  auto;        color: #fff;        font-family: arial;        font-size: 11px;        opacity: 0.8;        height: auto;",".src":"        opacity: 0.8;        margin: 4px;    "},Fr.prototype.templ='<div class="copyright-popup"></div>';var Ur=t.global.document,Nr=function(t,e){var i,r,n,o=t.scopes,a=o.length;if(!a)return!0;for(;i=o[--a];){var s=i.layer.getProvider(e),l=s&&s.level||e;if(r=i.minLevel||-1/0,n=i.maxLevel||1/0,l>=r&&l<=n)return!0}return!1},Br=function(t,e){t.style.display=e?"inline":"none"},Gr={defaultOwner:"XYZ",termsAndConditions:{label:"Terms and Conditions",url:!1}},Wr=function(e){function i(i,r,n){var o=e.call(this,i,t.JSUtils.extend(!0,t.JSUtils.clone(Gr),r),n)||this;o.sources=new t.Map,o.sLen=0,o.srcWidth=0;var a=o,s=a.opt,l=s.termsAndConditions,u=s.defaultOwner;return a.$src=a.querySelector(".sources"),a.$cDefault=a.querySelector(".cDefault"),a.$btn=a.querySelector(".btn"),o.details=new Fr(i,{visible:!1},n),o.setDefaultOwner(u),o.setTermsAndConditions(l),o}return r(i,e),i.prototype.setTermsAndConditions=function(t){var e=t.url,i=t.label,r=this.querySelector(".terms");e?(r.lastChild.href=e,i&&(r.lastChild.innerText=i)):Br(r,!1)},i.prototype.setDefaultOwner=function(t){"string"==typeof t&&this.setOwnerLabel(this.$cDefault,t)},i.prototype.enable=function(){var t=this;e.prototype.enable.call(this),t.map.addObserver("zoomlevel",t.onZoomChange=function(e,i,r){Math.abs((0^i)-(0^r))&&(t.sources.forEach(function(t){Br(t.el,Nr(t,i))}),t.showDetails(!1),t.handleOverflow())}),t.map.addEventListener("addLayer removeLayer",t.onLayerChange=function(e){var i=e.detail.layer;i.getCopyright(function(r){t.active&&("addLayer"==e.type?r.forEach(function(e){return t.addSource(e,i)}):r.forEach(function(e){return t.removeSource(e,i)}))})}),t.map.addEventListener("resize",t.onResize=function(){return t.handleOverflow()})},i.prototype.disable=function(){var t=this;e.prototype.disable.call(this),t.map.removeObserver("zoomlevel",t.onZoomChange),t.map.removeEventListener("addLayer removeLayer",t.onLayerChange),t.map.removeEventListener("resize",t.onResize)},i.prototype.getSourceLabelsString=function(){for(var t=0^this.map.getZoomlevel(),e="",i=0,r=this.sources.values();i<r.length;i++){var n=r[i];Nr(n,t)&&(e+="© ".concat(n.label," "))}return e},i.prototype.getColors=function(){return{color:window.getComputedStyle(this.$cDefault).getPropertyValue("color"),backgroundColor:window.getComputedStyle(this.html).getPropertyValue("background-color")}},i.prototype.calcWidth=function(){var t=0^this.map.getZoomlevel(),e=this.sources,i=0;return e.forEach(function(e){i+=Nr(e,t)&&e.width}),i},i.prototype.handleOverflow=function(){var t=this,e=t.$btn,i=t.map.getWidth(),r=t.calcWidth(),n=i-132^0;t.$src.style.width=(n<r?n-10:r)+"px",r>Math.min(n,384)?Br(e,!0):(Br(e,!1),t.showDetails(!1))},i.prototype.showDetails=function(t){var e=this,i=e.details,r=e.map.getZoomlevel();e.$btn.innerText=t?"-":"+",t?(i.show(),i.setData(e.sources.values().filter(function(t){return Nr(t,r)}))):i.hide()},i.prototype.setOwnerLabel=function(t,e){t.innerText="© "+e},i.prototype.addSource=function(t,e){var i,r=this,n=r.sources,o=t.label,a=t.scopes,s=0^r.map.getZoomlevel(),l=n.get(o);l?(i=l.el,l.cnt++):((i=Ur.createElement("span")).className=this.prefixClass(".source").substr(1),r.setOwnerLabel(i,o),r.$src.appendChild(i),l={label:o,scopes:[],el:i,cnt:1,width:i.getBoundingClientRect().width},n.set(o,l),r.sLen++,r.srcWidth+=l.width),null!=a&&a.forEach(function(t){return l.scopes.push({minLevel:t.minLevel,maxLevel:t.maxLevel,layer:e})}),Br(r.$cDefault,!1),Br(i,Nr(l,s)),r.handleOverflow()},i.prototype.removeSource=function(t,e){var i,r,n=this,o=t.label,a=n.sources.get(o);if(a){if(r=a.scopes,i=t.scopes)for(var s=0,l=void 0;s<i.length;s++){l=i[s];for(var u=0,h=void 0;s<r.length;u++)if((h=r[u]).layer==e&&h.minLevel==l.minLevel&&h.maxLevel==l.maxLevel){r.splice(u,1);break}}--a.cnt||(n.$src.removeChild(a.el),n.sources.delete(o),n.handleOverflow(),--n.sLen||Br(n.$cDefault,!0))}},i}(Dr);Wr.prototype.listeners={".btn":{click:function(t){var e="+"==this.$btn.innerText;this.showDetails(e)}}},Wr.prototype.style={".copyright *":"        color: rgba(255,255,255,.8);        font-family: arial;        text-decoration: none;",".copyright":"        right: 0px;        bottom: 0px;        padding: 1px 4px;        margin: 0px;        background-color: rgba(0,0,0,.1);        position: absolute;        font-size: 11px;        line-height: 13px;        overflow: hidden;        white-space: nowrap;        user-select: none;",".sources":"        width:auto;        max-width: 384px;        float: left;        white-space: nowrap;        overflow: hidden;        text-overflow: ellipsis;        border-right: 2px;",".btn":"        display: none;        font-family: sans-serif;        font-weight: bold;        text-align: center;        height: 12px;        width: 12px;        float: left;        padding: 0px;        line-height: 9px;        margin: 1px 2px 0px;        background-color: inherit;        box-sizing: border-box;        border-radius: 3px;        border: 1px solid;",".terms, .cDefault, .source":"        white-space: nowrap;        padding-right: 4px;"},Wr.prototype.templ='<div class="copyright">        <span style="float: left; white-space: nowrap;">            <span class="sources"></span>            <span class="cDefault"></span>         </span>        <span class="tac" style="float: right; white-space: nowrap;">            <span class="btn">+</span>            <span class="terms" style="white-space: nowrap;">|            <a target="_blank" style="white-space: nowrap;" href="">Terms and Conditions</a></span>        </span>    </div>';var Zr=function(t){function e(e,i,r){var n=t.call(this,e,i,r)||this,o=i.url;return o&&n.setSrc(o),n}return r(e,t),e.prototype.setSrc=function(t){this.html.style.backgroundImage="url(".concat(t,")")},e.prototype.getImage=function(){var t=window.getComputedStyle(this.html),e=Math.round(parseFloat(t.getPropertyValue("width"))),i=Math.round(parseFloat(t.getPropertyValue("height")));return new Promise(function(r){var n=new Image;n.onload=function(){return r({img:n,width:e,height:i})},n.src=t.getPropertyValue("background-image").slice(5,-2)})},e}(Dr);Zr.prototype.style={".logo":"        position: absolute;        bottom: 6px;        left: 6px;        z-index: 1;        margin:  0px;        background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjdweCIgaGVpZ2h0PSIzMnB4IiB2aWV3Qm94PSIwIDAgMjcgMzIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjYgKDY3NDkxKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTMiPgogICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aCIgZmlsbD0iIzA0QjZDOCIgcG9pbnRzPSItNy44NjQyMTYxOWUtMTQgOSAxMyAxNS45Njg4NjgxIDEzIDMyIDAgMjQuNDc4MDIyNiI+PC9wb2x5Z29uPgogICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aCIgZmlsbD0iIzBBNTdENCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAuNTAwMDAwLCAyMC41MDAwMDApIHNjYWxlKC0xLCAxKSB0cmFuc2xhdGUoLTIwLjUwMDAwMCwgLTIwLjUwMDAwMCkgIiBwb2ludHM9IjE0IDkgMjcgMTUuOTY4ODY4MSAyNyAzMiAxNCAyNC40NzgwMjI2Ij48L3BvbHlnb24+CiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJQYXRoLTIiIGZpbGw9IiMwQTk0REUiIHBvaW50cz0iMCA3Ljc5MTIyNDMxIDEzLjU1MDIxNTEgMCAyNyA3Ljc5MTIyNDMxIDEzLjU1MDIxNTEgMTUiPjwvcG9seWdvbj4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==);        background-repeat: no-repeat;        background-size: contain;        width: 32px;        height: 32px;        cursor: pointer;"},Zr.prototype.templ='<div class="logo"></div>';var Xr,Yr={Compass:Or,ZoomControl:Rr,Copyright:Wr,Logo:Zr},Hr=function(){function t(t,e,i){var r=n({},e.UI||e.ui||{}),o=this.components={};for(var a in this.el=t,null!=r.HERE&&(r.Logo=r.HERE),Yr){var s=r[a];!1!==s&&("object"!=typeof s&&(s={}),null==s.visible&&(s.visible=!0),s.visible&&(o[a]=new Yr[a](t,s,i,e)))}}return t.initComponentOptions=function(){},t.prototype.get=function(t){return this.components[t]},t.prototype.destroy=function(){var t=this.components;for(var e in t)t[e].destroy(),delete t[e]},t}(),jr=t.JSUtils.isFunction,Vr=function(){function t(t){void 0===t&&(t={}),this.animation=null,this.easing=t.easing,jr(t.onStart)&&(this.onStart=t.onStart),jr(t.onStop)&&(this.onStop=t.onStop)}return t.prototype.onStart=function(){},t.prototype.onStop=function(){},t.prototype.animate=function(t,e,i,r){return o(this,void 0,void 0,function(){var n;return a(this,function(o){switch(o.label){case 0:return(n=this).active?[3,2]:(n.active=!0,n.onStart(),n.animation=new dr(t,e,i,this.easing,r),[4,n.animation.start()]);case 1:o.sent(),n.onStop(),n.active=!1,n.animation=null,o.label=2;case 2:return[2]}})})},t.prototype.stop=function(){var t;null===(t=this.animation)||void 0===t||t.stop()},t}(),qr=function(t){function e(e,i){void 0===i&&(i={});var r=this;return i.easing=i.easing||"easeOutCubic",(r=t.call(this,i)||this).map=e,r}return r(e,t),e.prototype.start=function(t,e,i,r){var n=this.map;this.animate(n.getZoomlevel(),t,r,function(t){n.setZoomlevel(t,e,i)})},e}(Vr),Kr=t.JSUtils.isFunction,Qr=function(){function t(t,e){e=e||{};var i=this;i.map=t,i.duration=e.duration||500,Kr(e.onStart)&&(i.onStart=e.onStart),Kr(e.onStop)&&(i.onStop=e.onStop),i.raf=function(){i._pan()&&(i.rafId=requestAnimationFrame(i.raf))}}return t.prototype._pan=function(){var t=this,e=t.deltaX,i=t.deltaY,r=t.duration,n=t.startTs,o=Math.min(Date.now()-n,r)/r,a=cr(o)*e,s=cr(o)*i;if(t.map.pan(a-t.lastDx||0,s-t.lastDy||0),a!=e||s!=i)return t.lastDx=a,t.lastDy=s,!0;t.onStop()},t.prototype.pan=function(t,e,i){this.startTs=t,this.deltaX=e,this.deltaY=i,this.onStart(),this.raf()},t.prototype.cancel=function(){var t=this.rafId;t&&(cancelAnimationFrame(t),this.rafId=null),this.onStop(),this.startTs=0,this.lastDx=0,this.lastDy=0},t.prototype.onStart=function(){},t.prototype.onStop=function(){},t}(),Jr={ui:{},behavior:{drag:!0,pitch:!1,rotate:!1},rotate:0,pitch:0,zoomlevel:18,center:{longitude:8.534,latitude:50.162},layers:null,maxLevel:20,minLevel:2,debug:!1,minPanMapThreshold:4,minRotateMapThreshold:4,minPitchMapThreshold:4,zoomAnimationMs:100,maxPitch:50},$r=function(t){function i(e,i){void 0===i&&(i={});var r=this;return i.easing=i.easing||"easeOut",(r=t.call(this,i)||this).map=e,r}return r(i,t),i.prototype.start=function(t,i,r){var n=this.map,o=n.getZoomlevel(),a=n._worldSizeFixed,s=n.getCenter(),l=e.webMercator.lon2x(s.longitude,a),u=e.webMercator.lat2y(s.latitude,a),h=e.webMercator.lon2x(t.longitude,a),f=e.webMercator.lat2y(t.latitude,a),c=Math.max(n.getWidth(),n.getHeight()),p=c/Math.pow(2,i-o),d=k(h,f,l,u)||1,v=1.42,g=2.0164,y=function(t){return(Math.exp(t)-Math.exp(-t))/2},m=function(t){return(Math.exp(t)+Math.exp(-t))/2},x=function(t){var e=(p*p-c*c+(t?-1:1)*g*g*d*d)/(2*(t?p:c)*g*d);return Math.log(Math.sqrt(e*e+1)-e)},_=x(0),w=function(t){return c*(m(_)*(y(e=_+v*t)/m(e))-y(_))/g;var e},b=(x(1)-_)/v,T=c*Math.pow(2,o);r=r||1e3*b*.77,this.animate(0,b,r,function(r){var s,p,g=w(r)/d,y=l+(h-l)*g,x=u+(f-u)*g;r>=b?(s=t,p=i):(s=new e.GeoPoint(e.webMercator.x2lon(y,a),e.webMercator.y2lat(x,a)),p=Math.log(T/function(t){return c*(m(_)/m(_+v*t))}(r))/Math.LN2,p=isNaN(p)?o:p),n.setZoomlevel(p),n.setCenter(s)})},i}(Vr),tn=e.webMercator,en=e.webMercator.earthCircumference,rn="fixed",nn="longitude",on="latitude",an=[];function sn(t,e,i,r,n,o){for(var a,s,l,u=256*Math.pow(2,20),h=20;h>=0;--h)if(l=20-h,a=(tn.lon2x(i,u)>>l)-(tn.lon2x(t,u)>>l),s=(tn.lat2y(e,u)>>l)-(tn.lat2y(r,u)>>l),a<=n&&s<=o)return h;return 0}var ln=function(){function i(i,r){this._s=1,this._rz=0,this._rx=0,this._cWorldFixed=new e.PixelPoint(0,0),this._cWorld=new e.PixelPoint(0,0),this._c=new e.GeoPoint(0,0),this._pc=new e.GeoPoint(0,0),this._ox=0,this._oy=0,this._cfg=r=t.JSUtils.extend(!0,t.JSUtils.extend(!0,{},Jr),r||{});var o=this;this._w=u(i,"width"),this._h=u(i,"height"),this._cx=this._w/2,this._cy=this._h/2;var a=r.zoomLevel||r.zoomlevel;r.maxLevel=Math.min(28,r.maxLevel),r.maxPitch=Math.min(85,r.maxPitch),this._z=0^Math.min(20,a),this._worldSizeFixed=256*Math.pow(2,this._z),this._worldSize=256*Math.pow(2,a),this._l=new t.Listener(["center","rotation","zoomlevel","mapviewchangestart","mapviewchange","mapviewchangeend","resize","addLayer","removeLayer"]);var s=this._l,l=[],h=i;o._layers=l,o.id=1e6*Math.random()^0,(i=document.createElement("div")).className="_"+t.JSUtils.String.random(11),i.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",i.style.position="relative",i.style.width=this._w+"px",i.style.height=this._h+"px",h.appendChild(i),this._el=i;var f="canvas"==r.renderer?lr:Fi;"string"==typeof f.zoomBehavior&&(rn=f.zoomBehavior);var c=new f(i,256,r.devicePixelRatio,r.renderOptions||{});o._mvcRecognizer=new kr(o,function(t,e,i){s.trigger(t,[new mr(t,e)],i)},c),o._display=c,this._search=new zr(o,c.dpr);var p=this._evDispatcher=new Tr(i,o,l,r);s.add("mapviewchangestart",function(t){return p.disable("pointerenter")}),s.add("mapviewchangeend",function(t){return p.enable("pointerenter")}),s.add("mapviewchangeend",function(t){return c.viewChangeDone()}),this._zoomAnimator=new qr(o),this._flightAnimator=new $r(o);var d=n(n({},r.behavior),r.behaviour);d.zoom==Xr&&(d.zoom=rn);var v=this._b=new yr(i,o,new Qr(o),d,r);v.drag(!0),v.scroll(!0),this._vplock={pan:!1,minLevel:r.minLevel,maxLevel:r.maxLevel};var g=r.UI||r.ui||{};g.Compass==Xr&&(g.Compass=d.rotate||d.pitch),this.ui=new Hr(i,r,o),o.setCenter(r.center),o.pitch(r.pitch),o.rotate(r.rotate),o.setZoomlevel(a),o._layerClearListener=o._layerClearListener.bind(o);for(var y=0,m=r.layers||[];y<m.length;y++){var x=m[y];o.addLayer(x)}an.push(this),r.debug&&this.debug(r.debug)}return i.getInstances=function(){return an.slice()},i.prototype._layerClearListener=function(t){this.refresh(t.detail.layer)},i.prototype.initViewPort=function(){var t=this._s,i=this._worldSizeFixed,r=this._cWorldFixed.x,n=this._cWorldFixed.y,o=this._w/2,a=this._h/2,s=r-o/t,l=n-a/t;this._tlwx=s,this._tlwy=l,this._ox=r-o-s,this._oy=n-a-l;var u=tn.x2lon(s,i),h=tn.y2lat(l,i),f=r+o/t,c=n+a/t,p=tn.x2lon(f,i),d=tn.y2lat(c,i);return this._vp=new e.GeoRect(u,d,p,h),[r/i,n/i]},i.prototype.updateGrid=function(){var t=this._display,e=this._c,i=this._pc;this._mvcRecognizer.watch(!0),this._groundResolution=en(e.latitude)/this._worldSizeFixed,t.setView(this.initViewPort(),this._s,this._rz,this._rx,this._groundResolution,this._worldSize),t.updateGrid(this._z,this._ox,this._oy),i[nn]==e[nn]&&i[on]==e[on]||(this._l.trigger("center",["center",e,i],!0),this._pc=e)},i.prototype._clipLatitude=function(t){return Math.min(85.05112878,Math.max(-85.05112878,t))},i.prototype._setCenter=function(t,i){var r=this._worldSizeFixed;return 2!=arguments.length&&(t instanceof Array?(i=t[1],t=t[0]):(i=(t=t||this._c)[on],t=t[nn])),!isNaN(t)&&!isNaN(i)&&"number"==typeof t&&"number"==typeof i&&(t>180?t-=360:t<-180&&(t+=360),i=this._clipLatitude(i),this._c=new e.GeoPoint(t,i),this._cWorldFixed=new e.PixelPoint(tn.lon2x(t,r),tn.lat2y(i,r)),this._cWorld=new e.PixelPoint(tn.lon2x(t,this._worldSize),tn.lat2y(i,this._worldSize)),!0)},i.prototype.repaint=function(){this.updateGrid()},i.prototype.debug=function(t){this._display.showGrid(t),this.updateGrid()},i.prototype.pitch=function(t){if(t!==Xr){var e=this._cfg.maxPitch,i=Math.max(0,Math.min(e,Math.round(t%360*10)/10));this._rx=-i*Math.PI/180,this.updateGrid()}return 180*-this._rx/Math.PI},i.prototype.rotate=function(t){if(t!==Xr){var e=Math.round(10*t||0)*Math.PI/1800,i=this._rz;if(e!==i){var r=this._cx,n=this._cy,o=this._display.unproject(r,n),a=this._cWorldFixed;a.x+=o[0]-r,a.y+=o[1]-n,this._rz=e,this.updateGrid(),this._l.trigger("rotation",["rotation",this._rz,i],!0)}}return this._rz/Math.PI*180},i.prototype.setBackgroundColor=function(t){this._display.setBGColor(t),this.refresh()},i.prototype.addEventListener=function(t,e){var i=this,r=this._l;t.split(" ").forEach(function(t){if(r.isDefined(t))return r.add(t,e);i._evDispatcher.addEventListener(t,e)})},i.prototype.removeEventListener=function(t,e){var i=this,r=this._l;t.split(" ").forEach(function(t){if(r.isDefined(t))return r.remove(t,e);i._evDispatcher.removeEventListener(t,e)})},i.prototype.getViewBounds=function(){var t=this._vp,i=t.minLon,r=t.maxLon,n=t.minLat,o=t.maxLat;return n<=-85.05112878&&(n=-90),o>=85.05112878&&(o=90),i<-180&&(i=-180),r>180&&(r=180),new e.GeoRect(i,n,r,o)},i.prototype.setViewBounds=function(t,i){var r,n,o,a,s=arguments;if("number"==typeof t?t=[s[0],s[1],s[2],s[3]]:"FeatureCollection"==t.type?t=t.features:"Feature"==t.type&&(t=[t]),Array.isArray(t)){if("object"==typeof t[0]){for(var l=[1/0,1/0,-1/0,-1/0],u=0,h=t;u<h.length;u++){var f=h[u];e.utils.calcBBox(f,l)}t=l}r=t[0],n=t[1],o=t[2],a=t[3]}else{var c=t;r=c.minLon,n=c.minLat,o=c.maxLon,a=c.maxLat}var p=sn(r,n,o,a,this.getWidth(),this.getHeight()),d=new e.GeoPoint(r+(o-r)/2,n+(a-n)/2);i?this.flyTo(d,p,!0===i?{}:i):(this.setZoomlevel(p),this.setCenter(d))},i.prototype.getFeatureAt=function(t,e){e=e||{};var i=this.getFeaturesAt(t,e);if(i.length){var r=i[i.length-1];return r.feature=r.features[0],r}},i.prototype.getFeaturesAt=function(t,e){var i,r,n,o,a=!1,s=(e=e||{}).layers;if(s&&!Array.isArray(s)&&(s=[s]),t.x!=Xr&&t.y!=Xr){var l=t.x,u=t.y,h=0^e.width,f=e.height||h;if(!h&&!f){a=!0;var c=this._display.getRenderedFeatureAt(l,u,s||this._layers);if(null!=c.id){var p=s[c.layerIndex],d=p.getProvider(0^this.getZoomlevel()),v=(null==d?void 0:d.search)&&d.search(c.id);if(v)return[{layer:p,features:[v]}]}}i=l-h/2,r=l+h/2,n=u-f/2,o=u+f/2}else t.minX!=Xr&&t.maxX!=Xr&&(i=t.minX,n=t.minY,r=t.maxX,o=t.maxY);return i!=Xr&&this._search.search(i,n,r,o,s,a)},i.prototype.snapshot=function(t,e,i,r,n){if(t){e||(e=0),i||(i=0),r||(r=this._w),n||(n=this._h),r+e>this._w&&(r=this._w-e),n+i>this._h&&(n=this._h-i);var s=this._display,l=s.dpr,u=s.copyCanvas2d(e,i,r,n),h=Math.ceil(11/3),f=this.ui.get("Copyright"),c=f.getSourceLabelsString(),p=f.getColors(),d=f.calcWidth();o(this,void 0,void 0,function(){var e,i;return a(this,function(o){switch(o.label){case 0:return[4,this.ui.get("Logo").getImage()];case 1:return e=o.sent(),(i=u.getContext("2d")).scale(l,l),i.font="".concat(11,"px sans-serif"),i.textBaseline="hanging",i.fillStyle=p.backgroundColor,i.fillRect(r-d-2*h,n-11-h,r+2*h,11+h),i.fillStyle=p.color,i.fillText(c,r-d-h,n-11),i.drawImage(e.img,2*h,n-e.height-2*h),u.style.width="".concat(r,"px"),u.style.height="".concat(n,"px"),t(u),[2]}})})}},i.prototype.getBehavior=function(){var t={},e=this._b.getOptions();for(var i in e)t[i]=!!e[i];return t},i.prototype.setBehavior=function(t,e){var i=typeof t,r="object"==i?t:{},n=this._b.getOptions();"string"==i&&(r[t]=e);var o=r.zoom;o!=Xr&&(n.zoom="fixed"==o||"float"==o?o:!!o&&rn);for(var a=0,s=["drag","pitch","rotate"];a<s.length;a++){var l=s[a],u=r[l];u!=Xr&&(n[l]=!!u)}},i.prototype.getZoomlevel=function(){return this._z+Math.log(this._s)/Math.LN2},i.prototype.setZoomlevel=function(t,e,i,r){var n=this._vplock,o=this._z,a=this._s;if(t=Math.round(1e3*t)/1e3,t=Math.max(Math.min(t,n.maxLevel),n.minLevel),2==arguments.length&&(r=e,e=Xr),e!=Xr&&i!=Xr||(e=this._cx,i=this._cy),o!=t||1!=a)if(this._worldSize=256*Math.pow(2,t),r)this._zoomAnimator.start(t,e,i,"number"==typeof r?r:250);else{var s=this.getZoomlevel(),l=this._display.unproject(e,i),u=0^Math.min(20,t),h=o-u,f=this._worldSizeFixed,c=Math.pow(2,t-u);h&&(this._z=0^Math.min(20,t),this._worldSizeFixed=256*Math.pow(2,this._z)),this._display.setView(this.initViewPort(),c*Math.pow(.5,h),this._rz,this._rx,this._groundResolution,this._worldSize);var p=this._display.unproject(e,i);this._setCenter(tn.x2lon(this._cWorldFixed.x+l[0]-p[0],f),tn.y2lat(this._cWorldFixed.y+l[1]-p[1],f)),this._s=c,this.updateGrid(),this._l.trigger("zoomlevel",["zoomlevel",this.getZoomlevel(),s],!0)}},i.prototype.setCenter=function(t,e){this._setCenter.apply(this,arguments)&&this.updateGrid()},i.prototype.getCenter=function(){return new e.GeoPoint(this._c.longitude,this._c.latitude)},i.prototype.flyTo=function(t,e,i){e&&"object"!=typeof e||(i=e,e=this.getZoomlevel()),this._flightAnimator.stop(),this._flightAnimator.start(t,e,null==i?void 0:i.duration)},i.prototype.lockViewport=function(t){var e=this._vplock;if(t){var i=t.pan,r=t.minLevel,n=t.maxLevel;r=!1===r?this._cfg.minLevel:r,n=!1===n?this._cfg.maxLevel:n,i!=Xr&&(e.pan=i),"number"==typeof r&&(e.minLevel=r),"number"==typeof n&&(e.maxLevel=n)}return e},i.prototype.pan=function(t,e){if(0!=t||0!=e){var i=this._worldSizeFixed,r=this._cx,n=this._cy,o=this._cWorldFixed,a=this._display.unproject(r+t,n+e),s=o.x-a[0]+r,l=o.y-a[1]+n;this.setCenter(tn.x2lon(s,i),tn.y2lat(l,i))}},i.prototype.getLayers=function(t){var e=this._layers;return t!=Xr?e[t]:e.slice()},i.prototype.addLayer=function(t,e){var i=this._layers;if(-1==i.indexOf(t)){e==Xr&&(e=i.length),this._display.addLayer(t,t.getStyle(),e),t.addEventListener("clear",this._layerClearListener);var r={index:e,layer:t,map:this,context:this._display.getContext(),canvas:this._display.canvas};t.dispatchEvent("layerAdd",r),this._l.trigger("addLayer",[new mr("addLayer",r)]),i.splice(e,0,t),this.updateGrid()}},i.prototype.removeLayer=function(t){var e=this._layers,i=e.indexOf(t);i>=0&&(this._display.removeLayer(t),t.removeEventListener("clear",this._layerClearListener),e.splice(i,1),this.updateGrid(),this._l.trigger("removeLayer",[new mr("removeLayer",{index:i,layer:t})]))},i.prototype.refresh=function(t){t instanceof Array||(t=[t]);for(var i=0,r=t;i<r.length;i++){var n=r[i];n instanceof e.TileLayer&&this._display.clearLayer(n)}this.updateGrid()},i.prototype.pixelToGeo=function(t,i){1==arguments.length&&(i=t.y,t=t.x);var r=this._unprj(t,i),n=this._w2g(r),o=n[0],a=n[1];return new e.GeoPoint(o,a)},i.prototype._unprj=function(t,e,i){var r;Array.isArray(t)&&(t=(r=t)[0],e=r[1],i=r[2]);var n=this._ox,o=this._oy,a=this._display.unproject(t,e,i);return a[0]+=n,a[1]+=o,a},i.prototype._w2g=function(t,e,i){var r;Array.isArray(t)&&(t=(r=t)[0],e=r[1],i=r[2]);var n=this._worldSizeFixed,o=t+this._tlwx,a=e+this._tlwy;return o%=n,(a%=n)<0&&(a+=n),[tn.x2lon(o,n),tn.y2lat(a,n),i]},i.prototype.geoToPixel=function(t,i){var r;i==Xr&&(i=t.latitude,t=t.longitude);var n=this._g2w(t,i),o=n[0],a=n[1];return o=(r=this._prj([o,a]))[0],a=r[1],new e.PixelPoint(o,a)},i.prototype._g2w=function(t,e,i){var r;Array.isArray(t)&&(t=(r=t)[0],e=r[1],i=r[2]),e=this._clipLatitude(e);var n=this._worldSizeFixed,o=this._tlwx,a=this._tlwy;return[tn.lon2x(t,n)-o,tn.lat2y(e,n)-a,i||0]},i.prototype._prj=function(t){return this._display.project(t[0],t[1],t[2])},i.prototype.getCamera=function(){var t=this,e=t._w2g(t._unprj(t._cx,t._cy,-1));return{position:{longitude:e[0],latitude:e[1],altitude:e[2]}}},i.prototype._translateGeoCoord=function(t,e,i,r){var n,o=this,a=o._groundResolution/o._s,s=t[0],l=t[1],u=t[2];if(u+=r*a,e||i){var h=o._g2w(s,l,u),f=h[0],c=h[1],p=h[2];s=(n=o._w2g([f+e,c+i,p]))[0],l=n[1],u=n[2]}return[s,l,u]},i.prototype.destroy=function(){var t=this,e=this._el;this.ui.destroy(),this._layers.forEach(function(e){return t.removeLayer(e)}),this._display.destroy(),e.parentNode.removeChild(e),this._mvcRecognizer.watch(!1),this._evDispatcher.destroy(),this._b.drag(!1),this._b.scroll(!1);var i=this;i.__proto__=null,Object.keys(i).forEach(function(t){return delete i[t]}),an.splice(an.indexOf(i),1)},i.prototype.resize=function(t,e){var i=this._el;t!=Xr&&e!=Xr||(t=u(i.parentNode,"width"),e=u(i.parentNode,"height"));var r=this._w,n=this._h;r===t&&n===e||(i.style.width=t+"px",i.style.height=e+"px",this._display.setSize(t,e),this._w=t,this._h=e,this._cx=t/2,this._cy=e/2,this.updateGrid(),this._l.trigger("resize",[new mr("resize",{width:t,height:e})]))},i.prototype.getWidth=function(){return this._w},i.prototype.getHeight=function(){return this._h},i.prototype.addObserver=function(t,e){return"zoomLevel"==t&&(t="zoomlevel"),this._l.add(t,e)},i.prototype.removeObserver=function(t,e){return"zoomLevel"==t&&(t="zoomlevel"),this._l.remove(t,e)},i.prototype.getContainer=function(){return this._el.parentNode},i}(),un=t.global.here.xyz.maps;exports.default=exports.Map=ln,un.Map=ln,un.styleTools=at;
},{"@here/xyz-maps-common":"uecR","@here/xyz-maps-core":"V0BL"}],"H99C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateDeckView=j;var e=u(require("leaflet")),t=require("deck.gl-leaflet"),r=require("@deck.gl/core"),n=require("@deck.gl/layers"),o=require("./style"),a=require("@here/xyz-maps-display"),i=require("@here/xyz-maps-core");function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}function u(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function p(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=h();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){var t=x(e,"string");return"symbol"===l(t)?t:String(t)}function x(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var E="AGB705k1T0Oyizl4K04zMwA",k=new i.MVTLayer({name:"mvt-world-layer",zIndex:1,remote:{url:"https://xyz.api.here.com/tiles/osmbase/512/all/{z}/{x}/{y}.mvt?access_token="+E}}),O=function(e){d(n,i.CustomLayer);var t=m(n);function n(){var e;s(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return g(b(e=t.call.apply(t,[this].concat(o))),"min",0),g(b(e),"max",20),g(b(e),"renderOptions",{mode:"3d",zLayer:99,zIndex:99}),g(b(e),"props",void 0),g(b(e),"_deck",void 0),g(b(e),"_container",void 0),g(b(e),"_map",void 0),e}return p(n,[{key:"onLayerAdd",value:function(e){var t=e.detail,n=t.canvas,o=(t.context,t.map);_(o);console.log("canvas",n);var a=new r.Deck({parent:document.getElementById("xyzmap"),controller:!0,layers:[T]});window._deckGL=a,this._deck=a,this._map=o}},{key:"render",value:function(e,t){j(this._deck,this._map)}},{key:"setProps",value:function(e){this._deck&&this._deck.setProps(e)}}]),n}();function _(e){return{longitude:e.getCenter().longitude,latitude:e.getCenter().latitude,zoom:e.getZoomlevel(),pitch:0,bearing:0}}function j(e,t){var r=_(t);e.setProps({viewState:r}),e.redraw(!1)}var R="https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_10m_airports.geojson",T=[new n.GeoJsonLayer({id:"airports",data:R,filled:!0,pointRadiusMinPixels:2,pointRadiusScale:2e3,getPointRadius:function(e){return 11-e.properties.scalerank},getFillColor:[200,0,80,180],pickable:!0,autoHighlight:!0,onClick:function(e){return e.object&&alert("".concat(e.object.properties.name," (").concat(e.object.properties.abbrev,")"))}}),new n.ArcLayer({id:"arcs",data:R,dataTransform:function(e){return e.features.filter(function(e){return e.properties.scalerank<4})},getSourcePosition:function(e){return[-.4531566,51.4709959]},getTargetPosition:function(e){return e.geometry.coordinates},getSourceColor:[0,128,200],getTargetColor:[200,0,80],getWidth:1}),new n.ScatterplotLayer({data:[{position:[-80.62089,28.627275],color:[255,0,0],radius:1e3}],getPosition:function(e){return e.position},getColor:function(e){return e.color},getRadius:function(e){return e.radius},opacity:.3})],z=new O({zLayer:9,zIndex:10});z.setProps({layers:T});var M=function(e){d(r,i.CustomLayer);var t=m(r);function r(){var e;s(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return g(b(e=t.call.apply(t,[this].concat(o))),"min",10),g(b(e),"max",20),g(b(e),"renderOptions",{mode:"3d",zIndex:0}),g(b(e),"camera",void 0),g(b(e),"scene",void 0),g(b(e),"renderer",void 0),e}return p(r,[{key:"onLayerAdd",value:function(e){var t=this,r=e.detail,n=r.canvas,o=r.context;this.camera=new THREE.Camera,this.scene=new THREE.Scene,(new THREE.GLTFLoader).load("https://xyz.api.here.com/maps/playground/assets/models/ML_HP/ML_HP.gltf",function(e){return t.scene.add(e.scene)});var a=new THREE.DirectionalLight(16777215);a.position.set(200,150,50),this.scene.add(a);var i=new THREE.DirectionalLight(16777215);this.scene.add(i),this.renderer=new THREE.WebGLRenderer({canvas:n,context:o}),this.renderer.autoClear=!1}},{key:"render",value:function(e,t){var r=(new THREE.Matrix4).makeRotationAxis(new THREE.Vector3(1,0,0),D.rotateX),n=(new THREE.Matrix4).makeTranslation(D.translateX,D.translateY,D.translateZ).scale(new THREE.Vector3(D.scale,-D.scale,D.scale)).multiply(r);this.camera.projectionMatrix=(new THREE.Matrix4).fromArray(t).multiply(n),this.renderer.resetState(),this.renderer.render(this.scene,this.camera)}}]),r}(),L=new M,S=new a.Map(document.getElementById("xyzmap"),{zoomlevel:15,center:{longitude:-80.62089,latitude:28.627275},layers:[k,z],behavior:{}}),C=S.getCenter(),H=[C.longitude,C.latitude,0],A={x:i.webMercator.lon2x(H[0],1),y:i.webMercator.lat2y(H[1],1),z:i.webMercator.alt2z(H[2],H[1])},q=1/i.webMercator.earthCircumference(C.latitude),D={translateX:A.x,translateY:A.y,translateZ:A.z,rotateX:Math.PI/2,scale:q};window.map=S;
},{"leaflet":"H1SE","deck.gl-leaflet":"tyPT","@deck.gl/core":"vvxL","@deck.gl/layers":"aWVN","./style":"Qf5s","@here/xyz-maps-display":"TWyQ","@here/xyz-maps-core":"V0BL"}]},{},["H99C"], null)
//# sourceMappingURL=/src.1bd5fb75.js.map